function Rainbow(){function t(t){if(t.length<2)throw new Error("Rainbow must have two or more colours.");var o=(n-i)/(t.length-1),a=new ColourGradient;a.setGradient(t[0],t[1]),a.setNumberRange(i,i+o),e=[a];for(var s=1;s<t.length-1;s++){var l=new ColourGradient;l.setGradient(t[s],t[s+1]),l.setNumberRange(i+o*s,i+o*(s+1)),e[s]=l}return r=t,this}var e=null,i=0,n=100,r=["ff0000","ffff00","00ff00","0000ff"];t(r),this.setColors=this.setColours,this.setSpectrum=function(){return t(arguments),this},this.setSpectrumByArray=function(e){return t(e),this},this.colourAt=function(t){if(isNaN(t))throw new TypeError(t+" is not a number");if(1===e.length)return e[0].colourAt(t);var r=(n-i)/e.length,o=Math.min(Math.floor((Math.max(t,i)-i)/r),e.length-1);return e[o].colourAt(t)},this.colorAt=this.colourAt,this.setNumberRange=function(e,o){if(!(o>e))throw new RangeError("maxNumber ("+o+") is not greater than minNumber ("+e+")");return i=e,n=o,t(r),this}}function ColourGradient(){function t(t,e,i){var n=t;o>n&&(n=o),n>a&&(n=a);var r=a-o,s=parseInt(e,16),l=parseInt(i,16),c=(l-s)/r,h=Math.round(c*(n-o)+s);return formatHex(h.toString(16))}function e(t){var e=/^#?[0-9a-fA-F]{6}$/i;return e.test(t)}function i(t){if(e(t))return t.substring(t.length-6,t.length);for(var i=[["red","ff0000"],["lime","00ff00"],["blue","0000ff"],["yellow","ffff00"],["orange","ff8000"],["aqua","00ffff"],["fuchsia","ff00ff"],["white","ffffff"],["black","000000"],["gray","808080"],["grey","808080"],["silver","c0c0c0"],["maroon","800000"],["olive","808000"],["green","008000"],["teal","008080"],["navy","000080"],["purple","800080"]],n=0;n<i.length;n++)if(t.toLowerCase()===i[n][0])return i[n][1];throw new Error(t+" is not a valid colour.")}var n="ff0000",r="0000ff",o=0,a=100;this.setGradient=function(t,e){n=i(t),r=i(e)},this.setNumberRange=function(t,e){if(!(e>t))throw new RangeError("maxNumber ("+e+") is not greater than minNumber ("+t+")");o=t,a=e},this.colourAt=function(e){return t(e,n.substring(0,2),r.substring(0,2))+t(e,n.substring(2,4),r.substring(2,4))+t(e,n.substring(4,6),r.substring(4,6))},formatHex=function(t){return 1===t.length?"0"+t:t}}function ParallelCoordinates(){var t,e,i=new Rainbow,n,r=[],o,a;this.setData=function(e){t=e,this.initParallelCoordinates()},this.initParallelCoordinates=function(){d3.select("#plot").append("div").attr("id","parallelPlotWrapper"),t.forEach(function(t){t.Individual=t.Individual.substring(0,11),r.push(t.Individual)}),r=this.dedupe(r),i.setNumberRange(0,r.length),2==r.length?i.setSpectrum("blue","red","green"):i.setSpectrum("blue","red","green","yellow"),this.drawPlot()},this.dedupe=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=!0;t=[];for(var n in e)t.push(n);return t},this.drawPlot=function(){document.getElementById("plot").innerHTML='<div id="parallelPlot" class="parcoords" style="width:700px;height:530px"></div>',e=d3.parcoords()("#parallelPlot"),e.data(t).color(function(t){return"#"+i.colorAt(r.indexOf(t.colorKey||t.Individual))}).margin({top:70,left:0,bottom:40,right:130}).ticks(5).render().brushable(),o=d3.select("#parallelPlot").selectAll("svg").append("svg").attr("class","parallelLegend"),this.drawLegend()},this.drawLegend=function(){o.selectAll(".legend").selectAll("text").remove(),o.selectAll(".legend").selectAll("rect").remove(),a=o.selectAll(".legend").data(r),a.enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(-90,"+(20*e+50)+")"}),a.append("rect").attr("x",766).attr("width",16).attr("height",16).style("fill",function(t){return"#"+i.colorAt(r.indexOf(t))}),a.append("text").attr("x",760).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),a.exit().remove()},this.changeColors=function(t){this.setColorBy(t)},this.setColorBy=function(n){r=[],t.forEach(function(t){t.colorKey="Environment"==n?-1!=t.SampleID.indexOf("key")||-1!=t.SampleID.indexOf("space")?"Key":"Finger":t.Individual,r.push(t.colorKey)}),r=this.dedupe(r),i.setNumberRange(0,r.length),2==r.length?i.setSpectrum("blue","red","green"):i.setSpectrum("blue","red","green","yellow"),e.data(t).updateAxes().render(),this.drawLegend()}}function Partition(t){var e=1120,i=600,n=d3.scale.linear().range([0,e]),r=d3.scale.linear().range([0,i]),o,a,s,l,c,h=this,u;this.initPartition=function(){u=d3.select("#visWrapper").append("div").attr("class","tooltip").style("opacity",0),o=d3.select("#plot").append("div").attr("class","chart").style("width",e+"px").style("height",i+"px").append("svg:svg").attr("width",e).attr("height",i),a=d3.layout.partition().value(function(t){return t.length}),d3.json(t,function(t){function l(t){if(t.children){h=(t.y?e-40:e)/(1-t.y),f=i/t.dx,n.domain([t.y,1]).range([t.y?40:0,e]),r.domain([t.x,t.x+t.dx]);var o=s.transition().duration(d3.event.altKey?7500:750).attr("transform",function(t){return"translate("+n(t.y)+","+r(t.x)+")"});o.select("rect").attr("width",t.dy*h).attr("height",function(t){return t.dx*f}),o.select("text").attr("transform",c).text(function(t){return t.name}).style("display",function(t){return t.dx*f>12&&t.dx>this.getComputedTextLength()?"block":"none"}),d3.event.stopPropagation()}}function c(t){return"translate(1,"+t.dx*f/2+")"}s=o.selectAll("g").data(a.nodes(t)).enter().append("svg:g").attr("transform",function(t){return"translate("+n(t.y)+","+r(t.x)+")"}).on("click",function(t){l(t)});var h=e/t.dx,f=i/1;s.append("svg:rect").attr("width",t.dy*h).attr("height",function(t){return t.dx*f}).attr("class",function(t){return t.children?"parent":"child"}).attr("class","map").on("mouseover",function(t){this.style.opacity=.6,u.transition().duration(200).style("opacity",.9),u.html(t.name).style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(t){this.style.opacity=1,u.transition().duration(500).style("opacity",0)}),s.append("svg:text").attr("transform",c).attr("class","treemaptext").text(function(t){return t.name}).style("display",function(t){return t.dx*f>12&&t.dx>this.getComputedTextLength()?"block":"none"}),d3.select(window).on("click",function(){l(t)})})}}function Scatter(){var t,e,i,n,r,o,a,s,l,c,h,u=new Rainbow,f,d=[],p=[],m,g,v;this.setData=function(e){t=e,this.initScatter()},this.initScatter=function(){e={top:20,right:20,bottom:30,left:40},i=document.getElementById("plot").offsetWidth,n=.97*i-e.left-e.right,r=525-e.top-e.bottom,document.getElementById("plot").innerHTML='<div id="scatter" class="scatter"></div>',d3.select("#visWrapper").append("div").attr("id","axisChoosers").attr("class","axisChoosers"),document.getElementById("axisChoosers").innerHTML='<div id="legendHolder"></div><br><div>X axis:<select id="Xaxis" onchange="javascript:s.axisChanged()"></select><br>Y axis:<select id="Yaxis" onchange="javascript:s.axisChanged()"></select></div>';var h=d3.select("#visWrapper").append("div").html("<br><b>Use the select menus above to change the displayed axes.</b>");o=d3.scale.linear().range([0,n]),a=d3.scale.linear().range([r,0]),s=d3.svg.axis().scale(o).orient("bottom"),l=d3.svg.axis().scale(a).orient("left"),c=d3.select("#scatter").append("svg").attr("width",n+e.left+e.right).attr("height",r+e.top+e.bottom).append("g").attr("transform","translate("+e.left+","+e.top+")"),d3.select("#legendHolder").attr("width",50).attr("height",50),d=d3.keys(t[0]),d.splice(d.indexOf("Individual"),2),this.setSelects(),t.forEach(function(t){p.push(t.Individual.substring(0,11)),d.forEach(function(e){t[e]=+t[e]}),t.ID=t.Individual,t.colorKey=t.ID.substring(0,11),t.uniqueID=t.colorKey+t.ID+m.selectedIndex+g.selectedIndex}),p=this.dedupe(p),u.setNumberRange(0,p.length),2==p.length?u.setSpectrum("blue","red","green"):u.setSpectrum("blue","red","green","yellow"),this.drawPlot(t)},this.changeColors=function(t){this.setColorBy(t)},this.setColorBy=function(e){p=[],t.forEach(function(t){t.colorKey="Environment"==e?-1!=t.SampleID.indexOf("key")||-1!=t.SampleID.indexOf("space")?"Key":"Finger":t.ID.substring(0,11),p.push(t.colorKey),t.uniqueID=t.colorKey+t.ID+m.selectedIndex+g.selectedIndex}),p=this.dedupe(p),u.setNumberRange(0,p.length),2==p.length?u.setSpectrum("blue","red","green"):u.setSpectrum("blue","red","green","yellow"),this.drawPlot(t)},this.setSelects=function(){m=document.getElementById("Xaxis"),g=document.getElementById("Yaxis");var t=document.createElement("option");for(var e in d)t=document.createElement("option"),t.text="PC "+d[e],m.add(t),t=document.createElement("option"),t.text="PC "+d[e],g.add(t);m.selectedIndex=0,g.selectedIndex=1},this.axisChanged=function(){t.forEach(function(t){t.uniqueID=t.uniqueID=t.colorKey+t.ID+m.selectedIndex+g.selectedIndex}),this.drawPlot(t)},this.drawLegend=function(){c.selectAll(".legend").selectAll("text").remove(),c.selectAll(".legend").selectAll("rect").remove(),h=c.selectAll(".legend").data(p).attr("width",150),h.enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+20*e+")"}),h.append("rect").attr("x",n-18).attr("width",18).attr("height",18).style("fill",function(t){return"#"+u.colorAt(p.indexOf(t))}),h.append("text").attr("x",n-24).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),h.exit().remove()},this.drawPlot=function(t){o.domain(d3.extent(t,function(t){return t[m.selectedIndex+1]})).nice(),a.domain(d3.extent(t,function(t){return t[g.selectedIndex+1]})).nice(),c.select("#xaxis").remove(),c.select("#yaxis").remove(),c.selectAll(".dot").remove(),c.append("g").attr("class","x axis").attr("id","xaxis").attr("transform","translate(0,"+r+")").call(s).append("text").attr("class","label").attr("x",n).attr("y",-6).style("text-anchor","end").text("PC "+(m.selectedIndex+1)),c.append("g").attr("class","y axis").attr("id","yaxis").call(l).append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("PC "+(g.selectedIndex+1));var e=c.selectAll(".dot").data(t,function(t){return t.uniqueID});e.enter().append("circle").attr("class","dot").attr("r",3.5).attr("cx",function(t){return o(t[m.selectedIndex+1])}).attr("cy",function(t){return a(t[g.selectedIndex+1])}).style("fill",function(t){return"#"+u.colorAt(p.indexOf(t.colorKey))}),e.exit().remove(),this.drawLegend()},this.dedupe=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=!0;t=[];for(var n in e)t.push(n);return t}}function Splom(){function t(t){e.data!==t&&(d.call(e.clear()),e.x(c[t.x]).y(h[t.y]).data=t)}function e(t){var i=e.extent();f.selectAll(".cell circle").attr("class",function(e){return i[0][0]<=e[t.x]&&e[t.x]<=i[1][0]&&i[0][1]<=e[t.y]&&e[t.y]<=i[1][1]?e.colorKey:null})}function i(){e.empty()&&f.selectAll(".cell circle").attr("class",function(t){return t.colorKey})}function n(t,e){var i=[],n=t.length,r=e.length,o,a;for(o=-1;++o<n;)for(a=-1;++a<r;)i.push({x:t[o],i:o,y:e[a],j:a});return i}var r,o,a=125,s=10,l=4,c={},h={},u,e=d3.svg.brush().on("brushstart",t).on("brush",e).on("brushend",i),f,d,p,m,g,v=[],E,y,x=new Rainbow,T,b;this.setData=function(t){r=t,this.initSplom()},this.initSplom=function(){m=600,g=525,document.getElementById("plot").innerHTML='<div id="splom" class="splom"></div>',E=d3.keys(r[0]),E.splice(E.indexOf("Individual"),2),y=[],r.forEach(function(t){v.push(t.Individual.substring(0,11));var e={};E.forEach(function(i){e[i]=+t[i]}),e.Individual=t.Individual.substring(0,11),t.Individual=t.Individual.substring(0,11),t.colorKey=t.Individual,y.push(e)}),v=this.dedupe(v),o={axes:E,groups:v,values:y},o.values.forEach(function(t){o.axes.forEach(function(t){var e=function(e){return e[t]},i=[d3.min(o.values,e),d3.max(o.values,e)],n=[s/2,a-s/2];c[t]=d3.scale.linear().domain(i).range(n),h[t]=d3.scale.linear().domain(i).range(n.reverse())})}),x.setNumberRange(0,v.length),2==v.length?x.setSpectrum("blue","red","green"):x.setSpectrum("blue","red","green","yellow"),this.drawPlot()},this.changeColors=function(t){this.setColorBy(t)},this.setColorBy=function(t){v=[],r.forEach(function(e){e.colorKey="Environment"==t?-1!=e.SampleID.indexOf("key")||-1!=e.SampleID.indexOf("space")?"Key":"Finger":e.Individual,v.push(e.colorKey)}),v=this.dedupe(v),o={axes:E,groups:v,values:y},x.setNumberRange(0,v.length),2==v.length?x.setSpectrum("blue","red","green"):x.setSpectrum("blue","red","green","yellow"),this.drawPlot()},this.drawPlot=function(){d3.select("#splom").selectAll("svg").remove(),u=d3.svg.axis().ticks(3).tickSize(a*l),f=d3.select("#splom").append("svg:svg").attr("width",m).attr("height",g).append("svg:g").attr("transform","translate(5,5)"),f.selectAll("g.x.axis").data(E).enter().append("svg:g").attr("class","x axis").attr("transform",function(t,e){return"translate("+e*a+",0)"}).each(function(t){d3.select(this).call(u.scale(c[t]).orient("bottom"))}),f.selectAll("g.y.axis").data(E).enter().append("svg:g").attr("class","y axis").attr("transform",function(t,e){return"translate(0,"+e*a+")"}).each(function(t){d3.select(this).call(u.scale(h[t]).orient("right"))}),d=f.selectAll("g.cell").data(n(E,E)).enter().append("svg:g").attr("class","cell").attr("transform",function(t){return"translate("+t.i*a+","+t.j*a+")"}).each(this.plot),d.filter(function(t){return t.i==t.j}).append("svg:text").attr("x",s).attr("y",s).attr("dy",".71em").text(function(t){return"Axis "+t.x}),d.filter(function(t){return t.i!=t.j}).append("svg:text").attr("x",s).attr("y",s).attr("dy",".71em").text(function(t){return"Axis "+t.x+" × Axis "+t.y}),T=d3.select("#splom").selectAll("svg").append("svg").attr("class","splomLegend"),this.drawLegend()},this.drawLegend=function(){b=T.selectAll(".legend").data(v),b.enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(10,"+(20*e+50)+")"}),b.append("rect").attr("x",m-24).attr("width",16).attr("height",16).style("fill",function(t){return"#"+x.colorAt(v.indexOf(t))}),b.append("text").attr("x",m-30).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),b.exit().remove()},this.plot=function(t){var i=d3.select(this);i.append("svg:rect").attr("class","frame").attr("x",s/2).attr("y",s/2).attr("width",a-s).attr("height",a-s),i.selectAll("circle").data(r).enter().append("svg:circle").attr("class",function(t){return t.colorKey}).attr("cx",function(e){return c[t.x](e[t.x])}).attr("cy",function(e){return h[t.y](e[t.y])}).attr("r",3),i.call(e.x(c[t.x]).y(h[t.y]))},this.dedupe=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=!0;t=[];for(var n in e)t.push(n);return t}}function NormalizedStackedBar(){var t,e,i,n,r,a,s,l,c,h,u,f,d,p,m,g,v,E,y,x,T,b=new Rainbow;this.setBiom=function(t){f=t,this.initTaxonomyBarChart()},this.initTaxonomyBarChart=function(){e=document.getElementById("plot").offsetWidth,t={top:30,right:180,bottom:200,left:50},i=.9*e,n=600-t.top-t.bottom,r=d3.scale.ordinal().rangeBands([0,i],.1),a=d3.scale.linear().rangeRound([n,0]),b.setSpectrum("#e41a1c","#377eb8","#4daf4a","#984ea3","#000000"),l=d3.svg.axis().scale(r).orient("bottom"),c=d3.svg.axis().scale(a).orient("left").tickFormat(d3.format(".0%")),u=d3.select("#visWrapper").append("div").attr("class","tooltip").style("opacity",0);var o=["Phylum","Class","Order","Family","Genus","Species"];YaxisVis=d3.select("#yaxisholder"),YaxisSvg=YaxisVis.append("svg").attr("width",t.left).attr("height",n+t.top+10).attr("id","yaxis").append("g").attr("transform","translate("+t.left+","+t.top+")"),m=d3.select("#plot"),v=m.append("svg").attr("width",690).attr("height",465).attr("id","chart").append("g").attr("transform","translate(-10,"+t.top+")"),this.setData(1),r.domain(d.map(function(t){return t.SampleID})),YaxisSvg.append("g").attr("class","y axis").call(c),YaxisSvg.append("text").attr("class","axisLabel").attr("text-anchor","middle").attr("y",-55).attr("x",-n/2).attr("dy",".75em").attr("transform","rotate(-90)").text("Relative Abundance");var s=[{group:"SampleID"}];y=v.selectAll(".SampleID").data(d).enter().append("g").attr("class","SampleID").attr("transform",function(t){return"translate("+r(t.SampleID)+",0)"}),this.getTotalAbundances(d),this.drawTaxonomyBarVis(d)},this.getTotalAbundances=function(t){var e={};for(var i in t)for(var n=t[i].abundances,r=0;r<n.length;r++)n[r].name in e||(e[n[r].name]=0),e[n[r].name]+=Math.abs(n[r].y0-n[r].y1)},this.setData=function(t){d=[];var e=[],i={};if(x=[],"dense"==f.matrix_type)for(var n=0;n<f.columns.length;n++){e[n]=f.columns[n].id,i={SampleID:e[n]},i.metadata=f.columns[n].metadata,i.tax={};for(var r=0;r<f.rows.length;r++){var s=f.rows[r].metadata.taxonomy[t];x.push(s),s in i.tax||(i.tax[s]=0),i.tax[s]+=f.data[r][n]}d.push(i)}else{var l={};x=[];for(var r=0;r<f.data.length;r++){var c=f.data[r][0],h=f.data[r][1],u=f.data[r][2],s=f.rows[c].metadata.taxonomy[t];if(void 0!=s){x.push(s);var p=f.columns[h].id;p in l||(l[p]={},l[p].metadata=f.columns[h].metadata),s in l[p]||(l[p][s]=0),l[p][s]+=u}}for(o in l){i={SampleID:o},i.metadata=l[o].metadata,i.tax={};for(var n=0;n<x.length;n++)i.tax[x[n]]=x[n]in l[o]?l[o][x[n]]:0;d.push(i)}}var m=d3.keys(d[d3.keys(d)[0]].tax);d.forEach(function(t){var e=0;t.abundances=m.map(function(i){return{name:i,y0:e,y1:e+=+t.tax[i]}}),t.seqCount=t.abundances[t.abundances.length-1].y1,t.abundances.forEach(function(t){t.y0/=e,t.y1/=e}),t.total=t.abundances[t.abundances.length-1].y1,t.count=t.abundances.length,t.metadata=t.metadata}),a.domain([0,d3.max(d,function(t){return t.total})]),d.sort(function(t,e){return t.SampleID.localeCompare(e.SampleID)}),b.setNumberRange(0,m.length)},this.dedupe=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=!0;t=[];for(var n in e)t.push(n);return t},this.drawLegend=function(t){var e=v.selectAll(".legend").data(d3.keys(d[d3.keys(t)[0]].tax).slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+20*e+")"});e.append("rect").attr("x",i).attr("width",18).attr("height",18).style("fill",function(e){return"#"+b.colorAt(d3.keys(t[d3.keys(t)[0]].tax).indexOf(e))}),e.append("text").attr("x",i+22).attr("y",9).attr("dy",".35em").text(function(t){return t.substring(4,t.length)})},this.drawTaxonomyBarVis=function(t,e){e=!0,r=d3.scale.ordinal().rangeRoundBands([0,i],.1),r.domain(t.map(function(t){return t.SampleID})),y.selectAll("rect").remove(),y.selectAll("text").remove(),v.selectAll(".xAxisLabel").remove(),YaxisSvg.selectAll(".y.axis").remove(),c=d3.svg.axis().scale(a).orient("left").tickFormat(d3.format(".0%")),YaxisSvg.append("g").attr("class","y axis").call(c),y=v.selectAll(".SampleID").data(t).attr("transform",function(t){return"translate("+r(t.SampleID)+",0)"}),y.append("text").attr("y",r.rangeBand()/2).attr("x",-n-15).attr("text-anchor","end").attr("transform",function(t){return"rotate(-90)"}).text(function(t){return t.SampleID}),y.selectAll("rect").data(function(t){return t.abundances}).enter().append("rect").attr("width",r.rangeBand()).attr("y",function(t){return a(t.y1)}).attr("height",function(t){return a(t.y0)-a(t.y1)}).style("fill",function(t){return"#"+b.colorAt(d3.keys(d[d3.keys(d)[0]].tax).indexOf(t.name))}).on("mouseover",function(t){this.style.opacity=.6,u.transition().duration(200).style("opacity",.9),u.html(t.name.substring(4,t.name.length)+": "+(100*Math.abs(t.y0-t.y1)).toFixed(2)+"%").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(t){this.style.opacity=1,u.transition().duration(500).style("opacity",0)}),this.drawLegend(t)}}function Sunburst(t){var e,i,n=600,r=500,o=0,a=n/2,s,l,c,h=new Rainbow,u,f,d=this,p=0;this.initSunburst=function(){e=d3.scale.linear().range([0,2*Math.PI]),i=d3.scale.pow().exponent(1.3).domain([0,1]).range([0,a]);var c=d3.select("#plot"),h=c.append("svg").attr("width",n).attr("height",r).append("g").attr("transform","translate("+[a+o,a-100+o]+")"),u=d3.layout.partition().value(function(t){return t.length});this.arc(),d3.json(t,function(t){var n=u.nodes(t);t=t,paths=h.selectAll("path").data(n),l=paths.enter().append("path").attr("id","sunburst").attr("d",s).attr("fill-rule","evenodd").attr("display",function(t){return t.depth?null:"none"}).style("fill",function(t){return t.children?"#AAA":"#3182bd"});var r=h.selectAll("text").data(n),a=r.enter().append("text").attr("text-anchor",function(t){return e(t.x+t.dx/2)>Math.PI?"end":"start"}).attr("dy",".2em").attr("transform",function(t){var n=(t.name+": "+t.length||"").split(" ").length>1,r=180*e(t.x+t.dx/2)/Math.PI-90,a=r+(n?-.5:0);return"rotate("+a+")translate("+(i(t.y)+o)+")rotate("+(r>90?-180:0)+")"});a.append("tspan").attr("x",0).text(function(t){return t.depth?(t.name+" ("+t.length+")").split(" ")[0]:""}),a.append("tspan").attr("x",0).attr("dy","1em").text(function(t){return t.depth?(t.name+" ("+t.length+")").split(" ")[1]||"":""})}),d3.select("#container").on("mouseleave",this.mouseleave),d3.select(self.frameElement).style("height",r+"px")},this.arc=function(){s=d3.svg.arc().startAngle(function(t){return Math.max(0,Math.min(2*Math.PI,e(t.x)))}).endAngle(function(t){return Math.max(0,Math.min(2*Math.PI,e(t.x+t.dx)))}).innerRadius(function(t){return Math.max(0,i(t.y))}).outerRadius(function(t){return Math.max(0,i(t.y+t.dy))})}}function ThreeD(){var t,e=new Rainbow,i,n=[],r={},o=8,a=8,s=.01,l,c,h,u,f,d,p,m,g,v,E,y,x,T,b,_,w,R,H,M=0,S=1,C=2,A=3,D,P,k=this,L=[],N,F,I,z,O=[],U,B="",V=1,W;this.setData=function(i){function r(){d3.select("#visWrapper").append("div").attr("id","axislabels").attr("class","axislabels"),W=new THREE.PerspectiveCamera(se,he,le,ce),document.getElementById("plot").style.overflow="hidden",$("#plot canvas").attr("width",380),$("#plot canvas").attr("height",380),W.aspect=document.getElementById("plot").offsetWidth/document.getElementById("plot").offsetHeight,W.rotation.set(0,0,0),W.updateProjectionMatrix(),W.position.set(0,0,4.8*_+s),g_mainScene=new THREE.Scene,g_mainScene.add(W),U=new THREE.SphereGeometry(s,o,a),z=new THREE.Object3D,g_mainScene.add(z),L(),g_sceneLight=new THREE.DirectionalLight(10066329,2),g_sceneLight.position.set(1,1,1).normalize(),W.add(g_sceneLight),g_sceneControl=new THREE.TrackballControls(W,document.getElementById("plot")),g_sceneControl.rotateSpeed=1,g_sceneControl.zoomSpeed=1.2,g_sceneControl.panSpeed=.8,g_sceneControl.noZoom=!1,g_sceneControl.noPan=!1,g_sceneControl.staticMoving=!0,g_sceneControl.dynamicDampingFactor=.3,g_sceneControl.keys=[65,83,68];var t=new THREE.Color;t.setHex("0xf5f5f5"),g_mainRenderer=new THREE.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0}),g_mainRenderer.setClearColor(t,1),g_mainRenderer.setSize(document.getElementById("plot").offsetWidth,document.getElementById("plot").offsetHeight),g_mainRenderer.sortObjects=!0,Q.append(g_mainRenderer.domElement),B(),j(),X(),k.initLegend(),P()}function M(){requestAnimationFrame(M),D();var t;t=q(new THREE.Vector3(u,m,g),W,$("#plot")),$("#pc1_label").css("left",t.x),$("#pc1_label").css("top",t.y),t=q(new THREE.Vector3(p,f,g),W,$("#plot")),$("#pc2_label").css("left",t.x),$("#pc2_label").css("top",t.y),t=q(new THREE.Vector3(p,m,d),W,$("#plot")),$("#pc3_label").css("left",t.x),$("#pc3_label").css("top",t.y)}function D(){g_sceneControl.update(),g_mainRenderer.render(g_mainScene,W)}function P(){g_sceneControl.reset(),W.aspect=document.getElementById("plot").offsetWidth/document.getElementById("plot").offsetHeight,W.rotation.set(0,0,0),W.updateProjectionMatrix(),W.position.set(0,0,4.8*_+s)}function L(){t.forEach(function(t){var e=new THREE.Mesh(U,new THREE.MeshLambertMaterial);e.material.color=new THREE.Color,e.material.transparent=!0,e.material.depthWrite=!1,e.material.opacity=1,e.position.set(t[S],t[C],t[A]),e.updateMatrix(),e.matrixAutoUpdate=!0,g_mainScene.add(e);var i={mesh:e,obj:t};O.push(i)})}function B(){O.forEach(function(t){t.mesh.material.color.setHex("0x"+e.colorAt(n.indexOf(t.obj.colorKey)))})}function V(){v=d3.max(t,function(t){return t[S]}),E=d3.max(t,function(t){return t[C]}),y=d3.max(t,function(t){return t[A]}),x=d3.min(t,function(t){return t[S]}),T=d3.min(t,function(t){return t[C]}),b=d3.min(t,function(t){return t[A]}),u=v+(v>=0?6*s:-6*s),f=E+(E>=0?6*s:-6*s),d=y+(y>=0?6*s:-6*s),p=x+(x>=0?6*s:-6*s),m=T+(T>=0?6*s:-6*s),g=b+(b>=0?6*s:-6*s),l=u-p,c=f-m,h=d-g,_=d3.max([u,f,d])}function j(){N=G([p,m,g],[u,m,g],"0x000000",3),F=G([p,m,g],[p,f,g],"0x000000",3),I=G([p,m,g],[p,m,d],"0x000000",3),N.material.transparent=!1,F.material.transparent=!1,I.material.transparent=!1,g_mainScene.add(N),g_mainScene.add(F),g_mainScene.add(I)}function G(t,e,i,n){var r,o,a;return r=new THREE.LineBasicMaterial({color:i,linewidth:n}),r.matrixAutoUpdate=!0,r.transparent=!0,r.opacity=1,o=new THREE.Geometry,o.vertices.push(new THREE.Vector3(t[0],t[1],t[2])),o.vertices.push(new THREE.Vector3(e[0],e[1],e[2])),a=new THREE.Line(o,r)}function X(){w="Axis "+S,R="Axis "+C,H="Axis "+A;var t="",e=q(new THREE.Vector3(u,m,g),W,$("#plot"));t+='<label id="pc1_label" class="unselectable labels" style="position:absolute; left:'+parseInt(e.x)+"px; top:"+parseInt(e.y)+'px;">',t+=w,t+="</label>";var i=q(new THREE.Vector3(p,f,g),W,$("#plot"));t+='<label id="pc2_label" class="unselectable labels" style="position:absolute; left:'+parseInt(i.x)+"px; top:"+parseInt(i.y)+'px;">',t+=R,t+="</label>";var n=q(new THREE.Vector3(p,m,d),W,$("#plot"));t+='<label id="pc3_label" class="unselectable labels" style="position:absolute; left:'+parseInt(n.x)+"px; top:"+parseInt(n.y)+'px;">',t+=H,t+="</label>",document.getElementById("axislabels").innerHTML=t}function q(t,e,i){var n=t.clone(),r=new THREE.Matrix4;return r.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),n.applyProjection(r),{x:(n.x+1)*i.width()/2+i.offset().left,y:(-n.y+1)*i.height()/2+i.offset().top}}function Y(t){return!isNaN(parseFloat(t))&&isFinite(t)}t=i;var K=d3.keys(t[0]);K.splice(K.indexOf("Individual"),2),t.forEach(function(t){n.push(t.Individual.substring(0,11)),t.Individual=t.Individual.substring(0,11),t.colorKey=t.Individual;var e={};K.forEach(function(e){t[e]=+t[e]})}),n=this.dedupe(n),e.setNumberRange(0,n.length),2==n.length?e.setSpectrum("blue","red","green"):e.setSpectrum("blue","red","green","yellow"),V();var Q=$("#plot"),Z,J,te,ee,ie,ne,re=0,oe=0,ae=Math.min(document.getElementById("visWrapper").offsetWidth,document.getElementById("visWrapper").offsetHeight),se=25,le=1,ce=1e4,he=document.getElementById("visWrapper").offsetWidth/document.getElementById("visWrapper").offsetHeight;window.WebGLRenderingContext?(r(),M()):window.location="http://get.webgl.org"},this.dedupe=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=!0;t=[];for(var n in e)t.push(n);return t},this.changeColors=function(t){this.setColorBy(t)},this.setColorBy=function(i){n=[],t.forEach(function(t){t.colorKey="Environment"==i?-1!=t.SampleID.indexOf("key")||-1!=t.SampleID.indexOf("space")?"Key":"Finger":t.Individual,n.push(t.colorKey)}),n=this.dedupe(n),e.setNumberRange(0,n.length),2==n.length?e.setSpectrum("blue","red","green"):e.setSpectrum("blue","red","green","yellow"),O.forEach(function(t){t.mesh.material.color.setHex("0x"+e.colorAt(n.indexOf(t.obj.colorKey)))}),this.drawLegend()},this.initLegend=function(){d3.select("#visWrapper").append("div").attr("id","legendDiv"),this.drawLegend()},this.drawLegend=function(){document.getElementById("legendDiv").innerHTML="";var t="<ul>";for(var i in n)t+="<li>"+n[i]+'<div class="colorbox" style="background-color:#'+e.colorAt(i)+'"></div></li>';t+="</ul>",document.getElementById("legendDiv").innerHTML=t}}function DonutCharts(){var t=74,e=10,i,n,r,a,s,l,c,h,u,f,d,p,m,g,v=new Rainbow;this.setBiom=function(t){h=t,this.initTaxonomyBarChart()},this.initTaxonomyBarChart=function(){v.setSpectrum("#e41a1c","#377eb8","#4daf4a","#984ea3","#000000"),s=d3.select("#donutplot").append("div").attr("class","tooltip").style("opacity",0),l=d3.select("#donutplot").append("div").attr("class","donutLegendDiv").attr("id","donutLegendDiv").attr("width",180);var e=["Phylum","Class","Order","Family","Genus","Species"];d=d3.select("#donutplot"),c=d3.select("#donutLegendDiv"),i=d3.svg.arc().outerRadius(t).innerRadius(t-30),n=d3.layout.pie().sort(null).value(function(t){return t.abundance}),this.setData(1),a=d.selectAll(".pie").data(u).enter().append("svg").attr("class","pie").attr("width",2*t).attr("height",2*t).append("g").attr("transform","translate("+t+","+t+")"),r=a.selectAll(".arc").data(function(t){return n(t.abundances)}).enter().append("path").attr("class","arc").attr("d",i).style("fill",function(t){return"#"+v.colorAt(d3.keys(u[d3.keys(u)[0]].tax).indexOf(t.data.name))}),a.append("text").attr("dy",".35em").style("text-anchor","middle").text(function(t){return t.name}),this.getTotalAbundances(u),this.drawTaxonomyBarVis(u)},this.getTotalAbundances=function(t){var e={};for(var i in t)for(var n=t[i].abundances,r=0;r<n.length;r++)n[r].name in e||(e[n[r].name]=0),e[n[r].name]+=Math.abs(n[r].y0-n[r].y1)},this.setData=function(t){u=[];var e=[],i={};if(g=[],"dense"==h.matrix_type)for(var n=0;n<h.columns.length;n++){e[n]=h.columns[n].id,i={SampleID:e[n]},i.metadata=h.columns[n].metadata,i.tax={};for(var r=0;r<h.rows.length;r++){var a=h.rows[r].metadata.taxonomy[t];g.push(a),a in i.tax||(i.tax[a]=0),i.tax[a]+=h.data[r][n]}u.push(i)}else{var s={};g=[];for(var r=0;r<h.data.length;r++){var l=h.data[r][0],c=h.data[r][1],f=h.data[r][2],a=h.rows[l].metadata.taxonomy[t];if(void 0!=a){g.push(a);var d=h.columns[c].id;d in s||(s[d]={},s[d].metadata=h.columns[c].metadata),a in s[d]||(s[d][a]=0),s[d][a]+=f}}g=this.dedupe(g);for(o in s){i={SampleID:o},i.metadata=s[o].metadata,i.tax={};for(var n=0;n<g.length;n++)i.tax[g[n]]=g[n]in s[o]?s[o][g[n]]:0;u.push(i)}}var p=d3.keys(u[d3.keys(u)[0]].tax);u.forEach(function(t){t.name=t.SampleID,t.abundances=p.map(function(e){return{name:e,abundance:+t.tax[e]}}),t.total=d3.sum(t.abundances,function(t){return t.abundance}),t.abundances.forEach(function(e){e.percent=e.abundance/t.total}),t.metadata=t.metadata}),u.sort(function(t,e){return t.SampleID.localeCompare(e.SampleID)}),v.setNumberRange(0,p.length)},this.dedupe=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=!0;t=[];for(var n in e)t.push(n);return t},this.drawLegend=function(t){var e=c.append("svg").attr("class","legend").attr("width",200).attr("height",450).selectAll("g").data(d3.keys(u[d3.keys(t)[0]].tax).slice().reverse()).enter().append("g").attr("transform",function(t,e){return"translate(0,"+20*e+")"});e.append("rect").attr("width",18).attr("height",18).style("fill",function(e){return"#"+v.colorAt(d3.keys(t[d3.keys(t)[0]].tax).indexOf(e))}),e.append("text").attr("x",24).attr("y",9).attr("dy",".35em").text(function(t){return t.substring(4,t.length)})},this.drawTaxonomyBarVis=function(e,o){this.drawLegend(e),d.selectAll(".pie").remove(),a.selectAll("text").remove(),a=d.selectAll(".pie").data(e).enter().append("svg").attr("class","pie").attr("width",2*t).attr("height",2*t).append("g").attr("transform","translate("+t+","+t+")"),r=a.selectAll(".arc").data(function(t){return n(t.abundances)}).enter().append("path").attr("class","arc").attr("d",i).style("fill",function(t){return"#"+v.colorAt(d3.keys(u[d3.keys(u)[0]].tax).indexOf(t.data.name))}).on("mouseover",function(t){this.style.opacity=.6,s.transition().duration(200).style("opacity",.9),s.html(t.data.name.substring(4,t.data.name.length)+": "+(100*t.data.percent).toFixed(2)+"%").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(t){this.style.opacity=1,s.transition().duration(500).style("opacity",0)}),a.append("text").attr("dy",".35em").style("text-anchor","middle").text(function(t){return t.name})}}function AreaChart(){var t,e,i,n,r,a,s,l,c,h,u,f,d,p,m,g,v,E,y,x,T,b,_=new Rainbow;this.setBiom=function(t){m=t,this.initTaxonomyChart()},this.initTaxonomyChart=function(){e=document.getElementById("plot").offsetWidth,t={top:30,right:180,bottom:200,left:50},i=.9*e,n=600-t.top-t.bottom,r=d3.scale.ordinal().rangePoints([0,i]),a=d3.scale.linear().range([n,0]),_.setSpectrum("#e41a1c","#377eb8","#4daf4a","#984ea3","#000000"),f=d3.svg.axis().scale(r).orient("bottom"),d=d3.svg.axis().scale(a).orient("left").tickFormat(d3.format(".0%")),p=d3.select("#visWrapper").append("div").attr("class","tooltip").style("opacity",0),YaxisVis=d3.select("#yaxisholder"),YaxisSvg=YaxisVis.append("svg").attr("width",t.left).attr("height",n+t.top+10).attr("id","yaxis").append("g").attr("transform","translate("+t.left+","+t.top+")"),YaxisSvg.append("g").attr("class","y axis").call(d),YaxisSvg.append("text").attr("class","axisLabel").attr("text-anchor","middle").attr("y",-55).attr("x",-n/2).attr("dy",".75em").attr("transform","rotate(-90)").text("Relative Abundance"),E=d3.select("#plot"),y=E.append("svg").attr("width",690).attr("height",465).attr("id","chart").append("g").attr("transform","translate(0,"+t.top+")"),s=d3.svg.area().x(function(t){return r(t.SampleID)
}).y0(function(t){return a(t.y0)}).y1(function(t){return a(t.y0+t.y)}),l=d3.layout.stack().values(function(t){return t.values}),this.setData(1),r.domain(g.map(function(t){return t.SampleID})),x=y.selectAll(".SampleID").data(g).enter().append("g").attr("class","SampleID").attr("transform",function(t){return"translate("+r(t.SampleID)+",0)"}),h=y.selectAll(".taxon").data(c).enter().append("g").attr("class","taxon"),g.sort(function(t,e){return t.SampleID.localeCompare(e.SampleID)}),this.getTotalAbundances(g),this.drawTaxonomyVis(g)},this.getTotalAbundances=function(t){var e={};for(var i in t)for(var n=t[i].abundances,r=0;r<n.length;r++)n[r].name in e||(e[n[r].name]=0),e[n[r].name]+=Math.abs(n[r].y0-n[r].y1)},this.setData=function(t){g=[];var e=[],i={};if(T=[],"dense"==m.matrix_type)for(var n=0;n<m.columns.length;n++){e[n]=m.columns[n].id,i={SampleID:e[n]},i.metadata=m.columns[n].metadata,i.tax={};for(var r=0;r<m.rows.length;r++){var a=m.rows[r].metadata.taxonomy[t];T.push(a),a in i.tax||(i.tax[a]=0),i.tax[a]+=m.data[r][n]}g.push(i)}else{var s={};T=[];for(var r=0;r<m.data.length;r++){var h=m.data[r][0],u=m.data[r][1],f=m.data[r][2],a=m.rows[h].metadata.taxonomy[t];if(void 0!=a){T.push(a);var d=m.columns[u].id;d in s||(s[d]={},s[d].metadata=m.columns[u].metadata),a in s[d]||(s[d][a]=0),s[d][a]+=f}}T=this.dedupe(T);for(o in s){i={SampleID:o},i.metadata=s[o].metadata,i.tax={};for(var n=0;n<T.length;n++)i.tax[T[n]]=T[n]in s[o]?s[o][T[n]]:0;g.push(i)}}var p=d3.keys(g[d3.keys(g)[0]].tax);g.forEach(function(t){var e=0;t.abundances=p.map(function(i){return{name:i,y0:e,y1:e+=+t.tax[i]}}),t.total=t.abundances[t.abundances.length-1].y1,t.metadata=t.metadata}),c=l(p.map(function(t){return{name:t,values:g.map(function(e){return{SampleID:e.SampleID,y:e.tax[t]/e.total}})}})),_.setNumberRange(0,p.length),c.forEach(function(t){t.values=t.values.sort(function(t,e){return t.SampleID.localeCompare(e.SampleID)})})},this.dedupe=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=!0;t=[];for(var n in e)t.push(n);return t},this.drawLegend=function(t){var e=y.selectAll(".legend").data(d3.keys(g[d3.keys(t)[0]].tax).slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(10,"+20*e+")"});e.append("rect").attr("x",i).attr("width",18).attr("height",18).style("fill",function(e){return"#"+_.colorAt(d3.keys(t[d3.keys(t)[0]].tax).indexOf(e))}),e.append("text").attr("x",i+22).attr("y",9).attr("dy",".35em").text(function(t){return t.substring(4,t.length)})},this.drawTaxonomyVis=function(t,e){r.domain(t.map(function(t){return t.SampleID})),h.selectAll("path").remove(),x.selectAll("text").remove(),y.selectAll(".xAxisLabel").remove(),x=y.selectAll(".SampleID").data(t).attr("transform",function(t){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"Sample 1"==t.SampleID?"translate("+r(t.SampleID)+"10,0)":"translate("+r(t.SampleID)+",0)"}),x.append("text").attr("y",function(t){return r(t.sampleID)}).attr("x",-n-15).attr("text-anchor","end").attr("transform",function(t){return"rotate(-90)"}).text(function(t){return t.SampleID}),h=y.selectAll(".taxon").data(c),h.append("path").attr("class","area").attr("d",function(t){return s(t.values)}).style("fill",function(t){return"#"+_.colorAt(d3.keys(g[d3.keys(g)[0]].tax).indexOf(t.name))}).on("mouseover",function(t){this.style.opacity=.6,p.transition().duration(200).style("opacity",.9),p.html(t.name.substring(4,t.name.length)).style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(t){this.style.opacity=1,p.transition().duration(500).style("opacity",0)}),h.enter().append("path").attr("class","area").attr("d",function(t){return s(t.values)}).style("fill",function(t){return"#"+_.colorAt(d3.keys(g[d3.keys(g)[0]].tax).indexOf(t.name))}).on("mouseover",function(t){this.style.opacity=.6,p.transition().duration(200).style("opacity",.9),p.html(t.name.substring(4,t.name.length)).style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(t){this.style.opacity=1,p.transition().duration(500).style("opacity",0)}),this.drawLegend(t)}}function buildSurvey(){if(urlParams.admin)window.onbeforeunload=null,visType=urlParams.admin[0],visID=urlParams.admin[1],$("#dialog-confirm").remove(),visFuns[visType][visID]();else{var t=[];urlParams.ids&&(t=urlParams.ids.split("_"));var e=["0","1","2"];if(t.length<3){newURL="http://";for(var i=document.URL.split("/"),n=2;n<i.length-1;n++)newURL+=i[n]+"/";newURL+="?src="+urlParams.src+"&u="+urlParams.u+"&ids=";for(var n in t)e.splice(e.indexOf(t[n][0]),1),newURL+=t[n]+"_";visType=e[Math.floor(Math.random()*e.length)],$.post("getVisID.php",{visType:visType,hasWebGl:null!=webgl_support()}).done(function(t){visID=parseInt(t),isNaN(visID)&&(visID=Math.floor(Math.random()*visFuns[visType].length)),2==visType&&(document.getElementById("multidimDefs").style.display="block",$("#multidimDefs").accordion("refresh"),3==visID&&null==webgl_support()&&(visID=Math.floor(Math.random()*visFuns[visType].length-1)),3==visID&&webgl_support()&&(document.getElementById("threeDnote").style.display="block")),1==visType&&(document.getElementById("phylogenyDefs").style.display="block",$("#phylogenyDefs").accordion("refresh")),0==visType&&(document.getElementById("abundanceNote").style.display="block",document.getElementById("abundanceDefs").style.display="block",$("#abundanceDefs").accordion("refresh")),buildPage(visID)})}else{window.onbeforeunload=null,$("#visWrapper").remove(),$("#nextSurvey").remove(),$("#dialog-confirm").remove(),$("#surveyNote").remove();var r=surveyStart+'FVDKBJX?c=" width="800" height="1347" style="border:0px;padding-bottom:4px;" frameborder="0" allowtransparency="true" ></iframe></div></div>';document.getElementById("survey").innerHTML=r}}}function buildPage(t){visID=t,visFuns[visType][visID]();var e=surveyIDs[visType]+urlParams.u+"_"+urlParams.src+"_"+visType+visID,i=Math.max($(window).height()-Math.max($("#visWrapper").height(),550)-$(".defNote").height()-$("#surveyNote").height(),200);surveyEnd='" width="800" height="'+i+'" style="border:0px;padding-bottom:4px;" frameborder="0" allowtransparency="true" ></iframe></div></div>';var n=surveyStart+e+surveyEnd;document.getElementById("survey").innerHTML=n,newURL+=visType+""+visID}function log(t,e){$.post("record.php",{vis:!0,visID:t,visType:e,id:urlParams.u,src:urlParams.src})}function triggerNextSurvey(){window.parent.onbeforeunload=null,newURL=window.parent.newURL,visID=window.parent.visID,visType=window.parent.visType,urlParams.u=window.parent.urlParams.u,urlParams.src=window.parent.urlParams.src,$.post("record.php",{vis:!0,visID:visID,visType:visType,id:urlParams.u,src:urlParams.src}).done(function(t){window.parent.open(newURL,"_self")})}function webgl_support(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}function sunburst(){s=new Sunburst("data/keyboard_mini.json"),document.getElementById("visWrapper").style.height="480px",d3.select("#visWrapper").append("div").attr("id","plot"),s.initSunburst()}function rectangularTree(){function t(e,n){if(i.push(e),e.branchset)for(var r=0;r<e.branchset.length;r++)t(e.branchset[r])}d3.select("#visWrapper").selectAll("div").remove(),d3.select("#visWrapper").append("div").attr("id","plot"),document.getElementById("visWrapper").style.height="500px";var e=Newick.parse("((Taxon6:0.020,(Taxon7:0.076,Taxon8:0.093):0.011):0.015,(Taxon1:0.011,(Taxon2:0.032,(Taxon3:0.030,(Taxon4:0.014,Taxon5:0.050):.001):0.006):0.017):0.016);"),i=[];t(e),d3.phylogram.build("#plot",e,{width:1050,skipLabels:!1})}function radialTree(){function t(e,n){if(i.push(e),e.branchset)for(var r=0;r<e.branchset.length;r++)t(e.branchset[r])}d3.select("#visWrapper").selectAll("div").remove(),d3.select("#visWrapper").append("div").attr("id","plot"),document.getElementById("visWrapper").style.height="600px";var e=Newick.parse("((Taxon6:0.020,(Taxon7:0.076,Taxon8:0.093):0.011):0.015,(Taxon1:0.011,(Taxon2:0.032,(Taxon3:0.030,(Taxon4:0.014,Taxon5:0.050):.001):0.006):0.017):0.016);"),i=[];t(e),d3.phylogram.buildRadial("#plot",e,{width:450,skipLabels:!1,skipBranchLengthScaling:!1})}function normStackedBar(){s=new NormalizedStackedBar,d3.select("#visWrapper").html(abundancehtml),initAbundance()}function donuts(){s=new DonutCharts,document.getElementById("visWrapper").style.height="440px",d3.select("#visWrapper").html('<div id="yaxisholder"></div><div id="donutplot"></div>'),initAbundance()}function area(){s=new AreaChart,d3.select("#visWrapper").html(abundancehtml),initAbundance()}function initAbundance(){queue().defer(d3.json,"data/subsubsetAG.biom").await(loadBiom)}function loadBiom(t,e){s.setBiom(e)}function parallel(){s=new ParallelCoordinates,initMultiDim()}function splom(){s=new Splom,initMultiDim()}function scatter(){s=new Scatter,initMultiDim()}function threeD(){s=new ThreeD,initMultiDim()}function initMultiDim(){d3.select("#visWrapper").selectAll("div").remove(),d3.select("#visWrapper").append("div").attr("id","plot").attr("class","plot"),document.getElementById("visWrapper").style.height="500px",d3.select("#visWrapper").append("div").attr("id","toggleHolder"),document.getElementById("toggleHolder").innerHTML=" <div id='colorBy'>Color by:<br><input type='radio' id='Individual' name='colorBy' checked='checked'><label for='Individual'>Individual</label><input type='radio' id='Environment' name='colorBy'><label for='Environment'>Environment</label></div><br>",$("#colorBy").buttonset().change(function(t){s.changeColors(t.target.id)}),queue().defer(d3.csv,"data/keyboard_realIDs.csv").await(loadMultiDim)}function loadMultiDim(t,e){s.setData(e)}if(!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function i(t){var e=t.length,i=oe.type(t);return"function"===i||oe.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t}function n(t,e,i){if(oe.isFunction(e))return oe.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return oe.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(de.test(e))return oe.filter(e,t,i);e=oe.filter(e,t)}return oe.grep(t,function(t){return oe.inArray(t,e)>=0!==i})}function r(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function o(t){var e=Te[t]={};return oe.each(t.match(xe)||[],function(t,i){e[i]=!0}),e}function a(){me.addEventListener?(me.removeEventListener("DOMContentLoaded",s,!1),t.removeEventListener("load",s,!1)):(me.detachEvent("onreadystatechange",s),t.detachEvent("onload",s))}function s(){(me.addEventListener||"load"===event.type||"complete"===me.readyState)&&(a(),oe.ready())}function l(t,e,i){if(void 0===i&&1===t.nodeType){var n="data-"+e.replace(He,"-$1").toLowerCase();if(i=t.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:Re.test(i)?oe.parseJSON(i):i}catch(r){}oe.data(t,e,i)}else i=void 0}return i}function c(t){var e;for(e in t)if(("data"!==e||!oe.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function h(t,e,i,n){if(oe.acceptData(t)){var r,o,a=oe.expando,s=t.nodeType,l=s?oe.cache:t,c=s?t[a]:t[a]&&a;if(c&&l[c]&&(n||l[c].data)||void 0!==i||"string"!=typeof e)return c||(c=s?t[a]=Y.pop()||oe.guid++:a),l[c]||(l[c]=s?{}:{toJSON:oe.noop}),("object"==typeof e||"function"==typeof e)&&(n?l[c]=oe.extend(l[c],e):l[c].data=oe.extend(l[c].data,e)),o=l[c],n||(o.data||(o.data={}),o=o.data),void 0!==i&&(o[oe.camelCase(e)]=i),"string"==typeof e?(r=o[e],null==r&&(r=o[oe.camelCase(e)])):r=o,r}}function u(t,e,i){if(oe.acceptData(t)){var n,r,o=t.nodeType,a=o?oe.cache:t,s=o?t[oe.expando]:oe.expando;if(a[s]){if(e&&(n=i?a[s]:a[s].data)){oe.isArray(e)?e=e.concat(oe.map(e,oe.camelCase)):e in n?e=[e]:(e=oe.camelCase(e),e=e in n?[e]:e.split(" ")),r=e.length;for(;r--;)delete n[e[r]];if(i?!c(n):!oe.isEmptyObject(n))return}(i||(delete a[s].data,c(a[s])))&&(o?oe.cleanData([t],!0):ne.deleteExpando||a!=a.window?delete a[s]:a[s]=null)}}}function f(){return!0}function d(){return!1}function p(){try{return me.activeElement}catch(t){}}function m(t){var e=Fe.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function g(t,e){var i,n,r=0,o=typeof t.getElementsByTagName!==_e?t.getElementsByTagName(e||"*"):typeof t.querySelectorAll!==_e?t.querySelectorAll(e||"*"):void 0;if(!o)for(o=[],i=t.childNodes||t;null!=(n=i[r]);r++)!e||oe.nodeName(n,e)?o.push(n):oe.merge(o,g(n,e));return void 0===e||e&&oe.nodeName(t,e)?oe.merge([t],o):o}function v(t){De.test(t.type)&&(t.defaultChecked=t.checked)}function E(t,e){return oe.nodeName(t,"table")&&oe.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function y(t){return t.type=(null!==oe.find.attr(t,"type"))+"/"+t.type,t}function x(t){var e=qe.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function T(t,e){for(var i,n=0;null!=(i=t[n]);n++)oe._data(i,"globalEval",!e||oe._data(e[n],"globalEval"))}function b(t,e){if(1===e.nodeType&&oe.hasData(t)){var i,n,r,o=oe._data(t),a=oe._data(e,o),s=o.events;if(s){delete a.handle,a.events={};for(i in s)for(n=0,r=s[i].length;r>n;n++)oe.event.add(e,i,s[i][n])}a.data&&(a.data=oe.extend({},a.data))}}function _(t,e){var i,n,r;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!ne.noCloneEvent&&e[oe.expando]){r=oe._data(e);for(n in r.events)oe.removeEvent(e,n,r.handle);e.removeAttribute(oe.expando)}"script"===i&&e.text!==t.text?(y(e).text=t.text,x(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),ne.html5Clone&&t.innerHTML&&!oe.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&De.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function w(e,i){var n,r=oe(i.createElement(e)).appendTo(i.body),o=t.getDefaultComputedStyle&&(n=t.getDefaultComputedStyle(r[0]))?n.display:oe.css(r[0],"display");return r.detach(),o}function R(t){var e=me,i=Je[t];return i||(i=w(t,e),"none"!==i&&i||(Ze=(Ze||oe("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=(Ze[0].contentWindow||Ze[0].contentDocument).document,e.write(),e.close(),i=w(t,e),Ze.detach()),Je[t]=i),i}function H(t,e){return{get:function(){var i=t();return null!=i?i?void delete this.get:(this.get=e).apply(this,arguments):void 0}}}function M(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,r=fi.length;r--;)if(e=fi[r]+i,e in t)return e;return n}function S(t,e){for(var i,n,r,o=[],a=0,s=t.length;s>a;a++)n=t[a],n.style&&(o[a]=oe._data(n,"olddisplay"),i=n.style.display,e?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&Ce(n)&&(o[a]=oe._data(n,"olddisplay",R(n.nodeName)))):(r=Ce(n),(i&&"none"!==i||!r)&&oe._data(n,"olddisplay",r?i:oe.css(n,"display"))));for(a=0;s>a;a++)n=t[a],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?o[a]||"":"none"));return t}function C(t,e,i){var n=li.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function A(t,e,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===e?1:0,a=0;4>o;o+=2)"margin"===i&&(a+=oe.css(t,i+Se[o],!0,r)),n?("content"===i&&(a-=oe.css(t,"padding"+Se[o],!0,r)),"margin"!==i&&(a-=oe.css(t,"border"+Se[o]+"Width",!0,r))):(a+=oe.css(t,"padding"+Se[o],!0,r),"padding"!==i&&(a+=oe.css(t,"border"+Se[o]+"Width",!0,r)));return a}function D(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=ii(t),a=ne.boxSizing&&"border-box"===oe.css(t,"boxSizing",!1,o);if(0>=r||null==r){if(r=ni(t,e,o),(0>r||null==r)&&(r=t.style[e]),ei.test(r))return r;n=a&&(ne.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+A(t,e,i||(a?"border":"content"),n,o)+"px"}function P(t,e,i,n,r){return new P.prototype.init(t,e,i,n,r)}function k(){return setTimeout(function(){di=void 0}),di=oe.now()}function L(t,e){var i,n={height:t},r=0;for(e=e?1:0;4>r;r+=2-e)i=Se[r],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function N(t,e,i){for(var n,r=(yi[e]||[]).concat(yi["*"]),o=0,a=r.length;a>o;o++)if(n=r[o].call(i,e,t))return n}function F(t,e,i){var n,r,o,a,s,l,c,h,u=this,f={},d=t.style,p=t.nodeType&&Ce(t),m=oe._data(t,"fxshow");i.queue||(s=oe._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,oe.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[d.overflow,d.overflowX,d.overflowY],c=oe.css(t,"display"),h="none"===c?oe._data(t,"olddisplay")||R(t.nodeName):c,"inline"===h&&"none"===oe.css(t,"float")&&(ne.inlineBlockNeedsLayout&&"inline"!==R(t.nodeName)?d.zoom=1:d.display="inline-block")),i.overflow&&(d.overflow="hidden",ne.shrinkWrapBlocks()||u.always(function(){d.overflow=i.overflow[0],d.overflowX=i.overflow[1],d.overflowY=i.overflow[2]}));for(n in e)if(r=e[n],mi.exec(r)){if(delete e[n],o=o||"toggle"===r,r===(p?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;p=!0}f[n]=m&&m[n]||oe.style(t,n)}else c=void 0;if(oe.isEmptyObject(f))"inline"===("none"===c?R(t.nodeName):c)&&(d.display=c);else{m?"hidden"in m&&(p=m.hidden):m=oe._data(t,"fxshow",{}),o&&(m.hidden=!p),p?oe(t).show():u.done(function(){oe(t).hide()}),u.done(function(){var e;oe._removeData(t,"fxshow");for(e in f)oe.style(t,e,f[e])});for(n in f)a=N(p?m[n]:0,n,u),n in m||(m[n]=a.start,p&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}function I(t,e){var i,n,r,o,a;for(i in t)if(n=oe.camelCase(i),r=e[n],o=t[i],oe.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),a=oe.cssHooks[n],a&&"expand"in a){o=a.expand(o),delete t[n];for(i in o)i in t||(t[i]=o[i],e[i]=r)}else e[n]=r}function z(t,e,i){var n,r,o=0,a=Ei.length,s=oe.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var e=di||k(),i=Math.max(0,c.startTime+c.duration-e),n=i/c.duration||0,o=1-n,a=0,l=c.tweens.length;l>a;a++)c.tweens[a].run(o);return s.notifyWith(t,[c,o,i]),1>o&&l?i:(s.resolveWith(t,[c]),!1)},c=s.promise({elem:t,props:oe.extend({},e),opts:oe.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:di||k(),duration:i.duration,tweens:[],createTween:function(e,i){var n=oe.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(r)return this;for(r=!0;n>i;i++)c.tweens[i].run(1);return e?s.resolveWith(t,[c,e]):s.rejectWith(t,[c,e]),this}}),h=c.props;for(I(h,c.opts.specialEasing);a>o;o++)if(n=Ei[o].call(c,t,h,c.opts))return n;return oe.map(h,N,c),oe.isFunction(c.opts.start)&&c.opts.start.call(t,c),oe.fx.timer(oe.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function O(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,o=e.toLowerCase().match(xe)||[];if(oe.isFunction(i))for(;n=o[r++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function U(t,e,i,n){function r(s){var l;return o[s]=!0,oe.each(t[s]||[],function(t,s){var c=s(e,i,n);return"string"!=typeof c||a||o[c]?a?!(l=c):void 0:(e.dataTypes.unshift(c),r(c),!1)}),l}var o={},a=t===Wi;return r(e.dataTypes[0])||!o["*"]&&r("*")}function B(t,e){var i,n,r=oe.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&oe.extend(!0,t,i),t}function V(t,e,i){for(var n,r,o,a,s=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){l.unshift(a);break}if(l[0]in i)o=l[0];else{for(a in i){if(!l[0]||t.converters[a+" "+l[0]]){o=a;break}n||(n=a)}o=o||n}return o?(o!==l[0]&&l.unshift(o),i[o]):void 0}function W(t,e,i,n){var r,o,a,s,l,c={},h=t.dataTypes.slice();if(h[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(o=h.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=h.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=c[l+" "+o]||c["* "+o],!a)for(r in c)if(s=r.split(" "),s[1]===o&&(a=c[l+" "+s[0]]||c["* "+s[0]])){a===!0?a=c[r]:c[r]!==!0&&(o=s[0],h.unshift(s[1]));break}if(a!==!0)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}function j(t,e,i,n){var r;if(oe.isArray(e))oe.each(e,function(e,r){i||qi.test(t)?n(t,r):j(t+"["+("object"==typeof r?e:"")+"]",r,i,n)});else if(i||"object"!==oe.type(e))n(t,e);else for(r in e)j(t+"["+r+"]",e[r],i,n)}function G(){try{return new t.XMLHttpRequest}catch(e){}}function X(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function q(t){return oe.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var Y=[],K=Y.slice,Q=Y.concat,Z=Y.push,J=Y.indexOf,te={},ee=te.toString,ie=te.hasOwnProperty,ne={},re="1.11.1",oe=function(t,e){return new oe.fn.init(t,e)},ae=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,se=/^-ms-/,le=/-([\da-z])/gi,ce=function(t,e){return e.toUpperCase()};oe.fn=oe.prototype={jquery:re,constructor:oe,selector:"",length:0,toArray:function(){return K.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:K.call(this)},pushStack:function(t){var e=oe.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return oe.each(this,t,e)},map:function(t){return this.pushStack(oe.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(K.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:Z,sort:Y.sort,splice:Y.splice},oe.extend=oe.fn.extend=function(){var t,e,i,n,r,o,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||oe.isFunction(a)||(a={}),s===l&&(a=this,s--);l>s;s++)if(null!=(r=arguments[s]))for(n in r)t=a[n],i=r[n],a!==i&&(c&&i&&(oe.isPlainObject(i)||(e=oe.isArray(i)))?(e?(e=!1,o=t&&oe.isArray(t)?t:[]):o=t&&oe.isPlainObject(t)?t:{},a[n]=oe.extend(c,o,i)):void 0!==i&&(a[n]=i));return a},oe.extend({expando:"jQuery"+(re+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===oe.type(t)},isArray:Array.isArray||function(t){return"array"===oe.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!oe.isArray(t)&&t-parseFloat(t)>=0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},isPlainObject:function(t){var e;if(!t||"object"!==oe.type(t)||t.nodeType||oe.isWindow(t))return!1;try{if(t.constructor&&!ie.call(t,"constructor")&&!ie.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(ne.ownLast)for(e in t)return ie.call(t,e);for(e in t);return void 0===e||ie.call(t,e)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?te[ee.call(t)]||"object":typeof t},globalEval:function(e){e&&oe.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(se,"ms-").replace(le,ce)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var r,o=0,a=t.length,s=i(t);if(n){if(s)for(;a>o&&(r=e.apply(t[o],n),r!==!1);o++);else for(o in t)if(r=e.apply(t[o],n),r===!1)break}else if(s)for(;a>o&&(r=e.call(t[o],o,t[o]),r!==!1);o++);else for(o in t)if(r=e.call(t[o],o,t[o]),r===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(ae,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?oe.merge(n,"string"==typeof t?[t]:t):Z.call(n,t)),n},inArray:function(t,e,i){var n;if(e){if(J)return J.call(e,t,i);for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;i>n;)t[r++]=e[n++];if(i!==i)for(;void 0!==e[n];)t[r++]=e[n++];return t.length=r,t},grep:function(t,e,i){for(var n,r=[],o=0,a=t.length,s=!i;a>o;o++)n=!e(t[o],o),n!==s&&r.push(t[o]);return r},map:function(t,e,n){var r,o=0,a=t.length,s=i(t),l=[];if(s)for(;a>o;o++)r=e(t[o],o,n),null!=r&&l.push(r);else for(o in t)r=e(t[o],o,n),null!=r&&l.push(r);return Q.apply([],l)},guid:1,proxy:function(t,e){var i,n,r;return"string"==typeof e&&(r=t[e],e=t,t=r),oe.isFunction(t)?(i=K.call(arguments,2),n=function(){return t.apply(e||this,i.concat(K.call(arguments)))},n.guid=t.guid=t.guid||oe.guid++,n):void 0},now:function(){return+new Date},support:ne}),oe.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){te["[object "+e+"]"]=e.toLowerCase()});var he=function(t){function e(t,e,i,n){var r,o,a,s,l,c,u,d,p,m;if((e?e.ownerDocument||e:U)!==P&&D(e),e=e||P,i=i||[],!t||"string"!=typeof t)return i;if(1!==(s=e.nodeType)&&9!==s)return[];if(L&&!n){if(r=Ee.exec(t))if(a=r[1]){if(9===s){if(o=e.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&z(e,o)&&o.id===a)return i.push(o),i}else{if(r[2])return te.apply(i,e.getElementsByTagName(t)),i;if((a=r[3])&&T.getElementsByClassName&&e.getElementsByClassName)return te.apply(i,e.getElementsByClassName(a)),i}if(T.qsa&&(!N||!N.test(t))){if(d=u=O,p=e,m=9===s&&t,1===s&&"object"!==e.nodeName.toLowerCase()){for(c=R(t),(u=e.getAttribute("id"))?d=u.replace(xe,"\\$&"):e.setAttribute("id",d),d="[id='"+d+"'] ",l=c.length;l--;)c[l]=d+f(c[l]);p=ye.test(t)&&h(e.parentNode)||e,m=c.join(",")}if(m)try{return te.apply(i,p.querySelectorAll(m)),i}catch(g){}finally{u||e.removeAttribute("id")}}}return M(t.replace(ce,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>b.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[O]=!0,t}function r(t){var e=P.createElement("div");try{return!!t(e)}catch(i){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),n=t.length;n--;)b.attrHandle[i[n]]=e}function a(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||Y)-(~t.sourceIndex||Y);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function s(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function l(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function c(t){return n(function(e){return e=+e,n(function(i,n){for(var r,o=t([],i.length,e),a=o.length;a--;)i[r=o[a]]&&(i[r]=!(n[r]=i[r]))})})}function h(t){return t&&typeof t.getElementsByTagName!==q&&t}function u(){}function f(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function d(t,e,i){var n=e.dir,r=i&&"parentNode"===n,o=V++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||r)return t(e,i,o)}:function(e,i,a){var s,l,c=[B,o];if(a){for(;e=e[n];)if((1===e.nodeType||r)&&t(e,i,a))return!0}else for(;e=e[n];)if(1===e.nodeType||r){if(l=e[O]||(e[O]={}),(s=l[n])&&s[0]===B&&s[1]===o)return c[2]=s[2];if(l[n]=c,c[2]=t(e,i,a))return!0}}}function p(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function m(t,i,n){for(var r=0,o=i.length;o>r;r++)e(t,i[r],n);return n}function g(t,e,i,n,r){for(var o,a=[],s=0,l=t.length,c=null!=e;l>s;s++)(o=t[s])&&(!i||i(o,n,r))&&(a.push(o),c&&e.push(s));return a}function v(t,e,i,r,o,a){return r&&!r[O]&&(r=v(r)),o&&!o[O]&&(o=v(o,a)),n(function(n,a,s,l){var c,h,u,f=[],d=[],p=a.length,v=n||m(e||"*",s.nodeType?[s]:s,[]),E=!t||!n&&e?v:g(v,f,t,s,l),y=i?o||(n?t:p||r)?[]:a:E;if(i&&i(E,y,s,l),r)for(c=g(y,d),r(c,[],s,l),h=c.length;h--;)(u=c[h])&&(y[d[h]]=!(E[d[h]]=u));if(n){if(o||t){if(o){for(c=[],h=y.length;h--;)(u=y[h])&&c.push(E[h]=u);o(null,y=[],c,l)}for(h=y.length;h--;)(u=y[h])&&(c=o?ie.call(n,u):f[h])>-1&&(n[c]=!(a[c]=u))}}else y=g(y===a?y.splice(p,y.length):y),o?o(null,a,y,l):te.apply(a,y)})}function E(t){for(var e,i,n,r=t.length,o=b.relative[t[0].type],a=o||b.relative[" "],s=o?1:0,l=d(function(t){return t===e},a,!0),c=d(function(t){return ie.call(e,t)>-1},a,!0),h=[function(t,i,n){return!o&&(n||i!==S)||((e=i).nodeType?l(t,i,n):c(t,i,n))}];r>s;s++)if(i=b.relative[t[s].type])h=[d(p(h),i)];else{if(i=b.filter[t[s].type].apply(null,t[s].matches),i[O]){for(n=++s;r>n&&!b.relative[t[n].type];n++);return v(s>1&&p(h),s>1&&f(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(ce,"$1"),i,n>s&&E(t.slice(s,n)),r>n&&E(t=t.slice(n)),r>n&&f(t))}h.push(i)}return p(h)}function y(t,i){var r=i.length>0,o=t.length>0,a=function(n,a,s,l,c){var h,u,f,d=0,p="0",m=n&&[],v=[],E=S,y=n||o&&b.find.TAG("*",c),x=B+=null==E?1:Math.random()||.1,T=y.length;for(c&&(S=a!==P&&a);p!==T&&null!=(h=y[p]);p++){if(o&&h){for(u=0;f=t[u++];)if(f(h,a,s)){l.push(h);break}c&&(B=x)}r&&((h=!f&&h)&&d--,n&&m.push(h))}if(d+=p,r&&p!==d){for(u=0;f=i[u++];)f(m,v,a,s);if(n){if(d>0)for(;p--;)m[p]||v[p]||(v[p]=Z.call(l));v=g(v)}te.apply(l,v),c&&!n&&v.length>0&&d+i.length>1&&e.uniqueSort(l)}return c&&(B=x,S=E),m};return r?n(a):a}var x,T,b,_,w,R,H,M,S,C,A,D,P,k,L,N,F,I,z,O="sizzle"+-new Date,U=t.document,B=0,V=0,W=i(),j=i(),G=i(),X=function(t,e){return t===e&&(A=!0),0},q="undefined",Y=1<<31,K={}.hasOwnProperty,Q=[],Z=Q.pop,J=Q.push,te=Q.push,ee=Q.slice,ie=Q.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},ne="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",re="[\\x20\\t\\r\\n\\f]",oe="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ae=oe.replace("w","w#"),se="\\["+re+"*("+oe+")(?:"+re+"*([*^$|!~]?=)"+re+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ae+"))|)"+re+"*\\]",le=":("+oe+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+se+")*)|.*)\\)|)",ce=new RegExp("^"+re+"+|((?:^|[^\\\\])(?:\\\\.)*)"+re+"+$","g"),he=new RegExp("^"+re+"*,"+re+"*"),ue=new RegExp("^"+re+"*([>+~]|"+re+")"+re+"*"),fe=new RegExp("="+re+"*([^\\]'\"]*?)"+re+"*\\]","g"),de=new RegExp(le),pe=new RegExp("^"+ae+"$"),me={ID:new RegExp("^#("+oe+")"),CLASS:new RegExp("^\\.("+oe+")"),TAG:new RegExp("^("+oe.replace("w","w*")+")"),ATTR:new RegExp("^"+se),PSEUDO:new RegExp("^"+le),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+re+"*(even|odd|(([+-]|)(\\d*)n|)"+re+"*(?:([+-]|)"+re+"*(\\d+)|))"+re+"*\\)|)","i"),bool:new RegExp("^(?:"+ne+")$","i"),needsContext:new RegExp("^"+re+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+re+"*((?:-\\d)?\\d*)"+re+"*\\)|)(?=[^-]|$)","i")},ge=/^(?:input|select|textarea|button)$/i,ve=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,Ee=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,xe=/'|\\/g,Te=new RegExp("\\\\([\\da-f]{1,6}"+re+"?|("+re+")|.)","ig"),be=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{te.apply(Q=ee.call(U.childNodes),U.childNodes),Q[U.childNodes.length].nodeType}catch(_e){te={apply:Q.length?function(t,e){J.apply(t,ee.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}T=e.support={},w=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},D=e.setDocument=function(t){var e,i=t?t.ownerDocument||t:U,n=i.defaultView;return i!==P&&9===i.nodeType&&i.documentElement?(P=i,k=i.documentElement,L=!w(i),n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",function(){D()},!1):n.attachEvent&&n.attachEvent("onunload",function(){D()})),T.attributes=r(function(t){return t.className="i",!t.getAttribute("className")
}),T.getElementsByTagName=r(function(t){return t.appendChild(i.createComment("")),!t.getElementsByTagName("*").length}),T.getElementsByClassName=$.test(i.getElementsByClassName)&&r(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),T.getById=r(function(t){return k.appendChild(t).id=O,!i.getElementsByName||!i.getElementsByName(O).length}),T.getById?(b.find.ID=function(t,e){if(typeof e.getElementById!==q&&L){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},b.filter.ID=function(t){var e=t.replace(Te,be);return function(t){return t.getAttribute("id")===e}}):(delete b.find.ID,b.filter.ID=function(t){var e=t.replace(Te,be);return function(t){var i=typeof t.getAttributeNode!==q&&t.getAttributeNode("id");return i&&i.value===e}}),b.find.TAG=T.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==q?e.getElementsByTagName(t):void 0}:function(t,e){var i,n=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},b.find.CLASS=T.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==q&&L?e.getElementsByClassName(t):void 0},F=[],N=[],(T.qsa=$.test(i.querySelectorAll))&&(r(function(t){t.innerHTML="<select msallowclip=''><option selected=''></option></select>",t.querySelectorAll("[msallowclip^='']").length&&N.push("[*^$]="+re+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||N.push("\\["+re+"*(?:value|"+ne+")"),t.querySelectorAll(":checked").length||N.push(":checked")}),r(function(t){var e=i.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&N.push("name"+re+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),N.push(",.*:")})),(T.matchesSelector=$.test(I=k.matches||k.webkitMatchesSelector||k.mozMatchesSelector||k.oMatchesSelector||k.msMatchesSelector))&&r(function(t){T.disconnectedMatch=I.call(t,"div"),I.call(t,"[s!='']:x"),F.push("!=",le)}),N=N.length&&new RegExp(N.join("|")),F=F.length&&new RegExp(F.join("|")),e=$.test(k.compareDocumentPosition),z=e||$.test(k.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},X=e?function(t,e){if(t===e)return A=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n?n:(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!T.sortDetached&&e.compareDocumentPosition(t)===n?t===i||t.ownerDocument===U&&z(U,t)?-1:e===i||e.ownerDocument===U&&z(U,e)?1:C?ie.call(C,t)-ie.call(C,e):0:4&n?-1:1)}:function(t,e){if(t===e)return A=!0,0;var n,r=0,o=t.parentNode,s=e.parentNode,l=[t],c=[e];if(!o||!s)return t===i?-1:e===i?1:o?-1:s?1:C?ie.call(C,t)-ie.call(C,e):0;if(o===s)return a(t,e);for(n=t;n=n.parentNode;)l.unshift(n);for(n=e;n=n.parentNode;)c.unshift(n);for(;l[r]===c[r];)r++;return r?a(l[r],c[r]):l[r]===U?-1:c[r]===U?1:0},i):P},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==P&&D(t),i=i.replace(fe,"='$1']"),!(!T.matchesSelector||!L||F&&F.test(i)||N&&N.test(i)))try{var n=I.call(t,i);if(n||T.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(r){}return e(i,P,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==P&&D(t),z(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==P&&D(t);var i=b.attrHandle[e.toLowerCase()],n=i&&K.call(b.attrHandle,e.toLowerCase())?i(t,e,!L):void 0;return void 0!==n?n:T.attributes||!L?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,r=0;if(A=!T.detectDuplicates,C=!T.sortStable&&t.slice(0),t.sort(X),A){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return C=null,t},_=e.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=_(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=_(e);return i},b=e.selectors={cacheLength:50,createPseudo:n,match:me,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(Te,be),t[3]=(t[3]||t[4]||t[5]||"").replace(Te,be),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return me.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&de.test(i)&&(e=R(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(Te,be).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=W[t+" "];return e||(e=new RegExp("(^|"+re+")"+t+"("+re+"|$)"))&&W(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==q&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(r){var o=e.attr(r,t);return null==o?"!="===i:i?(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o+" ").indexOf(n)>-1:"|="===i?o===n||o.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(t,e,i,n,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,l){var c,h,u,f,d,p,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),E=!l&&!s;if(g){if(o){for(;m;){for(u=e;u=u[m];)if(s?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?g.firstChild:g.lastChild],a&&E){for(h=g[O]||(g[O]={}),c=h[t]||[],d=c[0]===B&&c[1],f=c[0]===B&&c[2],u=d&&g.childNodes[d];u=++d&&u&&u[m]||(f=d=0)||p.pop();)if(1===u.nodeType&&++f&&u===e){h[t]=[B,d,f];break}}else if(E&&(c=(e[O]||(e[O]={}))[t])&&c[0]===B)f=c[1];else for(;(u=++d&&u&&u[m]||(f=d=0)||p.pop())&&((s?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++f||(E&&((u[O]||(u[O]={}))[t]=[B,f]),u!==e)););return f-=r,f===n||f%n===0&&f/n>=0}}},PSEUDO:function(t,i){var r,o=b.pseudos[t]||b.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[O]?o(i):o.length>1?(r=[t,t,"",i],b.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,r=o(t,i),a=r.length;a--;)n=ie.call(t,r[a]),t[n]=!(e[n]=r[a])}):function(t){return o(t,0,r)}):o}},pseudos:{not:n(function(t){var e=[],i=[],r=H(t.replace(ce,"$1"));return r[O]?n(function(t,e,i,n){for(var o,a=r(t,null,n,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,n,o){return e[0]=t,r(e,null,o,i),!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return function(e){return(e.textContent||e.innerText||_(e)).indexOf(t)>-1}}),lang:n(function(t){return pe.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(Te,be).toLowerCase(),function(e){var i;do if(i=L?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===k},focus:function(t){return t===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!b.pseudos.empty(t)},header:function(t){return ve.test(t.nodeName)},input:function(t){return ge.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:c(function(){return[0]}),last:c(function(t,e){return[e-1]}),eq:c(function(t,e,i){return[0>i?i+e:i]}),even:c(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:c(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:c(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:c(function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t})}},b.pseudos.nth=b.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[x]=s(x);for(x in{submit:!0,reset:!0})b.pseudos[x]=l(x);return u.prototype=b.filters=b.pseudos,b.setFilters=new u,R=e.tokenize=function(t,i){var n,r,o,a,s,l,c,h=j[t+" "];if(h)return i?0:h.slice(0);for(s=t,l=[],c=b.preFilter;s;){(!n||(r=he.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),n=!1,(r=ue.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(ce," ")}),s=s.slice(n.length));for(a in b.filter)!(r=me[a].exec(s))||c[a]&&!(r=c[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return i?s.length:s?e.error(t):j(t,l).slice(0)},H=e.compile=function(t,e){var i,n=[],r=[],o=G[t+" "];if(!o){for(e||(e=R(t)),i=e.length;i--;)o=E(e[i]),o[O]?n.push(o):r.push(o);o=G(t,y(r,n)),o.selector=t}return o},M=e.select=function(t,e,i,n){var r,o,a,s,l,c="function"==typeof t&&t,u=!n&&R(t=c.selector||t);if(i=i||[],1===u.length){if(o=u[0]=u[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&T.getById&&9===e.nodeType&&L&&b.relative[o[1].type]){if(e=(b.find.ID(a.matches[0].replace(Te,be),e)||[])[0],!e)return i;c&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=me.needsContext.test(t)?0:o.length;r--&&(a=o[r],!b.relative[s=a.type]);)if((l=b.find[s])&&(n=l(a.matches[0].replace(Te,be),ye.test(o[0].type)&&h(e.parentNode)||e))){if(o.splice(r,1),t=n.length&&f(o),!t)return te.apply(i,n),i;break}}return(c||H(t,u))(n,e,!L,i,ye.test(t)&&h(e.parentNode)||e),i},T.sortStable=O.split("").sort(X).join("")===O,T.detectDuplicates=!!A,D(),T.sortDetached=r(function(t){return 1&t.compareDocumentPosition(P.createElement("div"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),T.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(ne,function(t,e,i){var n;return i?void 0:t[e]===!0?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(t);oe.find=he,oe.expr=he.selectors,oe.expr[":"]=oe.expr.pseudos,oe.unique=he.uniqueSort,oe.text=he.getText,oe.isXMLDoc=he.isXML,oe.contains=he.contains;var ue=oe.expr.match.needsContext,fe=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,de=/^.[^:#\[\.,]*$/;oe.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?oe.find.matchesSelector(n,t)?[n]:[]:oe.find.matches(t,oe.grep(e,function(t){return 1===t.nodeType}))},oe.fn.extend({find:function(t){var e,i=[],n=this,r=n.length;if("string"!=typeof t)return this.pushStack(oe(t).filter(function(){for(e=0;r>e;e++)if(oe.contains(n[e],this))return!0}));for(e=0;r>e;e++)oe.find(t,n[e],i);return i=this.pushStack(r>1?oe.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(n(this,t||[],!1))},not:function(t){return this.pushStack(n(this,t||[],!0))},is:function(t){return!!n(this,"string"==typeof t&&ue.test(t)?oe(t):t||[],!1).length}});var pe,me=t.document,ge=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ve=oe.fn.init=function(t,e){var i,n;if(!t)return this;if("string"==typeof t){if(i="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:ge.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||pe).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof oe?e[0]:e,oe.merge(this,oe.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:me,!0)),fe.test(i[1])&&oe.isPlainObject(e))for(i in e)oe.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}if(n=me.getElementById(i[2]),n&&n.parentNode){if(n.id!==i[2])return pe.find(t);this.length=1,this[0]=n}return this.context=me,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):oe.isFunction(t)?"undefined"!=typeof pe.ready?pe.ready(t):t(oe):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),oe.makeArray(t,this))};ve.prototype=oe.fn,pe=oe(me);var Ee=/^(?:parents|prev(?:Until|All))/,ye={children:!0,contents:!0,next:!0,prev:!0};oe.extend({dir:function(t,e,i){for(var n=[],r=t[e];r&&9!==r.nodeType&&(void 0===i||1!==r.nodeType||!oe(r).is(i));)1===r.nodeType&&n.push(r),r=r[e];return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),oe.fn.extend({has:function(t){var e,i=oe(t,this),n=i.length;return this.filter(function(){for(e=0;n>e;e++)if(oe.contains(this,i[e]))return!0})},closest:function(t,e){for(var i,n=0,r=this.length,o=[],a=ue.test(t)||"string"!=typeof t?oe(t,e||this.context):0;r>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&oe.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?oe.unique(o):o)},index:function(t){return t?"string"==typeof t?oe.inArray(this[0],oe(t)):oe.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(oe.unique(oe.merge(this.get(),oe(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),oe.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return oe.dir(t,"parentNode")},parentsUntil:function(t,e,i){return oe.dir(t,"parentNode",i)},next:function(t){return r(t,"nextSibling")},prev:function(t){return r(t,"previousSibling")},nextAll:function(t){return oe.dir(t,"nextSibling")},prevAll:function(t){return oe.dir(t,"previousSibling")},nextUntil:function(t,e,i){return oe.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return oe.dir(t,"previousSibling",i)},siblings:function(t){return oe.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return oe.sibling(t.firstChild)},contents:function(t){return oe.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:oe.merge([],t.childNodes)}},function(t,e){oe.fn[t]=function(i,n){var r=oe.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=oe.filter(n,r)),this.length>1&&(ye[t]||(r=oe.unique(r)),Ee.test(t)&&(r=r.reverse())),this.pushStack(r)}});var xe=/\S+/g,Te={};oe.Callbacks=function(t){t="string"==typeof t?Te[t]||o(t):oe.extend({},t);var e,i,n,r,a,s,l=[],c=!t.once&&[],h=function(o){for(i=t.memory&&o,n=!0,a=s||0,s=0,r=l.length,e=!0;l&&r>a;a++)if(l[a].apply(o[0],o[1])===!1&&t.stopOnFalse){i=!1;break}e=!1,l&&(c?c.length&&h(c.shift()):i?l=[]:u.disable())},u={add:function(){if(l){var n=l.length;!function o(e){oe.each(e,function(e,i){var n=oe.type(i);"function"===n?t.unique&&u.has(i)||l.push(i):i&&i.length&&"string"!==n&&o(i)})}(arguments),e?r=l.length:i&&(s=n,h(i))}return this},remove:function(){return l&&oe.each(arguments,function(t,i){for(var n;(n=oe.inArray(i,l,n))>-1;)l.splice(n,1),e&&(r>=n&&r--,a>=n&&a--)}),this},has:function(t){return t?oe.inArray(t,l)>-1:!(!l||!l.length)},empty:function(){return l=[],r=0,this},disable:function(){return l=c=i=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,i||u.disable(),this},locked:function(){return!c},fireWith:function(t,i){return!l||n&&!c||(i=i||[],i=[t,i.slice?i.slice():i],e?c.push(i):h(i)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!n}};return u},oe.extend({Deferred:function(t){var e=[["resolve","done",oe.Callbacks("once memory"),"resolved"],["reject","fail",oe.Callbacks("once memory"),"rejected"],["notify","progress",oe.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return oe.Deferred(function(i){oe.each(e,function(e,o){var a=oe.isFunction(t[e])&&t[e];r[o[1]](function(){var t=a&&a.apply(this,arguments);t&&oe.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o[0]+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?oe.extend(t,n):n}},r={};return n.pipe=n.then,oe.each(e,function(t,o){var a=o[2],s=o[3];n[o[1]]=a.add,s&&a.add(function(){i=s},e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=a.fireWith}),n.promise(r),t&&t.call(r,r),r},when:function(t){var e=0,i=K.call(arguments),n=i.length,r=1!==n||t&&oe.isFunction(t.promise)?n:0,o=1===r?t:oe.Deferred(),a=function(t,e,i){return function(n){e[t]=this,i[t]=arguments.length>1?K.call(arguments):n,i===s?o.notifyWith(e,i):--r||o.resolveWith(e,i)}},s,l,c;if(n>1)for(s=new Array(n),l=new Array(n),c=new Array(n);n>e;e++)i[e]&&oe.isFunction(i[e].promise)?i[e].promise().done(a(e,c,i)).fail(o.reject).progress(a(e,l,s)):--r;return r||o.resolveWith(c,i),o.promise()}});var be;oe.fn.ready=function(t){return oe.ready.promise().done(t),this},oe.extend({isReady:!1,readyWait:1,holdReady:function(t){t?oe.readyWait++:oe.ready(!0)},ready:function(t){if(t===!0?!--oe.readyWait:!oe.isReady){if(!me.body)return setTimeout(oe.ready);oe.isReady=!0,t!==!0&&--oe.readyWait>0||(be.resolveWith(me,[oe]),oe.fn.triggerHandler&&(oe(me).triggerHandler("ready"),oe(me).off("ready")))}}}),oe.ready.promise=function(e){if(!be)if(be=oe.Deferred(),"complete"===me.readyState)setTimeout(oe.ready);else if(me.addEventListener)me.addEventListener("DOMContentLoaded",s,!1),t.addEventListener("load",s,!1);else{me.attachEvent("onreadystatechange",s),t.attachEvent("onload",s);var i=!1;try{i=null==t.frameElement&&me.documentElement}catch(n){}i&&i.doScroll&&!function r(){if(!oe.isReady){try{i.doScroll("left")}catch(t){return setTimeout(r,50)}a(),oe.ready()}}()}return be.promise(e)};var _e="undefined",we;for(we in oe(ne))break;ne.ownLast="0"!==we,ne.inlineBlockNeedsLayout=!1,oe(function(){var t,e,i,n;i=me.getElementsByTagName("body")[0],i&&i.style&&(e=me.createElement("div"),n=me.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(e),typeof e.style.zoom!==_e&&(e.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",ne.inlineBlockNeedsLayout=t=3===e.offsetWidth,t&&(i.style.zoom=1)),i.removeChild(n))}),function(){var t=me.createElement("div");if(null==ne.deleteExpando){ne.deleteExpando=!0;try{delete t.test}catch(e){ne.deleteExpando=!1}}t=null}(),oe.acceptData=function(t){var e=oe.noData[(t.nodeName+" ").toLowerCase()],i=+t.nodeType||1;return 1!==i&&9!==i?!1:!e||e!==!0&&t.getAttribute("classid")===e};var Re=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,He=/([A-Z])/g;oe.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return t=t.nodeType?oe.cache[t[oe.expando]]:t[oe.expando],!!t&&!c(t)},data:function(t,e,i){return h(t,e,i)},removeData:function(t,e){return u(t,e)},_data:function(t,e,i){return h(t,e,i,!0)},_removeData:function(t,e){return u(t,e,!0)}}),oe.fn.extend({data:function(t,e){var i,n,r,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(r=oe.data(o),1===o.nodeType&&!oe._data(o,"parsedAttrs"))){for(i=a.length;i--;)a[i]&&(n=a[i].name,0===n.indexOf("data-")&&(n=oe.camelCase(n.slice(5)),l(o,n,r[n])));oe._data(o,"parsedAttrs",!0)}return r}return"object"==typeof t?this.each(function(){oe.data(this,t)}):arguments.length>1?this.each(function(){oe.data(this,t,e)}):o?l(o,t,oe.data(o,t)):void 0},removeData:function(t){return this.each(function(){oe.removeData(this,t)})}}),oe.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=oe._data(t,e),i&&(!n||oe.isArray(i)?n=oe._data(t,e,oe.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=oe.queue(t,e),n=i.length,r=i.shift(),o=oe._queueHooks(t,e),a=function(){oe.dequeue(t,e)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,a,o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return oe._data(t,i)||oe._data(t,i,{empty:oe.Callbacks("once memory").add(function(){oe._removeData(t,e+"queue"),oe._removeData(t,i)})})}}),oe.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?oe.queue(this[0],t):void 0===e?this:this.each(function(){var i=oe.queue(this,t,e);oe._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&oe.dequeue(this,t)})},dequeue:function(t){return this.each(function(){oe.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=oe.Deferred(),o=this,a=this.length,s=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)i=oe._data(o[a],t+"queueHooks"),i&&i.empty&&(n++,i.empty.add(s));return s(),r.promise(e)}});var Me=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Se=["Top","Right","Bottom","Left"],Ce=function(t,e){return t=e||t,"none"===oe.css(t,"display")||!oe.contains(t.ownerDocument,t)},Ae=oe.access=function(t,e,i,n,r,o,a){var s=0,l=t.length,c=null==i;if("object"===oe.type(i)){r=!0;for(s in i)oe.access(t,e,s,i[s],!0,o,a)}else if(void 0!==n&&(r=!0,oe.isFunction(n)||(a=!0),c&&(a?(e.call(t,n),e=null):(c=e,e=function(t,e,i){return c.call(oe(t),i)})),e))for(;l>s;s++)e(t[s],i,a?n:n.call(t[s],s,e(t[s],i)));return r?t:c?e.call(t):l?e(t[0],i):o},De=/^(?:checkbox|radio)$/i;!function(){var t=me.createElement("input"),e=me.createElement("div"),i=me.createDocumentFragment();if(e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",ne.leadingWhitespace=3===e.firstChild.nodeType,ne.tbody=!e.getElementsByTagName("tbody").length,ne.htmlSerialize=!!e.getElementsByTagName("link").length,ne.html5Clone="<:nav></:nav>"!==me.createElement("nav").cloneNode(!0).outerHTML,t.type="checkbox",t.checked=!0,i.appendChild(t),ne.appendChecked=t.checked,e.innerHTML="<textarea>x</textarea>",ne.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,i.appendChild(e),e.innerHTML="<input type='radio' checked='checked' name='t'/>",ne.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,ne.noCloneEvent=!0,e.attachEvent&&(e.attachEvent("onclick",function(){ne.noCloneEvent=!1}),e.cloneNode(!0).click()),null==ne.deleteExpando){ne.deleteExpando=!0;try{delete e.test}catch(n){ne.deleteExpando=!1}}}(),function(){var e,i,n=me.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})i="on"+e,(ne[e+"Bubbles"]=i in t)||(n.setAttribute(i,"t"),ne[e+"Bubbles"]=n.attributes[i].expando===!1);n=null}();var Pe=/^(?:input|select|textarea)$/i,ke=/^key/,Le=/^(?:mouse|pointer|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,Ne=/^([^.]*)(?:\.(.+)|)$/;oe.event={global:{},add:function(t,e,i,n,r){var o,a,s,l,c,h,u,f,d,p,m,g=oe._data(t);if(g){for(i.handler&&(l=i,i=l.handler,r=l.selector),i.guid||(i.guid=oe.guid++),(a=g.events)||(a=g.events={}),(h=g.handle)||(h=g.handle=function(t){return typeof oe===_e||t&&oe.event.triggered===t.type?void 0:oe.event.dispatch.apply(h.elem,arguments)},h.elem=t),e=(e||"").match(xe)||[""],s=e.length;s--;)o=Ne.exec(e[s])||[],d=m=o[1],p=(o[2]||"").split(".").sort(),d&&(c=oe.event.special[d]||{},d=(r?c.delegateType:c.bindType)||d,c=oe.event.special[d]||{},u=oe.extend({type:d,origType:m,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&oe.expr.match.needsContext.test(r),namespace:p.join(".")},l),(f=a[d])||(f=a[d]=[],f.delegateCount=0,c.setup&&c.setup.call(t,n,p,h)!==!1||(t.addEventListener?t.addEventListener(d,h,!1):t.attachEvent&&t.attachEvent("on"+d,h))),c.add&&(c.add.call(t,u),u.handler.guid||(u.handler.guid=i.guid)),r?f.splice(f.delegateCount++,0,u):f.push(u),oe.event.global[d]=!0);t=null}},remove:function(t,e,i,n,r){var o,a,s,l,c,h,u,f,d,p,m,g=oe.hasData(t)&&oe._data(t);if(g&&(h=g.events)){for(e=(e||"").match(xe)||[""],c=e.length;c--;)if(s=Ne.exec(e[c])||[],d=m=s[1],p=(s[2]||"").split(".").sort(),d){for(u=oe.event.special[d]||{},d=(n?u.delegateType:u.bindType)||d,f=h[d]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;o--;)a=f[o],!r&&m!==a.origType||i&&i.guid!==a.guid||s&&!s.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,u.remove&&u.remove.call(t,a));l&&!f.length&&(u.teardown&&u.teardown.call(t,p,g.handle)!==!1||oe.removeEvent(t,d,g.handle),delete h[d])}else for(d in h)oe.event.remove(t,d+e[c],i,n,!0);oe.isEmptyObject(h)&&(delete g.handle,oe._removeData(t,"events"))}},trigger:function(e,i,n,r){var o,a,s,l,c,h,u,f=[n||me],d=ie.call(e,"type")?e.type:e,p=ie.call(e,"namespace")?e.namespace.split("."):[];if(s=h=n=n||me,3!==n.nodeType&&8!==n.nodeType&&!$.test(d+oe.event.triggered)&&(d.indexOf(".")>=0&&(p=d.split("."),d=p.shift(),p.sort()),a=d.indexOf(":")<0&&"on"+d,e=e[oe.expando]?e:new oe.Event(d,"object"==typeof e&&e),e.isTrigger=r?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:oe.makeArray(i,[e]),c=oe.event.special[d]||{},r||!c.trigger||c.trigger.apply(n,i)!==!1)){if(!r&&!c.noBubble&&!oe.isWindow(n)){for(l=c.delegateType||d,$.test(l+d)||(s=s.parentNode);s;s=s.parentNode)f.push(s),h=s;h===(n.ownerDocument||me)&&f.push(h.defaultView||h.parentWindow||t)}for(u=0;(s=f[u++])&&!e.isPropagationStopped();)e.type=u>1?l:c.bindType||d,o=(oe._data(s,"events")||{})[e.type]&&oe._data(s,"handle"),o&&o.apply(s,i),o=a&&s[a],o&&o.apply&&oe.acceptData(s)&&(e.result=o.apply(s,i),e.result===!1&&e.preventDefault());if(e.type=d,!r&&!e.isDefaultPrevented()&&(!c._default||c._default.apply(f.pop(),i)===!1)&&oe.acceptData(n)&&a&&n[d]&&!oe.isWindow(n)){h=n[a],h&&(n[a]=null),oe.event.triggered=d;try{n[d]()}catch(m){}oe.event.triggered=void 0,h&&(n[a]=h)}return e.result}},dispatch:function(t){t=oe.event.fix(t);var e,i,n,r,o,a=[],s=K.call(arguments),l=(oe._data(this,"events")||{})[t.type]||[],c=oe.event.special[t.type]||{};if(s[0]=t,t.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,t)!==!1){for(a=oe.event.handlers.call(this,t,l),e=0;(r=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,o=0;(n=r.handlers[o++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(n.namespace))&&(t.handleObj=n,t.data=n.data,i=((oe.event.special[n.origType]||{}).handle||n.handler).apply(r.elem,s),void 0!==i&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,r,o,a=[],s=e.delegateCount,l=t.target;if(s&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==t.type)){for(r=[],o=0;s>o;o++)n=e[o],i=n.selector+" ",void 0===r[i]&&(r[i]=n.needsContext?oe(i,this).index(l)>=0:oe.find(i,this,null,[l]).length),r[i]&&r.push(n);r.length&&a.push({elem:l,handlers:r})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},fix:function(t){if(t[oe.expando])return t;var e,i,n,r=t.type,o=t,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=Le.test(r)?this.mouseHooks:ke.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,t=new oe.Event(o),e=n.length;e--;)i=n[e],t[i]=o[i];return t.target||(t.target=o.srcElement||me),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,a.filter?a.filter(t,o):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,r,o=e.button,a=e.fromElement;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||me,r=n.documentElement,i=n.body,t.pageX=e.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?e.toElement:a),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==p()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===p()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return oe.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return oe.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var r=oe.extend(new oe.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?oe.event.trigger(r,null,e):oe.event.dispatch.call(e,r),r.isDefaultPrevented()&&i.preventDefault()}},oe.removeEvent=me.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var n="on"+e;t.detachEvent&&(typeof t[n]===_e&&(t[n]=null),t.detachEvent(n,i))},oe.Event=function(t,e){return this instanceof oe.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?f:d):this.type=t,e&&oe.extend(this,e),this.timeStamp=t&&t.timeStamp||oe.now(),void(this[oe.expando]=!0)):new oe.Event(t,e)},oe.Event.prototype={isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=f,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=f,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=f,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},oe.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){oe.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,o=t.handleObj;return(!r||r!==n&&!oe.contains(n,r))&&(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),ne.submitBubbles||(oe.event.special.submit={setup:function(){return oe.nodeName(this,"form")?!1:void oe.event.add(this,"click._submit keypress._submit",function(t){var e=t.target,i=oe.nodeName(e,"input")||oe.nodeName(e,"button")?e.form:void 0;i&&!oe._data(i,"submitBubbles")&&(oe.event.add(i,"submit._submit",function(t){t._submit_bubble=!0}),oe._data(i,"submitBubbles",!0))})},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&oe.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return oe.nodeName(this,"form")?!1:void oe.event.remove(this,"._submit")
}}),ne.changeBubbles||(oe.event.special.change={setup:function(){return Pe.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(oe.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),oe.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),oe.event.simulate("change",this,t,!0)})),!1):void oe.event.add(this,"beforeactivate._change",function(t){var e=t.target;Pe.test(e.nodeName)&&!oe._data(e,"changeBubbles")&&(oe.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||oe.event.simulate("change",this.parentNode,t,!0)}),oe._data(e,"changeBubbles",!0))})},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return oe.event.remove(this,"._change"),!Pe.test(this.nodeName)}}),ne.focusinBubbles||oe.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){oe.event.simulate(e,t.target,oe.event.fix(t),!0)};oe.event.special[e]={setup:function(){var n=this.ownerDocument||this,r=oe._data(n,e);r||n.addEventListener(t,i,!0),oe._data(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=oe._data(n,e)-1;r?oe._data(n,e,r):(n.removeEventListener(t,i,!0),oe._removeData(n,e))}}}),oe.fn.extend({on:function(t,e,i,n,r){var o,a;if("object"==typeof t){"string"!=typeof e&&(i=i||e,e=void 0);for(o in t)this.on(o,e,i,t[o],r);return this}if(null==i&&null==n?(n=e,i=e=void 0):null==n&&("string"==typeof e?(n=i,i=void 0):(n=i,i=e,e=void 0)),n===!1)n=d;else if(!n)return this;return 1===r&&(a=n,n=function(t){return oe().off(t),a.apply(this,arguments)},n.guid=a.guid||(a.guid=oe.guid++)),this.each(function(){oe.event.add(this,t,n,i,e)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,oe(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return(e===!1||"function"==typeof e)&&(i=e,e=void 0),i===!1&&(i=d),this.each(function(){oe.event.remove(this,t,i,e)})},trigger:function(t,e){return this.each(function(){oe.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?oe.event.trigger(t,e,i,!0):void 0}});var Fe="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ie=/ jQuery\d+="(?:null|\d+)"/g,ze=new RegExp("<(?:"+Fe+")[\\s/>]","i"),Oe=/^\s+/,Ue=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Be=/<([\w:]+)/,Ve=/<tbody/i,We=/<|&#?\w+;/,je=/<(?:script|style|link)/i,Ge=/checked\s*(?:[^=]|=\s*.checked.)/i,Xe=/^$|\/(?:java|ecma)script/i,qe=/^true\/(.*)/,Ye=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ke={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ne.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},$e=m(me),Qe=$e.appendChild(me.createElement("div"));Ke.optgroup=Ke.option,Ke.tbody=Ke.tfoot=Ke.colgroup=Ke.caption=Ke.thead,Ke.th=Ke.td,oe.extend({clone:function(t,e,i){var n,r,o,a,s,l=oe.contains(t.ownerDocument,t);if(ne.html5Clone||oe.isXMLDoc(t)||!ze.test("<"+t.nodeName+">")?o=t.cloneNode(!0):(Qe.innerHTML=t.outerHTML,Qe.removeChild(o=Qe.firstChild)),!(ne.noCloneEvent&&ne.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||oe.isXMLDoc(t)))for(n=g(o),s=g(t),a=0;null!=(r=s[a]);++a)n[a]&&_(r,n[a]);if(e)if(i)for(s=s||g(t),n=n||g(o),a=0;null!=(r=s[a]);a++)b(r,n[a]);else b(t,o);return n=g(o,"script"),n.length>0&&T(n,!l&&g(t,"script")),n=s=r=null,o},buildFragment:function(t,e,i,n){for(var r,o,a,s,l,c,h,u=t.length,f=m(e),d=[],p=0;u>p;p++)if(o=t[p],o||0===o)if("object"===oe.type(o))oe.merge(d,o.nodeType?[o]:o);else if(We.test(o)){for(s=s||f.appendChild(e.createElement("div")),l=(Be.exec(o)||["",""])[1].toLowerCase(),h=Ke[l]||Ke._default,s.innerHTML=h[1]+o.replace(Ue,"<$1></$2>")+h[2],r=h[0];r--;)s=s.lastChild;if(!ne.leadingWhitespace&&Oe.test(o)&&d.push(e.createTextNode(Oe.exec(o)[0])),!ne.tbody)for(o="table"!==l||Ve.test(o)?"<table>"!==h[1]||Ve.test(o)?0:s:s.firstChild,r=o&&o.childNodes.length;r--;)oe.nodeName(c=o.childNodes[r],"tbody")&&!c.childNodes.length&&o.removeChild(c);for(oe.merge(d,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=f.lastChild}else d.push(e.createTextNode(o));for(s&&f.removeChild(s),ne.appendChecked||oe.grep(g(d,"input"),v),p=0;o=d[p++];)if((!n||-1===oe.inArray(o,n))&&(a=oe.contains(o.ownerDocument,o),s=g(f.appendChild(o),"script"),a&&T(s),i))for(r=0;o=s[r++];)Xe.test(o.type||"")&&i.push(o);return s=null,f},cleanData:function(t,e){for(var i,n,r,o,a=0,s=oe.expando,l=oe.cache,c=ne.deleteExpando,h=oe.event.special;null!=(i=t[a]);a++)if((e||oe.acceptData(i))&&(r=i[s],o=r&&l[r])){if(o.events)for(n in o.events)h[n]?oe.event.remove(i,n):oe.removeEvent(i,n,o.handle);l[r]&&(delete l[r],c?delete i[s]:typeof i.removeAttribute!==_e?i.removeAttribute(s):i[s]=null,Y.push(r))}}}),oe.fn.extend({text:function(t){return Ae(this,function(t){return void 0===t?oe.text(this):this.empty().append((this[0]&&this[0].ownerDocument||me).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=E(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=E(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?oe.filter(t,this):this,r=0;null!=(i=n[r]);r++)e||1!==i.nodeType||oe.cleanData(g(i)),i.parentNode&&(e&&oe.contains(i.ownerDocument,i)&&T(g(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&oe.cleanData(g(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&oe.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return oe.clone(this,t,e)})},html:function(t){return Ae(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t)return 1===e.nodeType?e.innerHTML.replace(Ie,""):void 0;if(!("string"!=typeof t||je.test(t)||!ne.htmlSerialize&&ze.test(t)||!ne.leadingWhitespace&&Oe.test(t)||Ke[(Be.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(Ue,"<$1></$2>");try{for(;n>i;i++)e=this[i]||{},1===e.nodeType&&(oe.cleanData(g(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,oe.cleanData(g(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=Q.apply([],t);var i,n,r,o,a,s,l=0,c=this.length,h=this,u=c-1,f=t[0],d=oe.isFunction(f);if(d||c>1&&"string"==typeof f&&!ne.checkClone&&Ge.test(f))return this.each(function(i){var n=h.eq(i);d&&(t[0]=f.call(this,i,n.html())),n.domManip(t,e)});if(c&&(s=oe.buildFragment(t,this[0].ownerDocument,!1,this),i=s.firstChild,1===s.childNodes.length&&(s=i),i)){for(o=oe.map(g(s,"script"),y),r=o.length;c>l;l++)n=s,l!==u&&(n=oe.clone(n,!0,!0),r&&oe.merge(o,g(n,"script"))),e.call(this[l],n,l);if(r)for(a=o[o.length-1].ownerDocument,oe.map(o,x),l=0;r>l;l++)n=o[l],Xe.test(n.type||"")&&!oe._data(n,"globalEval")&&oe.contains(a,n)&&(n.src?oe._evalUrl&&oe._evalUrl(n.src):oe.globalEval((n.text||n.textContent||n.innerHTML||"").replace(Ye,"")));s=i=null}return this}}),oe.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){oe.fn[t]=function(t){for(var i,n=0,r=[],o=oe(t),a=o.length-1;a>=n;n++)i=n===a?this:this.clone(!0),oe(o[n])[e](i),Z.apply(r,i.get());return this.pushStack(r)}});var Ze,Je={};!function(){var t;ne.shrinkWrapBlocks=function(){if(null!=t)return t;t=!1;var e,i,n;return i=me.getElementsByTagName("body")[0],i&&i.style?(e=me.createElement("div"),n=me.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(e),typeof e.style.zoom!==_e&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(me.createElement("div")).style.width="5px",t=3!==e.offsetWidth),i.removeChild(n),t):void 0}}();var ti=/^margin/,ei=new RegExp("^("+Me+")(?!px)[a-z%]+$","i"),ii,ni,ri=/^(top|right|bottom|left)$/;t.getComputedStyle?(ii=function(t){return t.ownerDocument.defaultView.getComputedStyle(t,null)},ni=function(t,e,i){var n,r,o,a,s=t.style;return i=i||ii(t),a=i?i.getPropertyValue(e)||i[e]:void 0,i&&(""!==a||oe.contains(t.ownerDocument,t)||(a=oe.style(t,e)),ei.test(a)&&ti.test(e)&&(n=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=i.width,s.width=n,s.minWidth=r,s.maxWidth=o)),void 0===a?a:a+""}):me.documentElement.currentStyle&&(ii=function(t){return t.currentStyle},ni=function(t,e,i){var n,r,o,a,s=t.style;return i=i||ii(t),a=i?i[e]:void 0,null==a&&s&&s[e]&&(a=s[e]),ei.test(a)&&!ri.test(e)&&(n=s.left,r=t.runtimeStyle,o=r&&r.left,o&&(r.left=t.currentStyle.left),s.left="fontSize"===e?"1em":a,a=s.pixelLeft+"px",s.left=n,o&&(r.left=o)),void 0===a?a:a+""||"auto"}),!function(){function e(){var e,i,n,r;i=me.getElementsByTagName("body")[0],i&&i.style&&(e=me.createElement("div"),n=me.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(e),e.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",o=a=!1,l=!0,t.getComputedStyle&&(o="1%"!==(t.getComputedStyle(e,null)||{}).top,a="4px"===(t.getComputedStyle(e,null)||{width:"4px"}).width,r=e.appendChild(me.createElement("div")),r.style.cssText=e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",r.style.marginRight=r.style.width="0",e.style.width="1px",l=!parseFloat((t.getComputedStyle(r,null)||{}).marginRight)),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",r=e.getElementsByTagName("td"),r[0].style.cssText="margin:0;border:0;padding:0;display:none",s=0===r[0].offsetHeight,s&&(r[0].style.display="",r[1].style.display="none",s=0===r[0].offsetHeight),i.removeChild(n))}var i,n,r,o,a,s,l;i=me.createElement("div"),i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=i.getElementsByTagName("a")[0],(n=r&&r.style)&&(n.cssText="float:left;opacity:.5",ne.opacity="0.5"===n.opacity,ne.cssFloat=!!n.cssFloat,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",ne.clearCloneStyle="content-box"===i.style.backgroundClip,ne.boxSizing=""===n.boxSizing||""===n.MozBoxSizing||""===n.WebkitBoxSizing,oe.extend(ne,{reliableHiddenOffsets:function(){return null==s&&e(),s},boxSizingReliable:function(){return null==a&&e(),a},pixelPosition:function(){return null==o&&e(),o},reliableMarginRight:function(){return null==l&&e(),l}}))}(),oe.swap=function(t,e,i,n){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];r=i.apply(t,n||[]);for(o in e)t.style[o]=a[o];return r};var oi=/alpha\([^)]*\)/i,ai=/opacity\s*=\s*([^)]*)/,si=/^(none|table(?!-c[ea]).+)/,li=new RegExp("^("+Me+")(.*)$","i"),ci=new RegExp("^([+-])=("+Me+")","i"),hi={position:"absolute",visibility:"hidden",display:"block"},ui={letterSpacing:"0",fontWeight:"400"},fi=["Webkit","O","Moz","ms"];oe.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=ni(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ne.cssFloat?"cssFloat":"styleFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=oe.camelCase(e),l=t.style;if(e=oe.cssProps[s]||(oe.cssProps[s]=M(l,s)),a=oe.cssHooks[e]||oe.cssHooks[s],void 0===i)return a&&"get"in a&&void 0!==(r=a.get(t,!1,n))?r:l[e];if(o=typeof i,"string"===o&&(r=ci.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(oe.css(t,e)),o="number"),null!=i&&i===i&&("number"!==o||oe.cssNumber[s]||(i+="px"),ne.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),!(a&&"set"in a&&void 0===(i=a.set(t,i,n)))))try{l[e]=i}catch(c){}}},css:function(t,e,i,n){var r,o,a,s=oe.camelCase(e);return e=oe.cssProps[s]||(oe.cssProps[s]=M(t.style,s)),a=oe.cssHooks[e]||oe.cssHooks[s],a&&"get"in a&&(o=a.get(t,!0,i)),void 0===o&&(o=ni(t,e,n)),"normal"===o&&e in ui&&(o=ui[e]),""===i||i?(r=parseFloat(o),i===!0||oe.isNumeric(r)?r||0:o):o}}),oe.each(["height","width"],function(t,e){oe.cssHooks[e]={get:function(t,i,n){return i?si.test(oe.css(t,"display"))&&0===t.offsetWidth?oe.swap(t,hi,function(){return D(t,e,n)}):D(t,e,n):void 0},set:function(t,i,n){var r=n&&ii(t);return C(t,i,n?A(t,e,n,ne.boxSizing&&"border-box"===oe.css(t,"boxSizing",!1,r),r):0)}}}),ne.opacity||(oe.cssHooks.opacity={get:function(t,e){return ai.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,r=oe.isNumeric(e)?"alpha(opacity="+100*e+")":"",o=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===oe.trim(o.replace(oi,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=oi.test(o)?o.replace(oi,r):o+" "+r)}}),oe.cssHooks.marginRight=H(ne.reliableMarginRight,function(t,e){return e?oe.swap(t,{display:"inline-block"},ni,[t,"marginRight"]):void 0}),oe.each({margin:"",padding:"",border:"Width"},function(t,e){oe.cssHooks[t+e]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];4>n;n++)r[t+Se[n]+e]=o[n]||o[n-2]||o[0];return r}},ti.test(t)||(oe.cssHooks[t+e].set=C)}),oe.fn.extend({css:function(t,e){return Ae(this,function(t,e,i){var n,r,o={},a=0;if(oe.isArray(e)){for(n=ii(t),r=e.length;r>a;a++)o[e[a]]=oe.css(t,e[a],!1,n);return o}return void 0!==i?oe.style(t,e,i):oe.css(t,e)},t,e,arguments.length>1)},show:function(){return S(this,!0)},hide:function(){return S(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Ce(this)?oe(this).show():oe(this).hide()})}}),oe.Tween=P,P.prototype={constructor:P,init:function(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(oe.cssNumber[i]?"":"px")},cur:function(){var t=P.propHooks[this.prop];return t&&t.get?t.get(this):P.propHooks._default.get(this)},run:function(t){var e,i=P.propHooks[this.prop];return this.pos=e=this.options.duration?oe.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):P.propHooks._default.set(this),this}},P.prototype.init.prototype=P.prototype,P.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=oe.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){oe.fx.step[t.prop]?oe.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[oe.cssProps[t.prop]]||oe.cssHooks[t.prop])?oe.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},P.propHooks.scrollTop=P.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},oe.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},oe.fx=P.prototype.init,oe.fx.step={};var di,pi,mi=/^(?:toggle|show|hide)$/,gi=new RegExp("^(?:([+-])=|)("+Me+")([a-z%]*)$","i"),vi=/queueHooks$/,Ei=[F],yi={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),r=gi.exec(e),o=r&&r[3]||(oe.cssNumber[t]?"":"px"),a=(oe.cssNumber[t]||"px"!==o&&+n)&&gi.exec(oe.css(i.elem,t)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],r=r||[],a=+n||1;do s=s||".5",a/=s,oe.style(i.elem,t,a+o);while(s!==(s=i.cur()/n)&&1!==s&&--l)}return r&&(a=i.start=+a||+n||0,i.unit=o,i.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),i}]};oe.Animation=oe.extend(z,{tweener:function(t,e){oe.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,r=t.length;r>n;n++)i=t[n],yi[i]=yi[i]||[],yi[i].unshift(e)},prefilter:function(t,e){e?Ei.unshift(t):Ei.push(t)}}),oe.speed=function(t,e,i){var n=t&&"object"==typeof t?oe.extend({},t):{complete:i||!i&&e||oe.isFunction(t)&&t,duration:t,easing:i&&e||e&&!oe.isFunction(e)&&e};return n.duration=oe.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in oe.fx.speeds?oe.fx.speeds[n.duration]:oe.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){oe.isFunction(n.old)&&n.old.call(this),n.queue&&oe.dequeue(this,n.queue)},n},oe.fn.extend({fadeTo:function(t,e,i,n){return this.filter(Ce).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=oe.isEmptyObject(t),o=oe.speed(e,i,n),a=function(){var e=z(this,oe.extend({},t),o);(r||oe._data(this,"finish"))&&e.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=oe.timers,a=oe._data(this);if(r)a[r]&&a[r].stop&&n(a[r]);else for(r in a)a[r]&&a[r].stop&&vi.test(r)&&n(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(i),e=!1,o.splice(r,1));(e||!i)&&oe.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=oe._data(this),n=i[t+"queue"],r=i[t+"queueHooks"],o=oe.timers,a=n?n.length:0;for(i.finish=!0,oe.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;a>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),oe.each(["toggle","show","hide"],function(t,e){var i=oe.fn[e];oe.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(L(e,!0),t,n,r)}}),oe.each({slideDown:L("show"),slideUp:L("hide"),slideToggle:L("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){oe.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),oe.timers=[],oe.fx.tick=function(){var t,e=oe.timers,i=0;for(di=oe.now();i<e.length;i++)t=e[i],t()||e[i]!==t||e.splice(i--,1);e.length||oe.fx.stop(),di=void 0},oe.fx.timer=function(t){oe.timers.push(t),t()?oe.fx.start():oe.timers.pop()},oe.fx.interval=13,oe.fx.start=function(){pi||(pi=setInterval(oe.fx.tick,oe.fx.interval))},oe.fx.stop=function(){clearInterval(pi),pi=null},oe.fx.speeds={slow:600,fast:200,_default:400},oe.fn.delay=function(t,e){return t=oe.fx?oe.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},function(){var t,e,i,n,r;e=me.createElement("div"),e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=e.getElementsByTagName("a")[0],i=me.createElement("select"),r=i.appendChild(me.createElement("option")),t=e.getElementsByTagName("input")[0],n.style.cssText="top:1px",ne.getSetAttribute="t"!==e.className,ne.style=/top/.test(n.getAttribute("style")),ne.hrefNormalized="/a"===n.getAttribute("href"),ne.checkOn=!!t.value,ne.optSelected=r.selected,ne.enctype=!!me.createElement("form").enctype,i.disabled=!0,ne.optDisabled=!r.disabled,t=me.createElement("input"),t.setAttribute("value",""),ne.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),ne.radioValue="t"===t.value}();var xi=/\r/g;oe.fn.extend({val:function(t){var e,i,n,r=this[0];return arguments.length?(n=oe.isFunction(t),this.each(function(i){var r;1===this.nodeType&&(r=n?t.call(this,i,oe(this).val()):t,null==r?r="":"number"==typeof r?r+="":oe.isArray(r)&&(r=oe.map(r,function(t){return null==t?"":t+""})),e=oe.valHooks[this.type]||oe.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))})):r?(e=oe.valHooks[r.type]||oe.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(xi,""):null==i?"":i)):void 0}}),oe.extend({valHooks:{option:{get:function(t){var e=oe.find.attr(t,"value");return null!=e?e:oe.trim(oe.text(t))}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,o="select-one"===t.type||0>r,a=o?null:[],s=o?r+1:n.length,l=0>r?s:o?r:0;s>l;l++)if(i=n[l],!(!i.selected&&l!==r||(ne.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&oe.nodeName(i.parentNode,"optgroup"))){if(e=oe(i).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var i,n,r=t.options,o=oe.makeArray(e),a=r.length;a--;)if(n=r[a],oe.inArray(oe.valHooks.option.get(n),o)>=0)try{n.selected=i=!0}catch(s){n.scrollHeight}else n.selected=!1;return i||(t.selectedIndex=-1),r}}}}),oe.each(["radio","checkbox"],function(){oe.valHooks[this]={set:function(t,e){return oe.isArray(e)?t.checked=oe.inArray(oe(t).val(),e)>=0:void 0}},ne.checkOn||(oe.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Ti,bi,_i=oe.expr.attrHandle,wi=/^(?:checked|selected)$/i,Ri=ne.getSetAttribute,Hi=ne.input;oe.fn.extend({attr:function(t,e){return Ae(this,oe.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){oe.removeAttr(this,t)})}}),oe.extend({attr:function(t,e,i){var n,r,o=t.nodeType;return t&&3!==o&&8!==o&&2!==o?typeof t.getAttribute===_e?oe.prop(t,e,i):(1===o&&oe.isXMLDoc(t)||(e=e.toLowerCase(),n=oe.attrHooks[e]||(oe.expr.match.bool.test(e)?bi:Ti)),void 0===i?n&&"get"in n&&null!==(r=n.get(t,e))?r:(r=oe.find.attr(t,e),null==r?void 0:r):null!==i?n&&"set"in n&&void 0!==(r=n.set(t,i,e))?r:(t.setAttribute(e,i+""),i):void oe.removeAttr(t,e)):void 0},removeAttr:function(t,e){var i,n,r=0,o=e&&e.match(xe);if(o&&1===t.nodeType)for(;i=o[r++];)n=oe.propFix[i]||i,oe.expr.match.bool.test(i)?Hi&&Ri||!wi.test(i)?t[n]=!1:t[oe.camelCase("default-"+i)]=t[n]=!1:oe.attr(t,i,""),t.removeAttribute(Ri?i:n)},attrHooks:{type:{set:function(t,e){if(!ne.radioValue&&"radio"===e&&oe.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),bi={set:function(t,e,i){return e===!1?oe.removeAttr(t,i):Hi&&Ri||!wi.test(i)?t.setAttribute(!Ri&&oe.propFix[i]||i,i):t[oe.camelCase("default-"+i)]=t[i]=!0,i}},oe.each(oe.expr.match.bool.source.match(/\w+/g),function(t,e){var i=_i[e]||oe.find.attr;_i[e]=Hi&&Ri||!wi.test(e)?function(t,e,n){var r,o;return n||(o=_i[e],_i[e]=r,r=null!=i(t,e,n)?e.toLowerCase():null,_i[e]=o),r}:function(t,e,i){return i?void 0:t[oe.camelCase("default-"+e)]?e.toLowerCase():null}}),Hi&&Ri||(oe.attrHooks.value={set:function(t,e,i){return oe.nodeName(t,"input")?void(t.defaultValue=e):Ti&&Ti.set(t,e,i)}}),Ri||(Ti={set:function(t,e,i){var n=t.getAttributeNode(i);return n||t.setAttributeNode(n=t.ownerDocument.createAttribute(i)),n.value=e+="","value"===i||e===t.getAttribute(i)?e:void 0}},_i.id=_i.name=_i.coords=function(t,e,i){var n;return i?void 0:(n=t.getAttributeNode(e))&&""!==n.value?n.value:null},oe.valHooks.button={get:function(t,e){var i=t.getAttributeNode(e);return i&&i.specified?i.value:void 0},set:Ti.set},oe.attrHooks.contenteditable={set:function(t,e,i){Ti.set(t,""===e?!1:e,i)}},oe.each(["width","height"],function(t,e){oe.attrHooks[e]={set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}}})),ne.style||(oe.attrHooks.style={get:function(t){return t.style.cssText||void 0},set:function(t,e){return t.style.cssText=e+""}});var Mi=/^(?:input|select|textarea|button|object)$/i,Si=/^(?:a|area)$/i;oe.fn.extend({prop:function(t,e){return Ae(this,oe.prop,t,e,arguments.length>1)},removeProp:function(t){return t=oe.propFix[t]||t,this.each(function(){try{this[t]=void 0,delete this[t]}catch(e){}})}}),oe.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(t,e,i){var n,r,o,a=t.nodeType;return t&&3!==a&&8!==a&&2!==a?(o=1!==a||!oe.isXMLDoc(t),o&&(e=oe.propFix[e]||e,r=oe.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]):void 0},propHooks:{tabIndex:{get:function(t){var e=oe.find.attr(t,"tabindex");return e?parseInt(e,10):Mi.test(t.nodeName)||Si.test(t.nodeName)&&t.href?0:-1}}}}),ne.hrefNormalized||oe.each(["href","src"],function(t,e){oe.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),ne.optSelected||(oe.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),oe.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){oe.propFix[this.toLowerCase()]=this}),ne.enctype||(oe.propFix.enctype="encoding");var Ci=/[\t\r\n\f]/g;oe.fn.extend({addClass:function(t){var e,i,n,r,o,a,s=0,l=this.length,c="string"==typeof t&&t;if(oe.isFunction(t))return this.each(function(e){oe(this).addClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(xe)||[];l>s;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ci," "):" ")){for(o=0;r=e[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");a=oe.trim(n),i.className!==a&&(i.className=a)}return this},removeClass:function(t){var e,i,n,r,o,a,s=0,l=this.length,c=0===arguments.length||"string"==typeof t&&t;if(oe.isFunction(t))return this.each(function(e){oe(this).removeClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(xe)||[];l>s;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ci," "):"")){for(o=0;r=e[o++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");a=t?oe.trim(n):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):this.each(oe.isFunction(t)?function(i){oe(this).toggleClass(t.call(this,i,this.className,e),e)}:function(){if("string"===i)for(var e,n=0,r=oe(this),o=t.match(xe)||[];e=o[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else(i===_e||"boolean"===i)&&(this.className&&oe._data(this,"__className__",this.className),this.className=this.className||t===!1?"":oe._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Ci," ").indexOf(e)>=0)return!0;return!1}}),oe.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){oe.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),oe.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var Ai=oe.now(),Di=/\?/,Pi=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;oe.parseJSON=function(e){if(t.JSON&&t.JSON.parse)return t.JSON.parse(e+"");var i,n=null,r=oe.trim(e+"");return r&&!oe.trim(r.replace(Pi,function(t,e,r,o){return i&&e&&(n=0),0===n?t:(i=r||e,n+=!o-!r,"")}))?Function("return "+r)():oe.error("Invalid JSON: "+e)},oe.parseXML=function(e){var i,n;if(!e||"string"!=typeof e)return null;try{t.DOMParser?(n=new DOMParser,i=n.parseFromString(e,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(e))}catch(r){i=void 0}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||oe.error("Invalid XML: "+e),i};var ki,Li,Ni=/#.*$/,Fi=/([?&])_=[^&]*/,Ii=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,zi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Oi=/^(?:GET|HEAD)$/,Ui=/^\/\//,Bi=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Vi={},Wi={},ji="*/".concat("*");try{Li=location.href}catch(Gi){Li=me.createElement("a"),Li.href="",Li=Li.href}ki=Bi.exec(Li.toLowerCase())||[],oe.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Li,type:"GET",isLocal:zi.test(ki[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ji,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":oe.parseJSON,"text xml":oe.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?B(B(t,oe.ajaxSettings),e):B(oe.ajaxSettings,t)},ajaxPrefilter:O(Vi),ajaxTransport:O(Wi),ajax:function(t,e){function i(t,e,i,n){var r,h,v,E,x,b=e;2!==y&&(y=2,s&&clearTimeout(s),c=void 0,a=n||"",T.readyState=t>0?4:0,r=t>=200&&300>t||304===t,i&&(E=V(u,T,i)),E=W(u,E,T,r),r?(u.ifModified&&(x=T.getResponseHeader("Last-Modified"),x&&(oe.lastModified[o]=x),x=T.getResponseHeader("etag"),x&&(oe.etag[o]=x)),204===t||"HEAD"===u.type?b="nocontent":304===t?b="notmodified":(b=E.state,h=E.data,v=E.error,r=!v)):(v=b,(t||!b)&&(b="error",0>t&&(t=0))),T.status=t,T.statusText=(e||b)+"",r?p.resolveWith(f,[h,b,T]):p.rejectWith(f,[T,b,v]),T.statusCode(g),g=void 0,l&&d.trigger(r?"ajaxSuccess":"ajaxError",[T,u,r?h:v]),m.fireWith(f,[T,b]),l&&(d.trigger("ajaxComplete",[T,u]),--oe.active||oe.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,r,o,a,s,l,c,h,u=oe.ajaxSetup({},e),f=u.context||u,d=u.context&&(f.nodeType||f.jquery)?oe(f):oe.event,p=oe.Deferred(),m=oe.Callbacks("once memory"),g=u.statusCode||{},v={},E={},y=0,x="canceled",T={readyState:0,getResponseHeader:function(t){var e;if(2===y){if(!h)for(h={};e=Ii.exec(a);)h[e[1].toLowerCase()]=e[2];e=h[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===y?a:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return y||(t=E[i]=E[i]||t,v[t]=e),this},overrideMimeType:function(t){return y||(u.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>y)for(e in t)g[e]=[g[e],t[e]];else T.always(t[T.status]);return this},abort:function(t){var e=t||x;return c&&c.abort(e),i(0,e),this}};if(p.promise(T).complete=m.add,T.success=T.done,T.error=T.fail,u.url=((t||u.url||Li)+"").replace(Ni,"").replace(Ui,ki[1]+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=oe.trim(u.dataType||"*").toLowerCase().match(xe)||[""],null==u.crossDomain&&(n=Bi.exec(u.url.toLowerCase()),u.crossDomain=!(!n||n[1]===ki[1]&&n[2]===ki[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(ki[3]||("http:"===ki[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=oe.param(u.data,u.traditional)),U(Vi,u,e,T),2===y)return T;l=u.global,l&&0===oe.active++&&oe.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!Oi.test(u.type),o=u.url,u.hasContent||(u.data&&(o=u.url+=(Di.test(o)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=Fi.test(o)?o.replace(Fi,"$1_="+Ai++):o+(Di.test(o)?"&":"?")+"_="+Ai++)),u.ifModified&&(oe.lastModified[o]&&T.setRequestHeader("If-Modified-Since",oe.lastModified[o]),oe.etag[o]&&T.setRequestHeader("If-None-Match",oe.etag[o])),(u.data&&u.hasContent&&u.contentType!==!1||e.contentType)&&T.setRequestHeader("Content-Type",u.contentType),T.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+ji+"; q=0.01":""):u.accepts["*"]);
for(r in u.headers)T.setRequestHeader(r,u.headers[r]);if(u.beforeSend&&(u.beforeSend.call(f,T,u)===!1||2===y))return T.abort();x="abort";for(r in{success:1,error:1,complete:1})T[r](u[r]);if(c=U(Wi,u,e,T)){T.readyState=1,l&&d.trigger("ajaxSend",[T,u]),u.async&&u.timeout>0&&(s=setTimeout(function(){T.abort("timeout")},u.timeout));try{y=1,c.send(v,i)}catch(b){if(!(2>y))throw b;i(-1,b)}}else i(-1,"No Transport");return T},getJSON:function(t,e,i){return oe.get(t,e,i,"json")},getScript:function(t,e){return oe.get(t,void 0,e,"script")}}),oe.each(["get","post"],function(t,e){oe[e]=function(t,i,n,r){return oe.isFunction(i)&&(r=r||n,n=i,i=void 0),oe.ajax({url:t,type:e,dataType:r,data:i,success:n})}}),oe.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){oe.fn[e]=function(t){return this.on(e,t)}}),oe._evalUrl=function(t){return oe.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},oe.fn.extend({wrapAll:function(t){if(oe.isFunction(t))return this.each(function(e){oe(this).wrapAll(t.call(this,e))});if(this[0]){var e=oe(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return this.each(oe.isFunction(t)?function(e){oe(this).wrapInner(t.call(this,e))}:function(){var e=oe(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=oe.isFunction(t);return this.each(function(i){oe(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){oe.nodeName(this,"body")||oe(this).replaceWith(this.childNodes)}).end()}}),oe.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0||!ne.reliableHiddenOffsets()&&"none"===(t.style&&t.style.display||oe.css(t,"display"))},oe.expr.filters.visible=function(t){return!oe.expr.filters.hidden(t)};var Xi=/%20/g,qi=/\[\]$/,Yi=/\r?\n/g,Ki=/^(?:submit|button|image|reset|file)$/i,$i=/^(?:input|select|textarea|keygen)/i;oe.param=function(t,e){var i,n=[],r=function(t,e){e=oe.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=oe.ajaxSettings&&oe.ajaxSettings.traditional),oe.isArray(t)||t.jquery&&!oe.isPlainObject(t))oe.each(t,function(){r(this.name,this.value)});else for(i in t)j(i,t[i],e,r);return n.join("&").replace(Xi,"+")},oe.fn.extend({serialize:function(){return oe.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=oe.prop(this,"elements");return t?oe.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!oe(this).is(":disabled")&&$i.test(this.nodeName)&&!Ki.test(t)&&(this.checked||!De.test(t))}).map(function(t,e){var i=oe(this).val();return null==i?null:oe.isArray(i)?oe.map(i,function(t){return{name:e.name,value:t.replace(Yi,"\r\n")}}):{name:e.name,value:i.replace(Yi,"\r\n")}}).get()}}),oe.ajaxSettings.xhr=void 0!==t.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&G()||X()}:G;var Qi=0,Zi={},Ji=oe.ajaxSettings.xhr();t.ActiveXObject&&oe(t).on("unload",function(){for(var t in Zi)Zi[t](void 0,!0)}),ne.cors=!!Ji&&"withCredentials"in Ji,Ji=ne.ajax=!!Ji,Ji&&oe.ajaxTransport(function(t){if(!t.crossDomain||ne.cors){var e;return{send:function(i,n){var r,o=t.xhr(),a=++Qi;if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)o[r]=t.xhrFields[r];t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(r in i)void 0!==i[r]&&o.setRequestHeader(r,i[r]+"");o.send(t.hasContent&&t.data||null),e=function(i,r){var s,l,c;if(e&&(r||4===o.readyState))if(delete Zi[a],e=void 0,o.onreadystatechange=oe.noop,r)4!==o.readyState&&o.abort();else{c={},s=o.status,"string"==typeof o.responseText&&(c.text=o.responseText);try{l=o.statusText}catch(h){l=""}s||!t.isLocal||t.crossDomain?1223===s&&(s=204):s=c.text?200:404}c&&n(s,l,c,o.getAllResponseHeaders())},t.async?4===o.readyState?setTimeout(e):o.onreadystatechange=Zi[a]=e:e()},abort:function(){e&&e(void 0,!0)}}}}),oe.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return oe.globalEval(t),t}}}),oe.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),oe.ajaxTransport("script",function(t){if(t.crossDomain){var e,i=me.head||oe("head")[0]||me.documentElement;return{send:function(n,r){e=me.createElement("script"),e.async=!0,t.scriptCharset&&(e.charset=t.scriptCharset),e.src=t.url,e.onload=e.onreadystatechange=function(t,i){(i||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),e=null,i||r(200,"success"))},i.insertBefore(e,i.firstChild)},abort:function(){e&&e.onload(void 0,!0)}}}});var tn=[],en=/(=)\?(?=&|$)|\?\?/;oe.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=tn.pop()||oe.expando+"_"+Ai++;return this[t]=!0,t}}),oe.ajaxPrefilter("json jsonp",function(e,i,n){var r,o,a,s=e.jsonp!==!1&&(en.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&en.test(e.data)&&"data");return s||"jsonp"===e.dataTypes[0]?(r=e.jsonpCallback=oe.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(en,"$1"+r):e.jsonp!==!1&&(e.url+=(Di.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return a||oe.error(r+" was not called"),a[0]},e.dataTypes[0]="json",o=t[r],t[r]=function(){a=arguments},n.always(function(){t[r]=o,e[r]&&(e.jsonpCallback=i.jsonpCallback,tn.push(r)),a&&oe.isFunction(o)&&o(a[0]),a=o=void 0}),"script"):void 0}),oe.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||me;var n=fe.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=oe.buildFragment([t],e,r),r&&r.length&&oe(r).remove(),oe.merge([],n.childNodes))};var nn=oe.fn.load;oe.fn.load=function(t,e,i){if("string"!=typeof t&&nn)return nn.apply(this,arguments);var n,r,o,a=this,s=t.indexOf(" ");return s>=0&&(n=oe.trim(t.slice(s,t.length)),t=t.slice(0,s)),oe.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),a.length>0&&oe.ajax({url:t,type:o,dataType:"html",data:e}).done(function(t){r=arguments,a.html(n?oe("<div>").append(oe.parseHTML(t)).find(n):t)}).complete(i&&function(t,e){a.each(i,r||[t.responseText,e,t])}),this},oe.expr.filters.animated=function(t){return oe.grep(oe.timers,function(e){return t===e.elem}).length};var rn=t.document.documentElement;oe.offset={setOffset:function(t,e,i){var n,r,o,a,s,l,c,h=oe.css(t,"position"),u=oe(t),f={};"static"===h&&(t.style.position="relative"),s=u.offset(),o=oe.css(t,"top"),l=oe.css(t,"left"),c=("absolute"===h||"fixed"===h)&&oe.inArray("auto",[o,l])>-1,c?(n=u.position(),a=n.top,r=n.left):(a=parseFloat(o)||0,r=parseFloat(l)||0),oe.isFunction(e)&&(e=e.call(t,i,s)),null!=e.top&&(f.top=e.top-s.top+a),null!=e.left&&(f.left=e.left-s.left+r),"using"in e?e.using.call(t,f):u.css(f)}},oe.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){oe.offset.setOffset(this,t,e)});var e,i,n={top:0,left:0},r=this[0],o=r&&r.ownerDocument;return o?(e=o.documentElement,oe.contains(e,r)?(typeof r.getBoundingClientRect!==_e&&(n=r.getBoundingClientRect()),i=q(o),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):n):void 0},position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===oe.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),oe.nodeName(t[0],"html")||(i=t.offset()),i.top+=oe.css(t[0],"borderTopWidth",!0),i.left+=oe.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-oe.css(n,"marginTop",!0),left:e.left-i.left-oe.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||rn;t&&!oe.nodeName(t,"html")&&"static"===oe.css(t,"position");)t=t.offsetParent;return t||rn})}}),oe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i=/Y/.test(e);oe.fn[t]=function(n){return Ae(this,function(t,n,r){var o=q(t);return void 0===r?o?e in o?o[e]:o.document.documentElement[n]:t[n]:void(o?o.scrollTo(i?oe(o).scrollLeft():r,i?r:oe(o).scrollTop()):t[n]=r)},t,n,arguments.length,null)}}),oe.each(["top","left"],function(t,e){oe.cssHooks[e]=H(ne.pixelPosition,function(t,i){return i?(i=ni(t,e),ei.test(i)?oe(t).position()[e]+"px":i):void 0})}),oe.each({Height:"height",Width:"width"},function(t,e){oe.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){oe.fn[n]=function(n,r){var o=arguments.length&&(i||"boolean"!=typeof n),a=i||(n===!0||r===!0?"margin":"border");return Ae(this,function(e,i,n){var r;return oe.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===n?oe.css(e,i,a):oe.style(e,i,n,a)},e,o?n:void 0,o,null)}})}),oe.fn.size=function(){return this.length},oe.fn.andSelf=oe.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return oe});var on=t.jQuery,an=t.$;return oe.noConflict=function(e){return t.$===oe&&(t.$=an),e&&t.jQuery===oe&&(t.jQuery=on),oe},typeof e===_e&&(t.jQuery=t.$=oe),oe}),function($,t){function e(t,e){var n,r,o,a=t.nodeName.toLowerCase();return"area"===a?(n=t.parentNode,r=n.name,t.href&&r&&"map"===n.nodeName.toLowerCase()?(o=$("img[usemap=#"+r+"]")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||e:e)&&i(t)}function i(t){return $.expr.filters.visible(t)&&!$(t).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length}var n=0,r=/^ui-id-\d+$/;$.ui=$.ui||{},$.extend($.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),$.fn.extend({focus:function(t){return function(e,i){return"number"==typeof e?this.each(function(){var t=this;setTimeout(function(){$(t).focus(),i&&i.call(t)},e)}):t.apply(this,arguments)}}($.fn.focus),scrollParent:function(){var t;return t=$.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test($.css(this,"position"))&&/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?$(document):t},zIndex:function(e){if(e!==t)return this.css("zIndex",e);if(this.length)for(var i=$(this[0]),n,r;i.length&&i[0]!==document;){if(n=i.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(r=parseInt(i.css("zIndex"),10),!isNaN(r)&&0!==r))return r;i=i.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&$(this).removeAttr("id")})}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(t){return function(e){return!!$.data(e,t)}}):function(t,e,i){return!!$.data(t,i[3])},focusable:function(t){return e(t,!isNaN($.attr(t,"tabindex")))},tabbable:function(t){var i=$.attr(t,"tabindex"),n=isNaN(i);return(n||i>=0)&&e(t,!n)}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],function(e,i){function n(t,e,i,n){return $.each(r,function(){e-=parseFloat($.css(t,"padding"+this))||0,i&&(e-=parseFloat($.css(t,"border"+this+"Width"))||0),n&&(e-=parseFloat($.css(t,"margin"+this))||0)}),e}var r="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};$.fn["inner"+i]=function(e){return e===t?a["inner"+i].call(this):this.each(function(){$(this).css(o,n(this,e)+"px")})},$.fn["outer"+i]=function(t,e){return"number"!=typeof t?a["outer"+i].call(this,t):this.each(function(){$(this).css(o,n(this,t,!0,e)+"px")})}}),$.fn.addBack||($.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),$("<a>").data("a-b","a").removeData("a-b").data("a-b")&&($.fn.removeData=function(t){return function(e){return arguments.length?t.call(this,$.camelCase(e)):t.call(this)}}($.fn.removeData)),$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),$.support.selectstart="onselectstart"in document.createElement("div"),$.fn.extend({disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),$.extend($.ui,{plugin:{add:function(t,e,i){var n,r=$.ui[t].prototype;for(n in i)r.plugins[n]=r.plugins[n]||[],r.plugins[n].push([e,i[n]])},call:function(t,e,i){var n,r=t.plugins[e];if(r&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(n=0;n<r.length;n++)t.options[r[n][0]]&&r[n][1].apply(t.element,i)}},hasScroll:function(t,e){if("hidden"===$(t).css("overflow"))return!1;var i=e&&"left"===e?"scrollLeft":"scrollTop",n=!1;return t[i]>0?!0:(t[i]=1,n=t[i]>0,t[i]=0,n)}})}(jQuery),function($,t){var e=0,i=Array.prototype.slice,n=$.cleanData;$.cleanData=function(t){for(var e=0,i;null!=(i=t[e]);e++)try{$(i).triggerHandler("remove")}catch(r){}n(t)},$.widget=function(t,e,i){var n,r,o,a,s={},l=t.split(".")[0];t=t.split(".")[1],n=l+"-"+t,i||(i=e,e=$.Widget),$.expr[":"][n.toLowerCase()]=function(t){return!!$.data(t,n)},$[l]=$[l]||{},r=$[l][t],o=$[l][t]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new o(t,e)},$.extend(o,r,{version:i.version,_proto:$.extend({},i),_childConstructors:[]}),a=new e,a.options=$.widget.extend({},a.options),$.each(i,function(t,i){return $.isFunction(i)?void(s[t]=function(){var n=function(){return e.prototype[t].apply(this,arguments)},r=function(i){return e.prototype[t].apply(this,i)};return function(){var t=this._super,e=this._superApply,o;return this._super=n,this._superApply=r,o=i.apply(this,arguments),this._super=t,this._superApply=e,o}}()):void(s[t]=i)}),o.prototype=$.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix:t},s,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),r?($.each(r._childConstructors,function(t,e){var i=e.prototype;$.widget(i.namespace+"."+i.widgetName,o,e._proto)}),delete r._childConstructors):e._childConstructors.push(o),$.widget.bridge(t,o)},$.widget.extend=function(e){for(var n=i.call(arguments,1),r=0,o=n.length,a,s;o>r;r++)for(a in n[r])s=n[r][a],n[r].hasOwnProperty(a)&&s!==t&&(e[a]=$.isPlainObject(s)?$.isPlainObject(e[a])?$.widget.extend({},e[a],s):$.widget.extend({},s):s);return e},$.widget.bridge=function(e,n){var r=n.prototype.widgetFullName||e;$.fn[e]=function(o){var a="string"==typeof o,s=i.call(arguments,1),l=this;return o=!a&&s.length?$.widget.extend.apply(null,[o].concat(s)):o,this.each(a?function(){var i,n=$.data(this,r);return n?$.isFunction(n[o])&&"_"!==o.charAt(0)?(i=n[o].apply(n,s),i!==n&&i!==t?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):$.error("no such method '"+o+"' for "+e+" widget instance"):$.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")}:function(){var t=$.data(this,r);t?t.option(o||{})._init():$.data(this,r,new n(o,this))}),l}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=$(i||this.defaultElement||this)[0],this.element=$(i),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=$.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=$(),this.hoverable=$(),this.focusable=$(),i!==this&&($.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=$(i.style?i.ownerDocument:i.document||i),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(e,i){var n=e,r,o,a;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof e)if(n={},r=e.split("."),e=r.shift(),r.length){for(o=n[e]=$.widget.extend({},this.options[e]),a=0;a<r.length-1;a++)o[r[a]]=o[r[a]]||{},o=o[r[a]];if(e=r.pop(),i===t)return o[e]===t?null:o[e];o[e]=i}else{if(i===t)return this.options[e]===t?null:this.options[e];n[e]=i}return this._setOptions(n),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,e,i){var n,r=this;"boolean"!=typeof t&&(i=e,e=t,t=!1),i?(e=n=$(e),this.bindings=this.bindings.add(e)):(i=e,e=this.element,n=this.widget()),$.each(i,function(i,o){function a(){return t||r.options.disabled!==!0&&!$(this).hasClass("ui-state-disabled")?("string"==typeof o?r[o]:o).apply(r,arguments):void 0}"string"!=typeof o&&(a.guid=o.guid=o.guid||a.guid||$.guid++);var s=i.match(/^(\w+)\s*(.*)$/),l=s[1]+r.eventNamespace,c=s[2];c?n.delegate(c,l,a):e.bind(l,a)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){$(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){$(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){$(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){$(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,e,i){var n,r,o=this.options[t];if(i=i||{},e=$.Event(e),e.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],r=e.originalEvent)for(n in r)n in e||(e[n]=r[n]);return this.element.trigger(e,i),!($.isFunction(o)&&o.apply(this.element[0],[e].concat(i))===!1||e.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(t,e){$.Widget.prototype["_"+t]=function(i,n,r){"string"==typeof n&&(n={effect:n});var o,a=n?n===!0||"number"==typeof n?e:n.effect||e:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!$.isEmptyObject(n),n.complete=r,n.delay&&i.delay(n.delay),o&&$.effects&&$.effects.effect[a]?i[t](n):a!==t&&i[a]?i[a](n.duration,n.easing,r):i.queue(function(e){$(this)[t](),r&&r.call(i[0]),e()})}})}(jQuery),function($,t){var e=!1;$(document).mouseup(function(){e=!1}),$.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(e){return!0===$.data(e.target,t.widgetName+".preventClickEvent")?($.removeData(e.target,t.widgetName+".preventClickEvent"),e.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!e){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,n=1===t.which,r="string"==typeof this.options.cancel&&t.target.nodeName?$(t.target).closest(this.options.cancel).length:!1;return n&&!r&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===$.data(t.target,this.widgetName+".preventClickEvent")&&$.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(t){return $.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return $(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&$.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function($,t){$.widget("ui.draggable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var e=this.options;return this.helper||e.disabled||$(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?($(e.iframeFix===!0?"iframe":e.iframeFix).each(function(){$("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css($(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var e=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,$.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!e.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,e){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!e){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),$.ui.ddmanager&&$.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var e=this,i=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(i=$.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"original"!==this.options.helper||$.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){e._trigger("stop",t)!==!1&&e._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return $("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,t),$.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!$(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var e=this.options,i=$.isFunction(e.helper)?$(e.helper.apply(this.element[0],[t])):"clone"===e.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===e.appendTo?this.element[0].parentNode:e.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),$.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.element.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,i,n=this.options;return n.containment?"window"===n.containment?void(this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),e=$(n.containment),i=e[0],void(i&&(t="hidden"!==e.css("overflow"),this.containment=[(parseInt(e.css("borderLeftWidth"),10)||0)+(parseInt(e.css("paddingLeft"),10)||0),(parseInt(e.css("borderTopWidth"),10)||0)+(parseInt(e.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e.css("borderRightWidth"),10)||0)-(parseInt(e.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e.css("borderBottomWidth"),10)||0)-(parseInt(e.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=e))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:n.scrollTop(),left:n.scrollLeft()}),{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*i}},_generatePosition:function(t){var e,i,n,r,o=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=t.pageX,l=t.pageY;return this.offset.scroll||(this.offset.scroll={top:a.scrollTop(),left:a.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(i=this.relative_container.offset(),e=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):e=this.containment,t.pageX-this.offset.click.left<e[0]&&(s=e[0]+this.offset.click.left),t.pageY-this.offset.click.top<e[1]&&(l=e[1]+this.offset.click.top),t.pageX-this.offset.click.left>e[2]&&(s=e[2]+this.offset.click.left),t.pageY-this.offset.click.top>e[3]&&(l=e[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=e?n-this.offset.click.top>=e[1]||n-this.offset.click.top>e[3]?n:n-this.offset.click.top>=e[1]?n-o.grid[1]:n+o.grid[1]:n,r=o.grid[0]?this.originalPageX+Math.round((s-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,s=e?r-this.offset.click.left>=e[0]||r-this.offset.click.left>e[2]?r:r-this.offset.click.left>=e[0]?r-o.grid[0]:r+o.grid[0]:r)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}
},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,e,i){return i=i||this._uiHash(),$.ui.plugin.call(this,t,[e,i]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),$.Widget.prototype._trigger.call(this,t,e,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(t,e){var i=$(this).data("ui-draggable"),n=i.options,r=$.extend({},e,{item:i.element});i.sortables=[],$(n.connectToSortable).each(function(){var e=$.data(this,"ui-sortable");e&&!e.options.disabled&&(i.sortables.push({instance:e,shouldRevert:e.options.revert}),e.refreshPositions(),e._trigger("activate",t,r))})},stop:function(t,e){var i=$(this).data("ui-draggable"),n=$.extend({},e,{item:i.element});$.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,n))})},drag:function(t,e){var i=$(this).data("ui-draggable"),n=this;$.each(i.sortables,function(){var r=!1,o=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(r=!0,$.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&$.contains(o.instance.element[0],this.instance.element[0])&&(r=!1),r})),r?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=$(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return e.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),$.ui.plugin.add("draggable","cursor",{start:function(){var t=$("body"),e=$(this).data("ui-draggable").options;t.css("cursor")&&(e._cursor=t.css("cursor")),t.css("cursor",e.cursor)},stop:function(){var t=$(this).data("ui-draggable").options;t._cursor&&$("body").css("cursor",t._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(t,e){var i=$(e.helper),n=$(this).data("ui-draggable").options;i.css("opacity")&&(n._opacity=i.css("opacity")),i.css("opacity",n.opacity)},stop:function(t,e){var i=$(this).data("ui-draggable").options;i._opacity&&$(e.helper).css("opacity",i._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(){var t=$(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var e=$(this).data("ui-draggable"),i=e.options,n=!1;e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(e.overflowOffset.top+e.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?e.scrollParent[0].scrollTop=n=e.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-e.overflowOffset.top<i.scrollSensitivity&&(e.scrollParent[0].scrollTop=n=e.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(e.overflowOffset.left+e.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?e.scrollParent[0].scrollLeft=n=e.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-e.overflowOffset.left<i.scrollSensitivity&&(e.scrollParent[0].scrollLeft=n=e.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-$(document).scrollTop()<i.scrollSensitivity?n=$(document).scrollTop($(document).scrollTop()-i.scrollSpeed):$(window).height()-(t.pageY-$(document).scrollTop())<i.scrollSensitivity&&(n=$(document).scrollTop($(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-$(document).scrollLeft()<i.scrollSensitivity?n=$(document).scrollLeft($(document).scrollLeft()-i.scrollSpeed):$(window).width()-(t.pageX-$(document).scrollLeft())<i.scrollSensitivity&&(n=$(document).scrollLeft($(document).scrollLeft()+i.scrollSpeed)))),n!==!1&&$.ui.ddmanager&&!i.dropBehaviour&&$.ui.ddmanager.prepareOffsets(e,t)}}),$.ui.plugin.add("draggable","snap",{start:function(){var t=$(this).data("ui-draggable"),e=t.options;t.snapElements=[],$(e.snap.constructor!==String?e.snap.items||":data(ui-draggable)":e.snap).each(function(){var e=$(this),i=e.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(t,e){var i,n,r,o,a,s,l,c,h,u,f=$(this).data("ui-draggable"),d=f.options,p=d.snapTolerance,m=e.offset.left,g=m+f.helperProportions.width,v=e.offset.top,E=v+f.helperProportions.height;for(h=f.snapElements.length-1;h>=0;h--)a=f.snapElements[h].left,s=a+f.snapElements[h].width,l=f.snapElements[h].top,c=l+f.snapElements[h].height,a-p>g||m>s+p||l-p>E||v>c+p||!$.contains(f.snapElements[h].item.ownerDocument,f.snapElements[h].item)?(f.snapElements[h].snapping&&f.options.snap.release&&f.options.snap.release.call(f.element,t,$.extend(f._uiHash(),{snapItem:f.snapElements[h].item})),f.snapElements[h].snapping=!1):("inner"!==d.snapMode&&(i=Math.abs(l-E)<=p,n=Math.abs(c-v)<=p,r=Math.abs(a-g)<=p,o=Math.abs(s-m)<=p,i&&(e.position.top=f._convertPositionTo("relative",{top:l-f.helperProportions.height,left:0}).top-f.margins.top),n&&(e.position.top=f._convertPositionTo("relative",{top:c,left:0}).top-f.margins.top),r&&(e.position.left=f._convertPositionTo("relative",{top:0,left:a-f.helperProportions.width}).left-f.margins.left),o&&(e.position.left=f._convertPositionTo("relative",{top:0,left:s}).left-f.margins.left)),u=i||n||r||o,"outer"!==d.snapMode&&(i=Math.abs(l-v)<=p,n=Math.abs(c-E)<=p,r=Math.abs(a-m)<=p,o=Math.abs(s-g)<=p,i&&(e.position.top=f._convertPositionTo("relative",{top:l,left:0}).top-f.margins.top),n&&(e.position.top=f._convertPositionTo("relative",{top:c-f.helperProportions.height,left:0}).top-f.margins.top),r&&(e.position.left=f._convertPositionTo("relative",{top:0,left:a}).left-f.margins.left),o&&(e.position.left=f._convertPositionTo("relative",{top:0,left:s-f.helperProportions.width}).left-f.margins.left)),!f.snapElements[h].snapping&&(i||n||r||o||u)&&f.options.snap.snap&&f.options.snap.snap.call(f.element,t,$.extend(f._uiHash(),{snapItem:f.snapElements[h].item})),f.snapElements[h].snapping=i||n||r||o||u)}}),$.ui.plugin.add("draggable","stack",{start:function(){var t,e=this.data("ui-draggable").options,i=$.makeArray($(e.stack)).sort(function(t,e){return(parseInt($(t).css("zIndex"),10)||0)-(parseInt($(e).css("zIndex"),10)||0)});i.length&&(t=parseInt($(i[0]).css("zIndex"),10)||0,$(i).each(function(e){$(this).css("zIndex",t+e)}),this.css("zIndex",t+i.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(t,e){var i=$(e.helper),n=$(this).data("ui-draggable").options;i.css("zIndex")&&(n._zIndex=i.css("zIndex")),i.css("zIndex",n.zIndex)},stop:function(t,e){var i=$(this).data("ui-draggable").options;i._zIndex&&$(e.helper).css("zIndex",i._zIndex)}})}(jQuery),function($,t){function e(t,e,i){return t>e&&e+i>t}$.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t=this.options,e=t.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(e)?e:function(t){return t.is(e)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},$.ui.ddmanager.droppables[t.scope]=$.ui.ddmanager.droppables[t.scope]||[],$.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var t=0,e=$.ui.ddmanager.droppables[this.options.scope];t<e.length;t++)e[t]===this&&e.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,e){"accept"===t&&(this.accept=$.isFunction(e)?e:function(t){return t.is(e)}),$.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var e=$.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),e&&this._trigger("activate",t,this.ui(e))},_deactivate:function(t){var e=$.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),e&&this._trigger("deactivate",t,this.ui(e))},_over:function(t){var e=$.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(e)))},_out:function(t){var e=$.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(e)))},_drop:function(t,e){var i=e||$.ui.ddmanager.current,n=!1;return i&&(i.currentItem||i.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=$.data(this,"ui-droppable");return t.options.greedy&&!t.options.disabled&&t.options.scope===i.options.scope&&t.accept.call(t.element[0],i.currentItem||i.element)&&$.ui.intersect(i,$.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(i)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),$.ui.intersect=function(t,i,n){if(!i.offset)return!1;var r,o,a=(t.positionAbs||t.position.absolute).left,s=a+t.helperProportions.width,l=(t.positionAbs||t.position.absolute).top,c=l+t.helperProportions.height,h=i.offset.left,u=h+i.proportions.width,f=i.offset.top,d=f+i.proportions.height;switch(n){case"fit":return a>=h&&u>=s&&l>=f&&d>=c;case"intersect":return h<a+t.helperProportions.width/2&&s-t.helperProportions.width/2<u&&f<l+t.helperProportions.height/2&&c-t.helperProportions.height/2<d;case"pointer":return r=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,o=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,e(o,f,i.proportions.height)&&e(r,h,i.proportions.width);case"touch":return(l>=f&&d>=l||c>=f&&d>=c||f>l&&c>d)&&(a>=h&&u>=a||s>=h&&u>=s||h>a&&s>u);default:return!1}},$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,e){var i,n,r=$.ui.ddmanager.droppables[t.options.scope]||[],o=e?e.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();t:for(i=0;i<r.length;i++)if(!(r[i].options.disabled||t&&!r[i].accept.call(r[i].element[0],t.currentItem||t.element))){for(n=0;n<a.length;n++)if(a[n]===r[i].element[0]){r[i].proportions.height=0;continue t}r[i].visible="none"!==r[i].element.css("display"),r[i].visible&&("mousedown"===o&&r[i]._activate.call(r[i],e),r[i].offset=r[i].element.offset(),r[i].proportions={width:r[i].element[0].offsetWidth,height:r[i].element[0].offsetHeight})}},drop:function(t,e){var i=!1;return $.each(($.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&$.ui.intersect(t,this,this.options.tolerance)&&(i=this._drop.call(this,e)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,e)))}),i},dragStart:function(t,e){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||$.ui.ddmanager.prepareOffsets(t,e)})},drag:function(t,e){t.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(t,e),$.each($.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var i,n,r,o=$.ui.intersect(t,this,this.options.tolerance),a=!o&&this.isover?"isout":o&&!this.isover?"isover":null;a&&(this.options.greedy&&(n=this.options.scope,r=this.element.parents(":data(ui-droppable)").filter(function(){return $.data(this,"ui-droppable").options.scope===n}),r.length&&(i=$.data(r[0],"ui-droppable"),i.greedyChild="isover"===a)),i&&"isover"===a&&(i.isover=!1,i.isout=!0,i._out.call(i,e)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,e),i&&"isout"===a&&(i.isout=!1,i.isover=!0,i._over.call(i,e)))}})},dragStop:function(t,e){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||$.ui.ddmanager.prepareOffsets(t,e)}}}(jQuery),function($,t){function e(t){return parseInt(t,10)||0}function i(t){return!isNaN(parseInt(t,10))}$.widget("ui.resizable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,e,i,n,r,o=this,a=this.options;if(this.element.addClass("ui-resizable"),$.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||($(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},e=0;e<t.length;e++)i=$.trim(t[e]),r="ui-resizable-"+i,n=$("<div class='ui-resizable-handle "+r+"'></div>"),n.css({zIndex:a.zIndex}),"se"===i&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[i]=".ui-resizable-"+i,this.element.append(n);this._renderAxis=function(t){var e,i,n,r;t=t||this.element;for(e in this.handles)this.handles[e].constructor===String&&(this.handles[e]=$(this.handles[e],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(i=$(this.handles[e],this.element),r=/sw|ne|nw|se|n|s/.test(e)?i.outerHeight():i.outerWidth(),n=["padding",/ne|nw|n/.test(e)?"Top":/se|sw|s/.test(e)?"Bottom":/^e$/.test(e)?"Right":"Left"].join(""),t.css(n,r),this._proportionallyResize()),$(this.handles[e]).length},this._renderAxis(this.element),this._handles=$(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),a.autoHide&&(this._handles.hide(),$(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||($(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){a.disabled||o.resizing||($(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,e=function(t){$(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(e(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_mouseCapture:function(t){var e,i,n=!1;for(e in this.handles)i=$(this.handles[e])[0],(i===t.target||$.contains(i,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var i,n,r,o=this.options,a=this.element.position(),s=this.element;return this.resizing=!0,/absolute/.test(s.css("position"))?s.css({position:"absolute",top:s.css("top"),left:s.css("left")}):s.is(".ui-draggable")&&s.css({position:"absolute",top:a.top,left:a.left}),this._renderProxy(),i=e(this.helper.css("left")),n=e(this.helper.css("top")),o.containment&&(i+=$(o.containment).scrollLeft()||0,n+=$(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:n},this.size=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalPosition={left:i,top:n},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=$(".ui-resizable-"+this.axis).css("cursor"),$("body").css("cursor","auto"===r?this.axis+"-resize":r),s.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var e,i=this.helper,n={},r=this.originalMousePosition,o=this.axis,a=this.position.top,s=this.position.left,l=this.size.width,c=this.size.height,h=t.pageX-r.left||0,u=t.pageY-r.top||0,f=this._change[o];return f?(e=f.apply(this,[t,h,u]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(e=this._updateRatio(e,t)),e=this._respectSize(e,t),this._updateCache(e),this._propagate("resize",t),this.position.top!==a&&(n.top=this.position.top+"px"),this.position.left!==s&&(n.left=this.position.left+"px"),this.size.width!==l&&(n.width=this.size.width+"px"),this.size.height!==c&&(n.height=this.size.height+"px"),i.css(n),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),$.isEmptyObject(n)||this._trigger("resize",t,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var e,i,n,r,o,a,s,l=this.options,c=this;return this._helper&&(e=this._proportionallyResizeElements,i=e.length&&/textarea/i.test(e[0].nodeName),n=i&&$.ui.hasScroll(e[0],"left")?0:c.sizeDiff.height,r=i?0:c.sizeDiff.width,o={width:c.helper.width()-r,height:c.helper.height()-n},a=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,s=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null,l.animate||this.element.css($.extend(o,{top:s,left:a})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!l.animate&&this._proportionallyResize()),$("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(t){var e,n,r,o,a,s=this.options;a={minWidth:i(s.minWidth)?s.minWidth:0,maxWidth:i(s.maxWidth)?s.maxWidth:1/0,minHeight:i(s.minHeight)?s.minHeight:0,maxHeight:i(s.maxHeight)?s.maxHeight:1/0},(this._aspectRatio||t)&&(e=a.minHeight*this.aspectRatio,r=a.minWidth/this.aspectRatio,n=a.maxHeight*this.aspectRatio,o=a.maxWidth/this.aspectRatio,e>a.minWidth&&(a.minWidth=e),r>a.minHeight&&(a.minHeight=r),n<a.maxWidth&&(a.maxWidth=n),o<a.maxHeight&&(a.maxHeight=o)),this._vBoundaries=a},_updateCache:function(t){this.offset=this.helper.offset(),i(t.left)&&(this.position.left=t.left),i(t.top)&&(this.position.top=t.top),i(t.height)&&(this.size.height=t.height),i(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,n=this.size,r=this.axis;return i(t.height)?t.width=t.height*this.aspectRatio:i(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===r&&(t.left=e.left+(n.width-t.width),t.top=null),"nw"===r&&(t.top=e.top+(n.height-t.height),t.left=e.left+(n.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,n=this.axis,r=i(t.width)&&e.maxWidth&&e.maxWidth<t.width,o=i(t.height)&&e.maxHeight&&e.maxHeight<t.height,a=i(t.width)&&e.minWidth&&e.minWidth>t.width,s=i(t.height)&&e.minHeight&&e.minHeight>t.height,l=this.originalPosition.left+this.originalSize.width,c=this.position.top+this.size.height,h=/sw|nw|w/.test(n),u=/nw|ne|n/.test(n);return a&&(t.width=e.minWidth),s&&(t.height=e.minHeight),r&&(t.width=e.maxWidth),o&&(t.height=e.maxHeight),a&&h&&(t.left=l-e.minWidth),r&&h&&(t.left=l-e.maxWidth),s&&u&&(t.top=c-e.minHeight),o&&u&&(t.top=c-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var t,e,i,n,r,o=this.helper||this.element;for(t=0;t<this._proportionallyResizeElements.length;t++){if(r=this._proportionallyResizeElements[t],!this.borderDif)for(this.borderDif=[],i=[r.css("borderTopWidth"),r.css("borderRightWidth"),r.css("borderBottomWidth"),r.css("borderLeftWidth")],n=[r.css("paddingTop"),r.css("paddingRight"),r.css("paddingBottom"),r.css("paddingLeft")],e=0;e<i.length;e++)this.borderDif[e]=(parseInt(i[e],10)||0)+(parseInt(n[e],10)||0);r.css({height:o.height()-this.borderDif[0]-this.borderDif[2]||0,width:o.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,e=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||$("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++e.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,n=this.originalPosition;return{left:n.left+e,width:i.width-e}},n:function(t,e,i){var n=this.originalSize,r=this.originalPosition;return{top:r.top+i,height:n.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(t,e,i){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},sw:function(t,e,i){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,e,i]))},ne:function(t,e,i){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},nw:function(t,e,i){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,e,i]))}},_propagate:function(t,e){$.ui.plugin.call(this,t,[e,this.ui()]),"resize"!==t&&this._trigger(t,e,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),$.ui.plugin.add("resizable","animate",{stop:function(t){var e=$(this).data("ui-resizable"),i=e.options,n=e._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),o=r&&$.ui.hasScroll(n[0],"left")?0:e.sizeDiff.height,a=r?0:e.sizeDiff.width,s={width:e.size.width-a,height:e.size.height-o},l=parseInt(e.element.css("left"),10)+(e.position.left-e.originalPosition.left)||null,c=parseInt(e.element.css("top"),10)+(e.position.top-e.originalPosition.top)||null;e.element.animate($.extend(s,c&&l?{top:c,left:l}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseInt(e.element.css("width"),10),height:parseInt(e.element.css("height"),10),top:parseInt(e.element.css("top"),10),left:parseInt(e.element.css("left"),10)};n&&n.length&&$(n[0]).css({width:i.width,height:i.height}),e._updateCache(i),e._propagate("resize",t)}})}}),$.ui.plugin.add("resizable","containment",{start:function(){var t,i,n,r,o,a,s,l=$(this).data("ui-resizable"),c=l.options,h=l.element,u=c.containment,f=u instanceof $?u.get(0):/parent/.test(u)?h.parent().get(0):u;f&&(l.containerElement=$(f),/document/.test(u)||u===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}):(t=$(f),i=[],$(["Top","Right","Left","Bottom"]).each(function(n,r){i[n]=e(t.css("padding"+r))}),l.containerOffset=t.offset(),l.containerPosition=t.position(),l.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},n=l.containerOffset,r=l.containerSize.height,o=l.containerSize.width,a=$.ui.hasScroll(f,"left")?f.scrollWidth:o,s=$.ui.hasScroll(f)?f.scrollHeight:r,l.parentData={element:f,left:n.left,top:n.top,width:a,height:s}))},resize:function(t){var e,i,n,r,o=$(this).data("ui-resizable"),a=o.options,s=o.containerOffset,l=o.position,c=o._aspectRatio||t.shiftKey,h={top:0,left:0},u=o.containerElement;u[0]!==document&&/static/.test(u.css("position"))&&(h=s),l.left<(o._helper?s.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-s.left:o.position.left-h.left),c&&(o.size.height=o.size.width/o.aspectRatio),o.position.left=a.helper?s.left:0),l.top<(o._helper?s.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-s.top:o.position.top),c&&(o.size.width=o.size.height*o.aspectRatio),o.position.top=o._helper?s.top:0),o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top,e=Math.abs((o._helper?o.offset.left-h.left:o.offset.left-h.left)+o.sizeDiff.width),i=Math.abs((o._helper?o.offset.top-h.top:o.offset.top-s.top)+o.sizeDiff.height),n=o.containerElement.get(0)===o.element.parent().get(0),r=/relative|absolute/.test(o.containerElement.css("position")),n&&r&&(e-=o.parentData.left),e+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-e,c&&(o.size.height=o.size.width/o.aspectRatio)),i+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-i,c&&(o.size.width=o.size.height*o.aspectRatio))},stop:function(){var t=$(this).data("ui-resizable"),e=t.options,i=t.containerOffset,n=t.containerPosition,r=t.containerElement,o=$(t.helper),a=o.offset(),s=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!e.animate&&/relative/.test(r.css("position"))&&$(this).css({left:a.left-n.left-i.left,width:s,height:l}),t._helper&&!e.animate&&/static/.test(r.css("position"))&&$(this).css({left:a.left-n.left-i.left,width:s,height:l})}}),$.ui.plugin.add("resizable","alsoResize",{start:function(){var t=$(this).data("ui-resizable"),e=t.options,i=function(t){$(t).each(function(){var t=$(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof e.alsoResize||e.alsoResize.parentNode?i(e.alsoResize):e.alsoResize.length?(e.alsoResize=e.alsoResize[0],i(e.alsoResize)):$.each(e.alsoResize,function(t){i(t)})},resize:function(t,e){var i=$(this).data("ui-resizable"),n=i.options,r=i.originalSize,o=i.originalPosition,a={height:i.size.height-r.height||0,width:i.size.width-r.width||0,top:i.position.top-o.top||0,left:i.position.left-o.left||0},s=function(t,i){$(t).each(function(){var t=$(this),n=$(this).data("ui-resizable-alsoresize"),r={},o=i&&i.length?i:t.parents(e.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(o,function(t,e){var i=(n[e]||0)+(a[e]||0);i&&i>=0&&(r[e]=i||null)}),t.css(r)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?s(n.alsoResize):$.each(n.alsoResize,function(t,e){s(t,e)})},stop:function(){$(this).removeData("resizable-alsoresize")}}),$.ui.plugin.add("resizable","ghost",{start:function(){var t=$(this).data("ui-resizable"),e=t.options,i=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof e.ghost?e.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=$(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=$(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),$.ui.plugin.add("resizable","grid",{resize:function(){var t=$(this).data("ui-resizable"),e=t.options,i=t.size,n=t.originalSize,r=t.originalPosition,o=t.axis,a="number"==typeof e.grid?[e.grid,e.grid]:e.grid,s=a[0]||1,l=a[1]||1,c=Math.round((i.width-n.width)/s)*s,h=Math.round((i.height-n.height)/l)*l,u=n.width+c,f=n.height+h,d=e.maxWidth&&e.maxWidth<u,p=e.maxHeight&&e.maxHeight<f,m=e.minWidth&&e.minWidth>u,g=e.minHeight&&e.minHeight>f;e.grid=a,m&&(u+=s),g&&(f+=l),d&&(u-=s),p&&(f-=l),/^(se|s|e)$/.test(o)?(t.size.width=u,t.size.height=f):/^(ne)$/.test(o)?(t.size.width=u,t.size.height=f,t.position.top=r.top-h):/^(sw)$/.test(o)?(t.size.width=u,t.size.height=f,t.position.left=r.left-c):(t.size.width=u,t.size.height=f,t.position.top=r.top-h,t.position.left=r.left-c)}})}(jQuery),function($,t){$.widget("ui.selectable",$.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,e=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=$(e.options.filter,e.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=$(this),e=t.offset();$.data(this,"selectable-item",{element:this,$element:t,left:e.left,top:e.top,right:e.left+t.outerWidth(),bottom:e.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})
})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=$("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var e=this,i=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=$(i.filter,this.element[0]),this._trigger("start",t),$(i.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),i.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var i=$.data(this,"selectable-item");i.startselected=!0,t.metaKey||t.ctrlKey||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,e._trigger("unselecting",t,{unselecting:i.element}))}),$(t.target).parents().addBack().each(function(){var i,n=$.data(this,"selectable-item");return n?(i=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(i?"ui-unselecting":"ui-selected").addClass(i?"ui-selecting":"ui-unselecting"),n.unselecting=!i,n.selecting=i,n.selected=i,i?e._trigger("selecting",t,{selecting:n.element}):e._trigger("unselecting",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var e,i=this,n=this.options,r=this.opos[0],o=this.opos[1],a=t.pageX,s=t.pageY;return r>a&&(e=a,a=r,r=e),o>s&&(e=s,s=o,o=e),this.helper.css({left:r,top:o,width:a-r,height:s-o}),this.selectees.each(function(){var e=$.data(this,"selectable-item"),l=!1;e&&e.element!==i.element[0]&&("touch"===n.tolerance?l=!(e.left>a||e.right<r||e.top>s||e.bottom<o):"fit"===n.tolerance&&(l=e.left>r&&e.right<a&&e.top>o&&e.bottom<s),l?(e.selected&&(e.$element.removeClass("ui-selected"),e.selected=!1),e.unselecting&&(e.$element.removeClass("ui-unselecting"),e.unselecting=!1),e.selecting||(e.$element.addClass("ui-selecting"),e.selecting=!0,i._trigger("selecting",t,{selecting:e.element}))):(e.selecting&&((t.metaKey||t.ctrlKey)&&e.startselected?(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.$element.addClass("ui-selected"),e.selected=!0):(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.startselected&&(e.$element.addClass("ui-unselecting"),e.unselecting=!0),i._trigger("unselecting",t,{unselecting:e.element}))),e.selected&&(t.metaKey||t.ctrlKey||e.startselected||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,i._trigger("unselecting",t,{unselecting:e.element})))))}),!1}},_mouseStop:function(t){var e=this;return this.dragged=!1,$(".ui-unselecting",this.element[0]).each(function(){var i=$.data(this,"selectable-item");i.$element.removeClass("ui-unselecting"),i.unselecting=!1,i.startselected=!1,e._trigger("unselected",t,{unselected:i.element})}),$(".ui-selecting",this.element[0]).each(function(){var i=$.data(this,"selectable-item");i.$element.removeClass("ui-selecting").addClass("ui-selected"),i.selecting=!1,i.selected=!0,i.startselected=!0,e._trigger("selected",t,{selected:i.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function($,t){function e(t,e,i){return t>e&&e+i>t}function i(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))}$.widget("ui.sortable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===t.axis||i(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,e){"disabled"===t?(this.options[t]=e,this.widget().toggleClass("ui-sortable-disabled",!!e)):$.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,e){var i=null,n=!1,r=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),$(t.target).parents().each(function(){return $.data(this,r.widgetName+"-item")===r?(i=$(this),!1):void 0}),$.data(t.target,r.widgetName+"-item")===r&&(i=$(t.target)),i&&(!this.options.handle||e||($(this.options.handle,i).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n))?(this.currentItem=i,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(t,e,i){var n,r,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},$.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",o.cursor),this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(r)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return $.ui.ddmanager&&($.ui.ddmanager.current=this),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var e,i,n,r,o=this.options,a=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-$(document).scrollTop()<o.scrollSensitivity?a=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(t.pageY-$(document).scrollTop())<o.scrollSensitivity&&(a=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)),t.pageX-$(document).scrollLeft()<o.scrollSensitivity?a=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(t.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(a=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed))),a!==!1&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e=this.items.length-1;e>=0;e--)if(i=this.items[e],n=i.item[0],r=this._intersectsWithPointer(i),r&&i.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===r?"next":"prev"]()[0]!==n&&!$.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!$.contains(this.element[0],n):!0)){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),$.ui.ddmanager&&$.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,e){if(t){if($.ui.ddmanager&&!this.options.dropBehaviour&&$.ui.ddmanager.drop(this,t),this.options.revert){var i=this,n=this.placeholder.offset(),r=this.options.axis,o={};r&&"x"!==r||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),r&&"y"!==r||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,$(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){i._clear(t)})}else this._clear(t,e);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),$.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?$(this.domPosition.prev).after(this.currentItem):$(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var e=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},$(e).each(function(){var e=($(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);e&&i.push((t.key||e[1]+"[]")+"="+(t.key&&t.expression?e[1]:e[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var e=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e.each(function(){i.push($(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,r=n+this.helperProportions.height,o=t.left,a=o+t.width,s=t.top,l=s+t.height,c=this.offset.click.top,h=this.offset.click.left,u="x"===this.options.axis||n+c>s&&l>n+c,f="y"===this.options.axis||e+h>o&&a>e+h,d=u&&f;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?d:o<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<a&&s<n+this.helperProportions.height/2&&r-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var i="x"===this.options.axis||e(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||e(this.positionAbs.left+this.offset.click.left,t.left,t.width),r=i&&n,o=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return r?this.floating?a&&"right"===a||"down"===o?2:1:o&&("down"===o?2:1):!1},_intersectsWithSides:function(t){var i=e(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),n=e(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),r=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&n||"left"===o&&!n:r&&("down"===r&&i||"up"===r&&!i)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(t){var e,i,n,r,o=[],a=[],s=this._connectWith();if(s&&t)for(e=s.length-1;e>=0;e--)for(n=$(s[e]),i=n.length-1;i>=0;i--)r=$.data(n[i],this.widgetFullName),r&&r!==this&&!r.options.disabled&&a.push([$.isFunction(r.options.items)?r.options.items.call(r.element):$(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(a.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),e=a.length-1;e>=0;e--)a[e][0].each(function(){o.push(this)});return $(o)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(e){for(var i=0;i<t.length;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var e,i,n,r,o,a,s,l,c=this.items,h=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):$(this.options.items,this.element),this]],u=this._connectWith();if(u&&this.ready)for(e=u.length-1;e>=0;e--)for(n=$(u[e]),i=n.length-1;i>=0;i--)r=$.data(n[i],this.widgetFullName),r&&r!==this&&!r.options.disabled&&(h.push([$.isFunction(r.options.items)?r.options.items.call(r.element[0],t,{item:this.currentItem}):$(r.options.items,r.element),r]),this.containers.push(r));for(e=h.length-1;e>=0;e--)for(o=h[e][1],a=h[e][0],i=0,l=a.length;l>i;i++)s=$(a[i]),s.data(this.widgetName+"-item",o),c.push({item:s,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var e,i,n,r;for(e=this.items.length-1;e>=0;e--)i=this.items[e],i.instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?$(this.options.toleranceElement,i.item):i.item,t||(i.width=n.outerWidth(),i.height=n.outerHeight()),r=n.offset(),i.left=r.left,i.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(e=this.containers.length-1;e>=0;e--)r=this.containers[e].element.offset(),this.containers[e].containerCache.left=r.left,this.containers[e].containerCache.top=r.top,this.containers[e].containerCache.width=this.containers[e].element.outerWidth(),this.containers[e].containerCache.height=this.containers[e].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var e,i=t.options;i.placeholder&&i.placeholder.constructor!==String||(e=i.placeholder,i.placeholder={element:function(){var i=t.currentItem[0].nodeName.toLowerCase(),n=$("<"+i+">",t.document[0]).addClass(e||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===i?t.currentItem.children().each(function(){$("<td>&#160;</td>",t.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(n)}):"img"===i&&n.attr("src",t.currentItem.attr("src")),e||n.css("visibility","hidden"),n},update:function(n,r){(!e||i.forcePlaceholderSize)&&(r.height()||r.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=$(i.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),i.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var n,r,o,a,s,l,c,h,u,f,d=null,p=null;for(n=this.containers.length-1;n>=0;n--)if(!$.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(d&&$.contains(this.containers[n].element[0],d.element[0]))continue;d=this.containers[n],p=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(o=1e4,a=null,f=d.floating||i(this.currentItem),s=f?"left":"top",l=f?"width":"height",c=this.positionAbs[s]+this.offset.click[s],r=this.items.length-1;r>=0;r--)$.contains(this.containers[p].element[0],this.items[r].item[0])&&this.items[r].item[0]!==this.currentItem[0]&&(!f||e(this.positionAbs.top+this.offset.click.top,this.items[r].top,this.items[r].height))&&(h=this.items[r].item.offset()[s],u=!1,Math.abs(h-c)>Math.abs(h+this.items[r][l]-c)&&(u=!0,h+=this.items[r][l]),Math.abs(h-c)<o&&(o=Math.abs(h-c),a=this.items[r],this.direction=u?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var e=this.options,i=$.isFunction(e.helper)?$(e.helper.apply(this.element[0],[t,this.currentItem])):"clone"===e.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||$("parent"!==e.appendTo?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!i[0].style.width||e.forceHelperSize)&&i.width(this.currentItem.width()),(!i[0].style.height||e.forceHelperSize)&&i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),$.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,i,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,($("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=$(n.containment)[0],e=$(n.containment).offset(),i="hidden"!==$(t).css("overflow"),this.containment=[e.left+(parseInt($(t).css("borderLeftWidth"),10)||0)+(parseInt($(t).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt($(t).css("borderTopWidth"),10)||0)+(parseInt($(t).css("paddingTop"),10)||0)-this.margins.top,e.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt($(t).css("borderLeftWidth"),10)||0)-(parseInt($(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt($(t).css("borderTopWidth"),10)||0)-(parseInt($(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(n[0].tagName);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:n.scrollTop())*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:n.scrollLeft())*i}},_generatePosition:function(t){var e,i,n=this.options,r=t.pageX,o=t.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(e=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?e-this.offset.click.top>=this.containment[1]&&e-this.offset.click.top<=this.containment[3]?e:e-this.offset.click.top>=this.containment[1]?e-n.grid[1]:e+n.grid[1]:e,i=this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0],r=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-n.grid[0]:i+n.grid[0]:i)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:a.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:a.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!n)})},_clear:function(t,e){this.reverting=!1;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)e||n.push(function(t){return function(e){t._trigger("deactivate",e,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(n.push(function(t){return function(e){t._trigger("out",e,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!e){for(this._trigger("beforeStop",t,this._uiHash()),i=0;i<n.length;i++)n[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!e){for(i=0;i<n.length;i++)n[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){$.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var e=t||this;return{helper:e.helper,placeholder:e.placeholder||$([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:t?t.element:null}}})}(jQuery),function($,t){var e="ui-effects-";$.effects={effect:{}},function(t,e){function i(t,e,i){var n=h[e.type]||{};return null==t?i||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:0>t?0:n.max<t?n.max:t)}function n(e){var i=l(),n=i._rgba=[];return e=e.toLowerCase(),p(s,function(t,r){var o,a=r.re.exec(e),s=a&&r.parse(a),l=r.space||"rgba";return s?(o=i[l](s),i[c[l].cache]=o[c[l].cache],n=i._rgba=o._rgba,!1):void 0}),n.length?("0,0,0,0"===n.join()&&t.extend(n,d.transparent),i):d[e]}function r(t,e,i){return i=(i+1)%1,1>6*i?t+(e-t)*i*6:1>2*i?e:2>3*i?t+(e-t)*(2/3-i)*6:t}var o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,s=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,i,n,r){return new t.Color.fn.parse(e,i,n,r)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},h={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=l.support={},f=t("<p>")[0],d,p=t.each;f.style.cssText="background-color:rgba(1,1,1,.5)",u.rgba=f.style.backgroundColor.indexOf("rgba")>-1,p(c,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),l.fn=t.extend(l.prototype,{parse:function(r,o,a,s){if(r===e)return this._rgba=[null,null,null,null],this;(r.jquery||r.nodeType)&&(r=t(r).css(o),o=e);var h=this,u=t.type(r),f=this._rgba=[];return o!==e&&(r=[r,o,a,s],u="array"),"string"===u?this.parse(n(r)||d._default):"array"===u?(p(c.rgba.props,function(t,e){f[e.idx]=i(r[e.idx],e)}),this):"object"===u?(r instanceof l?p(c,function(t,e){r[e.cache]&&(h[e.cache]=r[e.cache].slice())}):p(c,function(e,n){var o=n.cache;p(n.props,function(t,e){if(!h[o]&&n.to){if("alpha"===t||null==r[t])return;h[o]=n.to(h._rgba)}h[o][e.idx]=i(r[t],e,!0)}),h[o]&&t.inArray(null,h[o].slice(0,3))<0&&(h[o][3]=1,n.from&&(h._rgba=n.from(h[o])))}),this):void 0},is:function(t){var e=l(t),i=!0,n=this;return p(c,function(t,r){var o,a=e[r.cache];return a&&(o=n[r.cache]||r.to&&r.to(n._rgba)||[],p(r.props,function(t,e){return null!=a[e.idx]?i=a[e.idx]===o[e.idx]:void 0})),i}),i},_space:function(){var t=[],e=this;return p(c,function(i,n){e[n.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var n=l(t),r=n._space(),o=c[r],a=0===this.alpha()?l("transparent"):this,s=a[o.cache]||o.to(a._rgba),u=s.slice();return n=n[o.cache],p(o.props,function(t,r){var o=r.idx,a=s[o],l=n[o],c=h[r.type]||{};null!==l&&(null===a?u[o]=l:(c.mod&&(l-a>c.mod/2?a+=c.mod:a-l>c.mod/2&&(a-=c.mod)),u[o]=i((l-a)*e+a,r)))}),this[r](u)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),r=l(e)._rgba;return l(t.map(i,function(t,e){return(1-n)*r[e]+n*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),n=i.pop();return e&&i.push(~~(255*n)),"#"+t.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/255,i=t[1]/255,n=t[2]/255,r=t[3],o=Math.max(e,i,n),a=Math.min(e,i,n),s=o-a,l=o+a,c=.5*l,h,u;return h=a===o?0:e===o?60*(i-n)/s+360:i===o?60*(n-e)/s+120:60*(e-i)/s+240,u=0===s?0:.5>=c?s/l:s/(2-l),[Math.round(h)%360,u,c,null==r?1:r]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],n=t[2],o=t[3],a=.5>=n?n*(1+i):n+i-n*i,s=2*n-a;return[Math.round(255*r(s,a,e+1/3)),Math.round(255*r(s,a,e)),Math.round(255*r(s,a,e-1/3)),o]
},p(c,function(n,r){var o=r.props,s=r.cache,c=r.to,h=r.from;l.fn[n]=function(n){if(c&&!this[s]&&(this[s]=c(this._rgba)),n===e)return this[s].slice();var r,a=t.type(n),u="array"===a||"object"===a?n:arguments,f=this[s].slice();return p(o,function(t,e){var n=u["object"===a?t:e.idx];null==n&&(n=f[e.idx]),f[e.idx]=i(n,e)}),h?(r=l(h(f)),r[s]=f,r):l(f)},p(o,function(e,i){l.fn[e]||(l.fn[e]=function(r){var o=t.type(r),s="alpha"===e?this._hsla?"hsla":"rgba":n,l=this[s](),c=l[i.idx],h;return"undefined"===o?c:("function"===o&&(r=r.call(this,c),o=t.type(r)),null==r&&i.empty?this:("string"===o&&(h=a.exec(r),h&&(r=c+parseFloat(h[2])*("+"===h[1]?1:-1))),l[i.idx]=r,this[s](l)))})})}),l.hook=function(e){var i=e.split(" ");p(i,function(e,i){t.cssHooks[i]={set:function(e,r){var o,a,s="";if("transparent"!==r&&("string"!==t.type(r)||(o=n(r)))){if(r=l(o||r),!u.rgba&&1!==r._rgba[3]){for(a="backgroundColor"===i?e.parentNode:e;(""===s||"transparent"===s)&&a&&a.style;)try{s=t.css(a,"backgroundColor"),a=a.parentNode}catch(c){}r=r.blend(s&&"transparent"!==s?s:"_default")}r=r.toRgbaString()}try{e.style[i]=r}catch(c){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=l(e.elem,i),e.end=l(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},l.hook(o),t.cssHooks.borderColor={expand:function(t){var e={};return p(["Top","Right","Bottom","Left"],function(i,n){e["border"+n+"Color"]=t}),e}},d=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function e(t){var e,i,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,r={};if(n&&n.length&&n[0]&&n[n[0]])for(i=n.length;i--;)e=n[i],"string"==typeof n[e]&&(r[$.camelCase(e)]=n[e]);else for(e in n)"string"==typeof n[e]&&(r[e]=n[e]);return r}function i(t,e){var i={},n,o;for(n in e)o=e[n],t[n]!==o&&(r[n]||($.fx.step[n]||!isNaN(parseFloat(o)))&&(i[n]=o));return i}var n=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,e){$.fx.step[e]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(jQuery.style(t.elem,e,t.end),t.setAttr=!0)}}),$.fn.addBack||($.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),$.effects.animateClass=function(t,r,o,a){var s=$.speed(r,o,a);return this.queue(function(){var r=$(this),o=r.attr("class")||"",a,l=s.children?r.find("*").addBack():r;l=l.map(function(){var t=$(this);return{el:t,start:e(this)}}),a=function(){$.each(n,function(e,i){t[i]&&r[i+"Class"](t[i])})},a(),l=l.map(function(){return this.end=e(this.el[0]),this.diff=i(this.start,this.end),this}),r.attr("class",o),l=l.map(function(){var t=this,e=$.Deferred(),i=$.extend({},s,{queue:!1,complete:function(){e.resolve(t)}});return this.el.animate(this.diff,i),e.promise()}),$.when.apply($,l.get()).done(function(){a(),$.each(arguments,function(){var t=this.el;$.each(this.diff,function(e){t.css(e,"")})}),s.complete.call(r[0])})})},$.fn.extend({addClass:function(t){return function(e,i,n,r){return i?$.effects.animateClass.call(this,{add:e},i,n,r):t.apply(this,arguments)}}($.fn.addClass),removeClass:function(t){return function(e,i,n,r){return arguments.length>1?$.effects.animateClass.call(this,{remove:e},i,n,r):t.apply(this,arguments)}}($.fn.removeClass),toggleClass:function(e){return function(i,n,r,o,a){return"boolean"==typeof n||n===t?r?$.effects.animateClass.call(this,n?{add:i}:{remove:i},r,o,a):e.apply(this,arguments):$.effects.animateClass.call(this,{toggle:i},n,r,o)}}($.fn.toggleClass),switchClass:function(t,e,i,n,r){return $.effects.animateClass.call(this,{add:e,remove:t},i,n,r)}})}(),function(){function i(t,e,i,n){return $.isPlainObject(t)&&(e=t,t=t.effect),t={effect:t},null==e&&(e={}),$.isFunction(e)&&(n=e,i=null,e={}),("number"==typeof e||$.fx.speeds[e])&&(n=i,i=e,e={}),$.isFunction(i)&&(n=i,i=null),e&&$.extend(t,e),i=i||e.duration,t.duration=$.fx.off?0:"number"==typeof i?i:i in $.fx.speeds?$.fx.speeds[i]:$.fx.speeds._default,t.complete=n||e.complete,t}function n(t){return!t||"number"==typeof t||$.fx.speeds[t]?!0:"string"!=typeof t||$.effects.effect[t]?$.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}$.extend($.effects,{version:"1.10.3",save:function(t,i){for(var n=0;n<i.length;n++)null!==i[n]&&t.data(e+i[n],t[0].style[i[n]])},restore:function(i,n){var r,o;for(o=0;o<n.length;o++)null!==n[o]&&(r=i.data(e+n[o]),r===t&&(r=""),i.css(n[o],r))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,n;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var e={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},i=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},r=document.activeElement;try{r.id}catch(o){r=document.body}return t.wrap(i),(t[0]===r||$.contains(t[0],r))&&$(r).focus(),i=t.parent(),"static"===t.css("position")?(i.css({position:"relative"}),t.css({position:"relative"})):($.extend(e,{position:t.css("position"),zIndex:t.css("z-index")}),$.each(["top","left","bottom","right"],function(i,n){e[n]=t.css(n),isNaN(parseInt(e[n],10))&&(e[n]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(n),i.css(e).show()},removeWrapper:function(t){var e=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===e||$.contains(t[0],e))&&$(e).focus()),t},setTransition:function(t,e,i,n){return n=n||{},$.each(e,function(e,r){var o=t.cssUnit(r);o[0]>0&&(n[r]=o[0]*i+o[1])}),n}}),$.fn.extend({effect:function(){function t(t){function i(){$.isFunction(r)&&r.call(n[0]),$.isFunction(t)&&t()}var n=$(this),r=e.complete,a=e.mode;(n.is(":hidden")?"hide"===a:"show"===a)?(n[a](),i()):o.call(n[0],e,i)}var e=i.apply(this,arguments),n=e.mode,r=e.queue,o=$.effects.effect[e.effect];return $.fx.off||!o?n?this[n](e.duration,e.complete):this.each(function(){e.complete&&e.complete.call(this)}):r===!1?this.each(t):this.queue(r||"fx",t)},show:function(t){return function(e){if(n(e))return t.apply(this,arguments);var r=i.apply(this,arguments);return r.mode="show",this.effect.call(this,r)}}($.fn.show),hide:function(t){return function(e){if(n(e))return t.apply(this,arguments);var r=i.apply(this,arguments);return r.mode="hide",this.effect.call(this,r)}}($.fn.hide),toggle:function(t){return function(e){if(n(e)||"boolean"==typeof e)return t.apply(this,arguments);var r=i.apply(this,arguments);return r.mode="toggle",this.effect.call(this,r)}}($.fn.toggle),cssUnit:function(t){var e=this.css(t),i=[];return $.each(["em","px","%","pt"],function(t,n){e.indexOf(n)>0&&(i=[parseFloat(e),n])}),i}})}(),function(){var t={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),$.extend(t,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;t<((e=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),$.each(t,function(t,e){$.easing["easeIn"+t]=e,$.easing["easeOut"+t]=function(t){return 1-e(1-t)},$.easing["easeInOut"+t]=function(t){return.5>t?e(2*t)/2:1-e(-2*t+2)/2}})}()}(jQuery),function($,t){var e=0,i={},n={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide",n.height=n.paddingTop=n.paddingBottom=n.borderTopWidth=n.borderBottomWidth="show",$.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=$(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():$(),content:this.active.length?this.active.next():$()}},_createIcons:function(){var t=this.options.icons;t&&($("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?void this._activate(e):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||this.options.active!==!1||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),void("disabled"===t&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e)))},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var e=$.ui.keyCode,i=this.headers.length,n=this.headers.index(t.target),r=!1;switch(t.keyCode){case e.RIGHT:case e.DOWN:r=this.headers[(n+1)%i];break;case e.LEFT:case e.UP:r=this.headers[(n-1+i)%i];break;case e.SPACE:case e.ENTER:this._eventHandler(t);break;case e.HOME:r=this.headers[0];break;case e.END:r=this.headers[i-1]}r&&($(t.target).attr("tabIndex",-1),$(r).attr("tabIndex",0),r.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===$.ui.keyCode.UP&&t.ctrlKey&&$(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=$()):t.active===!1?this._activate(0):this.active.length&&!$.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=$()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var t,i=this.options,n=i.heightStyle,r=this.element.parent(),o=this.accordionId="ui-accordion-"+(this.element.attr("id")||++e);this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(t){var e=$(this),i=e.attr("id"),n=e.next(),r=n.attr("id");i||(i=o+"-header-"+t,e.attr("id",i)),r||(r=o+"-panel-"+t,n.attr("id",r)),e.attr("aria-controls",r),n.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===n?(t=r.height(),this.element.siblings(":visible").each(function(){var e=$(this),i=e.css("position");"absolute"!==i&&"fixed"!==i&&(t-=e.outerHeight(!0))}),this.headers.each(function(){t-=$(this).outerHeight(!0)}),this.headers.next().each(function(){$(this).height(Math.max(0,t-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===n&&(t=0,this.headers.next().each(function(){t=Math.max(t,$(this).css("height","").height())}).height(t))},_activate:function(t){var e=this._findActive(t)[0];e!==this.active[0]&&(e=e||this.active[0],this._eventHandler({target:e,currentTarget:e,preventDefault:$.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):$()},_setupEvents:function(t){var e={keydown:"_keydown"};t&&$.each(t.split(" "),function(t,i){e[i]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,e),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var e=this.options,i=this.active,n=$(t.currentTarget),r=n[0]===i[0],o=r&&e.collapsible,a=o?$():n.next(),s=i.next(),l={oldHeader:i,oldPanel:s,newHeader:o?$():n,newPanel:a};t.preventDefault(),r&&!e.collapsible||this._trigger("beforeActivate",t,l)===!1||(e.active=o?!1:this.headers.index(n),this.active=r?$():n,this._toggle(l),i.removeClass("ui-accordion-header-active ui-state-active"),e.icons&&i.children(".ui-accordion-header-icon").removeClass(e.icons.activeHeader).addClass(e.icons.header),r||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),e.icons&&n.children(".ui-accordion-header-icon").removeClass(e.icons.header).addClass(e.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var e=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=e,this.prevHide=i,this.options.animate?this._animate(e,i,t):(i.hide(),e.show(),this._toggleComplete(t)),i.attr({"aria-expanded":"false","aria-hidden":"true"}),i.prev().attr("aria-selected","false"),e.length&&i.length?i.prev().attr("tabIndex",-1):e.length&&this.headers.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),e.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(t,e,r){var o,a,s,l=this,c=0,h=t.length&&(!e.length||t.index()<e.index()),u=this.options.animate||{},f=h&&u.down||u,d=function(){l._toggleComplete(r)};return"number"==typeof f&&(s=f),"string"==typeof f&&(a=f),a=a||f.easing||u.easing,s=s||f.duration||u.duration,e.length?t.length?(o=t.show().outerHeight(),e.animate(i,{duration:s,easing:a,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(n,{duration:s,easing:a,complete:d,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?c+=i.now:"content"!==l.options.heightStyle&&(i.now=Math.round(o-e.outerHeight()-c),c=0)}})):e.animate(i,s,a,d):t.animate(n,s,a,d)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}})}(jQuery),function($,t){var e=0;$.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,e,i,n=this.element[0].nodeName.toLowerCase(),r="textarea"===n,o="input"===n;this.isMultiLine=r?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[r||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,i=!0,void(e=!0);t=!1,i=!1,e=!1;var r=$.ui.keyCode;switch(n.keyCode){case r.PAGE_UP:t=!0,this._move("previousPage",n);break;case r.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case r.UP:t=!0,this._keyEvent("previous",n);break;case r.DOWN:t=!0,this._keyEvent("next",n);break;case r.ENTER:case r.NUMPAD_ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case r.TAB:this.menu.active&&this.menu.select(n);break;case r.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(n),n.preventDefault());break;default:e=!0,this._searchTimeout(n)}},keypress:function(i){if(t)return t=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&i.preventDefault());if(!e){var n=$.ui.keyCode;switch(i.keyCode){case n.PAGE_UP:this._move("previousPage",i);break;case n.PAGE_DOWN:this._move("nextPage",i);break;case n.UP:this._keyEvent("previous",i);break;case n.DOWN:this._keyEvent("next",i)}}},input:function(t){return i?(i=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this.menu=$("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var e=this.menu.element[0];$(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(i){i.target===t.element[0]||i.target===e||$.contains(e,i.target)||t.close()})})},menufocus:function(t,e){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){$(t.target).trigger(t.originalEvent)});var i=e.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:i})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(i.value):this.liveRegion.text(i.value)},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=$("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?$(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,e,i=this;$.isArray(this.options.source)?(t=this.options.source,this.source=function(e,i){i($.ui.autocomplete.filter(t,e.term))}):"string"==typeof this.options.source?(e=this.options.source,this.source=function(t,n){i.xhr&&i.xhr.abort(),i.xhr=$.ajax({url:e,data:t,dataType:"json",success:function(t){n(t)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var t=this,i=++e;return function(n){i===e&&t.__response(n),t.pending--,t.pending||t.element.removeClass("ui-autocomplete-loading")}},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:$.map(t,function(t){return"string"==typeof t?{label:t,value:t}:$.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var e=this.menu.element.empty();this._renderMenu(e,t),this.isNewMenu=!0,this.menu.refresh(),e.show(),this._resizeMenu(),e.position($.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,e){var i=this;$.each(e,function(e,n){i._renderItemData(t,n)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(t,e){return $("<li>").append($("<a>").text(e.label)).appendTo(t)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())}}),$.extend($.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,e){var i=new RegExp($.ui.autocomplete.escapeRegex(e),"i");return $.grep(t,function(t){return i.test(t.label||t.value||t)})}}),$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.text(e))}})}(jQuery),function($,t){var e,i,n,r,o="ui-button ui-widget ui-state-default ui-corner-all",a="ui-state-hover ui-state-active ",s="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",l=function(){var t=$(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},c=function(t){var e=t.name,i=t.form,n=$([]);return e&&(e=e.replace(/'/g,"\\'"),n=i?$(i).find("[name='"+e+"']"):$("[name='"+e+"']",t.ownerDocument).filter(function(){return!this.form})),n};$.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,l),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,a=this.options,s="checkbox"===this.type||"radio"===this.type,h=s?"":"ui-state-active",u="ui-state-focus";null===a.label&&(a.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){a.disabled||this===e&&$(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){a.disabled||$(this).removeClass(h)}).bind("click"+this.eventNamespace,function(t){a.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){t.buttonElement.addClass(u)}).bind("blur"+this.eventNamespace,function(){t.buttonElement.removeClass(u)}),s&&(this.element.bind("change"+this.eventNamespace,function(){r||t.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(t){a.disabled||(r=!1,i=t.pageX,n=t.pageY)}).bind("mouseup"+this.eventNamespace,function(t){a.disabled||(i!==t.pageX||n!==t.pageY)&&(r=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return a.disabled||r?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(a.disabled||r)return!1;$(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var e=t.element[0];c(e).not(e).map(function(){return $(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return a.disabled?!1:($(this).addClass("ui-state-active"),e=this,void t.document.one("mouseup",function(){e=null}))}).bind("mouseup"+this.eventNamespace,function(){return a.disabled?!1:void $(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return a.disabled?!1:void((t.keyCode===$.ui.keyCode.SPACE||t.keyCode===$.ui.keyCode.ENTER)&&$(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){$(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===$.ui.keyCode.SPACE&&$(this).click()})),this._setOption("disabled",a.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+a+" "+s).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?void(e?this.element.prop("disabled",!0):this.element.prop("disabled",!1)):void this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?c(this.element[0]).each(function(){$(this).is(":checked")?$(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):$(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var t=this.buttonElement.removeClass(s),e=$("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),i=this.options.icons,n=i.primary&&i.secondary,r=[];i.primary||i.secondary?(this.options.text&&r.push("ui-button-text-icon"+(n?"s":i.primary?"-primary":"-secondary")),i.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+i.primary+"'></span>"),i.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+i.secondary+"'></span>"),this.options.text||(r.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",$.trim(e)))):r.push("ui-button-text-only"),t.addClass(r.join(" "))}}),$.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function($,t){function e(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=i($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))
}function i(t){var e="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(e,"mouseout",function(){$(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(e,"mouseover",function(){$.datepicker._isDisabledDatepicker(o.inline?t.parent()[0]:o.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).addClass("ui-datepicker-next-hover"))})}function n(t,e){$.extend(t,e);for(var i in e)null==e[i]&&(t[i]=e[i]);return t}$.extend($.ui,{datepicker:{version:"1.10.3"}});var r="datepicker",o;$.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return n(this._defaults,t||{}),this},_attachDatepicker:function(t,e){var i,n,r;i=t.nodeName.toLowerCase(),n="div"===i||"span"===i,t.id||(this.uuid+=1,t.id="dp"+this.uuid),r=this._newInst($(t),n),r.settings=$.extend({},e||{}),"input"===i?this._connectDatepicker(t,r):n&&this._inlineDatepicker(t,r)},_newInst:function(t,e){var n=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:e,dpDiv:e?i($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,e){var i=$(t);e.append=$([]),e.trigger=$([]),i.hasClass(this.markerClassName)||(this._attachments(i,e),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(e),$.data(t,r,e),e.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,e){var i,n,r,o=this._get(e,"appendText"),a=this._get(e,"isRTL");e.append&&e.append.remove(),o&&(e.append=$("<span class='"+this._appendClass+"'>"+o+"</span>"),t[a?"before":"after"](e.append)),t.unbind("focus",this._showDatepicker),e.trigger&&e.trigger.remove(),i=this._get(e,"showOn"),("focus"===i||"both"===i)&&t.focus(this._showDatepicker),("button"===i||"both"===i)&&(n=this._get(e,"buttonText"),r=this._get(e,"buttonImage"),e.trigger=$(this._get(e,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:r,alt:n,title:n}):$("<button type='button'></button>").addClass(this._triggerClass).html(r?$("<img/>").attr({src:r,alt:n,title:n}):n)),t[a?"before":"after"](e.trigger),e.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput===t[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!==t[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(t[0])):$.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,r,o=new Date(2009,11,20),a=this._get(t,"dateFormat");a.match(/[DM]/)&&(e=function(t){for(i=0,n=0,r=0;r<t.length;r++)t[r].length>i&&(i=t[r].length,n=r);return n},o.setMonth(e(this._get(t,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length)}},_inlineDatepicker:function(t,e){var i=$(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(e.dpDiv),$.data(t,r,e),this._setDate(e,this._getDefaultDate(e),!0),this._updateDatepicker(e),this._updateAlternate(e),e.settings.disabled&&this._disableDatepicker(t),e.dpDiv.css("display","block"))},_dialogDatepicker:function(t,e,i,o,a){var s,l,c,h,u,f=this._dialogInst;return f||(this.uuid+=1,s="dp"+this.uuid,this._dialogInput=$("<input type='text' id='"+s+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),f=this._dialogInst=this._newInst(this._dialogInput,!1),f.settings={},$.data(this._dialogInput[0],r,f)),n(f.settings,o||{}),e=e&&e.constructor===Date?this._formatDate(f,e):e,this._dialogInput.val(e),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(l=document.documentElement.clientWidth,c=document.documentElement.clientHeight,h=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+h,c/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),f.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],r,f),this},_destroyDatepicker:function(t){var e,i=$(t),n=$.data(t,r);i.hasClass(this.markerClassName)&&(e=t.nodeName.toLowerCase(),$.removeData(t,r),"input"===e?(n.append.remove(),n.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===e||"span"===e)&&i.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var e,i,n=$(t),o=$.data(t,r);n.hasClass(this.markerClassName)&&(e=t.nodeName.toLowerCase(),"input"===e?(t.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===e||"span"===e)&&(i=n.children("."+this._inlineClass),i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=$.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var e,i,n=$(t),o=$.data(t,r);n.hasClass(this.markerClassName)&&(e=t.nodeName.toLowerCase(),"input"===e?(t.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===e||"span"===e)&&(i=n.children("."+this._inlineClass),i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=$.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(t){try{return $.data(t,r)}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,i,r){var o,a,s,l,c=this._getInst(e);return 2===arguments.length&&"string"==typeof i?"defaults"===i?$.extend({},$.datepicker._defaults):c?"all"===i?$.extend({},c.settings):this._get(c,i):null:(o=i||{},"string"==typeof i&&(o={},o[i]=r),void(c&&(this._curInst===c&&this._hideDatepicker(),a=this._getDateDatepicker(e,!0),s=this._getMinMaxDate(c,"min"),l=this._getMinMaxDate(c,"max"),n(c.settings,o),null!==s&&o.dateFormat!==t&&o.minDate===t&&(c.settings.minDate=this._formatDate(c,s)),null!==l&&o.dateFormat!==t&&o.maxDate===t&&(c.settings.maxDate=this._formatDate(c,l)),"disabled"in o&&(o.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments($(e),c),this._autoSize(c),this._setDate(c,a),this._updateAlternate(c),this._updateDatepicker(c))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(t){var e,i,n,r=$.datepicker._getInst(t.target),o=!0,a=r.dpDiv.is(".ui-datepicker-rtl");if(r._keyEvent=!0,$.datepicker._datepickerShowing)switch(t.keyCode){case 9:$.datepicker._hideDatepicker(),o=!1;break;case 13:return n=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",r.dpDiv),n[0]&&$.datepicker._selectDay(t.target,r.selectedMonth,r.selectedYear,n[0]),e=$.datepicker._get(r,"onSelect"),e?(i=$.datepicker._formatDate(r),e.apply(r.input?r.input[0]:null,[i,r])):$.datepicker._hideDatepicker(),!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(t.target,t.ctrlKey?-$.datepicker._get(r,"stepBigMonths"):-$.datepicker._get(r,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(t.target,t.ctrlKey?+$.datepicker._get(r,"stepBigMonths"):+$.datepicker._get(r,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&$.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&$.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&$.datepicker._adjustDate(t.target,a?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&$.datepicker._adjustDate(t.target,t.ctrlKey?-$.datepicker._get(r,"stepBigMonths"):-$.datepicker._get(r,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&$.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&$.datepicker._adjustDate(t.target,a?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&$.datepicker._adjustDate(t.target,t.ctrlKey?+$.datepicker._get(r,"stepBigMonths"):+$.datepicker._get(r,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&$.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?$.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var e,i,n=$.datepicker._getInst(t.target);return $.datepicker._get(n,"constrainInput")?(e=$.datepicker._possibleChars($.datepicker._get(n,"dateFormat")),i=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">i||!e||e.indexOf(i)>-1):void 0},_doKeyUp:function(t){var e,i=$.datepicker._getInst(t.target);if(i.input.val()!==i.lastVal)try{e=$.datepicker.parseDate($.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,$.datepicker._getFormatConfig(i)),e&&($.datepicker._setDateFromField(i),$.datepicker._updateAlternate(i),$.datepicker._updateDatepicker(i))}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=$("input",t.parentNode)[0]),!$.datepicker._isDisabledDatepicker(t)&&$.datepicker._lastInput!==t){var e,i,r,o,a,s,l;e=$.datepicker._getInst(t),$.datepicker._curInst&&$.datepicker._curInst!==e&&($.datepicker._curInst.dpDiv.stop(!0,!0),e&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0])),i=$.datepicker._get(e,"beforeShow"),r=i?i.apply(t,[t,e]):{},r!==!1&&(n(e.settings,r),e.lastVal=null,$.datepicker._lastInput=t,$.datepicker._setDateFromField(e),$.datepicker._inDialog&&(t.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(t),$.datepicker._pos[1]+=t.offsetHeight),o=!1,$(t).parents().each(function(){return o|="fixed"===$(this).css("position"),!o}),a={left:$.datepicker._pos[0],top:$.datepicker._pos[1]},$.datepicker._pos=null,e.dpDiv.empty(),e.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(e),a=$.datepicker._checkOffset(e,a,o),e.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":o?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),e.inline||(s=$.datepicker._get(e,"showAnim"),l=$.datepicker._get(e,"duration"),e.dpDiv.zIndex($(t).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects.effect[s]?e.dpDiv.show(s,$.datepicker._get(e,"showOptions"),l):e.dpDiv[s||"show"](s?l:null),$.datepicker._shouldFocusInput(e)&&e.input.focus(),$.datepicker._curInst=e))}},_updateDatepicker:function(t){this.maxRows=4,o=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var e,i=this._getNumberOfMonths(t),n=i[1],r=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",r*n+"em"),t.dpDiv[(1!==i[0]||1!==i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(e=t.yearshtml,setTimeout(function(){e===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),e=t.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(t,e,i){var n=t.dpDiv.outerWidth(),r=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,a=t.input?t.input.outerHeight():0,s=document.documentElement.clientWidth+(i?0:$(document).scrollLeft()),l=document.documentElement.clientHeight+(i?0:$(document).scrollTop());return e.left-=this._get(t,"isRTL")?n-o:0,e.left-=i&&e.left===t.input.offset().left?$(document).scrollLeft():0,e.top-=i&&e.top===t.input.offset().top+a?$(document).scrollTop():0,e.left-=Math.min(e.left,e.left+n>s&&s>n?Math.abs(e.left+n-s):0),e.top-=Math.min(e.top,e.top+r>l&&l>r?Math.abs(r+a):0),e},_findPos:function(t){for(var e,i=this._getInst(t),n=this._get(i,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||$.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return e=$(t).offset(),[e.left,e.top]},_hideDatepicker:function(t){var e,i,n,o,a=this._curInst;!a||t&&a!==$.data(t,r)||this._datepickerShowing&&(e=this._get(a,"showAnim"),i=this._get(a,"duration"),n=function(){$.datepicker._tidyDialog(a)},$.effects&&($.effects.effect[e]||$.effects[e])?a.dpDiv.hide(e,$.datepicker._get(a,"showOptions"),i,n):a.dpDiv["slideDown"===e?"slideUp":"fadeIn"===e?"fadeOut":"hide"](e?i:null,n),e||n(),this._datepickerShowing=!1,o=this._get(a,"onClose"),o&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if($.datepicker._curInst){var e=$(t.target),i=$.datepicker._getInst(e[0]);(e[0].id!==$.datepicker._mainDivId&&0===e.parents("#"+$.datepicker._mainDivId).length&&!e.hasClass($.datepicker.markerClassName)&&!e.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||e.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==i)&&$.datepicker._hideDatepicker()}},_adjustDate:function(t,e,i){var n=$(t),r=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(r,e+("M"===i?this._get(r,"showCurrentAtPos"):0),i),this._updateDatepicker(r))},_gotoToday:function(t){var e,i=$(t),n=this._getInst(i[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(e=new Date,n.selectedDay=e.getDate(),n.drawMonth=n.selectedMonth=e.getMonth(),n.drawYear=n.selectedYear=e.getFullYear()),this._notifyChange(n),this._adjustDate(i)},_selectMonthYear:function(t,e,i){var n=$(t),r=this._getInst(n[0]);r["selected"+("M"===i?"Month":"Year")]=r["draw"+("M"===i?"Month":"Year")]=parseInt(e.options[e.selectedIndex].value,10),this._notifyChange(r),this._adjustDate(n)},_selectDay:function(t,e,i,n){var r,o=$(t);$(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(r=this._getInst(o[0]),r.selectedDay=r.currentDay=$("a",n).html(),r.selectedMonth=r.currentMonth=e,r.selectedYear=r.currentYear=i,this._selectDate(t,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear)))},_clearDate:function(t){var e=$(t);this._selectDate(e,"")},_selectDate:function(t,e){var i,n=$(t),r=this._getInst(n[0]);e=null!=e?e:this._formatDate(r),r.input&&r.input.val(e),this._updateAlternate(r),i=this._get(r,"onSelect"),i?i.apply(r.input?r.input[0]:null,[e,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],"object"!=typeof r.input[0]&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var e,i,n,r=this._get(t,"altField");r&&(e=this._get(t,"altFormat")||this._get(t,"dateFormat"),i=this._getDate(t),n=this.formatDate(e,i,this._getFormatConfig(t)),$(r).each(function(){$(this).val(n)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(t,e,i){if(null==t||null==e)throw"Invalid arguments";if(e="object"==typeof e?e.toString():e+"",""===e)return null;var n,r,o,a=0,s=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,l="string"!=typeof s?s:(new Date).getFullYear()%100+parseInt(s,10),c=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,h=(i?i.dayNames:null)||this._defaults.dayNames,u=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,f=(i?i.monthNames:null)||this._defaults.monthNames,d=-1,p=-1,m=-1,g=-1,v=!1,E,y=function(e){var i=n+1<t.length&&t.charAt(n+1)===e;return i&&n++,i},x=function(t){var i=y(t),n="@"===t?14:"!"===t?20:"y"===t&&i?4:"o"===t?3:2,r=new RegExp("^\\d{1,"+n+"}"),o=e.substring(a).match(r);if(!o)throw"Missing number at position "+a;return a+=o[0].length,parseInt(o[0],10)},T=function(t,i,n){var r=-1,o=$.map(y(t)?n:i,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if($.each(o,function(t,i){var n=i[1];return e.substr(a,n.length).toLowerCase()===n.toLowerCase()?(r=i[0],a+=n.length,!1):void 0}),-1!==r)return r+1;throw"Unknown name at position "+a},b=function(){if(e.charAt(a)!==t.charAt(n))throw"Unexpected literal at position "+a;a++};for(n=0;n<t.length;n++)if(v)"'"!==t.charAt(n)||y("'")?b():v=!1;else switch(t.charAt(n)){case"d":m=x("d");break;case"D":T("D",c,h);break;case"o":g=x("o");break;case"m":p=x("m");break;case"M":p=T("M",u,f);break;case"y":d=x("y");break;case"@":E=new Date(x("@")),d=E.getFullYear(),p=E.getMonth()+1,m=E.getDate();break;case"!":E=new Date((x("!")-this._ticksTo1970)/1e4),d=E.getFullYear(),p=E.getMonth()+1,m=E.getDate();break;case"'":y("'")?b():v=!0;break;default:b()}if(a<e.length&&(o=e.substr(a),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===d?d=(new Date).getFullYear():100>d&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(l>=d?0:-100)),g>-1)for(p=1,m=g;;){if(r=this._getDaysInMonth(d,p-1),r>=m)break;p++,m-=r}if(E=this._daylightSavingAdjust(new Date(d,p-1,m)),E.getFullYear()!==d||E.getMonth()+1!==p||E.getDate()!==m)throw"Invalid date";return E},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(t,e,i){if(!e)return"";var n,r=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,s=(i?i.monthNames:null)||this._defaults.monthNames,l=function(e){var i=n+1<t.length&&t.charAt(n+1)===e;return i&&n++,i},c=function(t,e,i){var n=""+e;if(l(t))for(;n.length<i;)n="0"+n;return n},h=function(t,e,i,n){return l(t)?n[e]:i[e]},u="",f=!1;if(e)for(n=0;n<t.length;n++)if(f)"'"!==t.charAt(n)||l("'")?u+=t.charAt(n):f=!1;else switch(t.charAt(n)){case"d":u+=c("d",e.getDate(),2);break;case"D":u+=h("D",e.getDay(),r,o);break;case"o":u+=c("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=c("m",e.getMonth()+1,2);break;case"M":u+=h("M",e.getMonth(),a,s);break;case"y":u+=l("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":f=!0;break;default:u+=t.charAt(n)}return u},_possibleChars:function(t){var e,i="",n=!1,r=function(i){var n=e+1<t.length&&t.charAt(e+1)===i;return n&&e++,n};for(e=0;e<t.length;e++)if(n)"'"!==t.charAt(e)||r("'")?i+=t.charAt(e):n=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":r("'")?i+="'":n=!0;break;default:i+=t.charAt(e)}return i},_get:function(e,i){return e.settings[i]!==t?e.settings[i]:this._defaults[i]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,r=this._getDefaultDate(t),o=r,a=this._getFormatConfig(t);try{o=this.parseDate(i,n,a)||r}catch(s){n=e?"":n}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=n?o.getDate():0,t.currentMonth=n?o.getMonth():0,t.currentYear=n?o.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(t,e,i){var n=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},r=function(e){try{return $.datepicker.parseDate($.datepicker._get(t,"dateFormat"),e,$.datepicker._getFormatConfig(t))}catch(i){}for(var n=(e.toLowerCase().match(/^c/)?$.datepicker._getDate(t):null)||new Date,r=n.getFullYear(),o=n.getMonth(),a=n.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=s.exec(e);l;){switch(l[2]||"d"){case"d":case"D":a+=parseInt(l[1],10);break;case"w":case"W":a+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),a=Math.min(a,$.datepicker._getDaysInMonth(r,o));break;case"y":case"Y":r+=parseInt(l[1],10),a=Math.min(a,$.datepicker._getDaysInMonth(r,o))}l=s.exec(e)}return new Date(r,o,a)},o=null==e||""===e?i:"string"==typeof e?r(e):"number"==typeof e?isNaN(e)?i:n(e):new Date(e.getTime());return o=o&&"Invalid Date"===o.toString()?i:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,r=t.selectedMonth,o=t.selectedYear,a=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=a.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=a.getMonth(),t.drawYear=t.selectedYear=t.currentYear=a.getFullYear(),r===t.selectedMonth&&o===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(t){var e=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){$.datepicker._adjustDate(i,-e,"M")},next:function(){$.datepicker._adjustDate(i,+e,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(i)},selectDay:function(){return $.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return $.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return $.datepicker._selectMonthYear(i,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,n,r,o,a,s,l,c,h,u,f,d,p,m,g,v,E,y,x,T,b,_,w,R,H,M,S,C,A,D,P,k,L,N,F,I,z,O,U=new Date,B=this._daylightSavingAdjust(new Date(U.getFullYear(),U.getMonth(),U.getDate())),V=this._get(t,"isRTL"),W=this._get(t,"showButtonPanel"),j=this._get(t,"hideIfNoPrevNext"),G=this._get(t,"navigationAsDateFormat"),X=this._getNumberOfMonths(t),q=this._get(t,"showCurrentAtPos"),Y=this._get(t,"stepMonths"),K=1!==X[0]||1!==X[1],Q=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(t,"min"),J=this._getMinMaxDate(t,"max"),te=t.drawMonth-q,ee=t.drawYear;if(0>te&&(te+=12,ee--),J)for(e=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-X[0]*X[1]+1,J.getDate())),e=Z&&Z>e?Z:e;this._daylightSavingAdjust(new Date(ee,te,1))>e;)te--,0>te&&(te=11,ee--);for(t.drawMonth=te,t.drawYear=ee,i=this._get(t,"prevText"),i=G?this.formatDate(i,this._daylightSavingAdjust(new Date(ee,te-Y,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,ee,te)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(V?"e":"w")+"'>"+i+"</span></a>":j?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(V?"e":"w")+"'>"+i+"</span></a>",r=this._get(t,"nextText"),r=G?this.formatDate(r,this._daylightSavingAdjust(new Date(ee,te+Y,1)),this._getFormatConfig(t)):r,o=this._canAdjustMonth(t,1,ee,te)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(V?"w":"e")+"'>"+r+"</span></a>":j?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(V?"w":"e")+"'>"+r+"</span></a>",a=this._get(t,"currentText"),s=this._get(t,"gotoCurrent")&&t.currentDay?Q:B,a=G?this.formatDate(a,s,this._getFormatConfig(t)):a,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",c=W?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(V?l:"")+(this._isInRange(t,s)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(V?"":l)+"</div>":"",h=parseInt(this._get(t,"firstDay"),10),h=isNaN(h)?0:h,u=this._get(t,"showWeek"),f=this._get(t,"dayNames"),d=this._get(t,"dayNamesMin"),p=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),g=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),E=this._get(t,"selectOtherMonths"),y=this._getDefaultDate(t),x="",b=0;b<X[0];b++){for(_="",this.maxRows=4,w=0;w<X[1];w++){if(R=this._daylightSavingAdjust(new Date(ee,te,t.selectedDay)),H=" ui-corner-all",M="",K){if(M+="<div class='ui-datepicker-group",X[1]>1)switch(w){case 0:M+=" ui-datepicker-group-first",H=" ui-corner-"+(V?"right":"left");break;case X[1]-1:M+=" ui-datepicker-group-last",H=" ui-corner-"+(V?"left":"right");break;default:M+=" ui-datepicker-group-middle",H=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+H+"'>"+(/all|left/.test(H)&&0===b?V?o:n:"")+(/all|right/.test(H)&&0===b?V?n:o:"")+this._generateMonthYearHeader(t,te,ee,Z,J,b>0||w>0,p,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",S=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",T=0;7>T;T++)C=(T+h)%7,S+="<th"+((T+h+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+f[C]+"'>"+d[C]+"</span></th>";for(M+=S+"</tr></thead><tbody>",A=this._getDaysInMonth(ee,te),ee===t.selectedYear&&te===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,A)),D=(this._getFirstDayOfMonth(ee,te)-h+7)%7,P=Math.ceil((D+A)/7),k=K&&this.maxRows>P?this.maxRows:P,this.maxRows=k,L=this._daylightSavingAdjust(new Date(ee,te,1-D)),N=0;k>N;N++){for(M+="<tr>",F=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(L)+"</td>":"",T=0;7>T;T++)I=g?g.apply(t.input?t.input[0]:null,[L]):[!0,""],z=L.getMonth()!==te,O=z&&!E||!I[0]||Z&&Z>L||J&&L>J,F+="<td class='"+((T+h+6)%7>=5?" ui-datepicker-week-end":"")+(z?" ui-datepicker-other-month":"")+(L.getTime()===R.getTime()&&te===t.selectedMonth&&t._keyEvent||y.getTime()===L.getTime()&&y.getTime()===R.getTime()?" "+this._dayOverClass:"")+(O?" "+this._unselectableClass+" ui-state-disabled":"")+(z&&!v?"":" "+I[1]+(L.getTime()===Q.getTime()?" "+this._currentClass:"")+(L.getTime()===B.getTime()?" ui-datepicker-today":""))+"'"+(z&&!v||!I[2]?"":" title='"+I[2].replace(/'/g,"&#39;")+"'")+(O?"":" data-handler='selectDay' data-event='click' data-month='"+L.getMonth()+"' data-year='"+L.getFullYear()+"'")+">"+(z&&!v?"&#xa0;":O?"<span class='ui-state-default'>"+L.getDate()+"</span>":"<a class='ui-state-default"+(L.getTime()===B.getTime()?" ui-state-highlight":"")+(L.getTime()===Q.getTime()?" ui-state-active":"")+(z?" ui-priority-secondary":"")+"' href='#'>"+L.getDate()+"</a>")+"</td>",L.setDate(L.getDate()+1),L=this._daylightSavingAdjust(L);M+=F+"</tr>"}te++,te>11&&(te=0,ee++),M+="</tbody></table>"+(K?"</div>"+(X[0]>0&&w===X[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),_+=M}x+=_}return x+=c,t._keyEvent=!1,x},_generateMonthYearHeader:function(t,e,i,n,r,o,a,s){var l,c,h,u,f,d,p,m,g=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),E=this._get(t,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",x="";if(o||!g)x+="<span class='ui-datepicker-month'>"+a[e]+"</span>";else{for(l=n&&n.getFullYear()===i,c=r&&r.getFullYear()===i,x+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",h=0;12>h;h++)(!l||h>=n.getMonth())&&(!c||h<=r.getMonth())&&(x+="<option value='"+h+"'"+(h===e?" selected='selected'":"")+">"+s[h]+"</option>");x+="</select>"}if(E||(y+=x+(!o&&g&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),f=(new Date).getFullYear(),d=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?f+parseInt(t,10):parseInt(t,10);return isNaN(e)?f:e},p=d(u[0]),m=Math.max(p,d(u[1]||"")),p=n?Math.max(p,n.getFullYear()):p,m=r?Math.min(m,r.getFullYear()):m,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=p;p++)t.yearshtml+="<option value='"+p+"'"+(p===i?" selected='selected'":"")+">"+p+"</option>";t.yearshtml+="</select>",y+=t.yearshtml,t.yearshtml=null}return y+=this._get(t,"yearSuffix"),E&&(y+=(!o&&g&&v?"":"&#xa0;")+x),y+="</div>"},_adjustInstDate:function(t,e,i){var n=t.drawYear+("Y"===i?e:0),r=t.drawMonth+("M"===i?e:0),o=Math.min(t.selectedDay,this._getDaysInMonth(n,r))+("D"===i?e:0),a=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,r,o)));t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),r=i&&i>e?i:e;return n&&r>n?n:r},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var r=this._getNumberOfMonths(t),o=this._daylightSavingAdjust(new Date(i,n+(0>e?e:r[0]*r[1]),1));return 0>e&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(t,o)},_isInRange:function(t,e){var i,n,r=this._getMinMaxDate(t,"min"),o=this._getMinMaxDate(t,"max"),a=null,s=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),a=parseInt(i[0],10),s=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=n),i[1].match(/[+\-].*/)&&(s+=n)),(!r||e.getTime()>=r.getTime())&&(!o||e.getTime()<=o.getTime())&&(!a||e.getFullYear()>=a)&&(!s||e.getFullYear()<=s)
},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var r=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),r,this._getFormatConfig(t))}}),$.fn.datepicker=function(t){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick),$.datepicker.initialized=!0),0===$("#"+$.datepicker._mainDivId).length&&$("body").append($.datepicker.dpDiv);var e=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?$.datepicker["_"+t+"Datepicker"].apply($.datepicker,[this[0]].concat(e)):this.each(function(){"string"==typeof t?$.datepicker["_"+t+"Datepicker"].apply($.datepicker,[this].concat(e)):$.datepicker._attachDatepicker(this,t)}):$.datepicker["_"+t+"Datepicker"].apply($.datepicker,[this[0]].concat(e))},$.datepicker=new e,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.10.3"}(jQuery),function($,t){var e={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};$.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var e=$(this).css(t).offset().top;0>e&&$(this).css("top",t.top-e)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&$.fn.draggable&&this._makeDraggable(),this.options.resizable&&$.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?$(t):this.document.find(t||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:$.noop,enable:$.noop,close:function(t){var e=this;this._isOpen&&this._trigger("beforeClose",t)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||$(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){e._trigger("close",t)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,e){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return i&&!e&&this._trigger("focus",t),i},open:function(){var t=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=$(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var t=this.element.find("[autofocus]");t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(t){function e(){var t=this.document[0].activeElement,e=this.uiDialog[0]===t||$.contains(this.uiDialog[0],t);e||this._focusTabbable()}t.preventDefault(),e.call(this),this._delay(e)},_createWrapper:function(){this.uiDialog=$("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===$.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===$.ui.keyCode.TAB){var e=this.uiDialog.find(":tabbable"),i=e.filter(":first"),n=e.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==i[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(n.focus(1),t.preventDefault()):(i.focus(1),t.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=$("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){$(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=$("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),t=$("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(t){this.options.title||t.html("&#160;"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=$("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,e=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),$.isEmptyObject(e)||$.isArray(e)&&!e.length?void this.uiDialog.removeClass("ui-dialog-buttons"):($.each(e,function(e,i){var n,r;i=$.isFunction(i)?{click:i,text:e}:i,i=$.extend({type:"button"},i),n=i.click,i.click=function(){n.apply(t.element[0],arguments)},r={icons:i.icons,text:i.showText},delete i.icons,delete i.showText,$("<button></button>",i).button(r).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function t(t){return{position:t.position,offset:t.offset}}var e=this,i=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(i,n){$(this).addClass("ui-dialog-dragging"),e._blockFrames(),e._trigger("dragStart",i,t(n))},drag:function(i,n){e._trigger("drag",i,t(n))},stop:function(n,r){i.position=[r.position.left-e.document.scrollLeft(),r.position.top-e.document.scrollTop()],$(this).removeClass("ui-dialog-dragging"),e._unblockFrames(),e._trigger("dragStop",n,t(r))}})},_makeResizable:function(){function t(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var e=this,i=this.options,n=i.resizable,r=this.uiDialog.css("position"),o="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:i.maxWidth,maxHeight:i.maxHeight,minWidth:i.minWidth,minHeight:this._minHeight(),handles:o,start:function(i,n){$(this).addClass("ui-dialog-resizing"),e._blockFrames(),e._trigger("resizeStart",i,t(n))},resize:function(i,n){e._trigger("resize",i,t(n))},stop:function(n,r){i.height=$(this).height(),i.width=$(this).width(),$(this).removeClass("ui-dialog-resizing"),e._unblockFrames(),e._trigger("resizeStop",n,t(r))}}).css("position",r)},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(t){var n=this,r=!1,o={};$.each(t,function(t,a){n._setOption(t,a),t in e&&(r=!0),t in i&&(o[t]=a)}),r&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(t,e){var i,n,r=this.uiDialog;"dialogClass"===t&&r.removeClass(this.options.dialogClass).addClass(e),"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===t&&(i=r.is(":data(ui-draggable)"),i&&!e&&r.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&(n=r.is(":data(ui-resizable)"),n&&!e&&r.resizable("destroy"),n&&"string"==typeof e&&r.resizable("option","handles",e),n||e===!1||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),t=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),e=Math.max(0,n.minHeight-t),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-t):"none","auto"===n.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=$(this);return $("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return $(t.target).closest(".ui-dialog").length?!0:!!$(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=this,e=this.widgetFullName;$.ui.dialog.overlayInstances||this._delay(function(){$.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(i){t._allowInteraction(i)||(i.preventDefault(),$(".ui-dialog:visible:last .ui-dialog-content").data(e)._focusTabbable())})}),this.overlay=$("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),$.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&($.ui.dialog.overlayInstances--,$.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),$.ui.dialog.overlayInstances=0,$.uiBackCompat!==!1&&$.widget("ui.dialog",$.ui.dialog,{_position:function(){var t=this.options.position,e=[],i=[0,0],n;t?(("string"==typeof t||"object"==typeof t&&"0"in t)&&(e=t.split?t.split(" "):[t[0],t[1]],1===e.length&&(e[1]=e[0]),$.each(["left","top"],function(t,n){+e[t]===e[t]&&(i[t]=e[t],e[t]=n)}),t={my:e[0]+(i[0]<0?i[0]:"+"+i[0])+" "+e[1]+(i[1]<0?i[1]:"+"+i[1]),at:e.join(" ")}),t=$.extend({},$.ui.dialog.prototype.options.position,t)):t=$.ui.dialog.prototype.options.position,n=this.uiDialog.is(":visible"),n||this.uiDialog.show(),this.uiDialog.position(t),n||this.uiDialog.hide()}})}(jQuery),function($,t){var e=/up|down|vertical/,i=/up|left|vertical|horizontal/;$.effects.effect.blind=function(t,n){var r=$(this),o=["position","top","bottom","left","right","height","width"],a=$.effects.setMode(r,t.mode||"hide"),s=t.direction||"up",l=e.test(s),c=l?"height":"width",h=l?"top":"left",u=i.test(s),f={},d="show"===a,p,m,g;r.parent().is(".ui-effects-wrapper")?$.effects.save(r.parent(),o):$.effects.save(r,o),r.show(),p=$.effects.createWrapper(r).css({overflow:"hidden"}),m=p[c](),g=parseFloat(p.css(h))||0,f[c]=d?m:0,u||(r.css(l?"bottom":"right",0).css(l?"top":"left","auto").css({position:"absolute"}),f[h]=d?g:m+g),d&&(p.css(c,0),u||p.css(h,g+m)),p.animate(f,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===a&&r.hide(),$.effects.restore(r,o),$.effects.removeWrapper(r),n()}})}}(jQuery),function($,t){$.effects.effect.bounce=function(t,e){var i=$(this),n=["position","top","bottom","left","right","height","width"],r=$.effects.setMode(i,t.mode||"effect"),o="hide"===r,a="show"===r,s=t.direction||"up",l=t.distance,c=t.times||5,h=2*c+(a||o?1:0),u=t.duration/h,f=t.easing,d="up"===s||"down"===s?"top":"left",p="up"===s||"left"===s,m,g,v,E=i.queue(),y=E.length;for((a||o)&&n.push("opacity"),$.effects.save(i,n),i.show(),$.effects.createWrapper(i),l||(l=i["top"===d?"outerHeight":"outerWidth"]()/3),a&&(v={opacity:1},v[d]=0,i.css("opacity",0).css(d,p?2*-l:2*l).animate(v,u,f)),o&&(l/=Math.pow(2,c-1)),v={},v[d]=0,m=0;c>m;m++)g={},g[d]=(p?"-=":"+=")+l,i.animate(g,u,f).animate(v,u,f),l=o?2*l:l/2;o&&(g={opacity:0},g[d]=(p?"-=":"+=")+l,i.animate(g,u,f)),i.queue(function(){o&&i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),e()}),y>1&&E.splice.apply(E,[1,0].concat(E.splice(y,h+1))),i.dequeue()}}(jQuery),function($,t){$.effects.effect.clip=function(t,e){var i=$(this),n=["position","top","bottom","left","right","height","width"],r=$.effects.setMode(i,t.mode||"hide"),o="show"===r,a=t.direction||"vertical",s="vertical"===a,l=s?"height":"width",c=s?"top":"left",h={},u,f,d;$.effects.save(i,n),i.show(),u=$.effects.createWrapper(i).css({overflow:"hidden"}),f="IMG"===i[0].tagName?u:i,d=f[l](),o&&(f.css(l,0),f.css(c,d/2)),h[l]=o?d:0,h[c]=o?0:d/2,f.animate(h,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o||i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),e()}})}}(jQuery),function($,t){$.effects.effect.drop=function(t,e){var i=$(this),n=["position","top","bottom","left","right","opacity","height","width"],r=$.effects.setMode(i,t.mode||"hide"),o="show"===r,a=t.direction||"left",s="up"===a||"down"===a?"top":"left",l="up"===a||"left"===a?"pos":"neg",c={opacity:o?1:0},h;$.effects.save(i,n),i.show(),$.effects.createWrapper(i),h=t.distance||i["top"===s?"outerHeight":"outerWidth"](!0)/2,o&&i.css("opacity",0).css(s,"pos"===l?-h:h),c[s]=(o?"pos"===l?"+=":"-=":"pos"===l?"-=":"+=")+h,i.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),e()}})}}(jQuery),function($,t){$.effects.effect.explode=function(t,e){function i(){f.push(this),f.length===r*o&&n()}function n(){a.css({visibility:"visible"}),$(f).remove(),l||a.hide(),e()}var r=t.pieces?Math.round(Math.sqrt(t.pieces)):3,o=r,a=$(this),s=$.effects.setMode(a,t.mode||"hide"),l="show"===s,c=a.show().css("visibility","hidden").offset(),h=Math.ceil(a.outerWidth()/o),u=Math.ceil(a.outerHeight()/r),f=[],d,p,m,g,v,E;for(d=0;r>d;d++)for(g=c.top+d*u,E=d-(r-1)/2,p=0;o>p;p++)m=c.left+p*h,v=p-(o-1)/2,a.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-p*h,top:-d*u}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:h,height:u,left:m+(l?v*h:0),top:g+(l?E*u:0),opacity:l?0:1}).animate({left:m+(l?0:v*h),top:g+(l?0:E*u),opacity:l?1:0},t.duration||500,t.easing,i)}}(jQuery),function($,t){$.effects.effect.fade=function(t,e){var i=$(this),n=$.effects.setMode(i,t.mode||"toggle");i.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:e})}}(jQuery),function($,t){$.effects.effect.fold=function(t,e){var i=$(this),n=["position","top","bottom","left","right","height","width"],r=$.effects.setMode(i,t.mode||"hide"),o="show"===r,a="hide"===r,s=t.size||15,l=/([0-9]+)%/.exec(s),c=!!t.horizFirst,h=o!==c,u=h?["width","height"]:["height","width"],f=t.duration/2,d,p,m={},g={};$.effects.save(i,n),i.show(),d=$.effects.createWrapper(i).css({overflow:"hidden"}),p=h?[d.width(),d.height()]:[d.height(),d.width()],l&&(s=parseInt(l[1],10)/100*p[a?0:1]),o&&d.css(c?{height:0,width:s}:{height:s,width:0}),m[u[0]]=o?p[0]:s,g[u[1]]=o?p[1]:0,d.animate(m,f,t.easing).animate(g,f,t.easing,function(){a&&i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),e()})}}(jQuery),function($,t){$.effects.effect.highlight=function(t,e){var i=$(this),n=["backgroundImage","backgroundColor","opacity"],r=$.effects.setMode(i,t.mode||"show"),o={backgroundColor:i.css("backgroundColor")};"hide"===r&&(o.opacity=0),$.effects.save(i,n),i.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&i.hide(),$.effects.restore(i,n),e()}})}}(jQuery),function($,t){$.effects.effect.pulsate=function(t,e){var i=$(this),n=$.effects.setMode(i,t.mode||"show"),r="show"===n,o="hide"===n,a=r||"hide"===n,s=2*(t.times||5)+(a?1:0),l=t.duration/s,c=0,h=i.queue(),u=h.length,f;for((r||!i.is(":visible"))&&(i.css("opacity",0).show(),c=1),f=1;s>f;f++)i.animate({opacity:c},l,t.easing),c=1-c;i.animate({opacity:c},l,t.easing),i.queue(function(){o&&i.hide(),e()}),u>1&&h.splice.apply(h,[1,0].concat(h.splice(u,s+1))),i.dequeue()}}(jQuery),function($,t){$.effects.effect.puff=function(t,e){var i=$(this),n=$.effects.setMode(i,t.mode||"hide"),r="hide"===n,o=parseInt(t.percent,10)||150,a=o/100,s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};$.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:e,percent:r?o:100,from:r?s:{height:s.height*a,width:s.width*a,outerHeight:s.outerHeight*a,outerWidth:s.outerWidth*a}}),i.effect(t)},$.effects.effect.scale=function(t,e){var i=$(this),n=$.extend(!0,{},t),r=$.effects.setMode(i,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===r?0:100),a=t.direction||"both",s=t.origin,l={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()},c={y:"horizontal"!==a?o/100:1,x:"vertical"!==a?o/100:1};n.effect="size",n.queue=!1,n.complete=e,"effect"!==r&&(n.origin=s||["middle","center"],n.restore=!0),n.from=t.from||("show"===r?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*c.y,width:l.width*c.x,outerHeight:l.outerHeight*c.y,outerWidth:l.outerWidth*c.x},n.fade&&("show"===r&&(n.from.opacity=0,n.to.opacity=1),"hide"===r&&(n.from.opacity=1,n.to.opacity=0)),i.effect(n)},$.effects.effect.size=function(t,e){var i,n,r,o=$(this),a=["position","top","bottom","left","right","width","height","overflow","opacity"],s=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],c=["fontSize"],h=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],u=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],f=$.effects.setMode(o,t.mode||"effect"),d=t.restore||"effect"!==f,p=t.scale||"both",m=t.origin||["middle","center"],g=o.css("position"),v=d?a:s,E={height:0,width:0,outerHeight:0,outerWidth:0};"show"===f&&o.show(),i={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===f?(o.from=t.to||E,o.to=t.from||i):(o.from=t.from||("show"===f?E:i),o.to=t.to||("hide"===f?E:i)),r={from:{y:o.from.height/i.height,x:o.from.width/i.width},to:{y:o.to.height/i.height,x:o.to.width/i.width}},("box"===p||"both"===p)&&(r.from.y!==r.to.y&&(v=v.concat(h),o.from=$.effects.setTransition(o,h,r.from.y,o.from),o.to=$.effects.setTransition(o,h,r.to.y,o.to)),r.from.x!==r.to.x&&(v=v.concat(u),o.from=$.effects.setTransition(o,u,r.from.x,o.from),o.to=$.effects.setTransition(o,u,r.to.x,o.to))),("content"===p||"both"===p)&&r.from.y!==r.to.y&&(v=v.concat(c).concat(l),o.from=$.effects.setTransition(o,c,r.from.y,o.from),o.to=$.effects.setTransition(o,c,r.to.y,o.to)),$.effects.save(o,v),o.show(),$.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(n=$.effects.getBaseline(m,i),o.from.top=(i.outerHeight-o.outerHeight())*n.y,o.from.left=(i.outerWidth-o.outerWidth())*n.x,o.to.top=(i.outerHeight-o.to.outerHeight)*n.y,o.to.left=(i.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===p||"both"===p)&&(h=h.concat(["marginTop","marginBottom"]).concat(c),u=u.concat(["marginLeft","marginRight"]),l=a.concat(h).concat(u),o.find("*[width]").each(function(){var e=$(this),i={height:e.height(),width:e.width(),outerHeight:e.outerHeight(),outerWidth:e.outerWidth()};d&&$.effects.save(e,l),e.from={height:i.height*r.from.y,width:i.width*r.from.x,outerHeight:i.outerHeight*r.from.y,outerWidth:i.outerWidth*r.from.x},e.to={height:i.height*r.to.y,width:i.width*r.to.x,outerHeight:i.height*r.to.y,outerWidth:i.width*r.to.x},r.from.y!==r.to.y&&(e.from=$.effects.setTransition(e,h,r.from.y,e.from),e.to=$.effects.setTransition(e,h,r.to.y,e.to)),r.from.x!==r.to.x&&(e.from=$.effects.setTransition(e,u,r.from.x,e.from),e.to=$.effects.setTransition(e,u,r.to.x,e.to)),e.css(e.from),e.animate(e.to,t.duration,t.easing,function(){d&&$.effects.restore(e,l)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===f&&o.hide(),$.effects.restore(o,v),d||("static"===g?o.css({position:"relative",top:o.to.top,left:o.to.left}):$.each(["top","left"],function(t,e){o.css(e,function(e,i){var n=parseInt(i,10),r=t?o.to.left:o.to.top;return"auto"===i?r+"px":n+r+"px"})})),$.effects.removeWrapper(o),e()}})}}(jQuery),function($,t){$.effects.effect.shake=function(t,e){var i=$(this),n=["position","top","bottom","left","right","height","width"],r=$.effects.setMode(i,t.mode||"effect"),o=t.direction||"left",a=t.distance||20,s=t.times||3,l=2*s+1,c=Math.round(t.duration/l),h="up"===o||"down"===o?"top":"left",u="up"===o||"left"===o,f={},d={},p={},m,g=i.queue(),v=g.length;for($.effects.save(i,n),i.show(),$.effects.createWrapper(i),f[h]=(u?"-=":"+=")+a,d[h]=(u?"+=":"-=")+2*a,p[h]=(u?"-=":"+=")+2*a,i.animate(f,c,t.easing),m=1;s>m;m++)i.animate(d,c,t.easing).animate(p,c,t.easing);i.animate(d,c,t.easing).animate(f,c/2,t.easing).queue(function(){"hide"===r&&i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),e()}),v>1&&g.splice.apply(g,[1,0].concat(g.splice(v,l+1))),i.dequeue()}}(jQuery),function($,t){$.effects.effect.slide=function(t,e){var i=$(this),n=["position","top","bottom","left","right","width","height"],r=$.effects.setMode(i,t.mode||"show"),o="show"===r,a=t.direction||"left",s="up"===a||"down"===a?"top":"left",l="up"===a||"left"===a,c,h={};$.effects.save(i,n),i.show(),c=t.distance||i["top"===s?"outerHeight":"outerWidth"](!0),$.effects.createWrapper(i).css({overflow:"hidden"}),o&&i.css(s,l?isNaN(c)?"-"+c:-c:c),h[s]=(o?l?"+=":"-=":l?"-=":"+=")+c,i.animate(h,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),e()}})}}(jQuery),function($,t){$.effects.effect.transfer=function(t,e){var i=$(this),n=$(t.to),r="fixed"===n.css("position"),o=$("body"),a=r?o.scrollTop():0,s=r?o.scrollLeft():0,l=n.offset(),c={top:l.top-a,left:l.left-s,height:n.innerHeight(),width:n.innerWidth()},h=i.offset(),u=$("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:h.top-a,left:h.left-s,height:i.innerHeight(),width:i.innerWidth(),position:r?"fixed":"absolute"}).animate(c,t.duration,t.easing,function(){u.remove(),e()})}}(jQuery),function($,t){$.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,$.proxy(function(t){this.options.disabled&&t.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(t){t.preventDefault()},"click .ui-state-disabled > a":function(t){t.preventDefault()},"click .ui-menu-item:has(a)":function(t){var e=$(t.target).closest(".ui-menu-item");!this.mouseHandled&&e.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(t),e.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var e=$(t.currentTarget);e.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,e)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.children(".ui-menu-item").eq(0);e||this.focus(t,i)},blur:function(t){this._delay(function(){$.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){$(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=$(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function e(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var i,n,r,o,a,s=!0;switch(t.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(t);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case $.ui.keyCode.HOME:this._move("first","first",t);break;case $.ui.keyCode.END:this._move("last","last",t);break;case $.ui.keyCode.UP:this.previous(t);break;case $.ui.keyCode.DOWN:this.next(t);break;case $.ui.keyCode.LEFT:this.collapse(t);break;case $.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(t);break;case $.ui.keyCode.ESCAPE:this.collapse(t);break;default:s=!1,n=this.previousFilter||"",r=String.fromCharCode(t.keyCode),o=!1,clearTimeout(this.filterTimer),r===n?o=!0:r=n+r,a=new RegExp("^"+e(r),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test($(this).children("a").text())}),i=o&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(r=String.fromCharCode(t.keyCode),a=new RegExp("^"+e(r),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test($(this).children("a").text())})),i.length?(this.focus(t,i),i.length>1?(this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}s&&t.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var t,e=this.options.icons.submenu,i=this.element.find(this.options.menus);i.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=$(this),i=t.prev("a"),n=$("<span>").addClass("ui-menu-icon ui-icon "+e).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",i.attr("id"))}),t=i.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=$(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!$.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),this._super(t,e)},focus:function(t,e){var i,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(t){var e,i,n,r,o,a;this._hasScroll()&&(e=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-e-i,r=this.activeMenu.scrollTop(),o=this.activeMenu.height(),a=t.height(),0>n?this.activeMenu.scrollTop(r+n):n+a>o&&this.activeMenu.scrollTop(r+n-o+a))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(t){var e=$.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(e)},collapseAll:function(t,e){clearTimeout(this.timer),this.timer=this._delay(function(){var i=e?this.element:$(t&&t.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(t),this.activeMenu=i},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();
e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var n;this.active&&(n="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.children(".ui-menu-item")[e]()),this.focus(i,n)},nextPage:function(t){var e,i,n;return this.active?void(this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return e=$(this),e.offset().top-i-n<0}),this.focus(t,e)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var e,i,n;return this.active?void(this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return e=$(this),e.offset().top-i+n>0}),this.focus(t,e)):this.focus(t,this.activeMenu.children(".ui-menu-item").first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||$(t.target).closest(".ui-menu-item");var e={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,e)}})}(jQuery),function($,t){function e(t,e,i){return[parseFloat(t[0])*(f.test(t[0])?e/100:1),parseFloat(t[1])*(f.test(t[1])?i/100:1)]}function i(t,e){return parseInt($.css(t,e),10)||0}function n(t){var e=t[0];return 9===e.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:$.isWindow(e)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:e.preventDefault?{width:0,height:0,offset:{top:e.pageY,left:e.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}$.ui=$.ui||{};var r,o=Math.max,a=Math.abs,s=Math.round,l=/left|center|right/,c=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,u=/^\w+/,f=/%$/,d=$.fn.position;$.position={scrollbarWidth:function(){if(r!==t)return r;var e,i,n=$("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=n.children()[0];return $("body").append(n),e=o.offsetWidth,n.css("overflow","scroll"),i=o.offsetWidth,e===i&&(i=n[0].clientWidth),n.remove(),r=e-i},getScrollInfo:function(t){var e=t.isWindow?"":t.element.css("overflow-x"),i=t.isWindow?"":t.element.css("overflow-y"),n="scroll"===e||"auto"===e&&t.width<t.element[0].scrollWidth,r="scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight;return{width:r?$.position.scrollbarWidth():0,height:n?$.position.scrollbarWidth():0}},getWithinInfo:function(t){var e=$(t||window),i=$.isWindow(e[0]);return{element:e,isWindow:i,offset:e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:i?e.width():e.outerWidth(),height:i?e.height():e.outerHeight()}}},$.fn.position=function(t){if(!t||!t.of)return d.apply(this,arguments);t=$.extend({},t);var r,f,p,m,g,v,E=$(t.of),y=$.position.getWithinInfo(t.within),x=$.position.getScrollInfo(y),T=(t.collision||"flip").split(" "),b={};return v=n(E),E[0].preventDefault&&(t.at="left top"),f=v.width,p=v.height,m=v.offset,g=$.extend({},m),$.each(["my","at"],function(){var e=(t[this]||"").split(" "),i,n;1===e.length&&(e=l.test(e[0])?e.concat(["center"]):c.test(e[0])?["center"].concat(e):["center","center"]),e[0]=l.test(e[0])?e[0]:"center",e[1]=c.test(e[1])?e[1]:"center",i=h.exec(e[0]),n=h.exec(e[1]),b[this]=[i?i[0]:0,n?n[0]:0],t[this]=[u.exec(e[0])[0],u.exec(e[1])[0]]}),1===T.length&&(T[1]=T[0]),"right"===t.at[0]?g.left+=f:"center"===t.at[0]&&(g.left+=f/2),"bottom"===t.at[1]?g.top+=p:"center"===t.at[1]&&(g.top+=p/2),r=e(b.at,f,p),g.left+=r[0],g.top+=r[1],this.each(function(){var n,l,c=$(this),h=c.outerWidth(),u=c.outerHeight(),d=i(this,"marginLeft"),v=i(this,"marginTop"),_=h+d+i(this,"marginRight")+x.width,w=u+v+i(this,"marginBottom")+x.height,R=$.extend({},g),H=e(b.my,c.outerWidth(),c.outerHeight());"right"===t.my[0]?R.left-=h:"center"===t.my[0]&&(R.left-=h/2),"bottom"===t.my[1]?R.top-=u:"center"===t.my[1]&&(R.top-=u/2),R.left+=H[0],R.top+=H[1],$.support.offsetFractions||(R.left=s(R.left),R.top=s(R.top)),n={marginLeft:d,marginTop:v},$.each(["left","top"],function(e,i){$.ui.position[T[e]]&&$.ui.position[T[e]][i](R,{targetWidth:f,targetHeight:p,elemWidth:h,elemHeight:u,collisionPosition:n,collisionWidth:_,collisionHeight:w,offset:[r[0]+H[0],r[1]+H[1]],my:t.my,at:t.at,within:y,elem:c})}),t.using&&(l=function(e){var i=m.left-R.left,n=i+f-h,r=m.top-R.top,s=r+p-u,l={target:{element:E,left:m.left,top:m.top,width:f,height:p},element:{element:c,left:R.left,top:R.top,width:h,height:u},horizontal:0>n?"left":i>0?"right":"center",vertical:0>s?"top":r>0?"bottom":"middle"};h>f&&a(i+n)<f&&(l.horizontal="center"),u>p&&a(r+s)<p&&(l.vertical="middle"),l.important=o(a(i),a(n))>o(a(r),a(s))?"horizontal":"vertical",t.using.call(this,e,l)}),c.offset($.extend(R,{using:l}))})},$.ui.position={fit:{left:function(t,e){var i=e.within,n=i.isWindow?i.scrollLeft:i.offset.left,r=i.width,a=t.left-e.collisionPosition.marginLeft,s=n-a,l=a+e.collisionWidth-r-n,c;e.collisionWidth>r?s>0&&0>=l?(c=t.left+s+e.collisionWidth-r-n,t.left+=s-c):t.left=l>0&&0>=s?n:s>l?n+r-e.collisionWidth:n:s>0?t.left+=s:l>0?t.left-=l:t.left=o(t.left-a,t.left)},top:function(t,e){var i=e.within,n=i.isWindow?i.scrollTop:i.offset.top,r=e.within.height,a=t.top-e.collisionPosition.marginTop,s=n-a,l=a+e.collisionHeight-r-n,c;e.collisionHeight>r?s>0&&0>=l?(c=t.top+s+e.collisionHeight-r-n,t.top+=s-c):t.top=l>0&&0>=s?n:s>l?n+r-e.collisionHeight:n:s>0?t.top+=s:l>0?t.top-=l:t.top=o(t.top-a,t.top)}},flip:{left:function(t,e){var i=e.within,n=i.offset.left+i.scrollLeft,r=i.width,o=i.isWindow?i.scrollLeft:i.offset.left,s=t.left-e.collisionPosition.marginLeft,l=s-o,c=s+e.collisionWidth-r-o,h="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,u="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0],d,p;0>l?(d=t.left+h+u+f+e.collisionWidth-r-n,(0>d||d<a(l))&&(t.left+=h+u+f)):c>0&&(p=t.left-e.collisionPosition.marginLeft+h+u+f-o,(p>0||a(p)<c)&&(t.left+=h+u+f))},top:function(t,e){var i=e.within,n=i.offset.top+i.scrollTop,r=i.height,o=i.isWindow?i.scrollTop:i.offset.top,s=t.top-e.collisionPosition.marginTop,l=s-o,c=s+e.collisionHeight-r-o,h="top"===e.my[1],u=h?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,d=-2*e.offset[1],p,m;0>l?(m=t.top+u+f+d+e.collisionHeight-r-n,t.top+u+f+d>l&&(0>m||m<a(l))&&(t.top+=u+f+d)):c>0&&(p=t.top-e.collisionPosition.marginTop+u+f+d-o,t.top+u+f+d>c&&(p>0||a(p)<c)&&(t.top+=u+f+d))}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments),$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments),$.ui.position.fit.top.apply(this,arguments)}}},function(){var t,e,i,n,r,o=document.getElementsByTagName("body")[0],a=document.createElement("div");t=document.createElement(o?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&$.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(r in i)t.style[r]=i[r];t.appendChild(a),e=o||document.documentElement,e.insertBefore(t,e.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",n=$(a).offset().left,$.support.offsetFractions=n>10&&11>n,t.innerHTML="",e.removeChild(t)}()}(jQuery),function($,t){$.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=$("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return e===t?this.options.value:(this.options.value=this._constrainedValue(e),void this._refreshValue())},_constrainedValue:function(e){return e===t&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,e=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(e.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=$("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})}(jQuery),function($,t){var e=5;$.widget("ui.slider",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,e,i=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),r="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];for(e=i.values&&i.values.length||1,n.length>e&&(n.slice(e).remove(),n=n.slice(0,e)),t=n.length;e>t;t++)o.push(r);this.handles=n.add($(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){$(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,e="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:$.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=$("<div></div>").appendTo(this.element),e="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(e+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):this.range=$([])},_setupEvents:function(){var t=this.handles.add(this.range).filter("a");this._off(t),this._on(t,this._handleEvents),this._hoverable(t),this._focusable(t)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var e,i,n,r,o,a,s,l,c=this,h=this.options;return h.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var e=Math.abs(i-c.values(t));(n>e||n===e&&(t===c._lastChangedValue||c.values(t)===h.min))&&(n=e,r=$(this),o=t)}),a=this._start(t,o),a===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,r.addClass("ui-state-active").focus(),s=r.offset(),l=!$(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-s.left-r.width()/2,top:t.pageY-s.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,r,o;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/e,n>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),r=this._valueMax()-this._valueMin(),o=this._valueMin()+n*r,this._trimAlignValue(o)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var n,r,o;this.options.values&&this.options.values.length?(n=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>n||1===e&&n>i)&&(i=n),i!==this.values(e)&&(r=this.values(),r[e]=i,o=this._trigger("slide",t,{handle:this.handles[e],value:i,values:r}),n=this.values(e?0:1),o!==!1&&this.values(e,i,!0))):i!==this.value()&&(o=this._trigger("slide",t,{handle:this.handles[e],value:i}),o!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,e){var i,n,r;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(e),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!$.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(i=this.options.values,n=arguments[0],r=0;r<i.length;r+=1)i[r]=this._trimAlignValue(n[r]),this._change(null,r);this._refreshValue()},_setOption:function(t,e){var i,n=0;switch("range"===t&&this.options.range===!0&&("min"===e?(this.options.value=this._values(0),this.options.values=null):"max"===e&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),$.isArray(this.options.values)&&(n=this.options.values.length),$.Widget.prototype._setOption.apply(this,arguments),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;n>i;i+=1)this._change(null,i);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=i>0?e:-e),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,e,i,n,r,o=this.options.range,a=this.options,s=this,l=this._animateOff?!1:a.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(i){e=(s.values(i)-s._valueMin())/(s._valueMax()-s._valueMin())*100,c["horizontal"===s.orientation?"left":"bottom"]=e+"%",$(this).stop(1,1)[l?"animate":"css"](c,a.animate),s.options.range===!0&&("horizontal"===s.orientation?(0===i&&s.range.stop(1,1)[l?"animate":"css"]({left:e+"%"},a.animate),1===i&&s.range[l?"animate":"css"]({width:e-t+"%"},{queue:!1,duration:a.animate})):(0===i&&s.range.stop(1,1)[l?"animate":"css"]({bottom:e+"%"},a.animate),1===i&&s.range[l?"animate":"css"]({height:e-t+"%"},{queue:!1,duration:a.animate}))),t=e}):(i=this.value(),n=this._valueMin(),r=this._valueMax(),e=r!==n?(i-n)/(r-n)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=e+"%",this.handle.stop(1,1)[l?"animate":"css"](c,a.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:e+"%"},a.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-e+"%"},{queue:!1,duration:a.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:e+"%"},a.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-e+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(t){var i,n,r,o,a=$(t.target).data("ui-slider-handle-index");switch(t.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,$(t.target).addClass("ui-state-active"),i=this._start(t,a),i===!1))return}switch(o=this.options.step,n=r=this.options.values&&this.options.values.length?this.values(a):this.value(),t.keyCode){case $.ui.keyCode.HOME:r=this._valueMin();break;case $.ui.keyCode.END:r=this._valueMax();break;case $.ui.keyCode.PAGE_UP:r=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/e);break;case $.ui.keyCode.PAGE_DOWN:r=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/e);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(n===this._valueMax())return;r=this._trimAlignValue(n+o);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(n===this._valueMin())return;r=this._trimAlignValue(n-o)}this._slide(t,a,r)},click:function(t){t.preventDefault()},keyup:function(t){var e=$(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,e),this._change(t,e),$(t.target).removeClass("ui-state-active"))}}})}(jQuery),function($){function t(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}$.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},e=this.element;return $.each(["min","max","step"],function(i,n){var r=e.attr(n);void 0!==r&&r.length&&(t[n]=r)}),t},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(t){function e(){var t=this.element[0]===this.document[0].activeElement;t||(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i}))}var i;i=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),e.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,e.call(this)}),this._start(t)!==!1&&this._repeat(null,$(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return $(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:void this._repeat(null,$(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(t){var e=this.options,i=$.ui.keyCode;switch(t.keyCode){case i.UP:return this._repeat(null,1,t),!0;case i.DOWN:return this._repeat(null,-1,t),!0;case i.PAGE_UP:return this._repeat(null,e.page,t),!0;case i.PAGE_DOWN:return this._repeat(null,-e.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(t){return this.spinning||this._trigger("start",t)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var e=this.options.incremental;return e?$.isFunction(e)?e(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,n=this.options;return e=null!==n.min?n.min:0,i=t-e,i=Math.round(i/n.step)*n.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==n.max&&t>n.max?n.max:null!==n.min&&t<n.min?n.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,void this.element.val(this._format(i))}("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(e?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(t){this._super(t),this._value(this.element.val())}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:t(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:t(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:t(function(t){this._stepDown((t||1)*this.options.page)}),value:function(e){return arguments.length?void t(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function($,t){function e(){return++n}function i(t){return t.hash.length>1&&decodeURIComponent(t.href.replace(r,""))===decodeURIComponent(location.href.replace(r,""))}var n=0,r=/#.*$/;$.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,e=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",e.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){$(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){$(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),e.active=this._initialActive(),$.isArray(e.disabled)&&(e.disabled=$.unique(e.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(e.active):$(),this._refresh(),this.active.length&&this.load(e.active)},_initialActive:function(){var t=this.options.active,e=this.options.collapsible,i=location.hash.substring(1);return null===t&&(i&&this.tabs.each(function(e,n){return $(n).attr("aria-controls")===i?(t=e,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=e?!1:0)),!e&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):$()}},_tabKeydown:function(t){var e=$(this.document[0].activeElement).closest("li"),i=this.tabs.index(e),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:i++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:n=!1,i--;break;case $.ui.keyCode.END:i=this.anchors.length-1;break;case $.ui.keyCode.HOME:i=0;break;case $.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case $.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i===this.options.active?!1:i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,n),t.ctrlKey||(e.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===$.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===$.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===$.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,e){function i(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==$.inArray(i(),this.options.disabled);)t=e?t+1:t-1;return t},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,e){return"active"===t?void this._activate(e):"disabled"===t?void this._setupDisabled(e):(this._super(t,e),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",e),e||this.options.active!==!1||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_tabId:function(t){return t.attr("aria-controls")||"ui-tabs-"+e()},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,e=this.tablist.children(":has(a[href])");t.disabled=$.map(e.filter(".ui-state-disabled"),function(t){return e.index(t)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!$.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=$()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=$()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=$(),this.anchors.each(function(e,n){var r,o,a,s=$(n).uniqueId().attr("id"),l=$(n).closest("li"),c=l.attr("aria-controls");i(n)?(r=n.hash,o=t.element.find(t._sanitizeSelector(r))):(a=t._tabId(l),r="#"+a,o=t.element.find(r),o.length||(o=t._createPanel(a),o.insertAfter(t.panels[e-1]||t.tablist)),o.attr("aria-live","polite")),o.length&&(t.panels=t.panels.add(o)),c&&l.data("ui-tabs-aria-controls",c),l.attr({"aria-controls":r.substring(1),"aria-labelledby":s}),o.attr("aria-labelledby",s)
}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return $("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){$.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var e=0,i;i=this.tabs[e];e++)t===!0||-1!==$.inArray(e,t)?$(i).addClass("ui-state-disabled").attr("aria-disabled","true"):$(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var e={click:function(t){t.preventDefault()}};t&&$.each(t.split(" "),function(t,i){e[i]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,e),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var e,i=this.element.parent();"fill"===t?(e=i.height(),e-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=$(this),i=t.css("position");"absolute"!==i&&"fixed"!==i&&(e-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){e-=$(this).outerHeight(!0)}),this.panels.each(function(){$(this).height(Math.max(0,e-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===t&&(e=0,this.panels.each(function(){e=Math.max(e,$(this).height("").height())}).height(e))},_eventHandler:function(t){var e=this.options,i=this.active,n=$(t.currentTarget),r=n.closest("li"),o=r[0]===i[0],a=o&&e.collapsible,s=a?$():this._getPanelForTab(r),l=i.length?this._getPanelForTab(i):$(),c={oldTab:i,oldPanel:l,newTab:a?$():r,newPanel:s};t.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||o&&!e.collapsible||this._trigger("beforeActivate",t,c)===!1||(e.active=a?!1:this.tabs.index(r),this.active=o?$():r,this.xhr&&this.xhr.abort(),l.length||s.length||$.error("jQuery UI Tabs: Mismatching fragment identifier."),s.length&&this.load(this.tabs.index(r),t),this._toggle(t,c))},_toggle:function(t,e){function i(){r.running=!1,r._trigger("activate",t,e)}function n(){e.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&r.options.show?r._show(o,r.options.show,i):(o.show(),i())}var r=this,o=e.newPanel,a=e.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){e.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(e.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),n()),a.attr({"aria-expanded":"false","aria-hidden":"true"}),e.oldTab.attr("aria-selected","false"),o.length&&a.length?e.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr({"aria-expanded":"true","aria-hidden":"false"}),e.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var e,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),e=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:e,currentTarget:e,preventDefault:$.noop}))},_findActive:function(t){return t===!1?$():this.tabs.eq(t)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){$.data(this,"ui-tabs-destroy")?$(this).remove():$(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=$(this),e=t.data("ui-tabs-aria-controls");e?t.attr("aria-controls",e).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var i=this.options.disabled;i!==!1&&(e===t?i=!1:(e=this._getIndex(e),i=$.isArray(i)?$.map(i,function(t){return t!==e?t:null}):$.map(this.tabs,function(t,i){return i!==e?i:null})),this._setupDisabled(i))},disable:function(e){var i=this.options.disabled;if(i!==!0){if(e===t)i=!0;else{if(e=this._getIndex(e),-1!==$.inArray(e,i))return;i=$.isArray(i)?$.merge([e],i).sort():[e]}this._setupDisabled(i)}},load:function(t,e){t=this._getIndex(t);var n=this,r=this.tabs.eq(t),o=r.find(".ui-tabs-anchor"),a=this._getPanelForTab(r),s={tab:r,panel:a};i(o[0])||(this.xhr=$.ajax(this._ajaxSettings(o,e,s)),this.xhr&&"canceled"!==this.xhr.statusText&&(r.addClass("ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.success(function(t){setTimeout(function(){a.html(t),n._trigger("load",e,s)},1)}).complete(function(t,e){setTimeout(function(){"abort"===e&&n.panels.stop(!1,!0),r.removeClass("ui-tabs-loading"),a.removeAttr("aria-busy"),t===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(t,e,i){var n=this;return{url:t.attr("href"),beforeSend:function(t,r){return n._trigger("beforeLoad",e,$.extend({jqXHR:t,ajaxSettings:r},i))}}},_getPanelForTab:function(t){var e=$(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+e))}})}(jQuery),function($){function t(t,e){var i=(t.attr("aria-describedby")||"").split(/\s+/);i.push(e),t.data("ui-tooltip-id",e).attr("aria-describedby",$.trim(i.join(" ")))}function e(t){var e=t.data("ui-tooltip-id"),i=(t.attr("aria-describedby")||"").split(/\s+/),n=$.inArray(e,i);-1!==n&&i.splice(n,1),t.removeData("ui-tooltip-id"),i=$.trim(i.join(" ")),i?t.attr("aria-describedby",i):t.removeAttr("aria-describedby")}var i=0;$.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var t=$(this).attr("title")||"";return $("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(t,e){var i=this;return"disabled"===t?(this[e?"_disable":"_enable"](),void(this.options[t]=e)):(this._super(t,e),void("content"===t&&$.each(this.tooltips,function(t,e){i._updateContent(e)})))},_disable:function(){var t=this;$.each(this.tooltips,function(e,i){var n=$.Event("blur");n.target=n.currentTarget=i[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=$(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=$(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var e=this,i=$(t?t.target:this.element).closest(this.options.items);i.length&&!i.data("ui-tooltip-id")&&(i.attr("title")&&i.data("ui-tooltip-title",i.attr("title")),i.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&i.parents().each(function(){var t=$(this),i;t.data("ui-tooltip-open")&&(i=$.Event("blur"),i.target=i.currentTarget=this,e.close(i,!0)),t.attr("title")&&(t.uniqueId(),e.parents[this.id]={element:this,title:t.attr("title")},t.attr("title",""))}),this._updateContent(i,t))},_updateContent:function(t,e){var i,n=this.options.content,r=this,o=e?e.type:null;return"string"==typeof n?this._open(e,t,n):(i=n.call(t[0],function(i){t.data("ui-tooltip-open")&&r._delay(function(){e&&(e.type=o),this._open(e,t,i)})}),void(i&&this._open(e,t,i)))},_open:function(e,i,n){function r(t){l.of=t,o.is(":hidden")||o.position(l)}var o,a,s,l=$.extend({},this.options.position);if(n){if(o=this._find(i),o.length)return void o.find(".ui-tooltip-content").html(n);i.is("[title]")&&(e&&"mouseover"===e.type?i.attr("title",""):i.removeAttr("title")),o=this._tooltip(i),t(i,o.attr("id")),o.find(".ui-tooltip-content").html(n),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:r}),r(e)):o.position($.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(s=this.delayedShow=setInterval(function(){o.is(":visible")&&(r(l.of),clearInterval(s))},$.fx.interval)),this._trigger("open",e,{tooltip:o}),a={keyup:function(t){if(t.keyCode===$.ui.keyCode.ESCAPE){var e=$.Event(t);e.currentTarget=i[0],this.close(e,!0)}},remove:function(){this._removeTooltip(o)}},e&&"mouseover"!==e.type||(a.mouseleave="close"),e&&"focusin"!==e.type||(a.focusout="close"),this._on(!0,i,a)}},close:function(t){var i=this,n=$(t?t.currentTarget:this.element),r=this._find(n);this.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&n.attr("title",n.data("ui-tooltip-title")),e(n),r.stop(!0),this._hide(r,this.options.hide,function(){i._removeTooltip($(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&$.each(this.parents,function(t,e){$(e.element).attr("title",e.title),delete i.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:r}),this.closing=!1)},_tooltip:function(t){var e="ui-tooltip-"+i++,n=$("<div>").attr({id:e,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return $("<div>").addClass("ui-tooltip-content").appendTo(n),n.appendTo(this.document[0].body),this.tooltips[e]=t,n},_find:function(t){var e=t.data("ui-tooltip-id");return e?$("#"+e):$()},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var t=this;$.each(this.tooltips,function(e,i){var n=$.Event("blur");n.target=n.currentTarget=i[0],t.close(n,!0),$("#"+e).remove(),i.data("ui-tooltip-title")&&(i.attr("title",i.data("ui-tooltip-title")),i.removeData("ui-tooltip-title"))})}})}(jQuery),!function(){function t(t,e){return e>t?-1:t>e?1:t>=e?0:0/0}function e(t){return null!=t&&!isNaN(t)}function i(t){return{left:function(e,i,n,r){for(arguments.length<3&&(n=0),arguments.length<4&&(r=e.length);r>n;){var o=n+r>>>1;t(e[o],i)<0?n=o+1:r=o}return n},right:function(e,i,n,r){for(arguments.length<3&&(n=0),arguments.length<4&&(r=e.length);r>n;){var o=n+r>>>1;t(e[o],i)>0?r=o:n=o+1}return n}}}function n(t){return t.length}function r(t){for(var e=1;t*e%1;)e*=10;return e}function o(t,e){try{for(var i in e)Object.defineProperty(t.prototype,i,{value:e[i],enumerable:!1})}catch(n){t.prototype=e}}function a(){}function s(t){return as+t in this}function l(t){return t=as+t,t in this&&delete this[t]}function c(){var t=[];return this.forEach(function(e){t.push(e)}),t}function h(){var t=0;for(var e in this)e.charCodeAt(0)===ss&&++t;return t}function u(){for(var t in this)if(t.charCodeAt(0)===ss)return!1;return!0}function f(){}function d(t,e,i){return function(){var n=i.apply(e,arguments);return n===e?t:n}}function p(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.substring(1);for(var i=0,n=ls.length;n>i;++i){var r=ls[i]+e;if(r in t)return r}}function m(){}function g(){}function v(t){function e(){for(var e,n=i,r=-1,o=n.length;++r<o;)(e=n[r].on)&&e.apply(this,arguments);return t}var i=[],n=new a;return e.on=function(e,r){var o,a=n.get(e);return arguments.length<2?a&&a.on:(a&&(a.on=null,i=i.slice(0,o=i.indexOf(a)).concat(i.slice(o+1)),n.remove(e)),r&&i.push(n.set(e,{on:r})),t)},e}function E(){Ga.event.preventDefault()}function y(){for(var t,e=Ga.event;t=e.sourceEvent;)e=t;return e}function x(t){for(var e=new g,i=0,n=arguments.length;++i<n;)e[arguments[i]]=v(e);return e.of=function(i,n){return function(r){try{var o=r.sourceEvent=Ga.event;r.target=t,Ga.event=r,e[r.type].apply(i,n)}finally{Ga.event=o}}},e}function T(t){return hs(t,ms),t}function b(t){return"function"==typeof t?t:function(){return us(t,this)}}function _(t){return"function"==typeof t?t:function(){return fs(t,this)}}function w(t,e){function i(){this.removeAttribute(t)}function n(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,e)}function o(){this.setAttributeNS(t.space,t.local,e)}function a(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}function s(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}return t=Ga.ns.qualify(t),null==e?t.local?n:i:"function"==typeof e?t.local?s:a:t.local?o:r}function R(t){return t.trim().replace(/\s+/g," ")}function H(t){return new RegExp("(?:^|\\s+)"+Ga.requote(t)+"(?:\\s+|$)","g")}function M(t){return(t+"").trim().split(/^|\s+/)}function S(t,e){function i(){for(var i=-1;++i<r;)t[i](this,e)}function n(){for(var i=-1,n=e.apply(this,arguments);++i<r;)t[i](this,n)}t=M(t).map(C);var r=t.length;return"function"==typeof e?n:i}function C(t){var e=H(t);return function(i,n){if(r=i.classList)return n?r.add(t):r.remove(t);var r=i.getAttribute("class")||"";n?(e.lastIndex=0,e.test(r)||i.setAttribute("class",R(r+" "+t))):i.setAttribute("class",R(r.replace(e," ")))}}function A(t,e,i){function n(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,e,i)}function o(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,i)}return null==e?n:"function"==typeof e?o:r}function D(t,e){function i(){delete this[t]}function n(){this[t]=e}function r(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}return null==e?i:"function"==typeof e?r:n}function P(t){return"function"==typeof t?t:(t=Ga.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,t)}}function k(t){return{__data__:t}}function L(t){return function(){return ps(this,t)}}function N(e){return arguments.length||(e=t),function(t,i){return t&&i?e(t.__data__,i.__data__):!t-!i}}function F(t,e){for(var i=0,n=t.length;n>i;i++)for(var r,o=t[i],a=0,s=o.length;s>a;a++)(r=o[a])&&e(r,a,i);return t}function I(t){return hs(t,vs),t}function z(t){var e,i;return function(n,r,o){var a,s=t[o].update,l=s.length;for(o!=i&&(i=o,e=0),r>=e&&(e=r+1);!(a=s[e])&&++e<l;);return a}}function O(){var t=this.__transition__;t&&++t.active}function U(t,e,i){function n(){var e=this[a];e&&(this.removeEventListener(t,e,e.$),delete this[a])}function r(){var r=l(e,qa(arguments));n.call(this),this.addEventListener(t,this[a]=r,r.$=i),r._=e}function o(){var e,i=new RegExp("^__on([^.]+)"+Ga.requote(t)+"$");for(var n in this)if(e=n.match(i)){var r=this[n];this.removeEventListener(e[1],r,r.$),delete this[n]}}var a="__on"+t,s=t.indexOf("."),l=B;s>0&&(t=t.substring(0,s));var c=ys.get(t);return c&&(t=c,l=V),s?e?r:n:e?m:o}function B(t,e){return function(i){var n=Ga.event;Ga.event=i,e[0]=this.__data__;try{t.apply(this,e)}finally{Ga.event=n}}}function V(t,e){var i=B(t,e);return function(t){var e=this,n=t.relatedTarget;n&&(n===e||8&n.compareDocumentPosition(e))||i.call(e,t)}}function W(){var t=".dragsuppress-"+ ++Ts,e="click"+t,i=Ga.select($a).on("touchmove"+t,E).on("dragstart"+t,E).on("selectstart"+t,E);if(xs){var n=Ka.style,r=n[xs];n[xs]="none"}return function(o){function a(){i.on(e,null)}i.on(t,null),xs&&(n[xs]=r),o&&(i.on(e,function(){E(),a()},!0),setTimeout(a,0))}}function j(t,e){e.changedTouches&&(e=e.changedTouches[0]);var i=t.ownerSVGElement||t;if(i.createSVGPoint){var n=i.createSVGPoint();if(0>bs&&($a.scrollX||$a.scrollY)){i=Ga.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var r=i[0][0].getScreenCTM();bs=!(r.f||r.e),i.remove()}return bs?(n.x=e.pageX,n.y=e.pageY):(n.x=e.clientX,n.y=e.clientY),n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}function G(){return Ga.event.changedTouches[0].identifier}function X(){return Ga.event.target}function $(){return $a}function q(t){return t>0?1:0>t?-1:0}function Y(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(e[1]-t[1])*(i[0]-t[0])}function K(t){return t>1?0:-1>t?_s:Math.acos(t)}function Q(t){return t>1?Rs:-1>t?-Rs:Math.asin(t)}function Z(t){return((t=Math.exp(t))-1/t)/2}function J(t){return((t=Math.exp(t))+1/t)/2}function te(t){return((t=Math.exp(2*t))-1)/(t+1)}function ee(t){return(t=Math.sin(t/2))*t}function ie(){}function ne(t,e,i){return this instanceof ne?(this.h=+t,this.s=+e,void(this.l=+i)):arguments.length<2?t instanceof ne?new ne(t.h,t.s,t.l):ve(""+t,Ee,ne):new ne(t,e,i)}function re(t,e,i){function n(t){return t>360?t-=360:0>t&&(t+=360),60>t?o+(a-o)*t/60:180>t?a:240>t?o+(a-o)*(240-t)/60:o}function r(t){return Math.round(255*n(t))}var o,a;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,i=0>i?0:i>1?1:i,a=.5>=i?i*(1+e):i+e-i*e,o=2*i-a,new de(r(t+120),r(t),r(t-120))}function oe(t,e,i){return this instanceof oe?(this.h=+t,this.c=+e,void(this.l=+i)):arguments.length<2?t instanceof oe?new oe(t.h,t.c,t.l):t instanceof se?ce(t.l,t.a,t.b):ce((t=ye((t=Ga.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new oe(t,e,i)}function ae(t,e,i){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new se(i,Math.cos(t*=Ss)*e,Math.sin(t)*e)}function se(t,e,i){return this instanceof se?(this.l=+t,this.a=+e,void(this.b=+i)):arguments.length<2?t instanceof se?new se(t.l,t.a,t.b):t instanceof oe?ae(t.l,t.c,t.h):ye((t=de(t)).r,t.g,t.b):new se(t,e,i)}function le(t,e,i){var n=(t+16)/116,r=n+e/500,o=n-i/200;return r=he(r)*Os,n=he(n)*Us,o=he(o)*Bs,new de(fe(3.2404542*r-1.5371385*n-.4985314*o),fe(-.969266*r+1.8760108*n+.041556*o),fe(.0556434*r-.2040259*n+1.0572252*o))}function ce(t,e,i){return t>0?new oe(Math.atan2(i,e)*Cs,Math.sqrt(e*e+i*i),t):new oe(0/0,0/0,t)}function he(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function ue(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function fe(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function de(t,e,i){return this instanceof de?(this.r=~~t,this.g=~~e,void(this.b=~~i)):arguments.length<2?t instanceof de?new de(t.r,t.g,t.b):ve(""+t,de,re):new de(t,e,i)}function pe(t){return new de(t>>16,255&t>>8,255&t)}function me(t){return pe(t)+""}function ge(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function ve(t,e,i){var n,r,o,a=0,s=0,l=0;if(n=/([a-z]+)\((.*)\)/i.exec(t))switch(r=n[2].split(","),n[1]){case"hsl":return i(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(Te(r[0]),Te(r[1]),Te(r[2]))}return(o=js.get(t))?e(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.substring(1),16))||(4===t.length?(a=(3840&o)>>4,a=a>>4|a,s=240&o,s=s>>4|s,l=15&o,l=l<<4|l):7===t.length&&(a=(16711680&o)>>16,s=(65280&o)>>8,l=255&o)),e(a,s,l))}function Ee(t,e,i){var n,r,o=Math.min(t/=255,e/=255,i/=255),a=Math.max(t,e,i),s=a-o,l=(a+o)/2;return s?(r=.5>l?s/(a+o):s/(2-a-o),n=t==a?(e-i)/s+(i>e?6:0):e==a?(i-t)/s+2:(t-e)/s+4,n*=60):(n=0/0,r=l>0&&1>l?0:n),new ne(n,r,l)}function ye(t,e,i){t=xe(t),e=xe(e),i=xe(i);var n=ue((.4124564*t+.3575761*e+.1804375*i)/Os),r=ue((.2126729*t+.7151522*e+.072175*i)/Us),o=ue((.0193339*t+.119192*e+.9503041*i)/Bs);return se(116*r-16,500*(n-r),200*(r-o))}function xe(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Te(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function be(t){return"function"==typeof t?t:function(){return t}}function _e(t){return t}function we(t){return function(e,i,n){return 2===arguments.length&&"function"==typeof i&&(n=i,i=null),Re(e,i,t,n)}}function Re(t,e,i,n){function r(){var t,e=l.status;if(!e&&l.responseText||e>=200&&300>e||304===e){try{t=i.call(o,l)}catch(n){return void a.error.call(o,n)}a.load.call(o,t)}else a.error.call(o,l)}var o={},a=Ga.dispatch("beforesend","progress","load","error"),s={},l=new XMLHttpRequest,c=null;return!$a.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=r:l.onreadystatechange=function(){l.readyState>3&&r()},l.onprogress=function(t){var e=Ga.event;Ga.event=t;try{a.progress.call(o,l)}finally{Ga.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?s[t]:(null==e?delete s[t]:s[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.responseType=function(t){return arguments.length?(c=t,o):c},o.response=function(t){return i=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(qa(arguments)))}}),o.send=function(i,n,r){if(2===arguments.length&&"function"==typeof n&&(r=n,n=null),l.open(i,t,!0),null==e||"accept"in s||(s.accept=e+",*/*"),l.setRequestHeader)for(var h in s)l.setRequestHeader(h,s[h]);return null!=e&&l.overrideMimeType&&l.overrideMimeType(e),null!=c&&(l.responseType=c),null!=r&&o.on("error",r).on("load",function(t){r(null,t)}),a.beforesend.call(o,l),l.send(null==n?null:n),o},o.abort=function(){return l.abort(),o},Ga.rebind(o,a,"on"),null==n?o:o.get(He(n))}function He(t){return 1===t.length?function(e,i){t(null==e?i:null)}:t}function Me(){var t=Se(),e=Ce()-t;e>24?(isFinite(e)&&(clearTimeout(Ys),Ys=setTimeout(Me,e)),qs=0):(qs=1,$s(Me))}function Se(){var t=Date.now();for(Ks=Gs;Ks;)t>=Ks.t&&(Ks.f=Ks.c(t-Ks.t)),Ks=Ks.n;return t}function Ce(){for(var t,e=Gs,i=1/0;e;)e.f?e=t?t.n=e.n:Gs=e.n:(e.t<i&&(i=e.t),e=(t=e).n);return Xs=t,i}function Ae(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function De(t,e){var i=Math.pow(10,3*os(8-e));return{scale:e>8?function(t){return t/i}:function(t){return t*i},symbol:t}}function Pe(t){var e=t.decimal,i=t.thousands,n=t.grouping,r=t.currency,o=n?function(t){for(var e=t.length,r=[],o=0,a=n[0];e>0&&a>0;)r.push(t.substring(e-=a,e+a)),a=n[o=(o+1)%n.length];return r.reverse().join(i)}:_e;return function(t){var i=Zs.exec(t),n=i[1]||" ",a=i[2]||">",s=i[3]||"",l=i[4]||"",c=i[5],h=+i[6],u=i[7],f=i[8],d=i[9],p=1,m="",g="",v=!1;switch(f&&(f=+f.substring(1)),(c||"0"===n&&"="===a)&&(c=n="0",a="=",u&&(h-=Math.floor((h-1)/4))),d){case"n":u=!0,d="g";break;case"%":p=100,g="%",d="f";break;case"p":p=100,g="%",d="r";break;case"b":case"o":case"x":case"X":"#"===l&&(m="0"+d.toLowerCase());case"c":case"d":v=!0,f=0;break;case"s":p=-1,d="r"}"$"===l&&(m=r[0],g=r[1]),"r"!=d||f||(d="g"),null!=f&&("g"==d?f=Math.max(1,Math.min(21,f)):("e"==d||"f"==d)&&(f=Math.max(0,Math.min(20,f)))),d=Js.get(d)||ke;var E=c&&u;return function(t){var i=g;if(v&&t%1)return"";var r=0>t||0===t&&0>1/t?(t=-t,"-"):s;if(0>p){var l=Ga.formatPrefix(t,f);t=l.scale(t),i=l.symbol+g}else t*=p;t=d(t,f);var y=t.lastIndexOf("."),x=0>y?t:t.substring(0,y),T=0>y?"":e+t.substring(y+1);!c&&u&&(x=o(x));var b=m.length+x.length+T.length+(E?0:r.length),_=h>b?new Array(b=h-b+1).join(n):"";return E&&(x=o(_+x)),r+=m,t=x+T,("<"===a?r+t+_:">"===a?_+r+t:"^"===a?_.substring(0,b>>=1)+r+t+_.substring(b):r+(E?t:_+t))+i}}}function ke(t){return t+""}function Le(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ne(t,e,i){function n(e){var i=t(e),n=o(i,1);return n-e>e-i?i:n}function r(i){return e(i=t(new el(i-1)),1),i}function o(t,i){return e(t=new el(+t),i),t}function a(t,n,o){var a=r(t),s=[];if(o>1)for(;n>a;)i(a)%o||s.push(new Date(+a)),e(a,1);else for(;n>a;)s.push(new Date(+a)),e(a,1);return s}function s(t,e,i){try{el=Le;var n=new Le;return n._=t,a(n,e,i)}finally{el=Date}}t.floor=t,t.round=n,t.ceil=r,t.offset=o,t.range=a;var l=t.utc=Fe(t);return l.floor=l,l.round=Fe(n),l.ceil=Fe(r),l.offset=Fe(o),l.range=s,t}function Fe(t){return function(e,i){try{el=Le;var n=new Le;return n._=e,t(n,i)._}finally{el=Date}}}function Ie(t){function e(t){function e(e){for(var i,r,o,a=[],s=-1,l=0;++s<n;)37===t.charCodeAt(s)&&(a.push(t.substring(l,s)),null!=(r=nl[i=t.charAt(++s)])&&(i=t.charAt(++s)),(o=S[i])&&(i=o(e,null==r?"e"===i?" ":"0":r)),a.push(i),l=s+1);return a.push(t.substring(l,s)),a.join("")}var n=t.length;return e.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=i(n,t,e,0);if(r!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var o=null!=n.Z&&el!==Le,a=new(o?Le:el);return"j"in n?a.setFullYear(n.y,0,n.j):"w"in n&&("W"in n||"U"in n)?(a.setFullYear(n.y,0,1),a.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(a.getDay()+5)%7:n.w+7*n.U-(a.getDay()+6)%7)):a.setFullYear(n.y,n.m,n.d),a.setHours(n.H+Math.floor(n.Z/100),n.M+n.Z%100,n.S,n.L),o?a._:a},e.toString=function(){return t},e}function i(t,e,i,n){for(var r,o,a,s=0,l=e.length,c=i.length;l>s;){if(n>=c)return-1;if(r=e.charCodeAt(s++),37===r){if(a=e.charAt(s++),o=C[a in nl?e.charAt(s++):a],!o||(n=o(t,i,n))<0)return-1}else if(r!=i.charCodeAt(n++))return-1}return n}function n(t,e,i){b.lastIndex=0;var n=b.exec(e.substring(i));return n?(t.w=_.get(n[0].toLowerCase()),i+n[0].length):-1}function r(t,e,i){x.lastIndex=0;var n=x.exec(e.substring(i));return n?(t.w=T.get(n[0].toLowerCase()),i+n[0].length):-1}function o(t,e,i){H.lastIndex=0;var n=H.exec(e.substring(i));return n?(t.m=M.get(n[0].toLowerCase()),i+n[0].length):-1}function a(t,e,i){w.lastIndex=0;var n=w.exec(e.substring(i));return n?(t.m=R.get(n[0].toLowerCase()),i+n[0].length):-1}function s(t,e,n){return i(t,S.c.toString(),e,n)}function l(t,e,n){return i(t,S.x.toString(),e,n)}function c(t,e,n){return i(t,S.X.toString(),e,n)}function h(t,e,i){var n=y.get(e.substring(i,i+=2).toLowerCase());return null==n?-1:(t.p=n,i)}var u=t.dateTime,f=t.date,d=t.time,p=t.periods,m=t.days,g=t.shortDays,v=t.months,E=t.shortMonths;e.utc=function(t){function i(t){try{el=Le;var e=new el;return e._=t,n(e)}finally{el=Date}}var n=e(t);return i.parse=function(t){try{el=Le;var e=n.parse(t);return e&&e._}finally{el=Date}},i.toString=n.toString,i},e.multi=e.utc.multi=ni;var y=Ga.map(),x=Oe(m),T=Ue(m),b=Oe(g),_=Ue(g),w=Oe(v),R=Ue(v),H=Oe(E),M=Ue(E);p.forEach(function(t,e){y.set(t.toLowerCase(),e)});var S={a:function(t){return g[t.getDay()]},A:function(t){return m[t.getDay()]},b:function(t){return E[t.getMonth()]},B:function(t){return v[t.getMonth()]},c:e(u),d:function(t,e){return ze(t.getDate(),e,2)},e:function(t,e){return ze(t.getDate(),e,2)},H:function(t,e){return ze(t.getHours(),e,2)},I:function(t,e){return ze(t.getHours()%12||12,e,2)},j:function(t,e){return ze(1+tl.dayOfYear(t),e,3)},L:function(t,e){return ze(t.getMilliseconds(),e,3)},m:function(t,e){return ze(t.getMonth()+1,e,2)},M:function(t,e){return ze(t.getMinutes(),e,2)},p:function(t){return p[+(t.getHours()>=12)]},S:function(t,e){return ze(t.getSeconds(),e,2)},U:function(t,e){return ze(tl.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return ze(tl.mondayOfYear(t),e,2)},x:e(f),X:e(d),y:function(t,e){return ze(t.getFullYear()%100,e,2)},Y:function(t,e){return ze(t.getFullYear()%1e4,e,4)},Z:ei,"%":function(){return"%"}},C={a:n,A:r,b:o,B:a,c:s,d:Ke,e:Ke,H:Qe,I:Qe,j:$e,L:ti,m:Ye,M:Ze,p:h,S:Je,U:Ve,w:Be,W:We,x:l,X:c,y:Ge,Y:je,Z:Xe,"%":ii};return e}function ze(t,e,i){var n=0>t?"-":"",r=(n?-t:t)+"",o=r.length;return n+(i>o?new Array(i-o+1).join(e)+r:r)}function Oe(t){return new RegExp("^(?:"+t.map(Ga.requote).join("|")+")","i")}function Ue(t){for(var e=new a,i=-1,n=t.length;++i<n;)e.set(t[i].toLowerCase(),i);return e}function Be(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i,i+1));return n?(t.w=+n[0],i+n[0].length):-1}function Ve(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i));return n?(t.U=+n[0],i+n[0].length):-1}function We(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i));return n?(t.W=+n[0],i+n[0].length):-1}function je(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i,i+4));return n?(t.y=+n[0],i+n[0].length):-1}function Ge(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i,i+2));return n?(t.y=qe(+n[0]),i+n[0].length):-1}function Xe(t,e,i){return/^[+-]\d{4}$/.test(e=e.substring(i,i+5))?(t.Z=-e,i+5):-1}function qe(t){return t+(t>68?1900:2e3)}function Ye(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i,i+2));return n?(t.m=n[0]-1,i+n[0].length):-1}function Ke(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i,i+2));return n?(t.d=+n[0],i+n[0].length):-1}function $e(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i,i+3));return n?(t.j=+n[0],i+n[0].length):-1}function Qe(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i,i+2));return n?(t.H=+n[0],i+n[0].length):-1}function Ze(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i,i+2));return n?(t.M=+n[0],i+n[0].length):-1}function Je(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i,i+2));return n?(t.S=+n[0],i+n[0].length):-1}function ti(t,e,i){rl.lastIndex=0;var n=rl.exec(e.substring(i,i+3));return n?(t.L=+n[0],i+n[0].length):-1}function ei(t){var e=t.getTimezoneOffset(),i=e>0?"-":"+",n=~~(os(e)/60),r=os(e)%60;return i+ze(n,"0",2)+ze(r,"0",2)}function ii(t,e,i){ol.lastIndex=0;var n=ol.exec(e.substring(i,i+1));return n?i+n[0].length:-1}function ni(t){for(var e=t.length,i=-1;++i<e;)t[i][0]=this(t[i][0]);return function(e){for(var i=0,n=t[i];!n[1](e);)n=t[++i];return n[0](e)}}function ri(){}function oi(t,e,i){var n=i.s=t+e,r=n-t,o=n-r;i.t=t-o+(e-r)}function ai(t,e){t&&cl.hasOwnProperty(t.type)&&cl[t.type](t,e)}function si(t,e,i){var n,r=-1,o=t.length-i;for(e.lineStart();++r<o;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function li(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)si(t[i],e,1);e.polygonEnd()}function ci(){function t(t,e){t*=Ss,e=e*Ss/2+_s/4;var i=t-n,a=i>=0?1:-1,s=a*i,l=Math.cos(e),c=Math.sin(e),h=o*c,u=r*l+h*Math.cos(s),f=h*a*Math.sin(s);ul.add(Math.atan2(f,u)),n=t,r=l,o=c}var e,i,n,r,o;fl.point=function(a,s){fl.point=t,n=(e=a)*Ss,r=Math.cos(s=(i=s)*Ss/2+_s/4),o=Math.sin(s)},fl.lineEnd=function(){t(e,i)}}function hi(t){var e=t[0],i=t[1],n=Math.cos(i);return[n*Math.cos(e),n*Math.sin(e),Math.sin(i)]}function ui(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function fi(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function di(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function pi(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function mi(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function gi(t){return[Math.atan2(t[1],t[0]),Q(t[2])]}function vi(t,e){return os(t[0]-e[0])<Hs&&os(t[1]-e[1])<Hs}function Ei(t,e){t*=Ss;var i=Math.cos(e*=Ss);yi(i*Math.cos(t),i*Math.sin(t),Math.sin(e))}function yi(t,e,i){++dl,ml+=(t-ml)/dl,gl+=(e-gl)/dl,vl+=(i-vl)/dl}function xi(){function t(t,r){t*=Ss;var o=Math.cos(r*=Ss),a=o*Math.cos(t),s=o*Math.sin(t),l=Math.sin(r),c=Math.atan2(Math.sqrt((c=i*l-n*s)*c+(c=n*a-e*l)*c+(c=e*s-i*a)*c),e*a+i*s+n*l);pl+=c,El+=c*(e+(e=a)),yl+=c*(i+(i=s)),xl+=c*(n+(n=l)),yi(e,i,n)}var e,i,n;wl.point=function(r,o){r*=Ss;var a=Math.cos(o*=Ss);e=a*Math.cos(r),i=a*Math.sin(r),n=Math.sin(o),wl.point=t,yi(e,i,n)}}function Ti(){wl.point=Ei}function bi(){function t(t,e){t*=Ss;var i=Math.cos(e*=Ss),a=i*Math.cos(t),s=i*Math.sin(t),l=Math.sin(e),c=r*l-o*s,h=o*a-n*l,u=n*s-r*a,f=Math.sqrt(c*c+h*h+u*u),d=n*a+r*s+o*l,p=f&&-K(d)/f,m=Math.atan2(f,d);Tl+=p*c,bl+=p*h,_l+=p*u,pl+=m,El+=m*(n+(n=a)),yl+=m*(r+(r=s)),xl+=m*(o+(o=l)),yi(n,r,o)}var e,i,n,r,o;wl.point=function(a,s){e=a,i=s,wl.point=t,a*=Ss;var l=Math.cos(s*=Ss);n=l*Math.cos(a),r=l*Math.sin(a),o=Math.sin(s),yi(n,r,o)},wl.lineEnd=function(){t(e,i),wl.lineEnd=Ti,wl.point=Ei}}function _i(){return!0}function wi(t,e,i,n,r){var o=[],a=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,i=t[0],n=t[e];if(vi(i,n)){r.lineStart();for(var s=0;e>s;++s)r.point((i=t[s])[0],i[1]);return void r.lineEnd()}var l=new Hi(i,t,null,!0),c=new Hi(i,null,l,!1);l.o=c,o.push(l),a.push(c),l=new Hi(n,t,null,!1),c=new Hi(n,null,l,!0),l.o=c,o.push(l),a.push(c)}}),a.sort(e),Ri(o),Ri(a),o.length){for(var s=0,l=i,c=a.length;c>s;++s)a[s].e=l=!l;for(var h,u,f=o[0];;){for(var d=f,p=!0;d.v;)if((d=d.n)===f)return;
h=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(var s=0,c=h.length;c>s;++s)r.point((u=h[s])[0],u[1]);else n(d.x,d.n.x,1,r);d=d.n}else{if(p){h=d.p.z;for(var s=h.length-1;s>=0;--s)r.point((u=h[s])[0],u[1])}else n(d.x,d.p.x,-1,r);d=d.p}d=d.o,h=d.z,p=!p}while(!d.v);r.lineEnd()}}}function Ri(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function Hi(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function Mi(t,e,i,n){return function(r,o){function a(e,i){var n=r(e,i);t(e=n[0],i=n[1])&&o.point(e,i)}function s(t,e){var i=r(t,e);g.point(i[0],i[1])}function l(){E.point=s,g.lineStart()}function c(){E.point=a,g.lineEnd()}function h(t,e){m.push([t,e]);var i=r(t,e);x.point(i[0],i[1])}function u(){x.lineStart(),m=[]}function f(){h(m[0][0],m[0][1]),x.lineEnd();var t,e=x.clean(),i=y.buffer(),n=i.length;if(m.pop(),p.push(m),m=null,n)if(1&e){t=i[0];var r,n=t.length-1,a=-1;if(n>0){for(T||(o.polygonStart(),T=!0),o.lineStart();++a<n;)o.point((r=t[a])[0],r[1]);o.lineEnd()}}else n>1&&2&e&&i.push(i.pop().concat(i.shift())),d.push(i.filter(Si))}var d,p,m,g=e(o),v=r.invert(n[0],n[1]),E={point:a,lineStart:l,lineEnd:c,polygonStart:function(){E.point=h,E.lineStart=u,E.lineEnd=f,d=[],p=[]},polygonEnd:function(){E.point=a,E.lineStart=l,E.lineEnd=c,d=Ga.merge(d);var t=Di(v,p);d.length?(T||(o.polygonStart(),T=!0),wi(d,Ai,t,i,o)):t&&(T||(o.polygonStart(),T=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),T&&(o.polygonEnd(),T=!1),d=p=null},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd()}},y=Ci(),x=e(y),T=!1;return E}}function Si(t){return t.length>1}function Ci(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,i){t.push([e,i])},lineEnd:m,buffer:function(){var i=e;return e=[],t=null,i},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Ai(t,e){return((t=t.x)[0]<0?t[1]-Rs-Hs:Rs-t[1])-((e=e.x)[0]<0?e[1]-Rs-Hs:Rs-e[1])}function Di(t,e){var i=t[0],n=t[1],r=[Math.sin(i),-Math.cos(i),0],o=0,a=0;ul.reset();for(var s=0,l=e.length;l>s;++s){var c=e[s],h=c.length;if(h)for(var u=c[0],f=u[0],d=u[1]/2+_s/4,p=Math.sin(d),m=Math.cos(d),g=1;;){g===h&&(g=0),t=c[g];var v=t[0],E=t[1]/2+_s/4,y=Math.sin(E),x=Math.cos(E),T=v-f,b=T>=0?1:-1,_=b*T,w=_>_s,R=p*y;if(ul.add(Math.atan2(R*b*Math.sin(_),m*x+R*Math.cos(_))),o+=w?T+b*ws:T,w^f>=i^v>=i){var H=fi(hi(u),hi(t));mi(H);var M=fi(r,H);mi(M);var S=(w^T>=0?-1:1)*Q(M[2]);(n>S||n===S&&(H[0]||H[1]))&&(a+=w^T>=0?1:-1)}if(!g++)break;f=v,p=y,m=x,u=t}}return(-Hs>o||Hs>o&&0>ul)^1&a}function Pi(t){var e,i=0/0,n=0/0,r=0/0;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?_s:-_s,l=os(o-i);os(l-_s)<Hs?(t.point(i,n=(n+a)/2>0?Rs:-Rs),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),t.point(o,n),e=0):r!==s&&l>=_s&&(os(i-r)<Hs&&(i-=r*Hs),os(o-s)<Hs&&(o-=s*Hs),n=ki(i,n,o,a),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),e=0),t.point(i=o,n=a),r=s},lineEnd:function(){t.lineEnd(),i=n=0/0},clean:function(){return 2-e}}}function ki(t,e,i,n){var r,o,a=Math.sin(t-i);return os(a)>Hs?Math.atan((Math.sin(e)*(o=Math.cos(n))*Math.sin(i)-Math.sin(n)*(r=Math.cos(e))*Math.sin(t))/(r*o*a)):(e+n)/2}function Li(t,e,i,n){var r;if(null==t)r=i*Rs,n.point(-_s,r),n.point(0,r),n.point(_s,r),n.point(_s,0),n.point(_s,-r),n.point(0,-r),n.point(-_s,-r),n.point(-_s,0),n.point(-_s,r);else if(os(t[0]-e[0])>Hs){var o=t[0]<e[0]?_s:-_s;r=i*o/2,n.point(-o,r),n.point(0,r),n.point(o,r)}else n.point(e[0],e[1])}function Ni(t){function e(t,e){return Math.cos(t)*Math.cos(e)>o}function i(t){var i,o,l,c,h;return{lineStart:function(){c=l=!1,h=1},point:function(u,f){var d,p=[u,f],m=e(u,f),g=a?m?0:r(u,f):m?r(u+(0>u?_s:-_s),f):0;if(!i&&(c=l=m)&&t.lineStart(),m!==l&&(d=n(i,p),(vi(i,d)||vi(p,d))&&(p[0]+=Hs,p[1]+=Hs,m=e(p[0],p[1]))),m!==l)h=0,m?(t.lineStart(),d=n(p,i),t.point(d[0],d[1])):(d=n(i,p),t.point(d[0],d[1]),t.lineEnd()),i=d;else if(s&&i&&a^m){var v;g&o||!(v=n(p,i,!0))||(h=0,a?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!m||i&&vi(i,p)||t.point(p[0],p[1]),i=p,l=m,o=g},lineEnd:function(){l&&t.lineEnd(),i=null},clean:function(){return h|(c&&l)<<1}}}function n(t,e,i){var n=hi(t),r=hi(e),a=[1,0,0],s=fi(n,r),l=ui(s,s),c=s[0],h=l-c*c;if(!h)return!i&&t;var u=o*l/h,f=-o*c/h,d=fi(a,s),p=pi(a,u),m=pi(s,f);di(p,m);var g=d,v=ui(p,g),E=ui(g,g),y=v*v-E*(ui(p,p)-1);if(!(0>y)){var x=Math.sqrt(y),T=pi(g,(-v-x)/E);if(di(T,p),T=gi(T),!i)return T;var b,_=t[0],w=e[0],R=t[1],H=e[1];_>w&&(b=_,_=w,w=b);var M=w-_,S=os(M-_s)<Hs,C=S||Hs>M;if(!S&&R>H&&(b=R,R=H,H=b),C?S?R+H>0^T[1]<(os(T[0]-_)<Hs?R:H):R<=T[1]&&T[1]<=H:M>_s^(_<=T[0]&&T[0]<=w)){var A=pi(g,(-v+x)/E);return di(A,p),[T,gi(A)]}}}function r(e,i){var n=a?t:_s-t,r=0;return-n>e?r|=1:e>n&&(r|=2),-n>i?r|=4:i>n&&(r|=8),r}var o=Math.cos(t),a=o>0,s=os(o)>Hs,l=hn(t,6*Ss);return Mi(e,i,l,a?[0,-t]:[-_s,t-_s])}function Fi(t,e,i,n){return function(r){var o,a=r.a,s=r.b,l=a.x,c=a.y,h=s.x,u=s.y,f=0,d=1,p=h-l,m=u-c;if(o=t-l,p||!(o>0)){if(o/=p,0>p){if(f>o)return;d>o&&(d=o)}else if(p>0){if(o>d)return;o>f&&(f=o)}if(o=i-l,p||!(0>o)){if(o/=p,0>p){if(o>d)return;o>f&&(f=o)}else if(p>0){if(f>o)return;d>o&&(d=o)}if(o=e-c,m||!(o>0)){if(o/=m,0>m){if(f>o)return;d>o&&(d=o)}else if(m>0){if(o>d)return;o>f&&(f=o)}if(o=n-c,m||!(0>o)){if(o/=m,0>m){if(o>d)return;o>f&&(f=o)}else if(m>0){if(f>o)return;d>o&&(d=o)}return f>0&&(r.a={x:l+f*p,y:c+f*m}),1>d&&(r.b={x:l+d*p,y:c+d*m}),r}}}}}}function Ii(t,e,i,n){function r(n,r){return os(n[0]-t)<Hs?r>0?0:3:os(n[0]-i)<Hs?r>0?2:1:os(n[1]-e)<Hs?r>0?1:0:r>0?3:2}function o(t,e){return a(t.x,e.x)}function a(t,e){var i=r(t,1),n=r(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(s){function l(t){for(var e=0,i=g.length,n=t[1],r=0;i>r;++r)for(var o,a=1,s=g[r],l=s.length,c=s[0];l>a;++a)o=s[a],c[1]<=n?o[1]>n&&Y(c,o,t)>0&&++e:o[1]<=n&&Y(c,o,t)<0&&--e,c=o;return 0!==e}function c(o,s,l,c){var h=0,u=0;if(null==o||(h=r(o,l))!==(u=r(s,l))||a(o,s)<0^l>0){do c.point(0===h||3===h?t:i,h>1?n:e);while((h=(h+l+4)%4)!==u)}else c.point(s[0],s[1])}function h(r,o){return r>=t&&i>=r&&o>=e&&n>=o}function u(t,e){h(t,e)&&s.point(t,e)}function f(){C.point=p,g&&g.push(v=[]),w=!0,_=!1,T=b=0/0}function d(){m&&(p(E,y),x&&_&&M.rejoin(),m.push(M.buffer())),C.point=u,_&&s.lineEnd()}function p(t,e){t=Math.max(-Hl,Math.min(Hl,t)),e=Math.max(-Hl,Math.min(Hl,e));var i=h(t,e);if(g&&v.push([t,e]),w)E=t,y=e,x=i,w=!1,i&&(s.lineStart(),s.point(t,e));else if(i&&_)s.point(t,e);else{var n={a:{x:T,y:b},b:{x:t,y:e}};S(n)?(_||(s.lineStart(),s.point(n.a.x,n.a.y)),s.point(n.b.x,n.b.y),i||s.lineEnd(),R=!1):i&&(s.lineStart(),s.point(t,e),R=!1)}T=t,b=e,_=i}var m,g,v,E,y,x,T,b,_,w,R,H=s,M=Ci(),S=Fi(t,e,i,n),C={point:u,lineStart:f,lineEnd:d,polygonStart:function(){s=M,m=[],g=[],R=!0},polygonEnd:function(){s=H,m=Ga.merge(m);var e=l([t,n]),i=R&&e,r=m.length;(i||r)&&(s.polygonStart(),i&&(s.lineStart(),c(null,null,1,s),s.lineEnd()),r&&wi(m,o,e,c,s),s.polygonEnd()),m=g=v=null}};return C}}function zi(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return i=e.invert(i,n),i&&t.invert(i[0],i[1])}),i}function Oi(t){var e=0,i=_s/3,n=en(t),r=n(e,i);return r.parallels=function(t){return arguments.length?n(e=t[0]*_s/180,i=t[1]*_s/180):[180*(e/_s),180*(i/_s)]},r}function Ui(t,e){function i(t,e){var i=Math.sqrt(o-2*r*Math.sin(e))/r;return[i*Math.sin(t*=r),a-i*Math.cos(t)]}var n=Math.sin(t),r=(n+Math.sin(e))/2,o=1+n*(2*r-n),a=Math.sqrt(o)/r;return i.invert=function(t,e){var i=a-e;return[Math.atan2(t,i)/r,Q((o-(t*t+i*i)*r*r)/(2*r))]},i}function Bi(){function t(t,e){Sl+=r*t-n*e,n=t,r=e}var e,i,n,r;kl.point=function(o,a){kl.point=t,e=n=o,i=r=a},kl.lineEnd=function(){t(e,i)}}function Vi(t,e){Cl>t&&(Cl=t),t>Dl&&(Dl=t),Al>e&&(Al=e),e>Pl&&(Pl=e)}function Wi(){function t(t,e){a.push("M",t,",",e,o)}function e(t,e){a.push("M",t,",",e),s.point=i}function i(t,e){a.push("L",t,",",e)}function n(){s.point=t}function r(){a.push("Z")}var o=ji(4.5),a=[],s={point:t,lineStart:function(){s.point=e},lineEnd:n,polygonStart:function(){s.lineEnd=r},polygonEnd:function(){s.lineEnd=n,s.point=t},pointRadius:function(t){return o=ji(t),s},result:function(){if(a.length){var t=a.join("");return a=[],t}}};return s}function ji(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Gi(t,e){ml+=t,gl+=e,++vl}function Xi(){function t(t,n){var r=t-e,o=n-i,a=Math.sqrt(r*r+o*o);El+=a*(e+t)/2,yl+=a*(i+n)/2,xl+=a,Gi(e=t,i=n)}var e,i;Nl.point=function(n,r){Nl.point=t,Gi(e=n,i=r)}}function qi(){Nl.point=Gi}function Yi(){function t(t,e){var i=t-n,o=e-r,a=Math.sqrt(i*i+o*o);El+=a*(n+t)/2,yl+=a*(r+e)/2,xl+=a,a=r*t-n*e,Tl+=a*(n+t),bl+=a*(r+e),_l+=3*a,Gi(n=t,r=e)}var e,i,n,r;Nl.point=function(o,a){Nl.point=t,Gi(e=n=o,i=r=a)},Nl.lineEnd=function(){t(e,i)}}function Ki(t){function e(e,i){t.moveTo(e,i),t.arc(e,i,a,0,ws)}function i(e,i){t.moveTo(e,i),s.point=n}function n(e,i){t.lineTo(e,i)}function r(){s.point=e}function o(){t.closePath()}var a=4.5,s={point:e,lineStart:function(){s.point=i},lineEnd:r,polygonStart:function(){s.lineEnd=o},polygonEnd:function(){s.lineEnd=r,s.point=e},pointRadius:function(t){return a=t,s},result:m};return s}function $i(t){function e(t){return(s?n:i)(t)}function i(e){return Ji(e,function(i,n){i=t(i,n),e.point(i[0],i[1])})}function n(e){function i(i,n){i=t(i,n),e.point(i[0],i[1])}function n(){y=0/0,w.point=o,e.lineStart()}function o(i,n){var o=hi([i,n]),a=t(i,n);r(y,x,E,T,b,_,y=a[0],x=a[1],E=i,T=o[0],b=o[1],_=o[2],s,e),e.point(y,x)}function a(){w.point=i,e.lineEnd()}function l(){n(),w.point=c,w.lineEnd=h}function c(t,e){o(u=t,f=e),d=y,p=x,m=T,g=b,v=_,w.point=o}function h(){r(y,x,E,T,b,_,d,p,u,m,g,v,s,e),w.lineEnd=a,a()}var u,f,d,p,m,g,v,E,y,x,T,b,_,w={point:i,lineStart:n,lineEnd:a,polygonStart:function(){e.polygonStart(),w.lineStart=l},polygonEnd:function(){e.polygonEnd(),w.lineStart=n}};return w}function r(e,i,n,s,l,c,h,u,f,d,p,m,g,v){var E=h-e,y=u-i,x=E*E+y*y;if(x>4*o&&g--){var T=s+d,b=l+p,_=c+m,w=Math.sqrt(T*T+b*b+_*_),R=Math.asin(_/=w),H=os(os(_)-1)<Hs||os(n-f)<Hs?(n+f)/2:Math.atan2(b,T),M=t(H,R),S=M[0],C=M[1],A=S-e,D=C-i,P=y*A-E*D;(P*P/x>o||os((E*A+y*D)/x-.5)>.3||a>s*d+l*p+c*m)&&(r(e,i,n,s,l,c,S,C,H,T/=w,b/=w,_,g,v),v.point(S,C),r(S,C,H,T,b,_,h,u,f,d,p,m,g,v))}}var o=.5,a=Math.cos(30*Ss),s=16;return e.precision=function(t){return arguments.length?(s=(o=t*t)>0&&16,e):Math.sqrt(o)},e}function Qi(t){var e=$i(function(e,i){return t([e*Cs,i*Cs])});return function(t){return nn(e(t))}}function Zi(t){this.stream=t}function Ji(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function tn(t){return en(function(){return t})()}function en(t){function e(t){return t=s(t[0]*Ss,t[1]*Ss),[t[0]*f+l,c-t[1]*f]}function i(t){return t=s.invert((t[0]-l)/f,(c-t[1])/f),t&&[t[0]*Cs,t[1]*Cs]}function n(){s=zi(a=an(v,E,y),o);var t=o(m,g);return l=d-t[0]*f,c=p+t[1]*f,r()}function r(){return h&&(h.valid=!1,h=null),e}var o,a,s,l,c,h,u=$i(function(t,e){return t=o(t,e),[t[0]*f+l,c-t[1]*f]}),f=150,d=480,p=250,m=0,g=0,v=0,E=0,y=0,x=Rl,T=_e,b=null,_=null;return e.stream=function(t){return h&&(h.valid=!1),h=nn(x(a,u(T(t)))),h.valid=!0,h},e.clipAngle=function(t){return arguments.length?(x=null==t?(b=t,Rl):Ni((b=+t)*Ss),r()):b},e.clipExtent=function(t){return arguments.length?(_=t,T=t?Ii(t[0][0],t[0][1],t[1][0],t[1][1]):_e,r()):_},e.scale=function(t){return arguments.length?(f=+t,n()):f},e.translate=function(t){return arguments.length?(d=+t[0],p=+t[1],n()):[d,p]},e.center=function(t){return arguments.length?(m=t[0]%360*Ss,g=t[1]%360*Ss,n()):[m*Cs,g*Cs]},e.rotate=function(t){return arguments.length?(v=t[0]%360*Ss,E=t[1]%360*Ss,y=t.length>2?t[2]%360*Ss:0,n()):[v*Cs,E*Cs,y*Cs]},Ga.rebind(e,u,"precision"),function(){return o=t.apply(this,arguments),e.invert=o.invert&&i,n()}}function nn(t){return Ji(t,function(e,i){t.point(e*Ss,i*Ss)})}function rn(t,e){return[t,e]}function on(t,e){return[t>_s?t-ws:-_s>t?t+ws:t,e]}function an(t,e,i){return t?e||i?zi(ln(t),cn(e,i)):ln(t):e||i?cn(e,i):on}function sn(t){return function(e,i){return e+=t,[e>_s?e-ws:-_s>e?e+ws:e,i]}}function ln(t){var e=sn(t);return e.invert=sn(-t),e}function cn(t,e){function i(t,e){var i=Math.cos(e),s=Math.cos(t)*i,l=Math.sin(t)*i,c=Math.sin(e),h=c*n+s*r;return[Math.atan2(l*o-h*a,s*n-c*r),Q(h*o+l*a)]}var n=Math.cos(t),r=Math.sin(t),o=Math.cos(e),a=Math.sin(e);return i.invert=function(t,e){var i=Math.cos(e),s=Math.cos(t)*i,l=Math.sin(t)*i,c=Math.sin(e),h=c*o-l*a;return[Math.atan2(l*o+c*a,s*n+h*r),Q(h*n-s*r)]},i}function hn(t,e){var i=Math.cos(t),n=Math.sin(t);return function(r,o,a,s){var l=a*e;null!=r?(r=un(i,r),o=un(i,o),(a>0?o>r:r>o)&&(r+=a*ws)):(r=t+a*ws,o=t-.5*l);for(var c,h=r;a>0?h>o:o>h;h-=l)s.point((c=gi([i,-n*Math.cos(h),-n*Math.sin(h)]))[0],c[1])}}function un(t,e){var i=hi(e);i[0]-=t,mi(i);var n=K(-i[1]);return((-i[2]<0?-n:n)+2*Math.PI-Hs)%(2*Math.PI)}function fn(t,e,i){var n=Ga.range(t,e-Hs,i).concat(e);return function(t){return n.map(function(e){return[t,e]})}}function dn(t,e,i){var n=Ga.range(t,e-Hs,i).concat(e);return function(t){return n.map(function(e){return[e,t]})}}function pn(t){return t.source}function mn(t){return t.target}function gn(t,e,i,n){var r=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),l=r*Math.cos(t),c=r*Math.sin(t),h=a*Math.cos(i),u=a*Math.sin(i),f=2*Math.asin(Math.sqrt(ee(n-e)+r*a*ee(i-t))),d=1/Math.sin(f),p=f?function(t){var e=Math.sin(t*=f)*d,i=Math.sin(f-t)*d,n=i*l+e*h,r=i*c+e*u,a=i*o+e*s;return[Math.atan2(r,n)*Cs,Math.atan2(a,Math.sqrt(n*n+r*r))*Cs]}:function(){return[t*Cs,e*Cs]};return p.distance=f,p}function vn(){function t(t,r){var o=Math.sin(r*=Ss),a=Math.cos(r),s=os((t*=Ss)-e),l=Math.cos(s);Fl+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=n*o-i*a*l)*s),i*o+n*a*l),e=t,i=o,n=a}var e,i,n;Il.point=function(r,o){e=r*Ss,i=Math.sin(o*=Ss),n=Math.cos(o),Il.point=t},Il.lineEnd=function(){Il.point=Il.lineEnd=m}}function En(t,e){function i(e,i){var n=Math.cos(e),r=Math.cos(i),o=t(n*r);return[o*r*Math.sin(e),o*Math.sin(i)]}return i.invert=function(t,i){var n=Math.sqrt(t*t+i*i),r=e(n),o=Math.sin(r),a=Math.cos(r);return[Math.atan2(t*o,n*a),Math.asin(n&&i*o/n)]},i}function yn(t,e){function i(t,e){a>0?-Rs+Hs>e&&(e=-Rs+Hs):e>Rs-Hs&&(e=Rs-Hs);var i=a/Math.pow(r(e),o);return[i*Math.sin(o*t),a-i*Math.cos(o*t)]}var n=Math.cos(t),r=function(t){return Math.tan(_s/4+t/2)},o=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(r(e)/r(t)),a=n*Math.pow(r(t),o)/o;return o?(i.invert=function(t,e){var i=a-e,n=q(o)*Math.sqrt(t*t+i*i);return[Math.atan2(t,i)/o,2*Math.atan(Math.pow(a/n,1/o))-Rs]},i):Tn}function xn(t,e){function i(t,e){var i=o-e;return[i*Math.sin(r*t),o-i*Math.cos(r*t)]}var n=Math.cos(t),r=t===e?Math.sin(t):(n-Math.cos(e))/(e-t),o=n/r+t;return os(r)<Hs?rn:(i.invert=function(t,e){var i=o-e;return[Math.atan2(t,i)/r,o-q(r)*Math.sqrt(t*t+i*i)]},i)}function Tn(t,e){return[t,Math.log(Math.tan(_s/4+e/2))]}function bn(t){var e,i=tn(t),n=i.scale,r=i.translate,o=i.clipExtent;return i.scale=function(){var t=n.apply(i,arguments);return t===i?e?i.clipExtent(null):i:t},i.translate=function(){var t=r.apply(i,arguments);return t===i?e?i.clipExtent(null):i:t},i.clipExtent=function(t){var a=o.apply(i,arguments);if(a===i){if(e=null==t){var s=_s*n(),l=r();o([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else e&&(a=null);return a},i.clipExtent(null)}function _n(t,e){return[Math.log(Math.tan(_s/4+e/2)),-t]}function wn(t){return t[0]}function Rn(t){return t[1]}function Hn(t){for(var e=t.length,i=[0,1],n=2,r=2;e>r;r++){for(;n>1&&Y(t[i[n-2]],t[i[n-1]],t[r])<=0;)--n;i[n++]=r}return i.slice(0,n)}function Mn(t,e){return t[0]-e[0]||t[1]-e[1]}function Sn(t,e,i){return(i[0]-e[0])*(t[1]-e[1])<(i[1]-e[1])*(t[0]-e[0])}function Cn(t,e,i,n){var r=t[0],o=i[0],a=e[0]-r,s=n[0]-o,l=t[1],c=i[1],h=e[1]-l,u=n[1]-c,f=(s*(l-c)-u*(r-o))/(u*a-s*h);return[r+f*a,l+f*h]}function An(t){var e=t[0],i=t[t.length-1];return!(e[0]-i[0]||e[1]-i[1])}function Dn(){Zn(this),this.edge=this.site=this.circle=null}function Pn(t){var e=Kl.pop()||new Dn;return e.site=t,e}function kn(t){Wn(t),Xl.remove(t),Kl.push(t),Zn(t)}function Ln(t){var e=t.circle,i=e.x,n=e.cy,r={x:i,y:n},o=t.P,a=t.N,s=[t];kn(t);for(var l=o;l.circle&&os(i-l.circle.x)<Hs&&os(n-l.circle.cy)<Hs;)o=l.P,s.unshift(l),kn(l),l=o;s.unshift(l),Wn(l);for(var c=a;c.circle&&os(i-c.circle.x)<Hs&&os(n-c.circle.cy)<Hs;)a=c.N,s.push(c),kn(c),c=a;s.push(c),Wn(c);var h,u=s.length;for(h=1;u>h;++h)c=s[h],l=s[h-1],Kn(c.edge,l.site,c.site,r);l=s[0],c=s[u-1],c.edge=qn(l.site,c.site,null,r),Vn(l),Vn(c)}function Nn(t){for(var e,i,n,r,o=t.x,a=t.y,s=Xl._;s;)if(n=Fn(s,a)-o,n>Hs)s=s.L;else{if(r=o-In(s,a),!(r>Hs)){n>-Hs?(e=s.P,i=s):r>-Hs?(e=s,i=s.N):e=i=s;break}if(!s.R){e=s;break}s=s.R}var l=Pn(t);if(Xl.insert(e,l),e||i){if(e===i)return Wn(e),i=Pn(e.site),Xl.insert(l,i),l.edge=i.edge=qn(e.site,l.site),Vn(e),void Vn(i);if(!i)return void(l.edge=qn(e.site,l.site));Wn(e),Wn(i);var c=e.site,h=c.x,u=c.y,f=t.x-h,d=t.y-u,p=i.site,m=p.x-h,g=p.y-u,v=2*(f*g-d*m),E=f*f+d*d,y=m*m+g*g,x={x:(g*E-d*y)/v+h,y:(f*y-m*E)/v+u};Kn(i.edge,c,p,x),l.edge=qn(c,t,null,x),i.edge=qn(t,p,null,x),Vn(e),Vn(i)}}function Fn(t,e){var i=t.site,n=i.x,r=i.y,o=r-e;if(!o)return n;var a=t.P;if(!a)return-1/0;i=a.site;var s=i.x,l=i.y,c=l-e;if(!c)return s;var h=s-n,u=1/o-1/c,f=h/c;return u?(-f+Math.sqrt(f*f-2*u*(h*h/(-2*c)-l+c/2+r-o/2)))/u+n:(n+s)/2}function In(t,e){var i=t.N;if(i)return Fn(i,e);var n=t.site;return n.y===e?n.x:1/0}function zn(t){this.site=t,this.edges=[]}function On(t){for(var e,i,n,r,o,a,s,l,c,h,u=t[0][0],f=t[1][0],d=t[0][1],p=t[1][1],m=Gl,g=m.length;g--;)if(o=m[g],o&&o.prepare())for(s=o.edges,l=s.length,a=0;l>a;)h=s[a].end(),n=h.x,r=h.y,c=s[++a%l].start(),e=c.x,i=c.y,(os(n-e)>Hs||os(r-i)>Hs)&&(s.splice(a,0,new $n(Yn(o.site,h,os(n-u)<Hs&&p-r>Hs?{x:u,y:os(e-u)<Hs?i:p}:os(r-p)<Hs&&f-n>Hs?{x:os(i-p)<Hs?e:f,y:p}:os(n-f)<Hs&&r-d>Hs?{x:f,y:os(e-f)<Hs?i:d}:os(r-d)<Hs&&n-u>Hs?{x:os(i-d)<Hs?e:u,y:d}:null),o.site,null)),++l)}function Un(t,e){return e.angle-t.angle}function Bn(){Zn(this),this.x=this.y=this.arc=this.site=this.cy=null}function Vn(t){var e=t.P,i=t.N;if(e&&i){var n=e.site,r=t.site,o=i.site;if(n!==o){var a=r.x,s=r.y,l=n.x-a,c=n.y-s,h=o.x-a,u=o.y-s,f=2*(l*u-c*h);if(!(f>=-Ms)){var d=l*l+c*c,p=h*h+u*u,m=(u*d-c*p)/f,g=(l*p-h*d)/f,u=g+s,v=$l.pop()||new Bn;v.arc=t,v.site=r,v.x=m+a,v.y=u+Math.sqrt(m*m+g*g),v.cy=u,t.circle=v;for(var E=null,y=Yl._;y;)if(v.y<y.y||v.y===y.y&&v.x<=y.x){if(!y.L){E=y.P;break}y=y.L}else{if(!y.R){E=y;break}y=y.R}Yl.insert(E,v),E||(ql=v)}}}}function Wn(t){var e=t.circle;e&&(e.P||(ql=e.N),Yl.remove(e),$l.push(e),Zn(e),t.circle=null)}function jn(t){for(var e,i=jl,n=Fi(t[0][0],t[0][1],t[1][0],t[1][1]),r=i.length;r--;)e=i[r],(!Gn(e,t)||!n(e)||os(e.a.x-e.b.x)<Hs&&os(e.a.y-e.b.y)<Hs)&&(e.a=e.b=null,i.splice(r,1))}function Gn(t,e){var i=t.b;if(i)return!0;var n,r,o=t.a,a=e[0][0],s=e[1][0],l=e[0][1],c=e[1][1],h=t.l,u=t.r,f=h.x,d=h.y,p=u.x,m=u.y,g=(f+p)/2,v=(d+m)/2;if(m===d){if(a>g||g>=s)return;if(f>p){if(o){if(o.y>=c)return}else o={x:g,y:l};i={x:g,y:c}}else{if(o){if(o.y<l)return}else o={x:g,y:c};i={x:g,y:l}}}else if(n=(f-p)/(m-d),r=v-n*g,-1>n||n>1)if(f>p){if(o){if(o.y>=c)return}else o={x:(l-r)/n,y:l};i={x:(c-r)/n,y:c}}else{if(o){if(o.y<l)return}else o={x:(c-r)/n,y:c};i={x:(l-r)/n,y:l}}else if(m>d){if(o){if(o.x>=s)return}else o={x:a,y:n*a+r};i={x:s,y:n*s+r}}else{if(o){if(o.x<a)return}else o={x:s,y:n*s+r};i={x:a,y:n*a+r}}return t.a=o,t.b=i,!0}function Xn(t,e){this.l=t,this.r=e,this.a=this.b=null}function qn(t,e,i,n){var r=new Xn(t,e);return jl.push(r),i&&Kn(r,t,e,i),n&&Kn(r,e,t,n),Gl[t.i].edges.push(new $n(r,t,e)),Gl[e.i].edges.push(new $n(r,e,t)),r}function Yn(t,e,i){var n=new Xn(t,null);return n.a=e,n.b=i,jl.push(n),n}function Kn(t,e,i,n){t.a||t.b?t.l===i?t.b=n:t.a=n:(t.a=n,t.l=e,t.r=i)}function $n(t,e,i){var n=t.a,r=t.b;this.edge=t,this.site=e,this.angle=i?Math.atan2(i.y-e.y,i.x-e.x):t.l===e?Math.atan2(r.x-n.x,n.y-r.y):Math.atan2(n.x-r.x,r.y-n.y)}function Qn(){this._=null}function Zn(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Jn(t,e){var i=e,n=e.R,r=i.U;r?r.L===i?r.L=n:r.R=n:t._=n,n.U=r,i.U=n,i.R=n.L,i.R&&(i.R.U=i),n.L=i}function tr(t,e){var i=e,n=e.L,r=i.U;r?r.L===i?r.L=n:r.R=n:t._=n,n.U=r,i.U=n,i.L=n.R,i.L&&(i.L.U=i),n.R=i}function er(t){for(;t.L;)t=t.L;return t}function ir(t,e){var i,n,r,o=t.sort(nr).pop();for(jl=[],Gl=new Array(t.length),Xl=new Qn,Yl=new Qn;;)if(r=ql,o&&(!r||o.y<r.y||o.y===r.y&&o.x<r.x))(o.x!==i||o.y!==n)&&(Gl[o.i]=new zn(o),Nn(o),i=o.x,n=o.y),o=t.pop();else{if(!r)break;Ln(r.arc)}e&&(jn(e),On(e));var a={cells:Gl,edges:jl};return Xl=Yl=jl=Gl=null,a}function nr(t,e){return e.y-t.y||e.x-t.x}function rr(t,e,i){return(t.x-i.x)*(e.y-t.y)-(t.x-e.x)*(i.y-t.y)}function or(t){return t.x}function ar(t){return t.y}function sr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function lr(t,e,i,n,r,o){if(!t(e,i,n,r,o)){var a=.5*(i+r),s=.5*(n+o),l=e.nodes;l[0]&&lr(t,l[0],i,n,a,s),l[1]&&lr(t,l[1],a,n,r,s),l[2]&&lr(t,l[2],i,s,a,o),l[3]&&lr(t,l[3],a,s,r,o)}}function cr(t,e){t=Ga.rgb(t),e=Ga.rgb(e);var i=t.r,n=t.g,r=t.b,o=e.r-i,a=e.g-n,s=e.b-r;return function(t){return"#"+ge(Math.round(i+o*t))+ge(Math.round(n+a*t))+ge(Math.round(r+s*t))}}function hr(t,e){var i,n={},r={};for(i in t)i in e?n[i]=dr(t[i],e[i]):r[i]=t[i];for(i in e)i in t||(r[i]=e[i]);return function(t){for(i in n)r[i]=n[i](t);return r}}function ur(t,e){return e-=t=+t,function(i){return t+e*i}}function fr(t,e){var i,n,r,o=Zl.lastIndex=Jl.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(i=Zl.exec(t))&&(n=Jl.exec(e));)(r=n.index)>o&&(r=e.substring(o,r),s[a]?s[a]+=r:s[++a]=r),(i=i[0])===(n=n[0])?s[a]?s[a]+=n:s[++a]=n:(s[++a]=null,l.push({i:a,x:ur(i,n)})),o=Jl.lastIndex;return o<e.length&&(r=e.substring(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var i,n=0;e>n;++n)s[(i=l[n]).i]=i.x(t);return s.join("")})}function dr(t,e){for(var i,n=Ga.interpolators.length;--n>=0&&!(i=Ga.interpolators[n](t,e)););return i}function pr(t,e){var i,n=[],r=[],o=t.length,a=e.length,s=Math.min(t.length,e.length);for(i=0;s>i;++i)n.push(dr(t[i],e[i]));for(;o>i;++i)r[i]=t[i];for(;a>i;++i)r[i]=e[i];return function(t){for(i=0;s>i;++i)r[i]=n[i](t);return r}}function mr(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function gr(t){return function(e){return 1-t(1-e)}}function vr(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function Er(t){return t*t}function yr(t){return t*t*t}function xr(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,i=e*t;return 4*(.5>t?i:3*(t-e)+i-.75)}function Tr(t){return function(e){return Math.pow(e,t)}}function br(t){return 1-Math.cos(t*Rs)}function _r(t){return Math.pow(2,10*(t-1))}function wr(t){return 1-Math.sqrt(1-t*t)}function Rr(t,e){var i;return arguments.length<2&&(e=.45),arguments.length?i=e/ws*Math.asin(1/t):(t=1,i=e/4),function(n){return 1+t*Math.pow(2,-10*n)*Math.sin((n-i)*ws/e)}}function Hr(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Mr(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Sr(t,e){t=Ga.hcl(t),e=Ga.hcl(e);var i=t.h,n=t.c,r=t.l,o=e.h-i,a=e.c-n,s=e.l-r;return isNaN(a)&&(a=0,n=isNaN(n)?e.c:n),isNaN(o)?(o=0,i=isNaN(i)?e.h:i):o>180?o-=360:-180>o&&(o+=360),function(t){return ae(i+o*t,n+a*t,r+s*t)+""}}function Cr(t,e){t=Ga.hsl(t),e=Ga.hsl(e);var i=t.h,n=t.s,r=t.l,o=e.h-i,a=e.s-n,s=e.l-r;return isNaN(a)&&(a=0,n=isNaN(n)?e.s:n),isNaN(o)?(o=0,i=isNaN(i)?e.h:i):o>180?o-=360:-180>o&&(o+=360),function(t){return re(i+o*t,n+a*t,r+s*t)+""}}function Ar(t,e){t=Ga.lab(t),e=Ga.lab(e);var i=t.l,n=t.a,r=t.b,o=e.l-i,a=e.a-n,s=e.b-r;return function(t){return le(i+o*t,n+a*t,r+s*t)+""}}function Dr(t,e){return e-=t,function(i){return Math.round(t+e*i)}}function Pr(t){var e=[t.a,t.b],i=[t.c,t.d],n=Lr(e),r=kr(e,i),o=Lr(Nr(i,e,-r))||0;e[0]*i[1]<i[0]*e[1]&&(e[0]*=-1,e[1]*=-1,n*=-1,r*=-1),this.rotate=(n?Math.atan2(e[1],e[0]):Math.atan2(-i[0],i[1]))*Cs,this.translate=[t.e,t.f],this.scale=[n,o],this.skew=o?Math.atan2(r,o)*Cs:0}function kr(t,e){return t[0]*e[0]+t[1]*e[1]}function Lr(t){var e=Math.sqrt(kr(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Nr(t,e,i){return t[0]+=i*e[0],t[1]+=i*e[1],t}function Fr(t,e){var i,n=[],r=[],o=Ga.transform(t),a=Ga.transform(e),s=o.translate,l=a.translate,c=o.rotate,h=a.rotate,u=o.skew,f=a.skew,d=o.scale,p=a.scale;return s[0]!=l[0]||s[1]!=l[1]?(n.push("translate(",null,",",null,")"),r.push({i:1,x:ur(s[0],l[0])},{i:3,x:ur(s[1],l[1])})):n.push(l[0]||l[1]?"translate("+l+")":""),c!=h?(c-h>180?h+=360:h-c>180&&(c+=360),r.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:ur(c,h)})):h&&n.push(n.pop()+"rotate("+h+")"),u!=f?r.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:ur(u,f)}):f&&n.push(n.pop()+"skewX("+f+")"),d[0]!=p[0]||d[1]!=p[1]?(i=n.push(n.pop()+"scale(",null,",",null,")"),r.push({i:i-4,x:ur(d[0],p[0])},{i:i-2,x:ur(d[1],p[1])})):(1!=p[0]||1!=p[1])&&n.push(n.pop()+"scale("+p+")"),i=r.length,function(t){for(var e,o=-1;++o<i;)n[(e=r[o]).i]=e.x(t);return n.join("")}}function Ir(t,e){return e=e-(t=+t)?1/(e-t):0,function(i){return(i-t)*e}}function zr(t,e){return e=e-(t=+t)?1/(e-t):0,function(i){return Math.max(0,Math.min(1,(i-t)*e))}}function Or(t){for(var e=t.source,i=t.target,n=Br(e,i),r=[e];e!==n;)e=e.parent,r.push(e);for(var o=r.length;i!==n;)r.splice(o,0,i),i=i.parent;return r}function Ur(t){for(var e=[],i=t.parent;null!=i;)e.push(t),t=i,i=i.parent;return e.push(t),e}function Br(t,e){if(t===e)return t;for(var i=Ur(t),n=Ur(e),r=i.pop(),o=n.pop(),a=null;r===o;)a=r,r=i.pop(),o=n.pop();return a}function Vr(t){t.fixed|=2}function Wr(t){t.fixed&=-7}function jr(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Gr(t){t.fixed&=-5}function Xr(t,e,i){var n=0,r=0;if(t.charge=0,!t.leaf)for(var o,a=t.nodes,s=a.length,l=-1;++l<s;)o=a[l],null!=o&&(Xr(o,e,i),t.charge+=o.charge,n+=o.charge*o.cx,r+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var c=e*i[t.point.index];t.charge+=t.pointCharge=c,n+=c*t.point.x,r+=c*t.point.y}t.cx=n/t.charge,t.cy=r/t.charge}function qr(t,e){return Ga.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=Jr,t}function Yr(t,e){for(var i=[t];null!=(t=i.pop());)if(e(t),(r=t.children)&&(n=r.length))for(var n,r;--n>=0;)i.push(r[n])}function Kr(t,e){for(var i=[t],n=[];null!=(t=i.pop());)if(n.push(t),(o=t.children)&&(r=o.length))for(var r,o,a=-1;++a<r;)i.push(o[a]);for(;null!=(t=n.pop());)e(t)}function $r(t){return t.children}function Qr(t){return t.value}function Zr(t,e){return e.value-t.value}function Jr(t){return Ga.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function to(t){return t.x}function eo(t){return t.y}function io(t,e,i){t.y0=e,t.y=i}function no(t){return Ga.range(t.length)}function ro(t){for(var e=-1,i=t[0].length,n=[];++e<i;)n[e]=0;return n}function oo(t){for(var e,i=1,n=0,r=t[0][1],o=t.length;o>i;++i)(e=t[i][1])>r&&(n=i,r=e);return n}function ao(t){return t.reduce(so,0)}function so(t,e){return t+e[1]}function lo(t,e){return co(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function co(t,e){for(var i=-1,n=+t[0],r=(t[1]-n)/e,o=[];++i<=e;)o[i]=r*i+n;return o}function ho(t){return[Ga.min(t),Ga.max(t)]}function uo(t,e){return t.value-e.value}function fo(t,e){var i=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=i,i._pack_prev=e}function po(t,e){t._pack_next=e,e._pack_prev=t}function mo(t,e){var i=e.x-t.x,n=e.y-t.y,r=t.r+e.r;return.999*r*r>i*i+n*n}function go(t){function e(t){h=Math.min(t.x-t.r,h),u=Math.max(t.x+t.r,u),f=Math.min(t.y-t.r,f),d=Math.max(t.y+t.r,d)}if((i=t.children)&&(c=i.length)){var i,n,r,o,a,s,l,c,h=1/0,u=-1/0,f=1/0,d=-1/0;if(i.forEach(vo),n=i[0],n.x=-n.r,n.y=0,e(n),c>1&&(r=i[1],r.x=r.r,r.y=0,e(r),c>2))for(o=i[2],xo(n,r,o),e(o),fo(n,o),n._pack_prev=o,fo(o,r),r=n._pack_next,a=3;c>a;a++){xo(n,r,o=i[a]);var p=0,m=1,g=1;for(s=r._pack_next;s!==r;s=s._pack_next,m++)if(mo(s,o)){p=1;break}if(1==p)for(l=n._pack_prev;l!==s._pack_prev&&!mo(l,o);l=l._pack_prev,g++);p?(g>m||m==g&&r.r<n.r?po(n,r=s):po(n=l,r),a--):(fo(n,o),r=o,e(o))}var v=(h+u)/2,E=(f+d)/2,y=0;for(a=0;c>a;a++)o=i[a],o.x-=v,o.y-=E,y=Math.max(y,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=y,i.forEach(Eo)}}function vo(t){t._pack_next=t._pack_prev=t}function Eo(t){delete t._pack_next,delete t._pack_prev}function yo(t,e,i,n){var r=t.children;if(t.x=e+=n*t.x,t.y=i+=n*t.y,t.r*=n,r)for(var o=-1,a=r.length;++o<a;)yo(r[o],e,i,n)}function xo(t,e,i){var n=t.r+i.r,r=e.x-t.x,o=e.y-t.y;if(n&&(r||o)){var a=e.r+i.r,s=r*r+o*o;a*=a,n*=n;var l=.5+(n-a)/(2*s),c=Math.sqrt(Math.max(0,2*a*(n+s)-(n-=s)*n-a*a))/(2*s);i.x=t.x+l*r+c*o,i.y=t.y+l*o-c*r}else i.x=t.x+n,i.y=t.y}function To(t,e){return t.parent==e.parent?1:2}function bo(t){var e=t.children;return e.length?e[0]:t.t}function _o(t){var e,i=t.children;return(e=i.length)?i[e-1]:t.t}function wo(t,e,i){var n=i/(e.i-t.i);e.c-=n,e.s+=i,t.c+=n,e.z+=i,e.m+=i}function Ro(t){for(var e,i=0,n=0,r=t.children,o=r.length;--o>=0;)e=r[o],e.z+=i,e.m+=i,i+=e.s+(n+=e.c)}function Ho(t,e,i){return t.a.parent===e.parent?t.a:i}function Mo(t){return 1+Ga.max(t,function(t){return t.y})}function So(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Co(t){var e=t.children;return e&&e.length?Co(e[0]):t}function Ao(t){var e,i=t.children;return i&&(e=i.length)?Ao(i[e-1]):t}function Do(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Po(t,e){var i=t.x+e[3],n=t.y+e[0],r=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return 0>r&&(i+=r/2,r=0),0>o&&(n+=o/2,o=0),{x:i,y:n,dx:r,dy:o}}function ko(t){var e=t[0],i=t[t.length-1];return i>e?[e,i]:[i,e]}function Lo(t){return t.rangeExtent?t.rangeExtent():ko(t.range())}function No(t,e,i,n){var r=i(t[0],t[1]),o=n(e[0],e[1]);return function(t){return o(r(t))}}function Fo(t,e){var i,n=0,r=t.length-1,o=t[n],a=t[r];return o>a&&(i=n,n=r,r=i,i=o,o=a,a=i),t[n]=e.floor(o),t[r]=e.ceil(a),t}function Io(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:hc}function zo(t,e,i,n){var r=[],o=[],a=0,s=Math.min(t.length,e.length)-1;for(t[s]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<=s;)r.push(i(t[a-1],t[a])),o.push(n(e[a-1],e[a]));return function(e){var i=Ga.bisect(t,e,1,s)-1;return o[i](r[i](e))}}function Oo(t,e,i,n){function r(){var r=Math.min(t.length,e.length)>2?zo:No,l=n?zr:Ir;return a=r(t,e,l,i),s=r(e,t,l,dr),o}function o(t){return a(t)}var a,s;return o.invert=function(t){return s(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},o.range=function(t){return arguments.length?(e=t,r()):e},o.rangeRound=function(t){return o.range(t).interpolate(Dr)},o.clamp=function(t){return arguments.length?(n=t,r()):n},o.interpolate=function(t){return arguments.length?(i=t,r()):i},o.ticks=function(e){return Wo(t,e)},o.tickFormat=function(e,i){return jo(t,e,i)},o.nice=function(e){return Bo(t,e),r()},o.copy=function(){return Oo(t,e,i,n)},r()}function Uo(t,e){return Ga.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Bo(t,e){return Fo(t,Io(Vo(t,e)[2]))}function Vo(t,e){null==e&&(e=10);var i=ko(t),n=i[1]-i[0],r=Math.pow(10,Math.floor(Math.log(n/e)/Math.LN10)),o=e/n*r;return.15>=o?r*=10:.35>=o?r*=5:.75>=o&&(r*=2),i[0]=Math.ceil(i[0]/r)*r,i[1]=Math.floor(i[1]/r)*r+.5*r,i[2]=r,i}function Wo(t,e){return Ga.range.apply(Ga,Vo(t,e))}function jo(t,e,i){var n=Vo(t,e);if(i){var r=Zs.exec(i);if(r.shift(),"s"===r[8]){var o=Ga.formatPrefix(Math.max(os(n[0]),os(n[1])));return r[7]||(r[7]="."+Go(o.scale(n[2]))),r[8]="f",i=Ga.format(r.join("")),function(t){return i(o.scale(t))+o.symbol}}r[7]||(r[7]="."+Xo(r[8],n)),i=r.join("")}else i=",."+Go(n[2])+"f";return Ga.format(i)}function Go(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Xo(t,e){var i=Go(e[2]);return t in uc?Math.abs(i-Go(Math.max(os(e[0]),os(e[1]))))+ +("e"!==t):i-2*("%"===t)}function qo(t,e,i,n){function r(t){return(i?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)
}function o(t){return i?Math.pow(e,t):-Math.pow(e,-t)}function a(e){return t(r(e))}return a.invert=function(e){return o(t.invert(e))},a.domain=function(e){return arguments.length?(i=e[0]>=0,t.domain((n=e.map(Number)).map(r)),a):n},a.base=function(i){return arguments.length?(e=+i,t.domain(n.map(r)),a):e},a.nice=function(){var e=Fo(n.map(r),i?Math:dc);return t.domain(e),n=e.map(o),a},a.ticks=function(){var t=ko(n),a=[],s=t[0],l=t[1],c=Math.floor(r(s)),h=Math.ceil(r(l)),u=e%1?2:e;if(isFinite(h-c)){if(i){for(;h>c;c++)for(var f=1;u>f;f++)a.push(o(c)*f);a.push(o(c))}else for(a.push(o(c));c++<h;)for(var f=u-1;f>0;f--)a.push(o(c)*f);for(c=0;a[c]<s;c++);for(h=a.length;a[h-1]>l;h--);a=a.slice(c,h)}return a},a.tickFormat=function(t,e){if(!arguments.length)return fc;arguments.length<2?e=fc:"function"!=typeof e&&(e=Ga.format(e));var n,s=Math.max(.1,t/a.ticks().length),l=i?(n=1e-12,Math.ceil):(n=-1e-12,Math.floor);return function(t){return t/o(l(r(t)+n))<=s?e(t):""}},a.copy=function(){return qo(t.copy(),e,i,n)},Uo(a,t)}function Yo(t,e,i){function n(e){return t(r(e))}var r=Ko(e),o=Ko(1/e);return n.invert=function(e){return o(t.invert(e))},n.domain=function(e){return arguments.length?(t.domain((i=e.map(Number)).map(r)),n):i},n.ticks=function(t){return Wo(i,t)},n.tickFormat=function(t,e){return jo(i,t,e)},n.nice=function(t){return n.domain(Bo(i,t))},n.exponent=function(a){return arguments.length?(r=Ko(e=a),o=Ko(1/e),t.domain(i.map(r)),n):e},n.copy=function(){return Yo(t.copy(),e,i)},Uo(n,t)}function Ko(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function $o(t,e){function i(i){return o[((r.get(i)||("range"===e.t?r.set(i,t.push(i)):0/0))-1)%o.length]}function n(e,i){return Ga.range(t.length).map(function(t){return e+i*t})}var r,o,s;return i.domain=function(n){if(!arguments.length)return t;t=[],r=new a;for(var o,s=-1,l=n.length;++s<l;)r.has(o=n[s])||r.set(o,t.push(o));return i[e.t].apply(i,e.a)},i.range=function(t){return arguments.length?(o=t,s=0,e={t:"range",a:arguments},i):o},i.rangePoints=function(r,a){arguments.length<2&&(a=0);var l=r[0],c=r[1],h=(c-l)/(Math.max(1,t.length-1)+a);return o=n(t.length<2?(l+c)/2:l+h*a/2,h),s=0,e={t:"rangePoints",a:arguments},i},i.rangeBands=function(r,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=r[1]<r[0],h=r[c-0],u=r[1-c],f=(u-h)/(t.length-a+2*l);return o=n(h+f*l,f),c&&o.reverse(),s=f*(1-a),e={t:"rangeBands",a:arguments},i},i.rangeRoundBands=function(r,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=r[1]<r[0],h=r[c-0],u=r[1-c],f=Math.floor((u-h)/(t.length-a+2*l)),d=u-h-(t.length-a)*f;return o=n(h+Math.round(d/2),f),c&&o.reverse(),s=Math.round(f*(1-a)),e={t:"rangeRoundBands",a:arguments},i},i.rangeBand=function(){return s},i.rangeExtent=function(){return ko(e.a[0])},i.copy=function(){return $o(t,e)},i.domain(t)}function Qo(i,n){function r(){var t=0,e=n.length;for(a=[];++t<e;)a[t-1]=Ga.quantile(i,t/e);return o}function o(t){return isNaN(t=+t)?void 0:n[Ga.bisect(a,t)]}var a;return o.domain=function(n){return arguments.length?(i=n.filter(e).sort(t),r()):i},o.range=function(t){return arguments.length?(n=t,r()):n},o.quantiles=function(){return a},o.invertExtent=function(t){return t=n.indexOf(t),0>t?[0/0,0/0]:[t>0?a[t-1]:i[0],t<a.length?a[t]:i[i.length-1]]},o.copy=function(){return Qo(i,n)},r()}function Zo(t,e,i){function n(e){return i[Math.max(0,Math.min(a,Math.floor(o*(e-t))))]}function r(){return o=i.length/(e-t),a=i.length-1,n}var o,a;return n.domain=function(i){return arguments.length?(t=+i[0],e=+i[i.length-1],r()):[t,e]},n.range=function(t){return arguments.length?(i=t,r()):i},n.invertExtent=function(e){return e=i.indexOf(e),e=0>e?0/0:e/o+t,[e,e+1/o]},n.copy=function(){return Zo(t,e,i)},r()}function Jo(t,e){function i(i){return i>=i?e[Ga.bisect(t,i)]:void 0}return i.domain=function(e){return arguments.length?(t=e,i):t},i.range=function(t){return arguments.length?(e=t,i):e},i.invertExtent=function(i){return i=e.indexOf(i),[t[i-1],t[i]]},i.copy=function(){return Jo(t,e)},i}function ta(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(i){return arguments.length?(t=i.map(e),e):t},e.ticks=function(e){return Wo(t,e)},e.tickFormat=function(e,i){return jo(t,e,i)},e.copy=function(){return ta(t)},e}function ea(t){return t.innerRadius}function ia(t){return t.outerRadius}function na(t){return t.startAngle}function ra(t){return t.endAngle}function oa(t){function e(e){function a(){c.push("M",o(t(h),s))}for(var l,c=[],h=[],u=-1,f=e.length,d=be(i),p=be(n);++u<f;)r.call(this,l=e[u],u)?h.push([+d.call(this,l,u),+p.call(this,l,u)]):h.length&&(a(),h=[]);return h.length&&a(),c.length?c.join(""):null}var i=wn,n=Rn,r=_i,o=aa,a=o.key,s=.7;return e.x=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(n=t,e):n},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){return arguments.length?(a="function"==typeof t?o=t:(o=xc.get(t)||aa).key,e):a},e.tension=function(t){return arguments.length?(s=t,e):s},e}function aa(t){return t.join("L")}function sa(t){return aa(t)+"Z"}function la(t){for(var e=0,i=t.length,n=t[0],r=[n[0],",",n[1]];++e<i;)r.push("H",(n[0]+(n=t[e])[0])/2,"V",n[1]);return i>1&&r.push("H",n[0]),r.join("")}function ca(t){for(var e=0,i=t.length,n=t[0],r=[n[0],",",n[1]];++e<i;)r.push("V",(n=t[e])[1],"H",n[0]);return r.join("")}function ha(t){for(var e=0,i=t.length,n=t[0],r=[n[0],",",n[1]];++e<i;)r.push("H",(n=t[e])[0],"V",n[1]);return r.join("")}function ua(t,e){return t.length<4?aa(t):t[1]+pa(t.slice(1,t.length-1),ma(t,e))}function fa(t,e){return t.length<3?aa(t):t[0]+pa((t.push(t[0]),t),ma([t[t.length-2]].concat(t,[t[1]]),e))}function da(t,e){return t.length<3?aa(t):t[0]+pa(t,ma(t,e))}function pa(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return aa(t);var i=t.length!=e.length,n="",r=t[0],o=t[1],a=e[0],s=a,l=1;if(i&&(n+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],r=t[1],l=2),e.length>1){s=e[1],o=t[l],l++,n+="C"+(r[0]+a[0])+","+(r[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var c=2;c<e.length;c++,l++)o=t[l],s=e[c],n+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(i){var h=t[l];n+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+h[0]+","+h[1]}return n}function ma(t,e){for(var i,n=[],r=(1-e)/2,o=t[0],a=t[1],s=1,l=t.length;++s<l;)i=o,o=a,a=t[s],n.push([r*(a[0]-i[0]),r*(a[1]-i[1])]);return n}function ga(t){if(t.length<3)return aa(t);var e=1,i=t.length,n=t[0],r=n[0],o=n[1],a=[r,r,r,(n=t[1])[0]],s=[o,o,o,n[1]],l=[r,",",o,"L",xa(_c,a),",",xa(_c,s)];for(t.push(t[i-1]);++e<=i;)n=t[e],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),Ta(l,a,s);return t.pop(),l.push("L",n),l.join("")}function va(t){if(t.length<4)return aa(t);for(var e,i=[],n=-1,r=t.length,o=[0],a=[0];++n<3;)e=t[n],o.push(e[0]),a.push(e[1]);for(i.push(xa(_c,o)+","+xa(_c,a)),--n;++n<r;)e=t[n],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),Ta(i,o,a);return i.join("")}function Ea(t){for(var e,i,n=-1,r=t.length,o=r+4,a=[],s=[];++n<4;)i=t[n%r],a.push(i[0]),s.push(i[1]);for(e=[xa(_c,a),",",xa(_c,s)],--n;++n<o;)i=t[n%r],a.shift(),a.push(i[0]),s.shift(),s.push(i[1]),Ta(e,a,s);return e.join("")}function ya(t,e){var i=t.length-1;if(i)for(var n,r,o=t[0][0],a=t[0][1],s=t[i][0]-o,l=t[i][1]-a,c=-1;++c<=i;)n=t[c],r=c/i,n[0]=e*n[0]+(1-e)*(o+r*s),n[1]=e*n[1]+(1-e)*(a+r*l);return ga(t)}function xa(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Ta(t,e,i){t.push("C",xa(Tc,e),",",xa(Tc,i),",",xa(bc,e),",",xa(bc,i),",",xa(_c,e),",",xa(_c,i))}function ba(t,e){return(e[1]-t[1])/(e[0]-t[0])}function _a(t){for(var e=0,i=t.length-1,n=[],r=t[0],o=t[1],a=n[0]=ba(r,o);++e<i;)n[e]=(a+(a=ba(r=o,o=t[e+1])))/2;return n[e]=a,n}function wa(t){for(var e,i,n,r,o=[],a=_a(t),s=-1,l=t.length-1;++s<l;)e=ba(t[s],t[s+1]),os(e)<Hs?a[s]=a[s+1]=0:(i=a[s]/e,n=a[s+1]/e,r=i*i+n*n,r>9&&(r=3*e/Math.sqrt(r),a[s]=r*i,a[s+1]=r*n));for(s=-1;++s<=l;)r=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([r||0,a[s]*r||0]);return o}function Ra(t){return t.length<3?aa(t):t[0]+pa(t,wa(t))}function Ha(t){for(var e,i,n,r=-1,o=t.length;++r<o;)e=t[r],i=e[0],n=e[1]+Ec,e[0]=i*Math.cos(n),e[1]=i*Math.sin(n);return t}function Ma(t){function e(e){function l(){m.push("M",s(t(v),u),h,c(t(g.reverse()),u),"Z")}for(var f,d,p,m=[],g=[],v=[],E=-1,y=e.length,x=be(i),T=be(r),b=i===n?function(){return d}:be(n),_=r===o?function(){return p}:be(o);++E<y;)a.call(this,f=e[E],E)?(g.push([d=+x.call(this,f,E),p=+T.call(this,f,E)]),v.push([+b.call(this,f,E),+_.call(this,f,E)])):g.length&&(l(),g=[],v=[]);return g.length&&l(),m.length?m.join(""):null}var i=wn,n=wn,r=0,o=Rn,a=_i,s=aa,l=s.key,c=s,h="L",u=.7;return e.x=function(t){return arguments.length?(i=n=t,e):n},e.x0=function(t){return arguments.length?(i=t,e):i},e.x1=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=o=t,e):o},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(o=t,e):o},e.defined=function(t){return arguments.length?(a=t,e):a},e.interpolate=function(t){return arguments.length?(l="function"==typeof t?s=t:(s=xc.get(t)||aa).key,c=s.reverse||s,h=s.closed?"M":"L",e):l},e.tension=function(t){return arguments.length?(u=t,e):u},e}function Sa(t){return t.radius}function Ca(t){return[t.x,t.y]}function Aa(t){return function(){var e=t.apply(this,arguments),i=e[0],n=e[1]+Ec;return[i*Math.cos(n),i*Math.sin(n)]}}function Da(){return 64}function Pa(){return"circle"}function ka(t){var e=Math.sqrt(t/_s);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function La(t,e){return hs(t,Cc),t.id=e,t}function Na(t,e,i,n){var r=t.id;return F(t,"function"==typeof i?function(t,o,a){t.__transition__[r].tween.set(e,n(i.call(t,t.__data__,o,a)))}:(i=n(i),function(t){t.__transition__[r].tween.set(e,i)}))}function Fa(t){return null==t&&(t=""),function(){this.textContent=t}}function Ia(t,e,i,n){var r=t.__transition__||(t.__transition__={active:0,count:0}),o=r[i];if(!o){var s=n.time;o=r[i]={tween:new a,time:s,ease:n.ease,delay:n.delay,duration:n.duration},++r.count,Ga.timer(function(n){function a(n){return r.active>i?c():(r.active=i,o.event&&o.event.start.call(t,h,e),o.tween.forEach(function(i,n){(n=n.call(t,h,e))&&m.push(n)}),void Ga.timer(function(){return p.c=l(n||1)?_i:l,1},0,s))}function l(n){if(r.active!==i)return c();for(var a=n/d,s=u(a),l=m.length;l>0;)m[--l].call(t,s);return a>=1?(o.event&&o.event.end.call(t,h,e),c()):void 0}function c(){return--r.count?delete r[i]:delete t.__transition__,1}var h=t.__data__,u=o.ease,f=o.delay,d=o.duration,p=Ks,m=[];return p.t=f+s,n>=f?a(n-f):void(p.c=a)},0,s)}}function za(t,e){t.attr("transform",function(t){return"translate("+e(t)+",0)"})}function Oa(t,e){t.attr("transform",function(t){return"translate(0,"+e(t)+")"})}function Ua(t){return t.toISOString()}function Ba(t,e,i){function n(e){return t(e)}function r(t,i){var n=t[1]-t[0],r=n/i,o=Ga.bisect(zc,r);return o==zc.length?[e.year,Vo(t.map(function(t){return t/31536e6}),i)[2]]:o?e[r/zc[o-1]<zc[o]/r?o-1:o]:[Bc,Vo(t,i)[2]]}return n.invert=function(e){return Va(t.invert(e))},n.domain=function(e){return arguments.length?(t.domain(e),n):t.domain().map(Va)},n.nice=function(t,e){function i(i){return!isNaN(i)&&!t.range(i,Va(+i+1),e).length}var o=n.domain(),a=ko(o),s=null==t?r(a,10):"number"==typeof t&&r(a,t);return s&&(t=s[0],e=s[1]),n.domain(Fo(o,e>1?{floor:function(e){for(;i(e=t.floor(e));)e=Va(e-1);return e},ceil:function(e){for(;i(e=t.ceil(e));)e=Va(+e+1);return e}}:t))},n.ticks=function(t,e){var i=ko(n.domain()),o=null==t?r(i,10):"number"==typeof t?r(i,t):!t.range&&[{range:t},e];return o&&(t=o[0],e=o[1]),t.range(i[0],Va(+i[1]+1),1>e?1:e)},n.tickFormat=function(){return i},n.copy=function(){return Ba(t.copy(),e,i)},Uo(n,t)}function Va(t){return new Date(t)}function Wa(t){return JSON.parse(t.responseText)}function ja(t){var e=Ya.createRange();return e.selectNode(Ya.body),e.createContextualFragment(t.responseText)}var Ga={version:"3.4.11"};Date.now||(Date.now=function(){return+new Date});var Xa=[].slice,qa=function(t){return Xa.call(t)},Ya=document,Ka=Ya.documentElement,$a=window;try{qa(Ka.childNodes)[0].nodeType}catch(Qa){qa=function(t){for(var e=t.length,i=new Array(e);e--;)i[e]=t[e];return i}}try{Ya.createElement("div").style.setProperty("opacity",0,"")}catch(Za){var Ja=$a.Element.prototype,ts=Ja.setAttribute,es=Ja.setAttributeNS,is=$a.CSSStyleDeclaration.prototype,ns=is.setProperty;Ja.setAttribute=function(t,e){ts.call(this,t,e+"")},Ja.setAttributeNS=function(t,e,i){es.call(this,t,e,i+"")},is.setProperty=function(t,e,i){ns.call(this,t,e+"",i)}}Ga.ascending=t,Ga.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:0/0},Ga.min=function(t,e){var i,n,r=-1,o=t.length;if(1===arguments.length){for(;++r<o&&!(null!=(i=t[r])&&i>=i);)i=void 0;for(;++r<o;)null!=(n=t[r])&&i>n&&(i=n)}else{for(;++r<o&&!(null!=(i=e.call(t,t[r],r))&&i>=i);)i=void 0;for(;++r<o;)null!=(n=e.call(t,t[r],r))&&i>n&&(i=n)}return i},Ga.max=function(t,e){var i,n,r=-1,o=t.length;if(1===arguments.length){for(;++r<o&&!(null!=(i=t[r])&&i>=i);)i=void 0;for(;++r<o;)null!=(n=t[r])&&n>i&&(i=n)}else{for(;++r<o&&!(null!=(i=e.call(t,t[r],r))&&i>=i);)i=void 0;for(;++r<o;)null!=(n=e.call(t,t[r],r))&&n>i&&(i=n)}return i},Ga.extent=function(t,e){var i,n,r,o=-1,a=t.length;if(1===arguments.length){for(;++o<a&&!(null!=(i=r=t[o])&&i>=i);)i=r=void 0;for(;++o<a;)null!=(n=t[o])&&(i>n&&(i=n),n>r&&(r=n))}else{for(;++o<a&&!(null!=(i=r=e.call(t,t[o],o))&&i>=i);)i=void 0;for(;++o<a;)null!=(n=e.call(t,t[o],o))&&(i>n&&(i=n),n>r&&(r=n))}return[i,r]},Ga.sum=function(t,e){var i,n=0,r=t.length,o=-1;if(1===arguments.length)for(;++o<r;)isNaN(i=+t[o])||(n+=i);else for(;++o<r;)isNaN(i=+e.call(t,t[o],o))||(n+=i);return n},Ga.mean=function(t,i){var n,r=0,o=t.length,a=-1,s=o;if(1===arguments.length)for(;++a<o;)e(n=t[a])?r+=n:--s;else for(;++a<o;)e(n=i.call(t,t[a],a))?r+=n:--s;return s?r/s:void 0},Ga.quantile=function(t,e){var i=(t.length-1)*e+1,n=Math.floor(i),r=+t[n-1],o=i-n;return o?r+o*(t[n]-r):r},Ga.median=function(i,n){return arguments.length>1&&(i=i.map(n)),i=i.filter(e),i.length?Ga.quantile(i.sort(t),.5):void 0};var rs=i(t);Ga.bisectLeft=rs.left,Ga.bisect=Ga.bisectRight=rs.right,Ga.bisector=function(e){return i(1===e.length?function(i,n){return t(e(i),n)}:e)},Ga.shuffle=function(t){for(var e,i,n=t.length;n;)i=0|Math.random()*n--,e=t[n],t[n]=t[i],t[i]=e;return t},Ga.permute=function(t,e){for(var i=e.length,n=new Array(i);i--;)n[i]=t[e[i]];return n},Ga.pairs=function(t){for(var e,i=0,n=t.length-1,r=t[0],o=new Array(0>n?0:n);n>i;)o[i]=[e=r,r=t[++i]];return o},Ga.zip=function(){if(!(r=arguments.length))return[];for(var t=-1,e=Ga.min(arguments,n),i=new Array(e);++t<e;)for(var r,o=-1,a=i[t]=new Array(r);++o<r;)a[o]=arguments[o][t];return i},Ga.transpose=function(t){return Ga.zip.apply(Ga,t)},Ga.keys=function(t){var e=[];for(var i in t)e.push(i);return e},Ga.values=function(t){var e=[];for(var i in t)e.push(t[i]);return e},Ga.entries=function(t){var e=[];for(var i in t)e.push({key:i,value:t[i]});return e},Ga.merge=function(t){for(var e,i,n,r=t.length,o=-1,a=0;++o<r;)a+=t[o].length;for(i=new Array(a);--r>=0;)for(n=t[r],e=n.length;--e>=0;)i[--a]=n[e];return i};var os=Math.abs;Ga.range=function(t,e,i){if(arguments.length<3&&(i=1,arguments.length<2&&(e=t,t=0)),1/0===(e-t)/i)throw new Error("infinite range");var n,o=[],a=r(os(i)),s=-1;if(t*=a,e*=a,i*=a,0>i)for(;(n=t+i*++s)>e;)o.push(n/a);else for(;(n=t+i*++s)<e;)o.push(n/a);return o},Ga.map=function(t){var e=new a;if(t instanceof a)t.forEach(function(t,i){e.set(t,i)});else for(var i in t)e.set(i,t[i]);return e},o(a,{has:s,get:function(t){return this[as+t]},set:function(t,e){return this[as+t]=e},remove:l,keys:c,values:function(){var t=[];return this.forEach(function(e,i){t.push(i)}),t},entries:function(){var t=[];return this.forEach(function(e,i){t.push({key:e,value:i})}),t},size:h,empty:u,forEach:function(t){for(var e in this)e.charCodeAt(0)===ss&&t.call(this,e.substring(1),this[e])}});var as="\x00",ss=as.charCodeAt(0);Ga.nest=function(){function t(e,s,l){if(l>=o.length)return n?n.call(r,s):i?s.sort(i):s;for(var c,h,u,f,d=-1,p=s.length,m=o[l++],g=new a;++d<p;)(f=g.get(c=m(h=s[d])))?f.push(h):g.set(c,[h]);return e?(h=e(),u=function(i,n){h.set(i,t(e,n,l))}):(h={},u=function(i,n){h[i]=t(e,n,l)}),g.forEach(u),h}function e(t,i){if(i>=o.length)return t;var n=[],r=s[i++];return t.forEach(function(t,r){n.push({key:t,values:e(r,i)})}),r?n.sort(function(t,e){return r(t.key,e.key)}):n}var i,n,r={},o=[],s=[];return r.map=function(e,i){return t(i,e,0)},r.entries=function(i){return e(t(Ga.map,i,0),0)},r.key=function(t){return o.push(t),r},r.sortKeys=function(t){return s[o.length-1]=t,r},r.sortValues=function(t){return i=t,r},r.rollup=function(t){return n=t,r},r},Ga.set=function(t){var e=new f;if(t)for(var i=0,n=t.length;n>i;++i)e.add(t[i]);return e},o(f,{has:s,add:function(t){return this[as+t]=!0,t},remove:function(t){return t=as+t,t in this&&delete this[t]},values:c,size:h,empty:u,forEach:function(t){for(var e in this)e.charCodeAt(0)===ss&&t.call(this,e.substring(1))}}),Ga.behavior={},Ga.rebind=function(t,e){for(var i,n=1,r=arguments.length;++n<r;)t[i=arguments[n]]=d(t,e,e[i]);return t};var ls=["webkit","ms","moz","Moz","o","O"];Ga.dispatch=function(){for(var t=new g,e=-1,i=arguments.length;++e<i;)t[arguments[e]]=v(t);return t},g.prototype.on=function(t,e){var i=t.indexOf("."),n="";if(i>=0&&(n=t.substring(i+1),t=t.substring(0,i)),t)return arguments.length<2?this[t].on(n):this[t].on(n,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(n,null);return this}},Ga.event=null,Ga.requote=function(t){return t.replace(cs,"\\$&")};var cs=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,hs={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var i in e)t[i]=e[i]},us=function(t,e){return e.querySelector(t)},fs=function(t,e){return e.querySelectorAll(t)},ds=Ka.matches||Ka[p(Ka,"matchesSelector")],ps=function(t,e){return ds.call(t,e)};"function"==typeof Sizzle&&(us=function(t,e){return Sizzle(t,e)[0]||null},fs=Sizzle,ps=Sizzle.matchesSelector),Ga.selection=function(){return Es};var ms=Ga.selection.prototype=[];ms.select=function(t){var e,i,n,r,o=[];t=b(t);for(var a=-1,s=this.length;++a<s;){o.push(e=[]),e.parentNode=(n=this[a]).parentNode;for(var l=-1,c=n.length;++l<c;)(r=n[l])?(e.push(i=t.call(r,r.__data__,l,a)),i&&"__data__"in r&&(i.__data__=r.__data__)):e.push(null)}return T(o)},ms.selectAll=function(t){var e,i,n=[];t=_(t);for(var r=-1,o=this.length;++r<o;)for(var a=this[r],s=-1,l=a.length;++s<l;)(i=a[s])&&(n.push(e=qa(t.call(i,i.__data__,s,r))),e.parentNode=i);return T(n)};var gs={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Ga.ns={prefix:gs,qualify:function(t){var e=t.indexOf(":"),i=t;return e>=0&&(i=t.substring(0,e),t=t.substring(e+1)),gs.hasOwnProperty(i)?{space:gs[i],local:t}:t}},ms.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var i=this.node();return t=Ga.ns.qualify(t),t.local?i.getAttributeNS(t.space,t.local):i.getAttribute(t)}for(e in t)this.each(w(e,t[e]));return this}return this.each(w(t,e))},ms.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var i=this.node(),n=(t=M(t)).length,r=-1;if(e=i.classList){for(;++r<n;)if(!e.contains(t[r]))return!1}else for(e=i.getAttribute("class");++r<n;)if(!H(t[r]).test(e))return!1;return!0}for(e in t)this.each(S(e,t[e]));return this}return this.each(S(t,e))},ms.style=function(t,e,i){var n=arguments.length;if(3>n){if("string"!=typeof t){2>n&&(e="");for(i in t)this.each(A(i,t[i],e));return this}if(2>n)return $a.getComputedStyle(this.node(),null).getPropertyValue(t);i=""}return this.each(A(t,e,i))},ms.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(D(e,t[e]));return this}return this.each(D(t,e))},ms.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},ms.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},ms.append=function(t){return t=P(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},ms.insert=function(t,e){return t=P(t),e=b(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},ms.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},ms.data=function(t,e){function i(t,i){var n,r,o,s=t.length,u=i.length,f=Math.min(s,u),d=new Array(u),p=new Array(u),m=new Array(s);if(e){var g,v=new a,E=new a,y=[];for(n=-1;++n<s;)g=e.call(r=t[n],r.__data__,n),v.has(g)?m[n]=r:v.set(g,r),y.push(g);for(n=-1;++n<u;)g=e.call(i,o=i[n],n),(r=v.get(g))?(d[n]=r,r.__data__=o):E.has(g)||(p[n]=k(o)),E.set(g,o),v.remove(g);for(n=-1;++n<s;)v.has(y[n])&&(m[n]=t[n])}else{for(n=-1;++n<f;)r=t[n],o=i[n],r?(r.__data__=o,d[n]=r):p[n]=k(o);for(;u>n;++n)p[n]=k(i[n]);for(;s>n;++n)m[n]=t[n]}p.update=d,p.parentNode=d.parentNode=m.parentNode=t.parentNode,l.push(p),c.push(d),h.push(m)}var n,r,o=-1,s=this.length;if(!arguments.length){for(t=new Array(s=(n=this[0]).length);++o<s;)(r=n[o])&&(t[o]=r.__data__);return t}var l=I([]),c=T([]),h=T([]);if("function"==typeof t)for(;++o<s;)i(n=this[o],t.call(n,n.parentNode.__data__,o));else for(;++o<s;)i(n=this[o],t);return c.enter=function(){return l},c.exit=function(){return h},c},ms.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},ms.filter=function(t){var e,i,n,r=[];"function"!=typeof t&&(t=L(t));for(var o=0,a=this.length;a>o;o++){r.push(e=[]),e.parentNode=(i=this[o]).parentNode;for(var s=0,l=i.length;l>s;s++)(n=i[s])&&t.call(n,n.__data__,s,o)&&e.push(n)}return T(r)},ms.order=function(){for(var t=-1,e=this.length;++t<e;)for(var i,n=this[t],r=n.length-1,o=n[r];--r>=0;)(i=n[r])&&(o&&o!==i.nextSibling&&o.parentNode.insertBefore(i,o),o=i);return this},ms.sort=function(t){t=N.apply(this,arguments);for(var e=-1,i=this.length;++e<i;)this[e].sort(t);return this.order()},ms.each=function(t){return F(this,function(e,i,n){t.call(e,e.__data__,i,n)})},ms.call=function(t){var e=qa(arguments);return t.apply(e[0]=this,e),this},ms.empty=function(){return!this.node()},ms.node=function(){for(var t=0,e=this.length;e>t;t++)for(var i=this[t],n=0,r=i.length;r>n;n++){var o=i[n];if(o)return o}return null},ms.size=function(){var t=0;return this.each(function(){++t}),t};var vs=[];Ga.selection.enter=I,Ga.selection.enter.prototype=vs,vs.append=ms.append,vs.empty=ms.empty,vs.node=ms.node,vs.call=ms.call,vs.size=ms.size,vs.select=function(t){for(var e,i,n,r,o,a=[],s=-1,l=this.length;++s<l;){n=(r=this[s]).update,a.push(e=[]),e.parentNode=r.parentNode;for(var c=-1,h=r.length;++c<h;)(o=r[c])?(e.push(n[c]=i=t.call(r.parentNode,o.__data__,c,s)),i.__data__=o.__data__):e.push(null)}return T(a)},vs.insert=function(t,e){return arguments.length<2&&(e=z(this)),ms.insert.call(this,t,e)},ms.transition=function(){for(var t,e,i=Rc||++Ac,n=[],r=Hc||{time:Date.now(),ease:xr,delay:0,duration:250},o=-1,a=this.length;++o<a;){n.push(t=[]);for(var s=this[o],l=-1,c=s.length;++l<c;)(e=s[l])&&Ia(e,l,i,r),t.push(e)}return La(n,i)},ms.interrupt=function(){return this.each(O)},Ga.select=function(t){var e=["string"==typeof t?us(t,Ya):t];return e.parentNode=Ka,T([e])},Ga.selectAll=function(t){var e=qa("string"==typeof t?fs(t,Ya):t);return e.parentNode=Ka,T([e])};var Es=Ga.select(Ka);ms.on=function(t,e,i){var n=arguments.length;if(3>n){if("string"!=typeof t){2>n&&(e=!1);for(i in t)this.each(U(i,t[i],e));return this}if(2>n)return(n=this.node()["__on"+t])&&n._;i=!1}return this.each(U(t,e,i))};var ys=Ga.map({mouseenter:"mouseover",mouseleave:"mouseout"});ys.forEach(function(t){"on"+t in Ya&&ys.remove(t)});var xs="onselectstart"in Ya?null:p(Ka.style,"userSelect"),Ts=0;Ga.mouse=function(t){return j(t,y())};var bs=/WebKit/.test($a.navigator.userAgent)?-1:0;Ga.touches=function(t,e){return arguments.length<2&&(e=y().touches),e?qa(e).map(function(e){var i=j(t,e);return i.identifier=e.identifier,i}):[]},Ga.behavior.drag=function(){function t(){this.on("mousedown.drag",r).on("touchstart.drag",o)}function e(t,e,r,o,a){return function(){function s(){var t,i,n=e(f,m);n&&(t=n[0]-y[0],i=n[1]-y[1],p|=t|i,y=n,d({type:"drag",x:n[0]+c[0],y:n[1]+c[1],dx:t,dy:i}))}function l(){e(f,m)&&(v.on(o+g,null).on(a+g,null),E(p&&Ga.event.target===u),d({type:"dragend"}))}var c,h=this,u=Ga.event.target,f=h.parentNode,d=i.of(h,arguments),p=0,m=t(),g=".drag"+(null==m?"":"-"+m),v=Ga.select(r()).on(o+g,s).on(a+g,l),E=W(),y=e(f,m);n?(c=n.apply(h,arguments),c=[c.x-y[0],c.y-y[1]]):c=[0,0],d({type:"dragstart"})}}var i=x(t,"drag","dragstart","dragend"),n=null,r=e(m,Ga.mouse,$,"mousemove","mouseup"),o=e(G,Ga.touch,X,"touchmove","touchend");return t.origin=function(e){return arguments.length?(n=e,t):n},Ga.rebind(t,i,"on")};var _s=Math.PI,ws=2*_s,Rs=_s/2,Hs=1e-6,Ms=Hs*Hs,Ss=_s/180,Cs=180/_s,As=Math.SQRT2,Ds=2,Ps=4;Ga.interpolateZoom=function(t,e){function i(t){var e=t*E;if(v){var i=J(m),a=o/(Ds*f)*(i*te(As*e+m)-Z(m));return[n+a*c,r+a*h,o*i/J(As*e+m)]}return[n+t*c,r+t*h,o*Math.exp(As*e)]}var n=t[0],r=t[1],o=t[2],a=e[0],s=e[1],l=e[2],c=a-n,h=s-r,u=c*c+h*h,f=Math.sqrt(u),d=(l*l-o*o+Ps*u)/(2*o*Ds*f),p=(l*l-o*o-Ps*u)/(2*l*Ds*f),m=Math.log(Math.sqrt(d*d+1)-d),g=Math.log(Math.sqrt(p*p+1)-p),v=g-m,E=(v||Math.log(l/o))/As;return i.duration=1e3*E,i},Ga.behavior.zoom=function(){function t(t){t.on(M,c).on(Ns+".zoom",u).on("dblclick.zoom",f).on(A,h)}function e(t){return[(t[0]-w.x)/w.k,(t[1]-w.y)/w.k]}function i(t){return[t[0]*w.k+w.x,t[1]*w.k+w.y]}function n(t){w.k=Math.max(H[0],Math.min(H[1],t))}function r(t,e){e=i(e),w.x+=t[0]-e[0],w.y+=t[1]-e[1]}function o(){T&&T.domain(y.range().map(function(t){return(t-w.x)/w.k}).map(y.invert)),_&&_.domain(b.range().map(function(t){return(t-w.y)/w.k}).map(b.invert))}function a(t){t({type:"zoomstart"})}function s(t){o(),t({type:"zoom",scale:w.k,translate:[w.x,w.y]})}function l(t){t({type:"zoomend"})}function c(){function t(){h=1,r(Ga.mouse(n),f),s(c)}function i(){u.on(S,null).on(C,null),d(h&&Ga.event.target===o),l(c)}var n=this,o=Ga.event.target,c=D.of(n,arguments),h=0,u=Ga.select($a).on(S,t).on(C,i),f=e(Ga.mouse(n)),d=W();O.call(n),a(c)}function h(){function t(){var t=Ga.touches(d);return f=w.k,t.forEach(function(t){t.identifier in m&&(m[t.identifier]=e(t))}),t}function i(){var e=Ga.event.target;Ga.select(e).on(x,o).on(T,u),b.push(e);for(var i=Ga.event.changedTouches,a=0,l=i.length;l>a;++a)m[i[a].identifier]=null;var c=t(),h=Date.now();if(1===c.length){if(500>h-v){var f=c[0],d=m[f.identifier];n(2*w.k),r(f,d),E(),s(p)}v=h}else if(c.length>1){var f=c[0],y=c[1],_=f[0]-y[0],R=f[1]-y[1];g=_*_+R*R}}function o(){for(var t,e,i,o,a=Ga.touches(d),l=0,c=a.length;c>l;++l,o=null)if(i=a[l],o=m[i.identifier]){if(e)break;t=i,e=o}if(o){var h=(h=i[0]-t[0])*h+(h=i[1]-t[1])*h,u=g&&Math.sqrt(h/g);t=[(t[0]+i[0])/2,(t[1]+i[1])/2],e=[(e[0]+o[0])/2,(e[1]+o[1])/2],n(u*f)}v=null,r(t,e),s(p)}function u(){if(Ga.event.touches.length){for(var e=Ga.event.changedTouches,i=0,n=e.length;n>i;++i)delete m[e[i].identifier];for(var r in m)return void t()}Ga.selectAll(b).on(y,null),_.on(M,c).on(A,h),R(),l(p)}var f,d=this,p=D.of(d,arguments),m={},g=0,y=".zoom-"+Ga.event.changedTouches[0].identifier,x="touchmove"+y,T="touchend"+y,b=[],_=Ga.select(d).on(M,null).on(A,i),R=W();O.call(d),i(),a(p)}function u(){var t=D.of(this,arguments);g?clearTimeout(g):(d=e(p=m||Ga.mouse(this)),O.call(this),a(t)),g=setTimeout(function(){g=null,l(t)},50),E(),n(Math.pow(2,.002*ks())*w.k),r(p,d),s(t)}function f(){var t=D.of(this,arguments),i=Ga.mouse(this),o=e(i),c=Math.log(w.k)/Math.LN2;a(t),n(Math.pow(2,Ga.event.shiftKey?Math.ceil(c)-1:Math.floor(c)+1)),r(i,o),s(t),l(t)}var d,p,m,g,v,y,T,b,_,w={x:0,y:0,k:1},R=[960,500],H=Ls,M="mousedown.zoom",S="mousemove.zoom",C="mouseup.zoom",A="touchstart.zoom",D=x(t,"zoomstart","zoom","zoomend");return t.event=function(t){t.each(function(){var t=D.of(this,arguments),e=w;Rc?Ga.select(this).transition().each("start.zoom",function(){w=this.__chart__||{x:0,y:0,k:1},a(t)}).tween("zoom:zoom",function(){var i=R[0],n=R[1],r=i/2,o=n/2,a=Ga.interpolateZoom([(r-w.x)/w.k,(o-w.y)/w.k,i/w.k],[(r-e.x)/e.k,(o-e.y)/e.k,i/e.k]);return function(e){var n=a(e),l=i/n[2];this.__chart__=w={x:r-n[0]*l,y:o-n[1]*l,k:l},s(t)}}).each("end.zoom",function(){l(t)}):(this.__chart__=w,a(t),s(t),l(t))})},t.translate=function(e){return arguments.length?(w={x:+e[0],y:+e[1],k:w.k},o(),t):[w.x,w.y]},t.scale=function(e){return arguments.length?(w={x:w.x,y:w.y,k:+e},o(),t):w.k},t.scaleExtent=function(e){return arguments.length?(H=null==e?Ls:[+e[0],+e[1]],t):H},t.center=function(e){return arguments.length?(m=e&&[+e[0],+e[1]],t):m},t.size=function(e){return arguments.length?(R=e&&[+e[0],+e[1]],t):R},t.x=function(e){return arguments.length?(T=e,y=e.copy(),w={x:0,y:0,k:1},t):T},t.y=function(e){return arguments.length?(_=e,b=e.copy(),w={x:0,y:0,k:1},t):_},Ga.rebind(t,D,"on")};var ks,Ls=[0,1/0],Ns="onwheel"in Ya?(ks=function(){return-Ga.event.deltaY*(Ga.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Ya?(ks=function(){return Ga.event.wheelDelta},"mousewheel"):(ks=function(){return-Ga.event.detail},"MozMousePixelScroll");Ga.color=ie,ie.prototype.toString=function(){return this.rgb()+""},Ga.hsl=ne;var Fs=ne.prototype=new ie;Fs.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new ne(this.h,this.s,this.l/t)},Fs.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new ne(this.h,this.s,t*this.l)},Fs.rgb=function(){return re(this.h,this.s,this.l)},Ga.hcl=oe;var Is=oe.prototype=new ie;Is.brighter=function(t){return new oe(this.h,this.c,Math.min(100,this.l+zs*(arguments.length?t:1)))},Is.darker=function(t){return new oe(this.h,this.c,Math.max(0,this.l-zs*(arguments.length?t:1)))},Is.rgb=function(){return ae(this.h,this.c,this.l).rgb()},Ga.lab=se;var zs=18,Os=.95047,Us=1,Bs=1.08883,Vs=se.prototype=new ie;Vs.brighter=function(t){return new se(Math.min(100,this.l+zs*(arguments.length?t:1)),this.a,this.b)},Vs.darker=function(t){return new se(Math.max(0,this.l-zs*(arguments.length?t:1)),this.a,this.b)},Vs.rgb=function(){return le(this.l,this.a,this.b)},Ga.rgb=de;var Ws=de.prototype=new ie;Ws.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,i=this.g,n=this.b,r=30;return e||i||n?(e&&r>e&&(e=r),i&&r>i&&(i=r),n&&r>n&&(n=r),new de(Math.min(255,e/t),Math.min(255,i/t),Math.min(255,n/t))):new de(r,r,r)},Ws.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new de(t*this.r,t*this.g,t*this.b)},Ws.hsl=function(){return Ee(this.r,this.g,this.b)},Ws.toString=function(){return"#"+ge(this.r)+ge(this.g)+ge(this.b)};var js=Ga.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});
js.forEach(function(t,e){js.set(t,pe(e))}),Ga.functor=be,Ga.xhr=we(_e),Ga.dsv=function(t,e){function i(t,i,o){arguments.length<3&&(o=i,i=null);var a=Re(t,e,null==i?n:r(i),o);return a.row=function(t){return arguments.length?a.response(null==(i=t)?n:r(t)):i},a}function n(t){return i.parse(t.responseText)}function r(t){return function(e){return i.parse(e.responseText,t)}}function o(e){return e.map(a).join(t)}function a(t){return s.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var s=new RegExp('["'+t+"\n]"),l=t.charCodeAt(0);return i.parse=function(t,e){var n;return i.parseRows(t,function(t,i){if(n)return n(t,i-1);var r=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");n=e?function(t,i){return e(r(t),i)}:r})},i.parseRows=function(t,e){function i(){if(h>=c)return a;if(r)return r=!1,o;var e=h;if(34===t.charCodeAt(e)){for(var i=e;i++<c;)if(34===t.charCodeAt(i)){if(34!==t.charCodeAt(i+1))break;++i}h=i+2;var n=t.charCodeAt(i+1);return 13===n?(r=!0,10===t.charCodeAt(i+2)&&++h):10===n&&(r=!0),t.substring(e+1,i).replace(/""/g,'"')}for(;c>h;){var n=t.charCodeAt(h++),s=1;if(10===n)r=!0;else if(13===n)r=!0,10===t.charCodeAt(h)&&(++h,++s);else if(n!==l)continue;return t.substring(e,h-s)}return t.substring(e)}for(var n,r,o={},a={},s=[],c=t.length,h=0,u=0;(n=i())!==a;){for(var f=[];n!==o&&n!==a;)f.push(n),n=i();(!e||(f=e(f,u++)))&&s.push(f)}return s},i.format=function(e){if(Array.isArray(e[0]))return i.formatRows(e);var n=new f,r=[];return e.forEach(function(t){for(var e in t)n.has(e)||r.push(n.add(e))}),[r.map(a).join(t)].concat(e.map(function(e){return r.map(function(t){return a(e[t])}).join(t)})).join("\n")},i.formatRows=function(t){return t.map(o).join("\n")},i},Ga.csv=Ga.dsv(",","text/csv"),Ga.tsv=Ga.dsv("	","text/tab-separated-values"),Ga.touch=function(t,e,i){if(arguments.length<3&&(i=e,e=y().changedTouches),e)for(var n,r=0,o=e.length;o>r;++r)if((n=e[r]).identifier===i)return j(t,n)};var Gs,Xs,qs,Ys,Ks,$s=$a[p($a,"requestAnimationFrame")]||function(t){setTimeout(t,17)};Ga.timer=function(t,e,i){var n=arguments.length;2>n&&(e=0),3>n&&(i=Date.now());var r=i+e,o={c:t,t:r,f:!1,n:null};Xs?Xs.n=o:Gs=o,Xs=o,qs||(Ys=clearTimeout(Ys),qs=1,$s(Me))},Ga.timer.flush=function(){Se(),Ce()},Ga.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var Qs=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(De);Ga.formatPrefix=function(t,e){var i=0;return t&&(0>t&&(t*=-1),e&&(t=Ga.round(t,Ae(t,e))),i=1+Math.floor(1e-12+Math.log(t)/Math.LN10),i=Math.max(-24,Math.min(24,3*Math.floor((i-1)/3)))),Qs[8+i/3]};var Zs=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Js=Ga.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=Ga.round(t,Ae(t,e))).toFixed(Math.max(0,Math.min(20,Ae(t*(1+1e-15),e))))}}),tl=Ga.time={},el=Date;Le.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){il.setUTCDate.apply(this._,arguments)},setDay:function(){il.setUTCDay.apply(this._,arguments)},setFullYear:function(){il.setUTCFullYear.apply(this._,arguments)},setHours:function(){il.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){il.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){il.setUTCMinutes.apply(this._,arguments)},setMonth:function(){il.setUTCMonth.apply(this._,arguments)},setSeconds:function(){il.setUTCSeconds.apply(this._,arguments)},setTime:function(){il.setTime.apply(this._,arguments)}};var il=Date.prototype;tl.year=Ne(function(t){return t=tl.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),tl.years=tl.year.range,tl.years.utc=tl.year.utc.range,tl.day=Ne(function(t){var e=new el(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),tl.days=tl.day.range,tl.days.utc=tl.day.utc.range,tl.dayOfYear=function(t){var e=tl.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var i=tl[t]=Ne(function(t){return(t=tl.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var i=tl.year(t).getDay();return Math.floor((tl.dayOfYear(t)+(i+e)%7)/7)-(i!==e)});tl[t+"s"]=i.range,tl[t+"s"].utc=i.utc.range,tl[t+"OfYear"]=function(t){var i=tl.year(t).getDay();return Math.floor((tl.dayOfYear(t)+(i+e)%7)/7)}}),tl.week=tl.sunday,tl.weeks=tl.sunday.range,tl.weeks.utc=tl.sunday.utc.range,tl.weekOfYear=tl.sundayOfYear;var nl={"-":"",_:" ",0:"0"},rl=/^\s*\d+/,ol=/^%/;Ga.locale=function(t){return{numberFormat:Pe(t),timeFormat:Ie(t)}};var al=Ga.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Ga.format=al.numberFormat,Ga.geo={},ri.prototype={s:0,t:0,add:function(t){oi(t,this.t,sl),oi(sl.s,this.s,this),this.s?this.t+=sl.t:this.s=sl.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var sl=new ri;Ga.geo.stream=function(t,e){t&&ll.hasOwnProperty(t.type)?ll[t.type](t,e):ai(t,e)};var ll={Feature:function(t,e){ai(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,n=-1,r=i.length;++n<r;)ai(i[n].geometry,e)}},cl={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){si(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)si(i[n],e,0)},Polygon:function(t,e){li(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)li(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,n=-1,r=i.length;++n<r;)ai(i[n],e)}};Ga.geo.area=function(t){return hl=0,Ga.geo.stream(t,fl),hl};var hl,ul=new ri,fl={sphere:function(){hl+=4*_s},point:m,lineStart:m,lineEnd:m,polygonStart:function(){ul.reset(),fl.lineStart=ci},polygonEnd:function(){var t=2*ul;hl+=0>t?4*_s+t:t,fl.lineStart=fl.lineEnd=fl.point=m}};Ga.geo.bounds=function(){function t(t,e){y.push(x=[h=t,f=t]),u>e&&(u=e),e>d&&(d=e)}function e(e,i){var n=hi([e*Ss,i*Ss]);if(v){var r=fi(v,n),o=[r[1],-r[0],0],a=fi(o,r);mi(a),a=gi(a);var l=e-p,c=l>0?1:-1,m=a[0]*Cs*c,g=os(l)>180;if(g^(m>c*p&&c*e>m)){var E=a[1]*Cs;E>d&&(d=E)}else if(m=(m+360)%360-180,g^(m>c*p&&c*e>m)){var E=-a[1]*Cs;u>E&&(u=E)}else u>i&&(u=i),i>d&&(d=i);g?p>e?s(h,e)>s(h,f)&&(f=e):s(e,f)>s(h,f)&&(h=e):f>=h?(h>e&&(h=e),e>f&&(f=e)):e>p?s(h,e)>s(h,f)&&(f=e):s(e,f)>s(h,f)&&(h=e)}else t(e,i);v=n,p=e}function i(){T.point=e}function n(){x[0]=h,x[1]=f,T.point=t,v=null}function r(t,i){if(v){var n=t-p;E+=os(n)>180?n+(n>0?360:-360):n}else m=t,g=i;fl.point(t,i),e(t,i)}function o(){fl.lineStart()}function a(){r(m,g),fl.lineEnd(),os(E)>Hs&&(h=-(f=180)),x[0]=h,x[1]=f,v=null}function s(t,e){return(e-=t)<0?e+360:e}function l(t,e){return t[0]-e[0]}function c(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var h,u,f,d,p,m,g,v,E,y,x,T={point:t,lineStart:i,lineEnd:n,polygonStart:function(){T.point=r,T.lineStart=o,T.lineEnd=a,E=0,fl.polygonStart()},polygonEnd:function(){fl.polygonEnd(),T.point=t,T.lineStart=i,T.lineEnd=n,0>ul?(h=-(f=180),u=-(d=90)):E>Hs?d=90:-Hs>E&&(u=-90),x[0]=h,x[1]=f}};return function(t){d=f=-(h=u=1/0),y=[],Ga.geo.stream(t,T);var e=y.length;if(e){y.sort(l);for(var i,n=1,r=y[0],o=[r];e>n;++n)i=y[n],c(i[0],r)||c(i[1],r)?(s(r[0],i[1])>s(r[0],r[1])&&(r[1]=i[1]),s(i[0],r[1])>s(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(var a,i,p=-1/0,e=o.length-1,n=0,r=o[e];e>=n;r=i,++n)i=o[n],(a=s(r[1],i[0]))>p&&(p=a,h=i[0],f=r[1])}return y=x=null,1/0===h||1/0===u?[[0/0,0/0],[0/0,0/0]]:[[h,u],[f,d]]}}(),Ga.geo.centroid=function(t){dl=pl=ml=gl=vl=El=yl=xl=Tl=bl=_l=0,Ga.geo.stream(t,wl);var e=Tl,i=bl,n=_l,r=e*e+i*i+n*n;return Ms>r&&(e=El,i=yl,n=xl,Hs>pl&&(e=ml,i=gl,n=vl),r=e*e+i*i+n*n,Ms>r)?[0/0,0/0]:[Math.atan2(i,e)*Cs,Q(n/Math.sqrt(r))*Cs]};var dl,pl,ml,gl,vl,El,yl,xl,Tl,bl,_l,wl={sphere:m,point:Ei,lineStart:xi,lineEnd:Ti,polygonStart:function(){wl.lineStart=bi},polygonEnd:function(){wl.lineStart=xi}},Rl=Mi(_i,Pi,Li,[-_s,-_s/2]),Hl=1e9;Ga.geo.clipExtent=function(){var t,e,i,n,r,o,a={stream:function(t){return r&&(r.valid=!1),r=o(t),r.valid=!0,r},extent:function(s){return arguments.length?(o=Ii(t=+s[0][0],e=+s[0][1],i=+s[1][0],n=+s[1][1]),r&&(r.valid=!1,r=null),a):[[t,e],[i,n]]}};return a.extent([[0,0],[960,500]])},(Ga.geo.conicEqualArea=function(){return Oi(Ui)}).raw=Ui,Ga.geo.albers=function(){return Ga.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Ga.geo.albersUsa=function(){function t(t){var o=t[0],a=t[1];return e=null,i(o,a),e||(n(o,a),e)||r(o,a),e}var e,i,n,r,o=Ga.geo.albers(),a=Ga.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=Ga.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,i){e=[t,i]}};return t.invert=function(t){var e=o.scale(),i=o.translate(),n=(t[0]-i[0])/e,r=(t[1]-i[1])/e;return(r>=.12&&.234>r&&n>=-.425&&-.214>n?a:r>=.166&&.234>r&&n>=-.214&&-.115>n?s:o).invert(t)},t.stream=function(t){var e=o.stream(t),i=a.stream(t),n=s.stream(t);return{point:function(t,r){e.point(t,r),i.point(t,r),n.point(t,r)},sphere:function(){e.sphere(),i.sphere(),n.sphere()},lineStart:function(){e.lineStart(),i.lineStart(),n.lineStart()},lineEnd:function(){e.lineEnd(),i.lineEnd(),n.lineEnd()},polygonStart:function(){e.polygonStart(),i.polygonStart(),n.polygonStart()},polygonEnd:function(){e.polygonEnd(),i.polygonEnd(),n.polygonEnd()}}},t.precision=function(e){return arguments.length?(o.precision(e),a.precision(e),s.precision(e),t):o.precision()},t.scale=function(e){return arguments.length?(o.scale(e),a.scale(.35*e),s.scale(e),t.translate(o.translate())):o.scale()},t.translate=function(e){if(!arguments.length)return o.translate();var c=o.scale(),h=+e[0],u=+e[1];return i=o.translate(e).clipExtent([[h-.455*c,u-.238*c],[h+.455*c,u+.238*c]]).stream(l).point,n=a.translate([h-.307*c,u+.201*c]).clipExtent([[h-.425*c+Hs,u+.12*c+Hs],[h-.214*c-Hs,u+.234*c-Hs]]).stream(l).point,r=s.translate([h-.205*c,u+.212*c]).clipExtent([[h-.214*c+Hs,u+.166*c+Hs],[h-.115*c-Hs,u+.234*c-Hs]]).stream(l).point,t},t.scale(1070)};var Ml,Sl,Cl,Al,Dl,Pl,kl={point:m,lineStart:m,lineEnd:m,polygonStart:function(){Sl=0,kl.lineStart=Bi},polygonEnd:function(){kl.lineStart=kl.lineEnd=kl.point=m,Ml+=os(Sl/2)}},Ll={point:Vi,lineStart:m,lineEnd:m,polygonStart:m,polygonEnd:m},Nl={point:Gi,lineStart:Xi,lineEnd:qi,polygonStart:function(){Nl.lineStart=Yi},polygonEnd:function(){Nl.point=Gi,Nl.lineStart=Xi,Nl.lineEnd=qi}};Ga.geo.path=function(){function t(t){return t&&("function"==typeof s&&o.pointRadius(+s.apply(this,arguments)),a&&a.valid||(a=r(o)),Ga.geo.stream(t,a)),o.result()}function e(){return a=null,t}var i,n,r,o,a,s=4.5;return t.area=function(t){return Ml=0,Ga.geo.stream(t,r(kl)),Ml},t.centroid=function(t){return ml=gl=vl=El=yl=xl=Tl=bl=_l=0,Ga.geo.stream(t,r(Nl)),_l?[Tl/_l,bl/_l]:xl?[El/xl,yl/xl]:vl?[ml/vl,gl/vl]:[0/0,0/0]},t.bounds=function(t){return Dl=Pl=-(Cl=Al=1/0),Ga.geo.stream(t,r(Ll)),[[Cl,Al],[Dl,Pl]]},t.projection=function(t){return arguments.length?(r=(i=t)?t.stream||Qi(t):_e,e()):i},t.context=function(t){return arguments.length?(o=null==(n=t)?new Wi:new Ki(t),"function"!=typeof s&&o.pointRadius(s),e()):n},t.pointRadius=function(e){return arguments.length?(s="function"==typeof e?e:(o.pointRadius(+e),+e),t):s},t.projection(Ga.geo.albersUsa()).context(null)},Ga.geo.transform=function(t){return{stream:function(e){var i=new Zi(e);for(var n in t)i[n]=t[n];return i}}},Zi.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Ga.geo.projection=tn,Ga.geo.projectionMutator=en,(Ga.geo.equirectangular=function(){return tn(rn)}).raw=rn.invert=rn,Ga.geo.rotation=function(t){function e(e){return e=t(e[0]*Ss,e[1]*Ss),e[0]*=Cs,e[1]*=Cs,e}return t=an(t[0]%360*Ss,t[1]*Ss,t.length>2?t[2]*Ss:0),e.invert=function(e){return e=t.invert(e[0]*Ss,e[1]*Ss),e[0]*=Cs,e[1]*=Cs,e},e},on.invert=rn,Ga.geo.circle=function(){function t(){var t="function"==typeof n?n.apply(this,arguments):n,e=an(-t[0]*Ss,-t[1]*Ss,0).invert,r=[];return i(null,null,1,{point:function(t,i){r.push(t=e(t,i)),t[0]*=Cs,t[1]*=Cs}}),{type:"Polygon",coordinates:[r]}}var e,i,n=[0,0],r=6;return t.origin=function(e){return arguments.length?(n=e,t):n},t.angle=function(n){return arguments.length?(i=hn((e=+n)*Ss,r*Ss),t):e},t.precision=function(n){return arguments.length?(i=hn(e*Ss,(r=+n)*Ss),t):r},t.angle(90)},Ga.geo.distance=function(t,e){var i,n=(e[0]-t[0])*Ss,r=t[1]*Ss,o=e[1]*Ss,a=Math.sin(n),s=Math.cos(n),l=Math.sin(r),c=Math.cos(r),h=Math.sin(o),u=Math.cos(o);return Math.atan2(Math.sqrt((i=u*a)*i+(i=c*h-l*u*s)*i),l*h+c*u*s)},Ga.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return Ga.range(Math.ceil(o/g)*g,r,g).map(f).concat(Ga.range(Math.ceil(c/v)*v,l,v).map(d)).concat(Ga.range(Math.ceil(n/p)*p,i,p).filter(function(t){return os(t%g)>Hs}).map(h)).concat(Ga.range(Math.ceil(s/m)*m,a,m).filter(function(t){return os(t%v)>Hs}).map(u))}var i,n,r,o,a,s,l,c,h,u,f,d,p=10,m=p,g=90,v=360,E=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[f(o).concat(d(l).slice(1),f(r).reverse().slice(1),d(c).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(o=+e[0][0],r=+e[1][0],c=+e[0][1],l=+e[1][1],o>r&&(e=o,o=r,r=e),c>l&&(e=c,c=l,l=e),t.precision(E)):[[o,c],[r,l]]},t.minorExtent=function(e){return arguments.length?(n=+e[0][0],i=+e[1][0],s=+e[0][1],a=+e[1][1],n>i&&(e=n,n=i,i=e),s>a&&(e=s,s=a,a=e),t.precision(E)):[[n,s],[i,a]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(g=+e[0],v=+e[1],t):[g,v]},t.minorStep=function(e){return arguments.length?(p=+e[0],m=+e[1],t):[p,m]},t.precision=function(e){return arguments.length?(E=+e,h=fn(s,a,90),u=dn(n,i,E),f=fn(c,l,90),d=dn(o,r,E),t):E},t.majorExtent([[-180,-90+Hs],[180,90-Hs]]).minorExtent([[-180,-80-Hs],[180,80+Hs]])},Ga.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||n.apply(this,arguments),i||r.apply(this,arguments)]}}var e,i,n=pn,r=mn;return t.distance=function(){return Ga.geo.distance(e||n.apply(this,arguments),i||r.apply(this,arguments))},t.source=function(i){return arguments.length?(n=i,e="function"==typeof i?null:i,t):n},t.target=function(e){return arguments.length?(r=e,i="function"==typeof e?null:e,t):r},t.precision=function(){return arguments.length?t:0},t},Ga.geo.interpolate=function(t,e){return gn(t[0]*Ss,t[1]*Ss,e[0]*Ss,e[1]*Ss)},Ga.geo.length=function(t){return Fl=0,Ga.geo.stream(t,Il),Fl};var Fl,Il={sphere:m,point:m,lineStart:vn,lineEnd:m,polygonStart:m,polygonEnd:m},zl=En(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(Ga.geo.azimuthalEqualArea=function(){return tn(zl)}).raw=zl;var Ol=En(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},_e);(Ga.geo.azimuthalEquidistant=function(){return tn(Ol)}).raw=Ol,(Ga.geo.conicConformal=function(){return Oi(yn)}).raw=yn,(Ga.geo.conicEquidistant=function(){return Oi(xn)}).raw=xn;var Ul=En(function(t){return 1/t},Math.atan);(Ga.geo.gnomonic=function(){return tn(Ul)}).raw=Ul,Tn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Rs]},(Ga.geo.mercator=function(){return bn(Tn)}).raw=Tn;var Bl=En(function(){return 1},Math.asin);(Ga.geo.orthographic=function(){return tn(Bl)}).raw=Bl;var Vl=En(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(Ga.geo.stereographic=function(){return tn(Vl)}).raw=Vl,_n.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Rs]},(Ga.geo.transverseMercator=function(){var t=bn(_n),e=t.center,i=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?i([t[0],t[1],t.length>2?t[2]+90:90]):(t=i(),[t[0],t[1],t[2]-90])},i([0,0,90])}).raw=_n,Ga.geom={},Ga.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,r=be(i),o=be(n),a=t.length,s=[],l=[];for(e=0;a>e;e++)s.push([+r.call(this,t[e],e),+o.call(this,t[e],e),e]);for(s.sort(Mn),e=0;a>e;e++)l.push([s[e][0],-s[e][1]]);var c=Hn(s),h=Hn(l),u=h[0]===c[0],f=h[h.length-1]===c[c.length-1],d=[];for(e=c.length-1;e>=0;--e)d.push(t[s[c[e]][2]]);for(e=+u;e<h.length-f;++e)d.push(t[s[h[e]][2]]);return d}var i=wn,n=Rn;return arguments.length?e(t):(e.x=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(n=t,e):n},e)},Ga.geom.polygon=function(t){return hs(t,Wl),t};var Wl=Ga.geom.polygon.prototype=[];Wl.area=function(){for(var t,e=-1,i=this.length,n=this[i-1],r=0;++e<i;)t=n,n=this[e],r+=t[1]*n[0]-t[0]*n[1];return.5*r},Wl.centroid=function(t){var e,i,n=-1,r=this.length,o=0,a=0,s=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++n<r;)e=s,s=this[n],i=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*i,a+=(e[1]+s[1])*i;return[o*t,a*t]},Wl.clip=function(t){for(var e,i,n,r,o,a,s=An(t),l=-1,c=this.length-An(this),h=this[c-1];++l<c;){for(e=t.slice(),t.length=0,r=this[l],o=e[(n=e.length-s)-1],i=-1;++i<n;)a=e[i],Sn(a,h,r)?(Sn(o,h,r)||t.push(Cn(o,a,h,r)),t.push(a)):Sn(o,h,r)&&t.push(Cn(o,a,h,r)),o=a;s&&t.push(t[0]),h=r}return t};var jl,Gl,Xl,ql,Yl,Kl=[],$l=[];zn.prototype.prepare=function(){for(var t,e=this.edges,i=e.length;i--;)t=e[i].edge,t.b&&t.a||e.splice(i,1);return e.sort(Un),e.length},$n.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Qn.prototype={insert:function(t,e){var i,n,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;i=t}else this._?(t=er(this._),e.P=null,e.N=t,t.P=t.L=e,i=t):(e.P=e.N=null,this._=e,i=null);for(e.L=e.R=null,e.U=i,e.C=!0,t=e;i&&i.C;)n=i.U,i===n.L?(r=n.R,r&&r.C?(i.C=r.C=!1,n.C=!0,t=n):(t===i.R&&(Jn(this,i),t=i,i=t.U),i.C=!1,n.C=!0,tr(this,n))):(r=n.L,r&&r.C?(i.C=r.C=!1,n.C=!0,t=n):(t===i.L&&(tr(this,i),t=i,i=t.U),i.C=!1,n.C=!0,Jn(this,n))),i=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,i,n,r=t.U,o=t.L,a=t.R;if(i=o?a?er(a):o:a,r?r.L===t?r.L=i:r.R=i:this._=i,o&&a?(n=i.C,i.C=t.C,i.L=o,o.U=i,i!==a?(r=i.U,i.U=t.U,t=i.R,r.L=t,i.R=a,a.U=i):(i.U=r,r=i,t=i.R)):(n=t.C,t=i),t&&(t.U=r),!n){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===r.L){if(e=r.R,e.C&&(e.C=!1,r.C=!0,Jn(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,tr(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,Jn(this,r),t=this._;break}}else if(e=r.L,e.C&&(e.C=!1,r.C=!0,tr(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Jn(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,tr(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},Ga.geom.voronoi=function(t){function e(t){var e=new Array(t.length),n=s[0][0],r=s[0][1],o=s[1][0],a=s[1][1];return ir(i(t),s).cells.forEach(function(i,s){var l=i.edges,c=i.site,h=e[s]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):c.x>=n&&c.x<=o&&c.y>=r&&c.y<=a?[[n,a],[o,a],[o,r],[n,r]]:[];h.point=t[s]}),e}function i(t){return t.map(function(t,e){return{x:Math.round(o(t,e)/Hs)*Hs,y:Math.round(a(t,e)/Hs)*Hs,i:e}})}var n=wn,r=Rn,o=n,a=r,s=Ql;return t?e(t):(e.links=function(t){return ir(i(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return ir(i(t)).cells.forEach(function(i,n){for(var r,o,a=i.site,s=i.edges.sort(Un),l=-1,c=s.length,h=s[c-1].edge,u=h.l===a?h.r:h.l;++l<c;)r=h,o=u,h=s[l].edge,u=h.l===a?h.r:h.l,n<o.i&&n<u.i&&rr(a,o,u)<0&&e.push([t[n],t[o.i],t[u.i]])}),e},e.x=function(t){return arguments.length?(o=be(n=t),e):n},e.y=function(t){return arguments.length?(a=be(r=t),e):r},e.clipExtent=function(t){return arguments.length?(s=null==t?Ql:t,e):s===Ql?null:s},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):s===Ql?null:s&&s[1]},e)};var Ql=[[-1e6,-1e6],[1e6,1e6]];Ga.geom.delaunay=function(t){return Ga.geom.voronoi().triangles(t)},Ga.geom.quadtree=function(t,e,i,n,r){function o(t){function o(t,e,i,n,r,o,a,s){if(!isNaN(i)&&!isNaN(n))if(t.leaf){var l=t.x,h=t.y;if(null!=l)if(os(l-i)+os(h-n)<.01)c(t,e,i,n,r,o,a,s);else{var u=t.point;t.x=t.y=t.point=null,c(t,u,l,h,r,o,a,s),c(t,e,i,n,r,o,a,s)}else t.x=i,t.y=n,t.point=e}else c(t,e,i,n,r,o,a,s)}function c(t,e,i,n,r,a,s,l){var c=.5*(r+s),h=.5*(a+l),u=i>=c,f=n>=h,d=(f<<1)+u;t.leaf=!1,t=t.nodes[d]||(t.nodes[d]=sr()),u?r=c:s=c,f?a=h:l=h,o(t,e,i,n,r,a,s,l)}var h,u,f,d,p,m,g,v,E,y=be(s),x=be(l);if(null!=e)m=e,g=i,v=n,E=r;else if(v=E=-(m=g=1/0),u=[],f=[],p=t.length,a)for(d=0;p>d;++d)h=t[d],h.x<m&&(m=h.x),h.y<g&&(g=h.y),h.x>v&&(v=h.x),h.y>E&&(E=h.y),u.push(h.x),f.push(h.y);else for(d=0;p>d;++d){var T=+y(h=t[d],d),b=+x(h,d);m>T&&(m=T),g>b&&(g=b),T>v&&(v=T),b>E&&(E=b),u.push(T),f.push(b)}var _=v-m,w=E-g;_>w?E=g+_:v=m+w;var R=sr();if(R.add=function(t){o(R,t,+y(t,++d),+x(t,d),m,g,v,E)},R.visit=function(t){lr(t,R,m,g,v,E)},d=-1,null==e){for(;++d<p;)o(R,t[d],u[d],f[d],m,g,v,E);--d}else t.forEach(R.add);return u=f=t=h=null,R}var a,s=wn,l=Rn;return(a=arguments.length)?(s=or,l=ar,3===a&&(r=i,n=e,i=e=0),o(t)):(o.x=function(t){return arguments.length?(s=t,o):s},o.y=function(t){return arguments.length?(l=t,o):l},o.extent=function(t){return arguments.length?(null==t?e=i=n=r=null:(e=+t[0][0],i=+t[0][1],n=+t[1][0],r=+t[1][1]),o):null==e?null:[[e,i],[n,r]]},o.size=function(t){return arguments.length?(null==t?e=i=n=r=null:(e=i=0,n=+t[0],r=+t[1]),o):null==e?null:[n-e,r-i]},o)},Ga.interpolateRgb=cr,Ga.interpolateObject=hr,Ga.interpolateNumber=ur,Ga.interpolateString=fr;var Zl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jl=new RegExp(Zl.source,"g");Ga.interpolate=dr,Ga.interpolators=[function(t,e){var i=typeof e;return("string"===i?js.has(e)||/^(#|rgb\(|hsl\()/.test(e)?cr:fr:e instanceof ie?cr:Array.isArray(e)?pr:"object"===i&&isNaN(e)?hr:ur)(t,e)}],Ga.interpolateArray=pr;var tc=function(){return _e},ec=Ga.map({linear:tc,poly:Tr,quad:function(){return Er},cubic:function(){return yr},sin:function(){return br},exp:function(){return _r},circle:function(){return wr},elastic:Rr,back:Hr,bounce:function(){return Mr}}),ic=Ga.map({"in":_e,out:gr,"in-out":vr,"out-in":function(t){return vr(gr(t))}});Ga.ease=function(t){var e=t.indexOf("-"),i=e>=0?t.substring(0,e):t,n=e>=0?t.substring(e+1):"in";return i=ec.get(i)||tc,n=ic.get(n)||_e,mr(n(i.apply(null,Xa.call(arguments,1))))},Ga.interpolateHcl=Sr,Ga.interpolateHsl=Cr,Ga.interpolateLab=Ar,Ga.interpolateRound=Dr,Ga.transform=function(t){var e=Ya.createElementNS(Ga.ns.prefix.svg,"g");return(Ga.transform=function(t){if(null!=t){e.setAttribute("transform",t);var i=e.transform.baseVal.consolidate()}return new Pr(i?i.matrix:nc)})(t)},Pr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var nc={a:1,b:0,c:0,d:1,e:0,f:0};Ga.interpolateTransform=Fr,Ga.layout={},Ga.layout.bundle=function(){return function(t){for(var e=[],i=-1,n=t.length;++i<n;)e.push(Or(t[i]));return e}},Ga.layout.chord=function(){function t(){var t,c,u,f,d,p={},m=[],g=Ga.range(o),v=[];for(i=[],n=[],t=0,f=-1;++f<o;){for(c=0,d=-1;++d<o;)c+=r[f][d];m.push(c),v.push(Ga.range(o)),t+=c}for(a&&g.sort(function(t,e){return a(m[t],m[e])}),s&&v.forEach(function(t,e){t.sort(function(t,i){return s(r[e][t],r[e][i])})}),t=(ws-h*o)/t,c=0,f=-1;++f<o;){for(u=c,d=-1;++d<o;){var E=g[f],y=v[E][d],x=r[E][y],T=c,b=c+=x*t;p[E+"-"+y]={index:E,subindex:y,startAngle:T,endAngle:b,value:x}}n[E]={index:E,startAngle:u,endAngle:c,value:(c-u)/t},c+=h}for(f=-1;++f<o;)for(d=f-1;++d<o;){var _=p[f+"-"+d],w=p[d+"-"+f];(_.value||w.value)&&i.push(_.value<w.value?{source:w,target:_}:{source:_,target:w})}l&&e()}function e(){i.sort(function(t,e){return l((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var i,n,r,o,a,s,l,c={},h=0;return c.matrix=function(t){return arguments.length?(o=(r=t)&&r.length,i=n=null,c):r},c.padding=function(t){return arguments.length?(h=t,i=n=null,c):h},c.sortGroups=function(t){return arguments.length?(a=t,i=n=null,c):a},c.sortSubgroups=function(t){return arguments.length?(s=t,i=null,c):s},c.sortChords=function(t){return arguments.length?(l=t,i&&e(),c):l},c.chords=function(){return i||t(),i},c.groups=function(){return n||t(),n},c},Ga.layout.force=function(){function t(t){return function(e,i,n,r){if(e.point!==t){var o=e.cx-t.x,a=e.cy-t.y,s=r-i,l=o*o+a*a;if(l>s*s/g){if(p>l){var c=e.charge/l;t.px-=o*c,t.py-=a*c}return!0}if(e.point&&l&&p>l){var c=e.pointCharge/l;t.px-=o*c,t.py-=a*c}}return!e.charge}}function e(t){t.px=Ga.event.x,t.py=Ga.event.y,s.resume()}var i,n,r,o,a,s={},l=Ga.dispatch("start","tick","end"),c=[1,1],h=.9,u=rc,f=oc,d=-30,p=ac,m=.1,g=.64,v=[],E=[];return s.tick=function(){if((n*=.99)<.005)return l.end({type:"end",alpha:n=0}),!0;var e,i,s,u,f,p,g,y,x,T=v.length,b=E.length;for(i=0;b>i;++i)s=E[i],u=s.source,f=s.target,y=f.x-u.x,x=f.y-u.y,(p=y*y+x*x)&&(p=n*o[i]*((p=Math.sqrt(p))-r[i])/p,y*=p,x*=p,f.x-=y*(g=u.weight/(f.weight+u.weight)),f.y-=x*g,u.x+=y*(g=1-g),u.y+=x*g);if((g=n*m)&&(y=c[0]/2,x=c[1]/2,i=-1,g))for(;++i<T;)s=v[i],s.x+=(y-s.x)*g,s.y+=(x-s.y)*g;if(d)for(Xr(e=Ga.geom.quadtree(v),n,a),i=-1;++i<T;)(s=v[i]).fixed||e.visit(t(s));for(i=-1;++i<T;)s=v[i],s.fixed?(s.x=s.px,s.y=s.py):(s.x-=(s.px-(s.px=s.x))*h,s.y-=(s.py-(s.py=s.y))*h);l.tick({type:"tick",alpha:n})},s.nodes=function(t){return arguments.length?(v=t,s):v},s.links=function(t){return arguments.length?(E=t,s):E},s.size=function(t){return arguments.length?(c=t,s):c},s.linkDistance=function(t){return arguments.length?(u="function"==typeof t?t:+t,s):u},s.distance=s.linkDistance,s.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,s):f},s.friction=function(t){return arguments.length?(h=+t,s):h},s.charge=function(t){return arguments.length?(d="function"==typeof t?t:+t,s):d},s.chargeDistance=function(t){return arguments.length?(p=t*t,s):Math.sqrt(p)},s.gravity=function(t){return arguments.length?(m=+t,s):m},s.theta=function(t){return arguments.length?(g=t*t,s):Math.sqrt(g)},s.alpha=function(t){return arguments.length?(t=+t,n?n=t>0?t:0:t>0&&(l.start({type:"start",alpha:n=t}),Ga.timer(s.tick)),s):n},s.start=function(){function t(t,n){if(!i){for(i=new Array(l),s=0;l>s;++s)i[s]=[];for(s=0;c>s;++s){var r=E[s];i[r.source.index].push(r.target),i[r.target.index].push(r.source)}}for(var o,a=i[e],s=-1,c=a.length;++s<c;)if(!isNaN(o=a[s][t]))return o;return Math.random()*n}var e,i,n,l=v.length,h=E.length,p=c[0],m=c[1];for(e=0;l>e;++e)(n=v[e]).index=e,n.weight=0;for(e=0;h>e;++e)n=E[e],"number"==typeof n.source&&(n.source=v[n.source]),"number"==typeof n.target&&(n.target=v[n.target]),++n.source.weight,++n.target.weight;for(e=0;l>e;++e)n=v[e],isNaN(n.x)&&(n.x=t("x",p)),isNaN(n.y)&&(n.y=t("y",m)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(r=[],"function"==typeof u)for(e=0;h>e;++e)r[e]=+u.call(this,E[e],e);else for(e=0;h>e;++e)r[e]=u;if(o=[],"function"==typeof f)for(e=0;h>e;++e)o[e]=+f.call(this,E[e],e);else for(e=0;h>e;++e)o[e]=f;if(a=[],"function"==typeof d)for(e=0;l>e;++e)a[e]=+d.call(this,v[e],e);else for(e=0;l>e;++e)a[e]=d;return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){return i||(i=Ga.behavior.drag().origin(_e).on("dragstart.force",Vr).on("drag.force",e).on("dragend.force",Wr)),arguments.length?void this.on("mouseover.force",jr).on("mouseout.force",Gr).call(i):i},Ga.rebind(s,l,"on")};var rc=20,oc=1,ac=1/0;Ga.layout.hierarchy=function(){function t(r){var o,a=[r],s=[];for(r.depth=0;null!=(o=a.pop());)if(s.push(o),(c=i.call(t,o,o.depth))&&(l=c.length)){for(var l,c,h;--l>=0;)a.push(h=c[l]),h.parent=o,h.depth=o.depth+1;n&&(o.value=0),o.children=c}else n&&(o.value=+n.call(t,o,o.depth)||0),delete o.children;return Kr(r,function(t){var i,r;e&&(i=t.children)&&i.sort(e),n&&(r=t.parent)&&(r.value+=t.value)}),s}var e=Zr,i=$r,n=Qr;return t.sort=function(i){return arguments.length?(e=i,t):e},t.children=function(e){return arguments.length?(i=e,t):i},t.value=function(e){return arguments.length?(n=e,t):n},t.revalue=function(e){return n&&(Yr(e,function(t){t.children&&(t.value=0)}),Kr(e,function(e){var i;e.children||(e.value=+n.call(t,e,e.depth)||0),(i=e.parent)&&(i.value+=e.value)})),e},t},Ga.layout.partition=function(){function t(e,i,n,r){var o=e.children;if(e.x=i,e.y=e.depth*r,e.dx=n,e.dy=r,o&&(a=o.length)){var a,s,l,c=-1;for(n=e.value?n/e.value:0;++c<a;)t(s=o[c],i,l=s.value*n,r),i+=l}}function e(t){var i=t.children,n=0;if(i&&(r=i.length))for(var r,o=-1;++o<r;)n=Math.max(n,e(i[o]));return 1+n}function i(i,o){var a=n.call(this,i,o);return t(a[0],0,r[0],r[1]/e(a[0])),a}var n=Ga.layout.hierarchy(),r=[1,1];return i.size=function(t){return arguments.length?(r=t,i):r},qr(i,n)},Ga.layout.pie=function(){function t(o){var a=o.map(function(i,n){return+e.call(t,i,n)}),s=+("function"==typeof n?n.apply(this,arguments):n),l=(("function"==typeof r?r.apply(this,arguments):r)-s)/Ga.sum(a),c=Ga.range(o.length);null!=i&&c.sort(i===sc?function(t,e){return a[e]-a[t]}:function(t,e){return i(o[t],o[e])});var h=[];return c.forEach(function(t){var e;h[t]={data:o[t],value:e=a[t],startAngle:s,endAngle:s+=e*l}}),h}var e=Number,i=sc,n=0,r=ws;return t.value=function(i){return arguments.length?(e=i,t):e},t.sort=function(e){return arguments.length?(i=e,t):i},t.startAngle=function(e){return arguments.length?(n=e,t):n},t.endAngle=function(e){return arguments.length?(r=e,t):r},t};var sc={};Ga.layout.stack=function(){function t(s,l){var c=s.map(function(i,n){return e.call(t,i,n)}),h=c.map(function(e){return e.map(function(e,i){return[o.call(t,e,i),a.call(t,e,i)]})}),u=i.call(t,h,l);c=Ga.permute(c,u),h=Ga.permute(h,u);var f,d,p,m=n.call(t,h,l),g=c.length,v=c[0].length;for(d=0;v>d;++d)for(r.call(t,c[0][d],p=m[d],h[0][d][1]),f=1;g>f;++f)r.call(t,c[f][d],p+=h[f-1][d][1],h[f][d][1]);return s}var e=_e,i=no,n=ro,r=io,o=to,a=eo;return t.values=function(i){return arguments.length?(e=i,t):e},t.order=function(e){return arguments.length?(i="function"==typeof e?e:lc.get(e)||no,t):i},t.offset=function(e){return arguments.length?(n="function"==typeof e?e:cc.get(e)||ro,t):n},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(a=e,t):a},t.out=function(e){return arguments.length?(r=e,t):r},t};var lc=Ga.map({"inside-out":function(t){var e,i,n=t.length,r=t.map(oo),o=t.map(ao),a=Ga.range(n).sort(function(t,e){return r[t]-r[e]
}),s=0,l=0,c=[],h=[];for(e=0;n>e;++e)i=a[e],l>s?(s+=o[i],c.push(i)):(l+=o[i],h.push(i));return h.reverse().concat(c)},reverse:function(t){return Ga.range(t.length).reverse()},"default":no}),cc=Ga.map({silhouette:function(t){var e,i,n,r=t.length,o=t[0].length,a=[],s=0,l=[];for(i=0;o>i;++i){for(e=0,n=0;r>e;e++)n+=t[e][i][1];n>s&&(s=n),a.push(n)}for(i=0;o>i;++i)l[i]=(s-a[i])/2;return l},wiggle:function(t){var e,i,n,r,o,a,s,l,c,h=t.length,u=t[0],f=u.length,d=[];for(d[0]=l=c=0,i=1;f>i;++i){for(e=0,r=0;h>e;++e)r+=t[e][i][1];for(e=0,o=0,s=u[i][0]-u[i-1][0];h>e;++e){for(n=0,a=(t[e][i][1]-t[e][i-1][1])/(2*s);e>n;++n)a+=(t[n][i][1]-t[n][i-1][1])/s;o+=a*t[e][i][1]}d[i]=l-=r?o/r*s:0,c>l&&(c=l)}for(i=0;f>i;++i)d[i]-=c;return d},expand:function(t){var e,i,n,r=t.length,o=t[0].length,a=1/r,s=[];for(i=0;o>i;++i){for(e=0,n=0;r>e;e++)n+=t[e][i][1];if(n)for(e=0;r>e;e++)t[e][i][1]/=n;else for(e=0;r>e;e++)t[e][i][1]=a}for(i=0;o>i;++i)s[i]=0;return s},zero:ro});Ga.layout.histogram=function(){function t(t,o){for(var a,s,l=[],c=t.map(i,this),h=n.call(this,c,o),u=r.call(this,h,c,o),o=-1,f=c.length,d=u.length-1,p=e?1:1/f;++o<d;)a=l[o]=[],a.dx=u[o+1]-(a.x=u[o]),a.y=0;if(d>0)for(o=-1;++o<f;)s=c[o],s>=h[0]&&s<=h[1]&&(a=l[Ga.bisect(u,s,1,d)-1],a.y+=p,a.push(t[o]));return l}var e=!0,i=Number,n=ho,r=lo;return t.value=function(e){return arguments.length?(i=e,t):i},t.range=function(e){return arguments.length?(n=be(e),t):n},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return co(t,e)}:be(e),t):r},t.frequency=function(i){return arguments.length?(e=!!i,t):e},t},Ga.layout.pack=function(){function t(t,o){var a=i.call(this,t,o),s=a[0],l=r[0],c=r[1],h=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(s.x=s.y=0,Kr(s,function(t){t.r=+h(t.value)}),Kr(s,go),n){var u=n*(e?1:Math.max(2*s.r/l,2*s.r/c))/2;Kr(s,function(t){t.r+=u}),Kr(s,go),Kr(s,function(t){t.r-=u})}return yo(s,l/2,c/2,e?1:1/Math.max(2*s.r/l,2*s.r/c)),a}var e,i=Ga.layout.hierarchy().sort(uo),n=0,r=[1,1];return t.size=function(e){return arguments.length?(r=e,t):r},t.radius=function(i){return arguments.length?(e=null==i||"function"==typeof i?i:+i,t):e},t.padding=function(e){return arguments.length?(n=+e,t):n},qr(t,i)},Ga.layout.tree=function(){function t(t,r){var h=a.call(this,t,r),u=h[0],f=e(u);if(Kr(f,i),f.parent.m=-f.z,Yr(f,n),c)Yr(u,o);else{var d=u,p=u,m=u;Yr(u,function(t){t.x<d.x&&(d=t),t.x>p.x&&(p=t),t.depth>m.depth&&(m=t)});var g=s(d,p)/2-d.x,v=l[0]/(p.x+s(p,d)/2+g),E=l[1]/(m.depth||1);Yr(u,function(t){t.x=(t.x+g)*v,t.y=t.depth*E})}return h}function e(t){for(var e,i={A:null,children:[t]},n=[i];null!=(e=n.pop());)for(var r,o=e.children,a=0,s=o.length;s>a;++a)n.push((o[a]=r={_:o[a],parent:e,children:(r=o[a].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=r);return i.children[0]}function i(t){var e=t.children,i=t.parent.children,n=t.i?i[t.i-1]:null;if(e.length){Ro(t);var o=(e[0].z+e[e.length-1].z)/2;n?(t.z=n.z+s(t._,n._),t.m=t.z-o):t.z=o}else n&&(t.z=n.z+s(t._,n._));t.parent.A=r(t,n,t.parent.A||i[0])}function n(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function r(t,e,i){if(e){for(var n,r=t,o=t,a=e,l=r.parent.children[0],c=r.m,h=o.m,u=a.m,f=l.m;a=_o(a),r=bo(r),a&&r;)l=bo(l),o=_o(o),o.a=t,n=a.z+u-r.z-c+s(a._,r._),n>0&&(wo(Ho(a,t,i),t,n),c+=n,h+=n),u+=a.m,c+=r.m,f+=l.m,h+=o.m;a&&!_o(o)&&(o.t=a,o.m+=u-h),r&&!bo(l)&&(l.t=r,l.m+=c-f,i=t)}return i}function o(t){t.x*=l[0],t.y=t.depth*l[1]}var a=Ga.layout.hierarchy().sort(null).value(null),s=To,l=[1,1],c=null;return t.separation=function(e){return arguments.length?(s=e,t):s},t.size=function(e){return arguments.length?(c=null==(l=e)?o:null,t):c?null:l},t.nodeSize=function(e){return arguments.length?(c=null==(l=e)?null:o,t):c?l:null},qr(t,a)},Ga.layout.cluster=function(){function t(t,o){var a,s=e.call(this,t,o),l=s[0],c=0;Kr(l,function(t){var e=t.children;e&&e.length?(t.x=So(e),t.y=Mo(e)):(t.x=a?c+=i(t,a):0,t.y=0,a=t)});var h=Co(l),u=Ao(l),f=h.x-i(h,u)/2,d=u.x+i(u,h)/2;return Kr(l,r?function(t){t.x=(t.x-l.x)*n[0],t.y=(l.y-t.y)*n[1]}:function(t){t.x=(t.x-f)/(d-f)*n[0],t.y=(1-(l.y?t.y/l.y:1))*n[1]}),s}var e=Ga.layout.hierarchy().sort(null).value(null),i=To,n=[1,1],r=!1;return t.separation=function(e){return arguments.length?(i=e,t):i},t.size=function(e){return arguments.length?(r=null==(n=e),t):r?null:n},t.nodeSize=function(e){return arguments.length?(r=null!=(n=e),t):r?n:null},qr(t,e)},Ga.layout.treemap=function(){function t(t,e){for(var i,n,r=-1,o=t.length;++r<o;)n=(i=t[r]).value*(0>e?0:e),i.area=isNaN(n)||0>=n?0:n}function e(i){var o=i.children;if(o&&o.length){var a,s,l,c=u(i),h=[],f=o.slice(),p=1/0,m="slice"===d?c.dx:"dice"===d?c.dy:"slice-dice"===d?1&i.depth?c.dy:c.dx:Math.min(c.dx,c.dy);for(t(f,c.dx*c.dy/i.value),h.area=0;(l=f.length)>0;)h.push(a=f[l-1]),h.area+=a.area,"squarify"!==d||(s=n(h,m))<=p?(f.pop(),p=s):(h.area-=h.pop().area,r(h,m,c,!1),m=Math.min(c.dx,c.dy),h.length=h.area=0,p=1/0);h.length&&(r(h,m,c,!0),h.length=h.area=0),o.forEach(e)}}function i(e){var n=e.children;if(n&&n.length){var o,a=u(e),s=n.slice(),l=[];for(t(s,a.dx*a.dy/e.value),l.area=0;o=s.pop();)l.push(o),l.area+=o.area,null!=o.z&&(r(l,o.z?a.dx:a.dy,a,!s.length),l.length=l.area=0);n.forEach(i)}}function n(t,e){for(var i,n=t.area,r=0,o=1/0,a=-1,s=t.length;++a<s;)(i=t[a].area)&&(o>i&&(o=i),i>r&&(r=i));return n*=n,e*=e,n?Math.max(e*r*p/n,n/(e*o*p)):1/0}function r(t,e,i,n){var r,o=-1,a=t.length,s=i.x,c=i.y,h=e?l(t.area/e):0;if(e==i.dx){for((n||h>i.dy)&&(h=i.dy);++o<a;)r=t[o],r.x=s,r.y=c,r.dy=h,s+=r.dx=Math.min(i.x+i.dx-s,h?l(r.area/h):0);r.z=!0,r.dx+=i.x+i.dx-s,i.y+=h,i.dy-=h}else{for((n||h>i.dx)&&(h=i.dx);++o<a;)r=t[o],r.x=s,r.y=c,r.dx=h,c+=r.dy=Math.min(i.y+i.dy-c,h?l(r.area/h):0);r.z=!1,r.dy+=i.y+i.dy-c,i.x+=h,i.dx-=h}}function o(n){var r=a||s(n),o=r[0];return o.x=0,o.y=0,o.dx=c[0],o.dy=c[1],a&&s.revalue(o),t([o],o.dx*o.dy/o.value),(a?i:e)(o),f&&(a=r),r}var a,s=Ga.layout.hierarchy(),l=Math.round,c=[1,1],h=null,u=Do,f=!1,d="squarify",p=.5*(1+Math.sqrt(5));return o.size=function(t){return arguments.length?(c=t,o):c},o.padding=function(t){function e(e){var i=t.call(o,e,e.depth);return null==i?Do(e):Po(e,"number"==typeof i?[i,i,i,i]:i)}function i(e){return Po(e,t)}if(!arguments.length)return h;var n;return u=null==(h=t)?Do:"function"==(n=typeof t)?e:"number"===n?(t=[t,t,t,t],i):i,o},o.round=function(t){return arguments.length?(l=t?Math.round:Number,o):l!=Number},o.sticky=function(t){return arguments.length?(f=t,a=null,o):f},o.ratio=function(t){return arguments.length?(p=t,o):p},o.mode=function(t){return arguments.length?(d=t+"",o):d},qr(o,s)},Ga.random={normal:function(t,e){var i=arguments.length;return 2>i&&(e=1),1>i&&(t=0),function(){var i,n,r;do i=2*Math.random()-1,n=2*Math.random()-1,r=i*i+n*n;while(!r||r>1);return t+e*i*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=Ga.random.normal.apply(Ga,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=Ga.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,i=0;t>i;i++)e+=Math.random();return e}}},Ga.scale={};var hc={floor:_e,ceil:_e};Ga.scale.linear=function(){return Oo([0,1],[0,1],dr,!1)};var uc={s:1,g:1,p:1,r:1,e:1};Ga.scale.log=function(){return qo(Ga.scale.linear().domain([0,1]),10,!0,[1,10])};var fc=Ga.format(".0e"),dc={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};Ga.scale.pow=function(){return Yo(Ga.scale.linear(),1,[0,1])},Ga.scale.sqrt=function(){return Ga.scale.pow().exponent(.5)},Ga.scale.ordinal=function(){return $o([],{t:"range",a:[[]]})},Ga.scale.category10=function(){return Ga.scale.ordinal().range(pc)},Ga.scale.category20=function(){return Ga.scale.ordinal().range(mc)},Ga.scale.category20b=function(){return Ga.scale.ordinal().range(gc)},Ga.scale.category20c=function(){return Ga.scale.ordinal().range(vc)};var pc=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(me),mc=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(me),gc=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(me),vc=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(me);Ga.scale.quantile=function(){return Qo([],[])},Ga.scale.quantize=function(){return Zo(0,1,[0,1])},Ga.scale.threshold=function(){return Jo([.5],[0,1])},Ga.scale.identity=function(){return ta([0,1])},Ga.svg={},Ga.svg.arc=function(){function t(){var t=e.apply(this,arguments),o=i.apply(this,arguments),a=n.apply(this,arguments)+Ec,s=r.apply(this,arguments)+Ec,l=(a>s&&(l=a,a=s,s=l),s-a),c=_s>l?"0":"1",h=Math.cos(a),u=Math.sin(a),f=Math.cos(s),d=Math.sin(s);return l>=yc?t?"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"Z":t?"M"+o*h+","+o*u+"A"+o+","+o+" 0 "+c+",1 "+o*f+","+o*d+"L"+t*f+","+t*d+"A"+t+","+t+" 0 "+c+",0 "+t*h+","+t*u+"Z":"M"+o*h+","+o*u+"A"+o+","+o+" 0 "+c+",1 "+o*f+","+o*d+"L0,0Z"}var e=ea,i=ia,n=na,r=ra;return t.innerRadius=function(i){return arguments.length?(e=be(i),t):e},t.outerRadius=function(e){return arguments.length?(i=be(e),t):i},t.startAngle=function(e){return arguments.length?(n=be(e),t):n},t.endAngle=function(e){return arguments.length?(r=be(e),t):r},t.centroid=function(){var t=(e.apply(this,arguments)+i.apply(this,arguments))/2,o=(n.apply(this,arguments)+r.apply(this,arguments))/2+Ec;return[Math.cos(o)*t,Math.sin(o)*t]},t};var Ec=-Rs,yc=ws-Hs;Ga.svg.line=function(){return oa(_e)};var xc=Ga.map({linear:aa,"linear-closed":sa,step:la,"step-before":ca,"step-after":ha,basis:ga,"basis-open":va,"basis-closed":Ea,bundle:ya,cardinal:da,"cardinal-open":ua,"cardinal-closed":fa,monotone:Ra});xc.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Tc=[0,2/3,1/3,0],bc=[0,1/3,2/3,0],_c=[0,1/6,2/3,1/6];Ga.svg.line.radial=function(){var t=oa(Ha);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},ca.reverse=ha,ha.reverse=ca,Ga.svg.area=function(){return Ma(_e)},Ga.svg.area.radial=function(){var t=Ma(Ha);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},Ga.svg.chord=function(){function t(t,s){var l=e(this,o,t,s),c=e(this,a,t,s);return"M"+l.p0+n(l.r,l.p1,l.a1-l.a0)+(i(l,c)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,c.r,c.p0)+n(c.r,c.p1,c.a1-c.a0)+r(c.r,c.p1,l.r,l.p0))+"Z"}function e(t,e,i,n){var r=e.call(t,i,n),o=s.call(t,r,n),a=l.call(t,r,n)+Ec,h=c.call(t,r,n)+Ec;return{r:o,a0:a,a1:h,p0:[o*Math.cos(a),o*Math.sin(a)],p1:[o*Math.cos(h),o*Math.sin(h)]}}function i(t,e){return t.a0==e.a0&&t.a1==e.a1}function n(t,e,i){return"A"+t+","+t+" 0 "+ +(i>_s)+",1 "+e}function r(t,e,i,n){return"Q 0,0 "+n}var o=pn,a=mn,s=Sa,l=na,c=ra;return t.radius=function(e){return arguments.length?(s=be(e),t):s},t.source=function(e){return arguments.length?(o=be(e),t):o},t.target=function(e){return arguments.length?(a=be(e),t):a},t.startAngle=function(e){return arguments.length?(l=be(e),t):l},t.endAngle=function(e){return arguments.length?(c=be(e),t):c},t},Ga.svg.diagonal=function(){function t(t,r){var o=e.call(this,t,r),a=i.call(this,t,r),s=(o.y+a.y)/2,l=[o,{x:o.x,y:s},{x:a.x,y:s},a];return l=l.map(n),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=pn,i=mn,n=Ca;return t.source=function(i){return arguments.length?(e=be(i),t):e},t.target=function(e){return arguments.length?(i=be(e),t):i},t.projection=function(e){return arguments.length?(n=e,t):n},t},Ga.svg.diagonal.radial=function(){var t=Ga.svg.diagonal(),e=Ca,i=t.projection;return t.projection=function(t){return arguments.length?i(Aa(e=t)):e},t},Ga.svg.symbol=function(){function t(t,n){return(wc.get(e.call(this,t,n))||ka)(i.call(this,t,n))}var e=Pa,i=Da;return t.type=function(i){return arguments.length?(e=be(i),t):e},t.size=function(e){return arguments.length?(i=be(e),t):i},t};var wc=Ga.map({circle:ka,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Sc)),i=e*Sc;return"M0,"+-e+"L"+i+",0 0,"+e+" "+-i+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Mc),i=e*Mc/2;return"M0,"+i+"L"+e+","+-i+" "+-e+","+-i+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Mc),i=e*Mc/2;return"M0,"+-i+"L"+e+","+i+" "+-e+","+i+"Z"}});Ga.svg.symbolTypes=wc.keys();var Rc,Hc,Mc=Math.sqrt(3),Sc=Math.tan(30*Ss),Cc=[],Ac=0;Cc.call=ms.call,Cc.empty=ms.empty,Cc.node=ms.node,Cc.size=ms.size,Ga.transition=function(t){return arguments.length?Rc?t.transition():t:Es.transition()},Ga.transition.prototype=Cc,Cc.select=function(t){var e,i,n,r=this.id,o=[];t=b(t);for(var a=-1,s=this.length;++a<s;){o.push(e=[]);for(var l=this[a],c=-1,h=l.length;++c<h;)(n=l[c])&&(i=t.call(n,n.__data__,c,a))?("__data__"in n&&(i.__data__=n.__data__),Ia(i,c,r,n.__transition__[r]),e.push(i)):e.push(null)}return La(o,r)},Cc.selectAll=function(t){var e,i,n,r,o,a=this.id,s=[];t=_(t);for(var l=-1,c=this.length;++l<c;)for(var h=this[l],u=-1,f=h.length;++u<f;)if(n=h[u]){o=n.__transition__[a],i=t.call(n,n.__data__,u,l),s.push(e=[]);for(var d=-1,p=i.length;++d<p;)(r=i[d])&&Ia(r,d,a,o),e.push(r)}return La(s,a)},Cc.filter=function(t){var e,i,n,r=[];"function"!=typeof t&&(t=L(t));for(var o=0,a=this.length;a>o;o++){r.push(e=[]);for(var i=this[o],s=0,l=i.length;l>s;s++)(n=i[s])&&t.call(n,n.__data__,s,o)&&e.push(n)}return La(r,this.id)},Cc.tween=function(t,e){var i=this.id;return arguments.length<2?this.node().__transition__[i].tween.get(t):F(this,null==e?function(e){e.__transition__[i].tween.remove(t)}:function(n){n.__transition__[i].tween.set(t,e)})},Cc.attr=function(t,e){function i(){this.removeAttribute(s)}function n(){this.removeAttributeNS(s.space,s.local)}function r(t){return null==t?i:(t+="",function(){var e,i=this.getAttribute(s);return i!==t&&(e=a(i,t),function(t){this.setAttribute(s,e(t))})})}function o(t){return null==t?n:(t+="",function(){var e,i=this.getAttributeNS(s.space,s.local);return i!==t&&(e=a(i,t),function(t){this.setAttributeNS(s.space,s.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var a="transform"==t?Fr:dr,s=Ga.ns.qualify(t);return Na(this,"attr."+t,e,s.local?o:r)},Cc.attrTween=function(t,e){function i(t,i){var n=e.call(this,t,i,this.getAttribute(r));return n&&function(t){this.setAttribute(r,n(t))}}function n(t,i){var n=e.call(this,t,i,this.getAttributeNS(r.space,r.local));return n&&function(t){this.setAttributeNS(r.space,r.local,n(t))}}var r=Ga.ns.qualify(t);return this.tween("attr."+t,r.local?n:i)},Cc.style=function(t,e,i){function n(){this.style.removeProperty(t)}function r(e){return null==e?n:(e+="",function(){var n,r=$a.getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(n=dr(r,e),function(e){this.style.setProperty(t,n(e),i)})})}var o=arguments.length;if(3>o){if("string"!=typeof t){2>o&&(e="");for(i in t)this.style(i,t[i],e);return this}i=""}return Na(this,"style."+t,e,r)},Cc.styleTween=function(t,e,i){function n(n,r){var o=e.call(this,n,r,$a.getComputedStyle(this,null).getPropertyValue(t));return o&&function(e){this.style.setProperty(t,o(e),i)}}return arguments.length<3&&(i=""),this.tween("style."+t,n)},Cc.text=function(t){return Na(this,"text",t,Fa)},Cc.remove=function(){return this.each("end.transition",function(){var t;this.__transition__.count<2&&(t=this.parentNode)&&t.removeChild(this)})},Cc.ease=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].ease:("function"!=typeof t&&(t=Ga.ease.apply(Ga,arguments)),F(this,function(i){i.__transition__[e].ease=t}))},Cc.delay=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].delay:F(this,"function"==typeof t?function(i,n,r){i.__transition__[e].delay=+t.call(i,i.__data__,n,r)}:(t=+t,function(i){i.__transition__[e].delay=t}))},Cc.duration=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].duration:F(this,"function"==typeof t?function(i,n,r){i.__transition__[e].duration=Math.max(1,t.call(i,i.__data__,n,r))}:(t=Math.max(1,t),function(i){i.__transition__[e].duration=t}))},Cc.each=function(t,e){var i=this.id;if(arguments.length<2){var n=Hc,r=Rc;Rc=i,F(this,function(e,n,r){Hc=e.__transition__[i],t.call(e,e.__data__,n,r)}),Hc=n,Rc=r}else F(this,function(n){var r=n.__transition__[i];(r.event||(r.event=Ga.dispatch("start","end"))).on(t,e)});return this},Cc.transition=function(){for(var t,e,i,n,r=this.id,o=++Ac,a=[],s=0,l=this.length;l>s;s++){a.push(t=[]);for(var e=this[s],c=0,h=e.length;h>c;c++)(i=e[c])&&(n=Object.create(i.__transition__[r]),n.delay+=n.duration,Ia(i,c,o,n)),t.push(i)}return La(a,o)},Ga.svg.axis=function(){function t(t){t.each(function(){var t,c=Ga.select(this),h=this.__chart__||i,u=this.__chart__=i.copy(),f=null==l?u.ticks?u.ticks.apply(u,s):u.domain():l,d=null==e?u.tickFormat?u.tickFormat.apply(u,s):_e:e,p=c.selectAll(".tick").data(f,u),m=p.enter().insert("g",".domain").attr("class","tick").style("opacity",Hs),g=Ga.transition(p.exit()).style("opacity",Hs).remove(),v=Ga.transition(p.order()).style("opacity",1),E=Lo(u),y=c.selectAll(".domain").data([0]),x=(y.enter().append("path").attr("class","domain"),Ga.transition(y));m.append("line"),m.append("text");var T=m.select("line"),b=v.select("line"),_=p.select("text").text(d),w=m.select("text"),R=v.select("text");switch(n){case"bottom":t=za,T.attr("y2",r),w.attr("y",Math.max(r,0)+a),b.attr("x2",0).attr("y2",r),R.attr("x",0).attr("y",Math.max(r,0)+a),_.attr("dy",".71em").style("text-anchor","middle"),x.attr("d","M"+E[0]+","+o+"V0H"+E[1]+"V"+o);break;case"top":t=za,T.attr("y2",-r),w.attr("y",-(Math.max(r,0)+a)),b.attr("x2",0).attr("y2",-r),R.attr("x",0).attr("y",-(Math.max(r,0)+a)),_.attr("dy","0em").style("text-anchor","middle"),x.attr("d","M"+E[0]+","+-o+"V0H"+E[1]+"V"+-o);break;case"left":t=Oa,T.attr("x2",-r),w.attr("x",-(Math.max(r,0)+a)),b.attr("x2",-r).attr("y2",0),R.attr("x",-(Math.max(r,0)+a)).attr("y",0),_.attr("dy",".32em").style("text-anchor","end"),x.attr("d","M"+-o+","+E[0]+"H0V"+E[1]+"H"+-o);break;case"right":t=Oa,T.attr("x2",r),w.attr("x",Math.max(r,0)+a),b.attr("x2",r).attr("y2",0),R.attr("x",Math.max(r,0)+a).attr("y",0),_.attr("dy",".32em").style("text-anchor","start"),x.attr("d","M"+o+","+E[0]+"H0V"+E[1]+"H"+o)}if(u.rangeBand){var H=u,M=H.rangeBand()/2;h=u=function(t){return H(t)+M}}else h.rangeBand?h=u:g.call(t,u);m.call(t,h),v.call(t,u)})}var e,i=Ga.scale.linear(),n=Dc,r=6,o=6,a=3,s=[10],l=null;return t.scale=function(e){return arguments.length?(i=e,t):i},t.orient=function(e){return arguments.length?(n=e in Pc?e+"":Dc,t):n},t.ticks=function(){return arguments.length?(s=arguments,t):s},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(i){return arguments.length?(e=i,t):e},t.tickSize=function(e){var i=arguments.length;return i?(r=+e,o=+arguments[i-1],t):r},t.innerTickSize=function(e){return arguments.length?(r=+e,t):r},t.outerTickSize=function(e){return arguments.length?(o=+e,t):o},t.tickPadding=function(e){return arguments.length?(a=+e,t):a},t.tickSubdivide=function(){return arguments.length&&t},t};var Dc="bottom",Pc={top:1,right:1,bottom:1,left:1};Ga.svg.brush=function(){function t(o){o.each(function(){var o=Ga.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",r).on("touchstart.brush",r),a=o.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),o.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=o.selectAll(".resize").data(p,_e);s.exit().remove(),s.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return kc[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",t.empty()?"none":null);var h,u=Ga.transition(o),f=Ga.transition(a);l&&(h=Lo(l),f.attr("x",h[0]).attr("width",h[1]-h[0]),i(u)),c&&(h=Lo(c),f.attr("y",h[0]).attr("height",h[1]-h[0]),n(u)),e(u)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+h[+/e$/.test(t)]+","+u[+/^s/.test(t)]+")"})}function i(t){t.select(".extent").attr("x",h[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",h[1]-h[0])}function n(t){t.select(".extent").attr("y",u[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",u[1]-u[0])}function r(){function r(){32==Ga.event.keyCode&&(S||(y=null,A[0]-=h[1],A[1]-=u[1],S=2),E())}function p(){32==Ga.event.keyCode&&2==S&&(A[0]+=h[1],A[1]+=u[1],S=0,E())}function m(){var t=Ga.mouse(T),r=!1;x&&(t[0]+=x[0],t[1]+=x[1]),S||(Ga.event.altKey?(y||(y=[(h[0]+h[1])/2,(u[0]+u[1])/2]),A[0]=h[+(t[0]<y[0])],A[1]=u[+(t[1]<y[1])]):y=null),H&&g(t,l,0)&&(i(w),r=!0),M&&g(t,c,1)&&(n(w),r=!0),r&&(e(w),_({type:"brush",mode:S?"move":"resize"}))}function g(t,e,i){var n,r,s=Lo(e),l=s[0],c=s[1],p=A[i],m=i?u:h,g=m[1]-m[0];return S&&(l-=p,c-=g+p),n=(i?d:f)?Math.max(l,Math.min(c,t[i])):t[i],S?r=(n+=p)+g:(y&&(p=Math.max(l,Math.min(c,2*y[i]-n))),n>p?(r=n,n=p):r=p),m[0]!=n||m[1]!=r?(i?a=null:o=null,m[0]=n,m[1]=r,!0):void 0}function v(){m(),w.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),Ga.select("body").style("cursor",null),D.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),C(),_({type:"brushend"})}var y,x,T=this,b=Ga.select(Ga.event.target),_=s.of(T,arguments),w=Ga.select(T),R=b.datum(),H=!/^(n|s)$/.test(R)&&l,M=!/^(e|w)$/.test(R)&&c,S=b.classed("extent"),C=W(),A=Ga.mouse(T),D=Ga.select($a).on("keydown.brush",r).on("keyup.brush",p);if(Ga.event.changedTouches?D.on("touchmove.brush",m).on("touchend.brush",v):D.on("mousemove.brush",m).on("mouseup.brush",v),w.interrupt().selectAll("*").interrupt(),S)A[0]=h[0]-A[0],A[1]=u[0]-A[1];else if(R){var P=+/w$/.test(R),k=+/^n/.test(R);x=[h[1-P]-A[0],u[1-k]-A[1]],A[0]=h[P],A[1]=u[k]}else Ga.event.altKey&&(y=A.slice());w.style("pointer-events","none").selectAll(".resize").style("display",null),Ga.select("body").style("cursor",b.style("cursor")),_({type:"brushstart"}),m()}var o,a,s=x(t,"brushstart","brush","brushend"),l=null,c=null,h=[0,0],u=[0,0],f=!0,d=!0,p=Lc[0];return t.event=function(t){t.each(function(){var t=s.of(this,arguments),e={x:h,y:u,i:o,j:a},i=this.__chart__||e;this.__chart__=e,Rc?Ga.select(this).transition().each("start.brush",function(){o=i.i,a=i.j,h=i.x,u=i.y,t({type:"brushstart"})}).tween("brush:brush",function(){var i=pr(h,e.x),n=pr(u,e.y);return o=a=null,function(r){h=e.x=i(r),u=e.y=n(r),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=e.i,a=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(l=e,p=Lc[!l<<1|!c],t):l},t.y=function(e){return arguments.length?(c=e,p=Lc[!l<<1|!c],t):c},t.clamp=function(e){return arguments.length?(l&&c?(f=!!e[0],d=!!e[1]):l?f=!!e:c&&(d=!!e),t):l&&c?[f,d]:l?f:c?d:null},t.extent=function(e){var i,n,r,s,f;return arguments.length?(l&&(i=e[0],n=e[1],c&&(i=i[0],n=n[0]),o=[i,n],l.invert&&(i=l(i),n=l(n)),i>n&&(f=i,i=n,n=f),(i!=h[0]||n!=h[1])&&(h=[i,n])),c&&(r=e[0],s=e[1],l&&(r=r[1],s=s[1]),a=[r,s],c.invert&&(r=c(r),s=c(s)),r>s&&(f=r,r=s,s=f),(r!=u[0]||s!=u[1])&&(u=[r,s])),t):(l&&(o?(i=o[0],n=o[1]):(i=h[0],n=h[1],l.invert&&(i=l.invert(i),n=l.invert(n)),i>n&&(f=i,i=n,n=f))),c&&(a?(r=a[0],s=a[1]):(r=u[0],s=u[1],c.invert&&(r=c.invert(r),s=c.invert(s)),r>s&&(f=r,r=s,s=f))),l&&c?[[i,r],[n,s]]:l?[i,n]:c&&[r,s])},t.clear=function(){return t.empty()||(h=[0,0],u=[0,0],o=a=null),t},t.empty=function(){return!!l&&h[0]==h[1]||!!c&&u[0]==u[1]},Ga.rebind(t,s,"on")};var kc={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Lc=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Nc=tl.format=al.timeFormat,Fc=Nc.utc,Ic=Fc("%Y-%m-%dT%H:%M:%S.%LZ");Nc.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Ua:Ic,Ua.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Ua.toString=Ic.toString,tl.second=Ne(function(t){return new el(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),tl.seconds=tl.second.range,tl.seconds.utc=tl.second.utc.range,tl.minute=Ne(function(t){return new el(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),tl.minutes=tl.minute.range,tl.minutes.utc=tl.minute.utc.range,tl.hour=Ne(function(t){var e=t.getTimezoneOffset()/60;return new el(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),tl.hours=tl.hour.range,tl.hours.utc=tl.hour.utc.range,tl.month=Ne(function(t){return t=tl.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),tl.months=tl.month.range,tl.months.utc=tl.month.utc.range;var zc=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Oc=[[tl.second,1],[tl.second,5],[tl.second,15],[tl.second,30],[tl.minute,1],[tl.minute,5],[tl.minute,15],[tl.minute,30],[tl.hour,1],[tl.hour,3],[tl.hour,6],[tl.hour,12],[tl.day,1],[tl.day,2],[tl.week,1],[tl.month,1],[tl.month,3],[tl.year,1]],Uc=Nc.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",_i]]),Bc={range:function(t,e,i){return Ga.range(Math.ceil(t/i)*i,+e,i).map(Va)},floor:_e,ceil:_e};Oc.year=tl.year,tl.scale=function(){return Ba(Ga.scale.linear(),Oc,Uc)};var Vc=Oc.map(function(t){return[t[0].utc,t[1]]}),Wc=Fc.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",_i]]);Vc.year=tl.year.utc,tl.scale.utc=function(){return Ba(Ga.scale.linear(),Vc,Wc)},Ga.text=we(function(t){return t.responseText}),Ga.json=function(t,e){return Re(t,"application/json",Wa,e)},Ga.html=function(t,e){return Re(t,"text/html",ja,e)},Ga.xml=we(function(t){return t.responseXML}),"function"==typeof define&&define.amd?define(Ga):"object"==typeof module&&module.exports&&(module.exports=Ga),this.d3=Ga}(),!function(){function t(t){function n(){for(;s=h<c.length&&t>u;){var e=h++,n=c[e],o=i.call(n,1);o.push(r(e)),++u,n[0].apply(null,o)}}function r(t){return function(e,i){--u,null==d&&(null!=e?(d=e,h=f=0/0,o()):(c[t]=i,--f?s||n():o()))}}function o(){null!=d?p(d):l?p(d,c):p.apply(null,[d].concat(c))}var a,s,l,c=[],h=0,u=0,f=0,d=null,p=e;return t||(t=1/0),a={defer:function(){return d||(c.push(arguments),++f,n()),a},await:function(t){return p=t,l=!1,f||o(),a},awaitAll:function(t){return p=t,l=!0,f||o(),a}}}function e(){}var i=[].slice;t.version="1.0.7","function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.queue=t}(),d3.parcoords=function(t){function e(t,e,i){d3.keys(e).forEach(function(n){t[n]=function(r){if(!arguments.length)return e[n];var o=e[n];return e[n]=r,w[n].call(u,{value:r,previous:o}),i[n].call(u,{value:r,previous:o}),t}})}function i(t,e){for(key in e)t[key]=e[key];return t}function n(t,e){e.strokeStyle=d3.functor(h.color)(t),e.beginPath(),h.dimensions.map(function(i,n){0==n?e.moveTo(c(i),v[i](t[i])):e.lineTo(c(i),v[i](t[i]))}),e.stroke()}function r(t,e){e.clearRect(-1,-1,d()+2,p()+2),e.beginPath(),t.forEach(function(t){h.dimensions.map(function(i,n){0==n?e.moveTo(c(i),v[i](t[i])):e.lineTo(c(i),v[i](t[i]))})}),e.stroke()}function o(t){return n(t,b.foreground)}function a(t){return n(t,b.highlight)}function s(t){return!v[t].brush.empty()}function l(){var t=h.dimensions.filter(s),e=t.map(function(t){return v[t].brush.extent()}),i={number:function(t,i,n){return e[n][0]<=t[i]&&t[i]<=e[n][1]},string:function(t,i,n){return e[n][0]<=v[i](t[i])&&v[i](t[i])<=e[n][1]}};return h.data.filter(function(e){return t.every(function(t,n){return i[h.types[t]](e,t,n)})})}function c(t){var e=E[t];return null==e?g(t):e}var h={data:[],dimensions:[],types:{},brushed:!1,mode:"default",rate:20,width:600,height:300,margin:{top:24,right:0,bottom:12,left:0},color:"#069",composite:"source-over",alpha:.7};i(h,t);var u=function(t){return t=u.selection=d3.select(t),h.width=t[0][0].clientWidth,h.height=t[0][0].clientHeight,["shadows","marks","foreground","highlight"].forEach(function(e){_[e]=t.append("canvas").attr("class",e)[0][0],b[e]=_[e].getContext("2d")}),u.svg=t.append("svg").attr("width",h.width).attr("height",h.height).append("svg:g").attr("transform","translate("+h.margin.left+","+h.margin.top+")"),u},f=d3.dispatch.apply(this,["render","resize","highlight","brush"].concat(d3.keys(h))),d=function(){return h.width-h.margin.right-h.margin.left},p=function(){return h.height-h.margin.top-h.margin.bottom},m={brushable:!1,reorderable:!1,axes:!1,interactive:!1,shadows:!1,debug:!1},g=d3.scale.ordinal(),v={},E={},y=d3.svg.line(),x=d3.svg.axis().orient("right").ticks(0),T,b={},_={},w=d3.dispatch.apply(this,d3.keys(h)).on("composite",function(t){b.foreground.globalCompositeOperation=t.value}).on("alpha",function(t){b.foreground.globalAlpha=t.value}).on("width",function(t){u.resize()}).on("height",function(t){u.resize()}).on("margin",function(t){u.resize()}).on("rate",function(t){R.rate(t.value)}).on("data",function(t){m.shadows&&r(h.data,b.shadows)}).on("dimensions",function(t){g.domain(h.dimensions),m.interactive&&u.render().updateAxes()});u.state=h,u.flags=m,e(u,h,f),d3.rebind(u,f,"on"),d3.rebind(u,x,"ticks","orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat"),u.autoscale=function(){var t={number:function(t){return d3.scale.linear().domain(d3.extent(h.data,function(e){return+e[t]})).range([p()+1,1])},string:function(t){return d3.scale.ordinal().domain(h.data.map(function(e){return e[t]})).rangePoints([p()+1,1])}};return h.dimensions.forEach(function(e){v[e]=t[h.types[e]](e)}),u.dimensions(u.dimensions().filter(function(t,e){var i=v[t].domain().length;return"string"==h.types[t]&&(i>60||2>i)?!1:!0})),g.rangePoints([0,d()],1),u.selection.selectAll("canvas").style("margin-top",h.margin.top+"px").style("margin-left",h.margin.left+"px").attr("width",d()+2).attr("height",p()+2),b.foreground.strokeStyle=h.color,b.foreground.lineWidth=1.4,b.foreground.globalCompositeOperation=h.composite,b.foreground.globalAlpha=h.alpha,b.highlight.lineWidth=3,b.shadows.strokeStyle="#dadada",this},u.detectDimensions=function(){return u.types(u.detectDimensionTypes(h.data)),u.dimensions(d3.keys(u.types())),this},u.toType=function(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},u.toTypeCoerceNumbers=function(t){return parseFloat(t)==t&&null!=t?"number":u.toType(t)},u.detectDimensionTypes=function(t){var e={};return d3.keys(t[0]).forEach(function(i){e[i]=u.toTypeCoerceNumbers(t[0][i])}),e},u.render=function(){return h.dimensions.length||u.detectDimensions(),h.dimensions[0]in v||u.autoscale(),u.render[h.mode](),f.render.call(this),this
},u.render.default=function(){u.clear("foreground"),h.brushed?h.brushed.forEach(o):h.data.forEach(o)};var R=d3.renderQueue(o).rate(50).clear(function(){u.clear("foreground")});return u.render.queue=function(){R(h.brushed?h.brushed:h.data)},u.shadows=function(){return m.shadows=!0,h.data.length>0&&r(h.data,b.shadows),this},u.axisDots=function(){var t=u.ctx.marks;return t.globalAlpha=d3.min([1/Math.pow(data.length,.5),1]),h.data.forEach(function(e){h.dimensions.map(function(i,n){t.fillRect(c(i)-.75,v[i](e[i])-.75,1.5,1.5)})}),this},u.clear=function(t){return b[t].clearRect(0,0,d()+2,p()+2),this},u.createAxes=function(){return T&&u.removeAxes(),T=u.svg.selectAll(".dimension").data(h.dimensions,function(t){return t}).enter().append("svg:g").attr("class","dimension").attr("transform",function(t){return"translate("+g(t)+")"}),T.append("svg:g").attr("class","axis").attr("transform","translate(0,0)").each(function(t){d3.select(this).call(x.scale(v[t]))}).append("svg:text").attr({"text-anchor":"middle",y:0,transform:"translate(0,-12)",x:0,"class":"label"}).text(function(t){return isNaN(parseInt(t))?t:"PC "+t}),m.axes=!0,this},u.removeAxes=function(){return T.remove(),this},u.updateAxes=function(){var t=u.svg.selectAll(".dimension").data(h.dimensions,function(t){return t});return t.enter().append("svg:g").attr("class","dimension").attr("transform",function(t){return"translate("+c(t)+")"}).style("opacity",0).append("svg:g").attr("class","axis").attr("transform","translate(0,0)").each(function(t){d3.select(this).call(x.scale(v[t]))}).append("svg:text").attr({"text-anchor":"middle",y:0,transform:"translate(0,-12)",x:0,"class":"label"}).text(String),t.exit().remove(),T=u.svg.selectAll(".dimension"),T.transition().duration(1100).attr("transform",function(t){return"translate("+c(t)+")"}).style("opacity",1),m.shadows&&r(h.data,b.shadows),this},u.brushable=function(){return T||u.createAxes(),T.append("svg:g").attr("class","brush").each(function(t){d3.select(this).call(v[t].brush=d3.svg.brush().y(v[t]).on("brush",u.brush))}).selectAll("rect").style("visibility",null).attr("x",-15).attr("width",30),m.brushable=!0,this},u.reorderable=function(){return T||u.createAxes(),T.style("cursor","move").call(d3.behavior.drag().on("dragstart",function(t){E[t]=this.__origin__=g(t)}).on("drag",function(t){E[t]=Math.min(d(),Math.max(0,this.__origin__+=d3.event.dx)),h.dimensions.sort(function(t,e){return c(t)-c(e)}),g.domain(h.dimensions),u.render(),T.attr("transform",function(t){return"translate("+c(t)+")"})}).on("dragend",function(t){delete this.__origin__,delete E[t],d3.select(this).transition().attr("transform","translate("+g(t)+")"),u.render()})),m.reorderable=!0,this},u.adjacent_pairs=function(t){for(var e=[],i=0;i<t.length-1;i++)e.push([t[i],t[i+1]]);return e},u.interactive=function(){return m.interactive=!0,this},u.brush=function(){h.brushed=l(),f.brush.call(u,h.brushed),u.render()},u.xscale=g,u.yscale=v,u.ctx=b,u.canvas=_,u.g=function(){return T},u.brushReset=function(t){return v[t].brush.clear()(u.g().filter(function(e){return t==e})),this},u.resize=function(){return u.selection.select("svg").attr("width",h.width).attr("height",h.height),u.svg.attr("transform","translate("+h.margin.left+","+h.margin.top+")"),u.autoscale(),T&&u.createAxes().brushable(),f.resize.call(this,{width:h.width,height:h.height,margin:h.margin}),this},u.highlight=function(t){return u.clear("highlight"),d3.select(_.foreground).classed("faded",!0),t.forEach(a),f.highlight.call(this,t),this},u.unhighlight=function(t){return u.clear("highlight"),d3.select(_.foreground).classed("faded",!1),this},u.intersection=function(t,e,i,n){return{x:((t.x*e.y-t.y*e.x)*(i.x-n.x)-(t.x-e.x)*(i.x*n.y-i.y*n.x))/((t.x-e.x)*(i.y-n.y)-(t.y-e.y)*(i.x-n.x)),y:((t.x*e.y-t.y*e.x)*(i.y-n.y)-(t.y-e.y)*(i.x*n.y-i.y*n.x))/((t.x-e.x)*(i.y-n.y)-(t.y-e.y)*(i.x-n.x))}},u.toString=function(){return"Parallel Coordinates: "+h.dimensions.length+" dimensions ("+d3.keys(h.data[0]).length+" total) , "+h.data.length+" rows"},u.version="0.1.7",u},d3.renderQueue=function(t){var e=[],i=10,n=function(){},r=0,o=function(t){t&&o.data(t),o.invalidate(),n(),o.render()};return o.render=function(){function n(){if(!a)return!1;if(r>e.length)return!1;var o=e.slice(r,r+i);r+=i,o.map(t),d3.timer(n)}r=0;var a=!0;o.invalidate=function(){a=!1},n()},o.data=function(t){return o.invalidate(),e=t.slice(0),o},o.rate=function(t){return arguments.length?(i=t,o):i},o.remaining=function(){return e.length-r},o.clear=function(t){return arguments.length?(n=t,o):(n(),o)},o.invalidate=function(){},o},!d3)throw"d3 wasn't included!";!function(){function t(t,e){var i=function(t,e){if(e(t),t.children)for(var n=t.children.length-1;n>=0;n--)i(t.children[n],e)};i(t[0],function(t){t.rootDist=(t.parent?t.parent.rootDist:0)+(t.length||0)});var n=t.map(function(t){return t.rootDist}),r=d3.scale.linear().domain([0,d3.max(n)]).range([0,e/2]);return i(t[0],function(t){t.y=r(t.rootDist)}),r}d3.phylogram={},d3.phylogram.rightAngleDiagonal=function(){function t(t,n){var r=t.source,o=t.target,a=(r.x+o.x)/2,s=(r.y+o.y)/2,l=[r,{x:o.x,y:r.y},o];return l=l.map(e),i(l)}var e=function(t){return[t.y,t.x]},i=function(t){return"M"+t[0]+" "+t[1]+" "+t[2]};return t.projection=function(i){return arguments.length?(e=i,t):e},t.path=function(e){return arguments.length?(i=e,t):i},t},d3.phylogram.radialRightAngleDiagonal=function(){return d3.phylogram.rightAngleDiagonal().path(function(t){var e=t[0],i=t[1],n=t[2],r=Math.sqrt(e[0]*e[0]+e[1]*e[1]),o=d3.phylogram.coordinateToAngle(e,r),a=d3.phylogram.coordinateToAngle(i,r),s=Math.abs(a-o)>Math.PI?o>=a:a>o,l=0,c=0,h=s?0:1;return"M"+e+" A"+[r,r]+" "+l+" "+c+","+h+" "+i+"L"+n}).projection(function(t){var e=t.y,i=(t.x-90)/180*Math.PI;return[e*Math.cos(i),e*Math.sin(i)]})},d3.phylogram.coordinateToAngle=function(t,e){var i=2*Math.PI,n=i/4,r=t[0]>=0?t[1]>=0?1:2:t[1]>=0?4:3,o=Math.abs(Math.asin(t[1]/e));switch(r){case 1:coordAngle=n-o;break;case 2:coordAngle=n+o;break;case 3:coordAngle=2*n+n-o;break;case 4:coordAngle=3*n+o}return coordAngle},d3.phylogram.styleTreeNodes=function(t){t.selectAll("g.leaf.node").append("svg:circle").attr("r",4.5).attr("stroke","steelblue").attr("fill","steelblue").attr("stroke-width","2px"),t.selectAll("g.root.node").append("svg:circle").attr("r",4.5).attr("fill","steelblue").attr("stroke","steelblue").attr("stroke-width","2px")},d3.phylogram.build=function(e,i,n){n=n||{};var r=n.width||d3.select(e).style("width")||d3.select(e).attr("width"),o=n.height||d3.select(e).style("height")||d3.select(e).attr("height"),r=parseInt(r),o=parseInt(o),a=n.tree||d3.layout.cluster().size([o,r]).sort(function(t){return t.children?t.children.length:-1}).children(n.children||function(t){return t.branchset}),s=n.diagonal||d3.phylogram.rightAngleDiagonal(),l=n.vis||d3.select(e).append("svg:svg").attr("width",r+300).attr("height",o+30).attr("class","phylogram").append("svg:g").attr("transform","translate(20, 20)"),i=a(i);if(n.skipBranchLengthScaling)var c=d3.scale.linear().domain([0,r]).range([0,r]);else var c=t(i,r);n.skipTicks||(l.selectAll("line").data(c.ticks(10)).enter().append("svg:line").attr("y1",0).attr("y2",o).attr("x1",c).attr("x2",c).attr("stroke","#ddd"),l.selectAll("text.rule").data(c.ticks(10)).enter().append("svg:text").attr("class","rule").attr("x",c).attr("y",0).attr("dy",-3).attr("text-anchor","middle").attr("font-size","8px").attr("fill","#ccc").text(function(t){return Math.round(100*t)/100}));var h=l.selectAll("path.link").data(a.links(i)).enter().append("svg:path").attr("class","link").attr("d",s).attr("fill","none").attr("stroke","#aaa").attr("stroke-width","4px"),u=l.selectAll("g.node").data(i).enter().append("svg:g").attr("class",function(t){return t.children?0==t.depth?"root node":"inner node":"leaf node"}).attr("transform",function(t){return"translate("+t.y+","+t.x+")"});return d3.phylogram.styleTreeNodes(l),n.skipLabels||(l.selectAll("g.inner.node").append("svg:text").attr("dx",-6).attr("dy",-6).attr("text-anchor","end").attr("font-size","8px").attr("fill","#ccc").text(function(t){return t.length}),l.selectAll("g.leaf.node").append("svg:text").attr("dx",8).attr("dy",3).attr("text-anchor","start").attr("font-family","Helvetica Neue, Helvetica, sans-serif").attr("font-size","10px").attr("fill","black").text(function(t){return t.name+" ("+t.length+")"})),{tree:a,vis:l}},d3.phylogram.buildRadial=function(t,e,i){i=i||{};var n=i.width||d3.select(t).style("width")||d3.select(t).attr("width"),r=n/2,o=i.skipLabels?10:i.labelWidth||300,a=d3.select(t).append("svg:svg").attr("width",n+235).attr("height",n+180).append("svg:g").attr("transform","translate("+(r-60+o/2)+","+(r-50+o/2)+")"),s=d3.layout.tree().size([360,r]).sort(function(t){return t.children?t.children.length:-1}).children(i.children||function(t){return t.branchset}).separation(function(t,e){return(t.parent==e.parent?1:2)/t.depth}),l=d3.phylogram.build(t,e,{vis:a,tree:s,skipBranchLengthScaling:i.skipBranchLengthScaling,skipTicks:!0,skipLabels:i.skipLabels,diagonal:d3.phylogram.radialRightAngleDiagonal()});return a.selectAll("g.node").attr("transform",function(t){return"rotate("+(t.x-90)+")translate("+t.y+")"}),i.skipLabels||(a.selectAll("g.leaf.node text").attr("dx",function(t){return t.x<180?8:-8}).attr("dy",".31em").attr("text-anchor",function(t){return t.x<180?"start":"end"}).attr("transform",function(t){return t.x<180?null:"rotate(180)"}).attr("font-family","Helvetica Neue, Helvetica, sans-serif").attr("font-size","10px").attr("fill","black").text(function(t){return t.name+"("+t.length+")"}),a.selectAll("g.inner.node text").attr("dx",function(t){return t.x<180?-6:6}).attr("text-anchor",function(t){return t.x<180?"end":"start"}).attr("transform",function(t){return t.x<180?null:"rotate(180)"})),{tree:s,vis:a}}}(),function(t){t.parse=function(t){for(var e=[],i={},n=t.split(/\s*(;|\(|\)|,|:)\s*/),r=0;r<n.length;r++){var o=n[r];switch(o){case"(":var a={};i.branchset=[a],e.push(i),i=a;break;case",":var a={};e[e.length-1].branchset.push(a),i=a;break;case")":i=e.pop();break;case":":break;default:var s=n[r-1];")"==s||"("==s||","==s?i.name=o:":"==s&&(i.length=parseFloat(o))}}return i}}("undefined"!=typeof exports?exports:this.Newick={});var THREE=THREE||{REVISION:"58"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}},self.Int32Array=self.Int32Array||Array,self.Float32Array=self.Float32Array||Array,String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},THREE.extend=function(t,e){if(Object.keys)for(var i=Object.keys(e),n=0,r=i.length;r>n;n++){var o=i[n];Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}else{var a={}.hasOwnProperty;for(var o in e)a.call(e,o)&&(t[o]=e[o])}return t},function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];void 0===window.requestAnimationFrame&&(window.requestAnimationFrame=function(e){var i=Date.now(),n=Math.max(0,16-(i-t)),r=window.setTimeout(function(){e(i+n)},n);return t=i+n,r}),window.cancelAnimationFrame=window.cancelAnimationFrame||function(t){window.clearTimeout(t)}}(),THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.Color=function(t){return void 0!==t&&this.set(t),this},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(t){return t instanceof THREE.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(t,e,i){if(0===e)this.r=this.g=this.b=i;else{var n=function(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+6*(e-t)*(2/3-i):t},r=.5>=i?i*(1+e):i+e-i*e,o=2*i-r;this.r=n(o,r,t+1/3),this.g=n(o,r,t),this.b=n(o,r,t-1/3)}return this},setStyle:function(t){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(t)){var e=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(t);return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(t)){var e=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(t);return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(t)){var e=/^\#([0-9a-f]{6})$/i.exec(t);return this.setHex(parseInt(e[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(t)){var e=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t);return this.setHex(parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3],16)),this}return/^(\w+)$/i.test(t)?(this.setHex(THREE.ColorKeywords[t]),this):void 0},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t){return this.r=t.r*t.r,this.g=t.g*t.g,this.b=t.b*t.b,this},copyLinearToGamma:function(t){return this.r=Math.sqrt(t.r),this.g=Math.sqrt(t.g),this.b=Math.sqrt(t.b),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var t={h:0,s:0,l:0};return function(){var e=this.r,i=this.g,n=this.b,r=Math.max(e,i,n),o=Math.min(e,i,n),a,s,l=(o+r)/2;if(o===r)a=0,s=0;else{var c=r-o;switch(s=.5>=l?c/(r+o):c/(2-r-o),r){case e:a=(i-n)/c+(n>i?6:0);break;case i:a=(n-e)/c+2;break;case n:a=(e-i)/c+4}a/=6}return t.h=a,t.s=s,t.l=l,t}}(),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},setFromEuler:function(t,e){var i=Math.cos(t.x/2),n=Math.cos(t.y/2),r=Math.cos(t.z/2),o=Math.sin(t.x/2),a=Math.sin(t.y/2),s=Math.sin(t.z/2);return void 0===e||"XYZ"===e?(this.x=o*n*r+i*a*s,this.y=i*a*r-o*n*s,this.z=i*n*s+o*a*r,this.w=i*n*r-o*a*s):"YXZ"===e?(this.x=o*n*r+i*a*s,this.y=i*a*r-o*n*s,this.z=i*n*s-o*a*r,this.w=i*n*r+o*a*s):"ZXY"===e?(this.x=o*n*r-i*a*s,this.y=i*a*r+o*n*s,this.z=i*n*s+o*a*r,this.w=i*n*r-o*a*s):"ZYX"===e?(this.x=o*n*r-i*a*s,this.y=i*a*r+o*n*s,this.z=i*n*s-o*a*r,this.w=i*n*r+o*a*s):"YZX"===e?(this.x=o*n*r+i*a*s,this.y=i*a*r+o*n*s,this.z=i*n*s-o*a*r,this.w=i*n*r-o*a*s):"XZY"===e&&(this.x=o*n*r-i*a*s,this.y=i*a*r-o*n*s,this.z=i*n*s+o*a*r,this.w=i*n*r+o*a*s),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this.w=Math.cos(i),this},setFromRotationMatrix:function(t){var e=t.elements,i=e[0],n=e[4],r=e[8],o=e[1],a=e[5],s=e[9],l=e[2],c=e[6],h=e[10],u=i+a+h,f;return u>0?(f=.5/Math.sqrt(u+1),this.w=.25/f,this.x=(c-s)*f,this.y=(r-l)*f,this.z=(o-n)*f):i>a&&i>h?(f=2*Math.sqrt(1+i-a-h),this.w=(c-s)/f,this.x=.25*f,this.y=(n+o)/f,this.z=(r+l)/f):a>h?(f=2*Math.sqrt(1+a-i-h),this.w=(r-l)/f,this.x=(n+o)/f,this.y=.25*f,this.z=(s+c)/f):(f=2*Math.sqrt(1+h-i-a),this.w=(o-n)/f,this.x=(r+l)/f,this.y=(s+c)/f,this.z=.25*f),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var t=this.length();return 0===t?(this.x=0,this.y=0,this.z=0,this.w=1):(t=1/t,this.x=this.x*t,this.y=this.y*t,this.z=this.z*t,this.w=this.w*t),this},multiply:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var i=t.x,n=t.y,r=t.z,o=t.w,a=e.x,s=e.y,l=e.z,c=e.w;return this.x=i*c+o*a+n*l-r*s,this.y=n*c+o*s+r*a-i*l,this.z=r*c+o*l+i*s-n*a,this.w=o*c-i*a-n*s-r*l,this},multiplyVector3:function(t){return console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},slerp:function(t,e){var i=this.x,n=this.y,r=this.z,o=this.w,a=o*t.w+i*t.x+n*t.y+r*t.z;if(0>a?(this.w=-t.w,this.x=-t.x,this.y=-t.y,this.z=-t.z,a=-a):this.copy(t),a>=1)return this.w=o,this.x=i,this.y=n,this.z=r,this;var s=Math.acos(a),l=Math.sqrt(1-a*a);if(Math.abs(l)<.001)return this.w=.5*(o+this.w),this.x=.5*(i+this.x),this.y=.5*(n+this.y),this.z=.5*(r+this.z),this;var c=Math.sin((1-e)*s)/l,h=Math.sin(e*s)/l;return this.w=o*c+this.w*h,this.x=i*c+this.x*h,this.y=n*c+this.y*h,this.z=r*c+this.z*h,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t){return this.x=t[0],this.y=t[1],this.z=t[2],this.w=t[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}},THREE.Quaternion.slerp=function(t,e,i,n){return i.copy(t).slerp(e,n)},THREE.Vector2=function(t,e){this.x=t||0,this.y=e||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},sub:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t):this.set(0,0),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t){return this.x=t[0],this.y=t[1],this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},sub:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12],this.y=r[1]*e+r[5]*i+r[9]*n+r[13],this.z=r[2]*e+r[6]*i+r[10]*n+r[14],this},applyProjection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements,o=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*o,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*o,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*o,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*n-a*i,c=s*i+a*e-r*n,h=s*n+r*i-o*e,u=-r*e-o*i-a*n;return this.x=l*s+u*-r+c*-a-h*-o,this.y=c*s+u*-o+h*-r-l*-a,this.z=h*s+u*-a+l*-o-c*-r,this},transformDirection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t,this.z/=t):(this.x=0,this.y=0,this.z=0),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},cross:function(t,e){if(void 0!==e)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var i=this.x,n=this.y,r=this.z;return this.x=n*t.z-r*t.y,this.y=r*t.x-i*t.z,this.z=i*t.y-n*t.x,this},crossVectors:function(t,e){return this.x=t.y*e.z-t.z*e.y,this.y=t.z*e.x-t.x*e.z,this.z=t.x*e.y-t.y*e.x,this},angleTo:function(t){var e=this.dot(t)/(this.length()*t.length());return Math.acos(THREE.Math.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},setEulerFromRotationMatrix:function(t,e){function i(t){return Math.min(Math.max(t,-1),1)}var n=t.elements,r=n[0],o=n[4],a=n[8],s=n[1],l=n[5],c=n[9],h=n[2],u=n[6],f=n[10];return void 0===e||"XYZ"===e?(this.y=Math.asin(i(a)),Math.abs(a)<.99999?(this.x=Math.atan2(-c,f),this.z=Math.atan2(-o,r)):(this.x=Math.atan2(u,l),this.z=0)):"YXZ"===e?(this.x=Math.asin(-i(c)),Math.abs(c)<.99999?(this.y=Math.atan2(a,f),this.z=Math.atan2(s,l)):(this.y=Math.atan2(-h,r),this.z=0)):"ZXY"===e?(this.x=Math.asin(i(u)),Math.abs(u)<.99999?(this.y=Math.atan2(-h,f),this.z=Math.atan2(-o,l)):(this.y=0,this.z=Math.atan2(s,r))):"ZYX"===e?(this.y=Math.asin(-i(h)),Math.abs(h)<.99999?(this.x=Math.atan2(u,f),this.z=Math.atan2(s,r)):(this.x=0,this.z=Math.atan2(-o,l))):"YZX"===e?(this.z=Math.asin(i(s)),Math.abs(s)<.99999?(this.x=Math.atan2(-c,l),this.y=Math.atan2(-h,r)):(this.x=0,this.y=Math.atan2(a,f))):"XZY"===e&&(this.z=Math.asin(-i(o)),Math.abs(o)<.99999?(this.x=Math.atan2(u,l),this.y=Math.atan2(a,r)):(this.x=Math.atan2(-c,f),this.y=0)),this},setEulerFromQuaternion:function(t,e){function i(t){return Math.min(Math.max(t,-1),1)}var n=t.x*t.x,r=t.y*t.y,o=t.z*t.z,a=t.w*t.w;return void 0===e||"XYZ"===e?(this.x=Math.atan2(2*(t.x*t.w-t.y*t.z),a-n-r+o),this.y=Math.asin(i(2*(t.x*t.z+t.y*t.w))),this.z=Math.atan2(2*(t.z*t.w-t.x*t.y),a+n-r-o)):"YXZ"===e?(this.x=Math.asin(i(2*(t.x*t.w-t.y*t.z))),this.y=Math.atan2(2*(t.x*t.z+t.y*t.w),a-n-r+o),this.z=Math.atan2(2*(t.x*t.y+t.z*t.w),a-n+r-o)):"ZXY"===e?(this.x=Math.asin(i(2*(t.x*t.w+t.y*t.z))),this.y=Math.atan2(2*(t.y*t.w-t.z*t.x),a-n-r+o),this.z=Math.atan2(2*(t.z*t.w-t.x*t.y),a-n+r-o)):"ZYX"===e?(this.x=Math.atan2(2*(t.x*t.w+t.z*t.y),a-n-r+o),this.y=Math.asin(i(2*(t.y*t.w-t.x*t.z))),this.z=Math.atan2(2*(t.x*t.y+t.z*t.w),a+n-r-o)):"YZX"===e?(this.x=Math.atan2(2*(t.x*t.w-t.z*t.y),a-n+r-o),this.y=Math.atan2(2*(t.y*t.w-t.x*t.z),a+n-r-o),this.z=Math.asin(i(2*(t.x*t.y+t.z*t.w)))):"XZY"===e&&(this.x=Math.atan2(2*(t.x*t.w+t.y*t.z),a-n+r-o),this.y=Math.atan2(2*(t.x*t.z+t.y*t.w),a+n-r-o),this.z=Math.asin(i(2*(t.z*t.w-t.x*t.y)))),this},getPositionFromMatrix:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},getScaleFromMatrix:function(t){var e=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),i=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),n=this.set(t.elements[8],t.elements[9],t.elements[10]).length();
return this.x=e,this.y=i,this.z=n,this},getColumnFromMatrix:function(t,e){var i=4*t,n=e.elements;return this.x=n[i],this.y=n[i+1],this.z=n[i+2],this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t){return this.x=t[0],this.y=t[1],this.z=t[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var t=new THREE.Quaternion;return function(e,i){var n=t.setFromEuler(e,i);return this.applyQuaternion(n),this}}(),applyAxisAngle:function(){var t=new THREE.Quaternion;return function(e,i){var n=t.setFromAxisAngle(e,i);return this.applyQuaternion(n),this}}(),projectOnVector:function(){var t=new THREE.Vector3;return function(e){t.copy(e).normalize();var i=this.dot(t);return this.copy(t).multiplyScalar(i)}}(),projectOnPlane:function(){var t=new THREE.Vector3;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new THREE.Vector3;return function(e){return t.copy(this).projectOnVector(e).multiplyScalar(2),this.subVectors(t,this)}}()}),THREE.Vector4=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},sub:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*i+o[8]*n+o[12]*r,this.y=o[1]*e+o[5]*i+o[9]*n+o[13]*r,this.z=o[2]*e+o[6]*i+o[10]*n+o[14]*r,this.w=o[3]*e+o[7]*i+o[11]*n+o[15]*r,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t,this.z/=t,this.w/=t):(this.x=0,this.y=0,this.z=0,this.w=1),this},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,n,r,o=.01,a=.1,s=t.elements,l=s[0],c=s[4],h=s[8],u=s[1],f=s[5],d=s[9],p=s[2],m=s[6],g=s[10];if(Math.abs(c-u)<o&&Math.abs(h-p)<o&&Math.abs(d-m)<o){if(Math.abs(c+u)<a&&Math.abs(h+p)<a&&Math.abs(d+m)<a&&Math.abs(l+f+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;var v=(l+1)/2,E=(f+1)/2,y=(g+1)/2,x=(c+u)/4,T=(h+p)/4,b=(d+m)/4;return v>E&&v>y?o>v?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(v),n=x/i,r=T/i):E>y?o>E?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(E),i=x/n,r=b/n):o>y?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(y),i=T/r,n=b/r),this.set(i,n,r,e),this}var _=Math.sqrt((m-d)*(m-d)+(h-p)*(h-p)+(u-c)*(u-c));return Math.abs(_)<.001&&(_=1),this.x=(m-d)/_,this.y=(h-p)/_,this.z=(u-c)/_,this.w=Math.acos((l+f+g-1)/2),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this.w>t.w&&(this.w=t.w),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this.w<t.w&&(this.w=t.w),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this.w<t.w?this.w=t.w:this.w>e.w&&(this.w=e.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t){return this.x=t[0],this.y=t[1],this.z=t[2],this.w=t[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Line3=function(t,e){this.start=void 0!==t?t:new THREE.Vector3,this.end=void 0!==e?e:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){var e=t||new THREE.Vector3;return e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){var e=t||new THREE.Vector3;return e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var i=e||new THREE.Vector3;return this.delta(i).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i,n){t.subVectors(i,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),o=e.dot(t),a=o/r;return n&&(a=THREE.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,i){var n=this.closestPointToPointParameter(t,e),r=i||new THREE.Vector3;return this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}},THREE.Box2=function(t,e){this.min=void 0!==t?t:new THREE.Vector2(1/0,1/0),this.max=void 0!==e?e:new THREE.Vector2(-1/0,-1/0)},THREE.Box2.prototype={constructor:THREE.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){if(t.length>0){var e=t[0];this.min.copy(e),this.max.copy(e);for(var i=1,n=t.length;n>i;i++)e=t[i],e.x<this.min.x?this.min.x=e.x:e.x>this.max.x&&(this.max.x=e.x),e.y<this.min.y?this.min.y=e.y:e.y>this.max.y&&(this.max.y=e.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var t=new THREE.Vector2;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){var e=t||new THREE.Vector2;return e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var e=t||new THREE.Vector2;return e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y?!1:!0},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y?!0:!1},getParameter:function(t){return new THREE.Vector2((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y?!1:!0},clampPoint:function(t,e){var i=e||new THREE.Vector2;return i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new THREE.Vector2;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}},THREE.Box3=function(t,e){this.min=void 0!==t?t:new THREE.Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new THREE.Vector3(-1/0,-1/0,-1/0)},THREE.Box3.prototype={constructor:THREE.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){if(t.length>0){var e=t[0];this.min.copy(e),this.max.copy(e);for(var i=1,n=t.length;n>i;i++)e=t[i],e.x<this.min.x?this.min.x=e.x:e.x>this.max.x&&(this.max.x=e.x),e.y<this.min.y?this.min.y=e.y:e.y>this.max.y&&(this.max.y=e.y),e.z<this.min.z?this.min.z=e.z:e.z>this.max.z&&(this.max.z=e.z)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var t=new THREE.Vector3;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){var e=t||new THREE.Vector3;return e.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){var e=t||new THREE.Vector3;return e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z?!1:!0},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z?!0:!1},getParameter:function(t){return new THREE.Vector3((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z?!1:!0},clampPoint:function(t,e){var i=e||new THREE.Vector3;return i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new THREE.Vector3;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),getBoundingSphere:function(){var t=new THREE.Vector3;return function(e){var i=e||new THREE.Sphere;return i.center=this.center(),i.radius=.5*this.size(t).length(),i}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(e){return t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(t),this}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}},THREE.Matrix3=function(t,e,i,n,r,o,a,s,l){this.elements=new Float32Array(9),this.set(void 0!==t?t:1,e||0,i||0,n||0,void 0!==r?r:1,o||0,a||0,s||0,void 0!==l?l:1)},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(t,e,i,n,r,o,a,s,l){var c=this.elements;return c[0]=t,c[3]=e,c[6]=i,c[1]=n,c[4]=r,c[7]=o,c[2]=a,c[5]=s,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},multiplyVector3:function(t){return console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){var t=new THREE.Vector3;return function(e){for(var i=0,n=e.length;n>i;i+=3)t.x=e[i],t.y=e[i+1],t.z=e[i+2],t.applyMatrix3(this),e[i]=t.x,e[i+1]=t.y,e[i+2]=t.z;return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8];return e*o*c-e*a*l-i*r*c+i*a*s+n*r*l-n*o*s},getInverse:function(t,e){var i=t.elements,n=this.elements;n[0]=i[10]*i[5]-i[6]*i[9],n[1]=-i[10]*i[1]+i[2]*i[9],n[2]=i[6]*i[1]-i[2]*i[5],n[3]=-i[10]*i[4]+i[6]*i[8],n[4]=i[10]*i[0]-i[2]*i[8],n[5]=-i[6]*i[0]+i[2]*i[4],n[6]=i[9]*i[4]-i[5]*i[8],n[7]=-i[9]*i[0]+i[1]*i[8],n[8]=i[5]*i[0]-i[1]*i[4];var r=i[0]*n[0]+i[1]*n[3]+i[2]*n[6];if(0===r){var o="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(o);return console.warn(o),this.identity(),this}return this.multiplyScalar(1/r),this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.getInverse(t).transpose(),this},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},clone:function(){var t=this.elements;return new THREE.Matrix3(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])}},THREE.Matrix4=function(t,e,i,n,r,o,a,s,l,c,h,u,f,d,p,m){var g=this.elements=new Float32Array(16);g[0]=void 0!==t?t:1,g[4]=e||0,g[8]=i||0,g[12]=n||0,g[1]=r||0,g[5]=void 0!==o?o:1,g[9]=a||0,g[13]=s||0,g[2]=l||0,g[6]=c||0,g[10]=void 0!==h?h:1,g[14]=u||0,g[3]=f||0,g[7]=d||0,g[11]=p||0,g[15]=void 0!==m?m:1},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(t,e,i,n,r,o,a,s,l,c,h,u,f,d,p,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=f,g[7]=d,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]),this},extractPosition:function(t){return console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractRotation:function(){var t=new THREE.Vector3;return function(e){var i=this.elements,n=e.elements,r=1/t.set(n[0],n[1],n[2]).length(),o=1/t.set(n[4],n[5],n[6]).length(),a=1/t.set(n[8],n[9],n[10]).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[4]=n[4]*o,i[5]=n[5]*o,i[6]=n[6]*o,i[8]=n[8]*a,i[9]=n[9]*a,i[10]=n[10]*a,this}}(),setRotationFromEuler:function(t,e){return console.warn("DEPRECATED: Matrix4's .setRotationFromEuler() has been deprecated in favor of makeRotationFromEuler.  Please update your code."),this.makeRotationFromEuler(t,e)},makeRotationFromEuler:function(t,e){var i=this.elements,n=t.x,r=t.y,o=t.z,a=Math.cos(n),s=Math.sin(n),l=Math.cos(r),c=Math.sin(r),h=Math.cos(o),u=Math.sin(o);if(void 0===e||"XYZ"===e){var f=a*h,d=a*u,p=s*h,m=s*u;i[0]=l*h,i[4]=-l*u,i[8]=c,i[1]=d+p*c,i[5]=f-m*c,i[9]=-s*l,i[2]=m-f*c,i[6]=p+d*c,i[10]=a*l}else if("YXZ"===e){var g=l*h,v=l*u,E=c*h,y=c*u;i[0]=g+y*s,i[4]=E*s-v,i[8]=a*c,i[1]=a*u,i[5]=a*h,i[9]=-s,i[2]=v*s-E,i[6]=y+g*s,i[10]=a*l}else if("ZXY"===e){var g=l*h,v=l*u,E=c*h,y=c*u;i[0]=g-y*s,i[4]=-a*u,i[8]=E+v*s,i[1]=v+E*s,i[5]=a*h,i[9]=y-g*s,i[2]=-a*c,i[6]=s,i[10]=a*l}else if("ZYX"===e){var f=a*h,d=a*u,p=s*h,m=s*u;i[0]=l*h,i[4]=p*c-d,i[8]=f*c+m,i[1]=l*u,i[5]=m*c+f,i[9]=d*c-p,i[2]=-c,i[6]=s*l,i[10]=a*l}else if("YZX"===e){var x=a*l,T=a*c,b=s*l,_=s*c;i[0]=l*h,i[4]=_-x*u,i[8]=b*u+T,i[1]=u,i[5]=a*h,i[9]=-s*h,i[2]=-c*h,i[6]=T*u+b,i[10]=x-_*u}else if("XZY"===e){var x=a*l,T=a*c,b=s*l,_=s*c;i[0]=l*h,i[4]=-u,i[8]=c*h,i[1]=x*u+_,i[5]=a*h,i[9]=T*u-b,i[2]=b*u-T,i[6]=s*h,i[10]=_*u+x}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},setRotationFromQuaternion:function(t){return console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code."),this.makeRotationFromQuaternion(t)},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z,o=t.w,a=i+i,s=n+n,l=r+r,c=i*a,h=i*s,u=i*l,f=n*s,d=n*l,p=r*l,m=o*a,g=o*s,v=o*l;return e[0]=1-(f+p),e[4]=h-v,e[8]=u+g,e[1]=h+v,e[5]=1-(c+p),e[9]=d-m,e[2]=u-g,e[6]=d+m,e[10]=1-(c+f),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(n,r,o){var a=this.elements;return i.subVectors(n,r).normalize(),0===i.length()&&(i.z=1),t.crossVectors(o,i).normalize(),0===t.length()&&(i.x+=1e-4,t.crossVectors(o,i).normalize()),e.crossVectors(i,t),a[0]=t.x,a[4]=e.x,a[8]=i.x,a[1]=t.y,a[5]=e.y,a[9]=i.y,a[2]=t.z,a[6]=e.z,a[10]=i.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,o=i[0],a=i[4],s=i[8],l=i[12],c=i[1],h=i[5],u=i[9],f=i[13],d=i[2],p=i[6],m=i[10],g=i[14],v=i[3],E=i[7],y=i[11],x=i[15],T=n[0],b=n[4],_=n[8],w=n[12],R=n[1],H=n[5],M=n[9],S=n[13],C=n[2],A=n[6],D=n[10],P=n[14],k=n[3],L=n[7],N=n[11],F=n[15];return r[0]=o*T+a*R+s*C+l*k,r[4]=o*b+a*H+s*A+l*L,r[8]=o*_+a*M+s*D+l*N,r[12]=o*w+a*S+s*P+l*F,r[1]=c*T+h*R+u*C+f*k,r[5]=c*b+h*H+u*A+f*L,r[9]=c*_+h*M+u*D+f*N,r[13]=c*w+h*S+u*P+f*F,r[2]=d*T+p*R+m*C+g*k,r[6]=d*b+p*H+m*A+g*L,r[10]=d*_+p*M+m*D+g*N,r[14]=d*w+p*S+m*P+g*F,r[3]=v*T+E*R+y*C+x*k,r[7]=v*b+E*H+y*A+x*L,r[11]=v*_+E*M+y*D+x*N,r[15]=v*w+E*S+y*P+x*F,this},multiplyToArray:function(t,e,i){var n=this.elements;return this.multiplyMatrices(t,e),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},multiplyVector3:function(t){return console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){var t=new THREE.Vector3;return function(e){for(var i=0,n=e.length;n>i;i+=3)t.x=e[i],t.y=e[i+1],t.z=e[i+2],t.applyProjection(this),e[i]=t.x,e[i+1]=t.y,e[i+2]=t.z;return e}}(),rotateAxis:function(t){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],o=t[1],a=t[5],s=t[9],l=t[13],c=t[2],h=t[6],u=t[10],f=t[14],d=t[3],p=t[7],m=t[11],g=t[15];return d*(+r*s*h-n*l*h-r*a*u+i*l*u+n*a*f-i*s*f)+p*(+e*s*f-e*l*u+r*o*u-n*o*f+n*l*c-r*s*c)+m*(+e*l*h-e*a*f-r*o*h+i*o*f+r*a*c-i*l*c)+g*(-n*a*c-e*s*h+e*a*u+n*o*h-i*o*u+i*s*c)},transpose:function(){var t=this.elements,e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t},getPosition:function(){var t=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var e=this.elements;return t.set(e[12],e[13],e[14])}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,n=t.elements,r=n[0],o=n[4],a=n[8],s=n[12],l=n[1],c=n[5],h=n[9],u=n[13],f=n[2],d=n[6],p=n[10],m=n[14],g=n[3],v=n[7],E=n[11],y=n[15];i[0]=h*m*v-u*p*v+u*d*E-c*m*E-h*d*y+c*p*y,i[4]=s*p*v-a*m*v-s*d*E+o*m*E+a*d*y-o*p*y,i[8]=a*u*v-s*h*v+s*c*E-o*u*E-a*c*y+o*h*y,i[12]=s*h*d-a*u*d-s*c*p+o*u*p+a*c*m-o*h*m,i[1]=u*p*g-h*m*g-u*f*E+l*m*E+h*f*y-l*p*y,i[5]=a*m*g-s*p*g+s*f*E-r*m*E-a*f*y+r*p*y,i[9]=s*h*g-a*u*g-s*l*E+r*u*E+a*l*y-r*h*y,i[13]=a*u*f-s*h*f+s*l*p-r*u*p-a*l*m+r*h*m,i[2]=c*m*g-u*d*g+u*f*v-l*m*v-c*f*y+l*d*y,i[6]=s*d*g-o*m*g-s*f*v+r*m*v+o*f*y-r*d*y,i[10]=o*u*g-s*c*g+s*l*v-r*u*v-o*l*y+r*c*y,i[14]=s*c*f-o*u*f-s*l*d+r*u*d+o*l*m-r*c*m,i[3]=h*d*g-c*p*g-h*f*v+l*p*v+c*f*E-l*d*E,i[7]=o*p*g-a*d*g+a*f*v-r*p*v-o*f*E+r*d*E,i[11]=a*c*g-o*h*g-a*l*v+r*h*v+o*l*E-r*c*E,i[15]=o*h*f-a*c*f+a*l*d-r*h*d-o*l*p+r*c*p;var x=n[0]*i[0]+n[1]*i[4]+n[2]*i[8]+n[3]*i[12];if(0==x){var T="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(T);return console.warn(T),this.identity(),this}return this.multiplyScalar(1/x),this},translate:function(t){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(t){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(t){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(t){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(t,e){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,Math.max(i,n)))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=1-i,o=t.x,a=t.y,s=t.z,l=r*o,c=r*a;return this.set(l*o+i,l*a-n*s,l*s+n*a,0,l*a+n*s,c*a+i,c*s-n*o,0,l*s-n*a,c*s+n*o,r*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},compose:function(t,e,i){return console.warn("DEPRECATED: Matrix4's .compose() has been deprecated in favor of makeFromPositionQuaternionScale. Please update your code."),this.makeFromPositionQuaternionScale(t,e,i)},makeFromPositionQuaternionScale:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},makeFromPositionEulerScale:function(t,e,i,n){return this.makeRotationFromEuler(e,i),this.scale(n),this.setPosition(t),this},makeFrustum:function(t,e,i,n,r,o){var a=this.elements,s=2*r/(e-t),l=2*r/(n-i),c=(e+t)/(e-t),h=(n+i)/(n-i),u=-(o+r)/(o-r),f=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,i,n){var r=i*Math.tan(THREE.Math.degToRad(.5*t)),o=-r,a=o*e,s=r*e;return this.makeFrustum(a,s,o,r,i,n)},makeOrthographic:function(t,e,i,n,r,o){var a=this.elements,s=e-t,l=i-n,c=o-r,h=(e+t)/s,u=(i+n)/l,f=(o+r)/c;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2/l,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2/c,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},clone:function(){var t=this.elements;return new THREE.Matrix4(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15])}},THREE.extend(THREE.Matrix4.prototype,{decompose:function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Matrix4;return function(r,o,a){var s=this.elements;return t.set(s[0],s[1],s[2]),e.set(s[4],s[5],s[6]),i.set(s[8],s[9],s[10]),r=r instanceof THREE.Vector3?r:new THREE.Vector3,o=o instanceof THREE.Quaternion?o:new THREE.Quaternion,a=a instanceof THREE.Vector3?a:new THREE.Vector3,a.x=t.length(),a.y=e.length(),a.z=i.length(),r.x=s[12],r.y=s[13],r.z=s[14],n.copy(this),n.elements[0]/=a.x,n.elements[1]/=a.x,n.elements[2]/=a.x,n.elements[4]/=a.y,n.elements[5]/=a.y,n.elements[6]/=a.y,n.elements[8]/=a.z,n.elements[9]/=a.z,n.elements[10]/=a.z,o.setFromRotationMatrix(n),[r,o,a]}}()}),THREE.Ray=function(t,e){this.origin=void 0!==t?t:new THREE.Vector3,this.direction=void 0!==e?e:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){var i=e||new THREE.Vector3;return i.copy(this.direction).multiplyScalar(t).add(this.origin)},recast:function(){var t=new THREE.Vector3;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var i=e||new THREE.Vector3;i.subVectors(t,this.origin);var n=i.dot(this.direction);return i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(){var t=new THREE.Vector3;return function(e){var i=t.subVectors(e,this.origin).dot(this.direction);return t.copy(this.direction).multiplyScalar(i).add(this.origin),t.distanceTo(e)}}(),isIntersectionSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},isIntersectionPlane:function(t){var e=t.normal.dot(this.direction);return 0!=e?!0:0==t.distanceToPoint(this.origin)?!0:!1},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0==e)return 0==t.distanceToPoint(this.origin)?0:void 0;var i=-(this.origin.dot(t.normal)+t.constant)/e;return i},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return void 0===i?void 0:this.at(i,e)},applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}},THREE.Sphere=function(t,e){this.center=void 0!==t?t:new THREE.Vector3,this.radius=void 0!==e?e:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromCenterAndPoints:function(t,e){for(var i=0,n=0,r=e.length;r>n;n++){var o=t.distanceToSquared(e[n]);i=Math.max(i,o)}return this.center=t,this.radius=Math.sqrt(i),this},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),n=e||new THREE.Vector3;return n.copy(t),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(t){var e=t||new THREE.Box3;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}},THREE.Frustum=function(t,e,i,n,r,o){this.planes=[void 0!==t?t:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==o?o:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(t,e,i,n,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(o),this},copy:function(t){for(var e=this.planes,i=0;6>i;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],l=i[5],c=i[6],h=i[7],u=i[8],f=i[9],d=i[10],p=i[11],m=i[12],g=i[13],v=i[14],E=i[15];return e[0].setComponents(a-n,h-s,p-u,E-m).normalize(),e[1].setComponents(a+n,h+s,p+u,E+m).normalize(),e[2].setComponents(a+r,h+l,p+f,E+g).normalize(),e[3].setComponents(a-r,h-l,p-f,E-g).normalize(),e[4].setComponents(a-o,h-c,p-d,E-v).normalize(),e[5].setComponents(a+o,h+c,p+d,E+v).normalize(),this},intersectsObject:function(){var t=new THREE.Vector3;return function(e){var i=e.matrixWorld,n=this.planes,r=-e.geometry.boundingSphere.radius*i.getMaxScaleOnAxis();t.getPositionFromMatrix(i);for(var o=0;6>o;o++){var a=n[o].distanceToPoint(t);if(r>a)return!1}return!0}}(),intersectsSphere:function(t){for(var e=this.planes,i=t.center,n=-t.radius,r=0;6>r;r++){var o=e[r].distanceToPoint(i);if(n>o)return!1}return!0},containsPoint:function(t){for(var e=this.planes,i=0;6>i;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}},THREE.Plane=function(t,e){this.normal=void 0!==t?t:new THREE.Vector3(1,0,0),this.constant=void 0!==e?e:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i,n,r){var o=t.subVectors(r,n).cross(e.subVectors(i,n)).normalize();
return this.setFromNormalAndCoplanarPoint(o,i),this}}(),copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var i=this.distanceToPoint(t),n=e||new THREE.Vector3;return n.copy(this.normal).multiplyScalar(i)},isIntersectionLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return 0>e&&i>0||0>i&&e>0},intersectLine:function(){var t=new THREE.Vector3;return function(e,i){var n=i||new THREE.Vector3,r=e.delta(t),o=this.normal.dot(r);if(0==o)return 0==this.distanceToPoint(e.start)?n.copy(e.start):void 0;var a=-(e.start.dot(this.normal)+this.constant)/o;return 0>a||a>1?void 0:n.copy(r).multiplyScalar(a).add(e.start)}}(),coplanarPoint:function(t){var e=t||new THREE.Vector3;return e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i,n){n=n||(new THREE.Matrix3).getNormalMatrix(i);var r=t.copy(this.normal).applyMatrix3(n),o=this.coplanarPoint(e);return o.applyMatrix4(i),this.setFromNormalAndCoplanarPoint(r,o),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}},THREE.Math={clamp:function(t,e,i){return e>t?e:t>i?i:t},clampBottom:function(t,e){return e>t?e:t},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},smoothstep:function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))},smootherstep:function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(6*t-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},sign:function(t){return 0>t?-1:t>0?1:0},degToRad:function(){var t=Math.PI/180;return function(e){return e*t}}(),radToDeg:function(){var t=180/Math.PI;return function(e){return e*t}}()},THREE.Spline=function(t){function e(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e}this.points=t;var i=[],n={x:0,y:0,z:0},r,o,a,s,l,c,h,u,f;this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return r=(this.points.length-1)*t,o=Math.floor(r),a=r-o,i[0]=0===o?o:o-1,i[1]=o,i[2]=o>this.points.length-2?this.points.length-1:o+1,i[3]=o>this.points.length-3?this.points.length-1:o+2,c=this.points[i[0]],h=this.points[i[1]],u=this.points[i[2]],f=this.points[i[3]],s=a*a,l=a*s,n.x=e(c.x,h.x,u.x,f.x,a,s,l),n.y=e(c.y,h.y,u.y,f.y,a,s,l),n.z=e(c.z,h.z,u.z,f.z,a,s,l),n},this.getControlPointsArray=function(){var t,e,i=this.points.length,n=[];for(t=0;i>t;t++)e=this.points[t],n[t]=[e.x,e.y,e.z];return n},this.getLength=function(t){var e,i,n,r,o=0,a=0,s=0,l=new THREE.Vector3,c=new THREE.Vector3,h=[],u=0;for(h[0]=0,t||(t=100),n=this.points.length*t,l.copy(this.points[0]),e=1;n>e;e++)i=e/n,r=this.getPoint(i),c.copy(r),u+=c.distanceTo(l),l.copy(r),o=(this.points.length-1)*i,a=Math.floor(o),a!=s&&(h[a]=u,s=a);return h[h.length]=u,{chunks:h,total:u}},this.reparametrizeByArcLength=function(t){var e,i,n,r,o,a,s,l,c,h=[],u=new THREE.Vector3,f=this.getLength();for(h.push(u.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(s=f.chunks[e]-f.chunks[e-1],l=Math.ceil(t*s/f.total),r=(e-1)/(this.points.length-1),o=e/(this.points.length-1),i=1;l-1>i;i++)n=r+i*(1/l)*(o-r),c=this.getPoint(n),h.push(u.copy(c).clone());h.push(u.copy(this.points[e]).clone())}this.points=h}},THREE.Triangle=function(t,e,i){this.a=void 0!==t?t:new THREE.Vector3,this.b=void 0!==e?e:new THREE.Vector3,this.c=void 0!==i?i:new THREE.Vector3},THREE.Triangle.normal=function(){var t=new THREE.Vector3;return function(e,i,n,r){var o=r||new THREE.Vector3;o.subVectors(n,i),t.subVectors(e,i),o.cross(t);var a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(n,r,o,a,s){t.subVectors(a,r),e.subVectors(o,r),i.subVectors(n,r);var l=t.dot(t),c=t.dot(e),h=t.dot(i),u=e.dot(e),f=e.dot(i),d=l*u-c*c,p=s||new THREE.Vector3;if(0==d)return p.set(-2,-1,-1);var m=1/d,g=(u*h-c*f)*m,v=(l*f-c*h)*m;return p.set(1-g-v,v,g)}}(),THREE.Triangle.containsPoint=function(){var t=new THREE.Vector3;return function(e,i,n,r){var o=THREE.Triangle.barycoordFromPoint(e,i,n,r,t);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){var e=t||new THREE.Vector3;return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return THREE.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){var e=t||new THREE.Plane;return e.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return THREE.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return THREE.Triangle.containsPoint(t,this.a,this.b,this.c)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}},THREE.Vertex=function(t){return console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead."),t},THREE.UV=function(t,e){return console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead."),new THREE.Vector2(t,e)},THREE.Clock=function(t){this.autoStart=void 0!==t?t:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();t=.001*(e-this.oldTime),this.oldTime=e,this.elapsedTime+=t}return t}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)?!0:!1},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners,n=i[t].indexOf(e);-1!==n&&i[t].splice(n,1)}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,i=e[t.type];if(void 0!==i){t.target=this;for(var n=0,r=i.length;r>n;n++)i[n].call(this,t)}}}},function(THREE){THREE.Raycaster=function(t,e,i,n){this.ray=new THREE.Ray(t,e),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=i||0,this.far=n||1/0};var t=new THREE.Sphere,e=new THREE.Ray,i=new THREE.Plane,n=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Matrix4,a=function(t,e){return t.distance-e.distance},s=function(a,l,c){if(a instanceof THREE.Particle){r.getPositionFromMatrix(a.matrixWorld);var h=l.ray.distanceToPoint(r);if(h>a.scale.x)return c;c.push({distance:h,point:a.position,face:null,object:a})}else if(a instanceof THREE.LOD){r.getPositionFromMatrix(a.matrixWorld);var h=l.ray.origin.distanceTo(r);s(a.getObjectForDistance(h),l,c)}else if(a instanceof THREE.Mesh){if(r.getPositionFromMatrix(a.matrixWorld),t.set(r,a.geometry.boundingSphere.radius*a.matrixWorld.getMaxScaleOnAxis()),!l.ray.isIntersectionSphere(t))return c;var u=a.geometry,f=u.vertices,d=a.material instanceof THREE.MeshFaceMaterial,p=d===!0?a.material.materials:null,m=a.material.side,g,v,E,y,x=l.precision;o.getInverse(a.matrixWorld),e.copy(l.ray).applyMatrix4(o);for(var T=0,b=u.faces.length;b>T;T++){var _=u.faces[T],w=d===!0?p[_.materialIndex]:a.material;if(void 0!==w){i.setFromNormalAndCoplanarPoint(_.normal,f[_.a]);var R=e.distanceToPlane(i);if(!(Math.abs(R)<x||0>R)){if(m=w.side,m!==THREE.DoubleSide){var H=e.direction.dot(i.normal);if(!(m===THREE.FrontSide?0>H:H>0))continue}if(!(R<l.near||R>l.far)){if(n=e.at(R,n),_ instanceof THREE.Face3){if(g=f[_.a],v=f[_.b],E=f[_.c],!THREE.Triangle.containsPoint(n,g,v,E))continue}else{if(!(_ instanceof THREE.Face4))throw Error("face type not supported");if(g=f[_.a],v=f[_.b],E=f[_.c],y=f[_.d],!THREE.Triangle.containsPoint(n,g,v,y)&&!THREE.Triangle.containsPoint(n,v,E,y))continue}c.push({distance:R,point:l.ray.at(R),face:_,faceIndex:T,object:a})}}}}}},l=function(t,e,i){for(var n=t.getDescendants(),r=0,o=n.length;o>r;r++)s(n[r],e,i)};THREE.Raycaster.prototype.precision=1e-4,THREE.Raycaster.prototype.set=function(t,e){this.ray.set(t,e),this.ray.direction.length()>0&&this.ray.direction.normalize()},THREE.Raycaster.prototype.intersectObject=function(t,e){var i=[];return e===!0&&l(t,this,i),s(t,this,i),i.sort(a),i},THREE.Raycaster.prototype.intersectObjects=function(t,e){for(var i=[],n=0,r=t.length;r>n;n++)s(t[n],this,i),e===!0&&l(t[n],this,i);return i.sort(a),i}}(THREE),THREE.Object3D=function(){this.id=THREE.Object3DIdCount++,this.name="",this.parent=void 0,this.children=[],this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this.rotation=new THREE.Vector3,this.eulerOrder=THREE.Object3D.defaultEulerOrder,this.scale=new THREE.Vector3(1,1,1),this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.quaternion=new THREE.Quaternion,this.useQuaternion=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.userData={}},THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(){var t=new THREE.Matrix4;return function(e){this.matrix.multiplyMatrices(e,this.matrix),this.position.getPositionFromMatrix(this.matrix),this.scale.getScaleFromMatrix(this.matrix),t.extractRotation(this.matrix),this.useQuaternion===!0?this.quaternion.setFromRotationMatrix(t):this.rotation.setEulerFromRotationMatrix(t,this.eulerOrder)}}(),rotateOnAxis:function(){var t=new THREE.Quaternion,e=new THREE.Quaternion;return function(i,n){return t.setFromAxisAngle(i,n),this.useQuaternion===!0?this.quaternion.multiply(t):(e.setFromEuler(this.rotation,this.eulerOrder),e.multiply(t),this.rotation.setEulerFromQuaternion(e,this.eulerOrder)),this}}(),translateOnAxis:function(){var t=new THREE.Vector3;return function(e,i){return t.copy(e),this.useQuaternion===!0?t.applyQuaternion(this.quaternion):t.applyEuler(this.rotation,this.eulerOrder),this.position.add(t.multiplyScalar(i)),this}}(),translate:function(t,e){return console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed."),this.translateOnAxis(e,t)},translateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new THREE.Matrix4;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new THREE.Matrix4;return function(e){t.lookAt(e,this.position,this.up),this.useQuaternion===!0?this.quaternion.setFromRotationMatrix(t):this.rotation.setEulerFromRotationMatrix(t,this.eulerOrder)}}(),add:function(t){if(t===this)return void console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");if(t instanceof THREE.Object3D){void 0!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t);for(var e=this;void 0!==e.parent;)e=e.parent;void 0!==e&&e instanceof THREE.Scene&&e.__addObject(t)}},remove:function(t){var e=this.children.indexOf(t);if(-1!==e){t.parent=void 0,this.children.splice(e,1);for(var i=this;void 0!==i.parent;)i=i.parent;void 0!==i&&i instanceof THREE.Scene&&i.__removeObject(t)}},traverse:function(t){t(this);for(var e=0,i=this.children.length;i>e;e++)this.children[e].traverse(t)},getObjectById:function(t,e){for(var i=0,n=this.children.length;n>i;i++){var r=this.children[i];if(r.id===t)return r;if(e===!0&&(r=r.getObjectById(t,e),void 0!==r))return r}return void 0},getObjectByName:function(t,e){for(var i=0,n=this.children.length;n>i;i++){var r=this.children[i];if(r.name===t)return r;if(e===!0&&(r=r.getObjectByName(t,e),void 0!==r))return r}return void 0},getChildByName:function(t,e){return console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t,e)},getDescendants:function(t){void 0===t&&(t=[]),Array.prototype.push.apply(t,this.children);for(var e=0,i=this.children.length;i>e;e++)this.children[e].getDescendants(t);return t},updateMatrix:function(){this.useQuaternion===!1?this.matrix.makeFromPositionEulerScale(this.position,this.rotation,this.eulerOrder,this.scale):this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||t===!0)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,i=this.children.length;i>e;e++)this.children[e].updateMatrixWorld(t)},clone:function(t){void 0===t&&(t=new THREE.Object3D),t.name=this.name,t.up.copy(this.up),t.position.copy(this.position),t.rotation instanceof THREE.Vector3&&t.rotation.copy(this.rotation),t.eulerOrder=this.eulerOrder,t.scale.copy(this.scale),t.renderDepth=this.renderDepth,t.rotationAutoUpdate=this.rotationAutoUpdate,t.matrix.copy(this.matrix),t.matrixWorld.copy(this.matrixWorld),t.matrixAutoUpdate=this.matrixAutoUpdate,t.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,t.quaternion.copy(this.quaternion),t.useQuaternion=this.useQuaternion,t.visible=this.visible,t.castShadow=this.castShadow,t.receiveShadow=this.receiveShadow,t.frustumCulled=this.frustumCulled,t.userData=JSON.parse(JSON.stringify(this.userData));for(var e=0;e<this.children.length;e++){var i=this.children[e];t.add(i.clone())}return t}},THREE.Object3D.defaultEulerOrder="XYZ",THREE.Object3DIdCount=0,THREE.Projector=function(){function t(){if(c===u){var t=new THREE.RenderableObject;return h.push(t),u++,c++,t}return h[c++]}function e(){if(d===m){var t=new THREE.RenderableVertex;return p.push(t),m++,d++,t}return p[d++]}function i(){if(v===y){var t=new THREE.RenderableFace3;return E.push(t),y++,v++,t}return E[v++]}function n(){if(x===b){var t=new THREE.RenderableFace4;return T.push(t),b++,x++,t}return T[x++]}function r(){if(w===H){var t=new THREE.RenderableLine;return R.push(t),H++,w++,t}return R[w++]}function o(){if(S===A){var t=new THREE.RenderableParticle;return C.push(t),A++,S++,t}return C[S++]}function a(t,e){return e.z-t.z}function s(t,e){var i=0,n=1,r=t.z+t.w,o=e.z+e.w,a=-t.z+t.w,s=-e.z+e.w;return r>=0&&o>=0&&a>=0&&s>=0?!0:0>r&&0>o||0>a&&0>s?!1:(0>r?i=Math.max(i,r/(r-o)):0>o&&(n=Math.min(n,r/(r-o))),0>a?i=Math.max(i,a/(a-s)):0>s&&(n=Math.min(n,a/(a-s))),i>n?!1:(t.lerp(e,i),e.lerp(t,1-n),!0))}var l,c,h=[],u=0,f,d,p=[],m=0,g,v,E=[],y=0,x,T=[],b=0,_,w,R=[],H=0,M,S,C=[],A=0,D={objects:[],sprites:[],lights:[],elements:[]},P=new THREE.Vector3,k=new THREE.Vector4,L=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),N=new THREE.Box3,F=new Array(3),I=new Array(4),z=new THREE.Matrix4,O=new THREE.Matrix4,U,B=new THREE.Matrix4,V=new THREE.Matrix3,W=new THREE.Matrix3,j=new THREE.Vector3,G=new THREE.Frustum,X=new THREE.Vector4,q=new THREE.Vector4;this.projectVector=function(t,e){return e.matrixWorldInverse.getInverse(e.matrixWorld),O.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),t.applyProjection(O)},this.unprojectVector=function(t,e){return e.projectionMatrixInverse.getInverse(e.projectionMatrix),O.multiplyMatrices(e.matrixWorld,e.projectionMatrixInverse),t.applyProjection(O)},this.pickingRay=function(t,e){t.z=-1;var i=new THREE.Vector3(t.x,t.y,1);return this.unprojectVector(t,e),this.unprojectVector(i,e),i.sub(t).normalize(),new THREE.Raycaster(t,i)};var Y=function(e,i){c=0,D.objects.length=0,D.sprites.length=0,D.lights.length=0;var n=function(e){for(var i=0,r=e.children.length;r>i;i++){var o=e.children[i];o.visible!==!1&&(o instanceof THREE.Light?D.lights.push(o):o instanceof THREE.Mesh||o instanceof THREE.Line?(o.frustumCulled===!1||G.intersectsObject(o)===!0)&&(l=t(),l.object=o,null!==o.renderDepth?l.z=o.renderDepth:(P.getPositionFromMatrix(o.matrixWorld),P.applyProjection(O),l.z=P.z),D.objects.push(l)):o instanceof THREE.Sprite||o instanceof THREE.Particle?(l=t(),l.object=o,null!==o.renderDepth?l.z=o.renderDepth:(P.getPositionFromMatrix(o.matrixWorld),P.applyProjection(O),l.z=P.z),D.sprites.push(l)):(l=t(),l.object=o,null!==o.renderDepth?l.z=o.renderDepth:(P.getPositionFromMatrix(o.matrixWorld),P.applyProjection(O),l.z=P.z),D.objects.push(l)),n(o))}};return n(e),i===!0&&D.objects.sort(a),D};this.projectScene=function(t,l,c,h){var u=!1,m,E,y,T,b,R,H,C,A,P,K,Q,Z,J,te,ee,ie,ne,re,oe,ae,se,le,ce,he,ue;for(v=0,x=0,w=0,S=0,D.elements.length=0,t.autoUpdate===!0&&t.updateMatrixWorld(),void 0===l.parent&&l.updateMatrixWorld(),z.copy(l.matrixWorldInverse.getInverse(l.matrixWorld)),O.multiplyMatrices(l.projectionMatrix,z),W.getNormalMatrix(z),G.setFromMatrix(O),D=Y(t,c),m=0,E=D.objects.length;E>m;m++)if(Z=D.objects[m].object,U=Z.matrixWorld,d=0,Z instanceof THREE.Mesh){for(J=Z.geometry,te=J.vertices,ee=J.faces,re=J.faceVertexUvs,V.getNormalMatrix(U),he=Z.material instanceof THREE.MeshFaceMaterial,ue=he===!0?Z.material:null,y=0,T=te.length;T>y;y++)f=e(),f.positionWorld.copy(te[y]).applyMatrix4(U),f.positionScreen.copy(f.positionWorld).applyMatrix4(O),f.positionScreen.x/=f.positionScreen.w,f.positionScreen.y/=f.positionScreen.w,f.positionScreen.z/=f.positionScreen.w,f.visible=!(f.positionScreen.x<-1||f.positionScreen.x>1||f.positionScreen.y<-1||f.positionScreen.y>1||f.positionScreen.z<-1||f.positionScreen.z>1);for(b=0,R=ee.length;R>b;b++){ie=ee[b];var fe=he===!0?ue.materials[ie.materialIndex]:Z.material;if(void 0!==fe){var de=fe.side;if(ie instanceof THREE.Face3){if(ae=p[ie.a],se=p[ie.b],le=p[ie.c],F[0]=ae.positionScreen,F[1]=se.positionScreen,F[2]=le.positionScreen,ae.visible!==!0&&se.visible!==!0&&le.visible!==!0&&!L.isIntersectionBox(N.setFromPoints(F)))continue;if(u=(le.positionScreen.x-ae.positionScreen.x)*(se.positionScreen.y-ae.positionScreen.y)-(le.positionScreen.y-ae.positionScreen.y)*(se.positionScreen.x-ae.positionScreen.x)<0,de!==THREE.DoubleSide&&u!==(de===THREE.FrontSide))continue;g=i(),g.v1.copy(ae),g.v2.copy(se),g.v3.copy(le)}else if(ie instanceof THREE.Face4){if(ae=p[ie.a],se=p[ie.b],le=p[ie.c],ce=p[ie.d],I[0]=ae.positionScreen,I[1]=se.positionScreen,I[2]=le.positionScreen,I[3]=ce.positionScreen,ae.visible!==!0&&se.visible!==!0&&le.visible!==!0&&ce.visible!==!0&&!L.isIntersectionBox(N.setFromPoints(I)))continue;if(u=(ce.positionScreen.x-ae.positionScreen.x)*(se.positionScreen.y-ae.positionScreen.y)-(ce.positionScreen.y-ae.positionScreen.y)*(se.positionScreen.x-ae.positionScreen.x)<0||(se.positionScreen.x-le.positionScreen.x)*(ce.positionScreen.y-le.positionScreen.y)-(se.positionScreen.y-le.positionScreen.y)*(ce.positionScreen.x-le.positionScreen.x)<0,de!==THREE.DoubleSide&&u!==(de===THREE.FrontSide))continue;g=n(),g.v1.copy(ae),g.v2.copy(se),g.v3.copy(le),g.v4.copy(ce)}for(g.normalModel.copy(ie.normal),u!==!1||de!==THREE.BackSide&&de!==THREE.DoubleSide||g.normalModel.negate(),g.normalModel.applyMatrix3(V).normalize(),g.normalModelView.copy(g.normalModel).applyMatrix3(W),g.centroidModel.copy(ie.centroid).applyMatrix4(U),ne=ie.vertexNormals,H=0,C=ne.length;C>H;H++){var pe=g.vertexNormalsModel[H];pe.copy(ne[H]),u!==!1||de!==THREE.BackSide&&de!==THREE.DoubleSide||pe.negate(),pe.applyMatrix3(V).normalize();var me=g.vertexNormalsModelView[H];me.copy(pe).applyMatrix3(W)}for(g.vertexNormalsLength=ne.length,A=0,P=re.length;P>A;A++)if(oe=re[A][b],void 0!==oe)for(K=0,Q=oe.length;Q>K;K++)g.uvs[A][K]=oe[K];g.color=ie.color,g.material=fe,j.copy(g.centroidModel).applyProjection(O),g.z=j.z,D.elements.push(g)}}}else if(Z instanceof THREE.Line){B.multiplyMatrices(O,U),te=Z.geometry.vertices,ae=e(),ae.positionScreen.copy(te[0]).applyMatrix4(B);var ge=Z.type===THREE.LinePieces?2:1;for(y=1,T=te.length;T>y;y++)ae=e(),ae.positionScreen.copy(te[y]).applyMatrix4(B),(y+1)%ge>0||(se=p[d-2],X.copy(ae.positionScreen),q.copy(se.positionScreen),s(X,q)===!0&&(X.multiplyScalar(1/X.w),q.multiplyScalar(1/q.w),_=r(),_.v1.positionScreen.copy(X),_.v2.positionScreen.copy(q),_.z=Math.max(X.z,q.z),_.material=Z.material,Z.material.vertexColors===THREE.VertexColors&&(_.vertexColors[0].copy(Z.geometry.colors[y]),_.vertexColors[1].copy(Z.geometry.colors[y-1])),D.elements.push(_)))}for(m=0,E=D.sprites.length;E>m;m++)Z=D.sprites[m].object,U=Z.matrixWorld,Z instanceof THREE.Particle&&(k.set(U.elements[12],U.elements[13],U.elements[14],1),k.applyMatrix4(O),k.z/=k.w,k.z>0&&k.z<1&&(M=o(),M.object=Z,M.x=k.x/k.w,M.y=k.y/k.w,M.z=k.z,M.rotation=Z.rotation.z,M.scale.x=Z.scale.x*Math.abs(M.x-(k.x+l.projectionMatrix.elements[0])/(k.w+l.projectionMatrix.elements[12])),M.scale.y=Z.scale.y*Math.abs(M.y-(k.y+l.projectionMatrix.elements[5])/(k.w+l.projectionMatrix.elements[13])),M.material=Z.material,D.elements.push(M)));return h===!0&&D.elements.sort(a),D}},THREE.Face3=function(t,e,i,n,r,o){this.a=t,this.b=e,this.c=i,this.normal=n instanceof THREE.Vector3?n:new THREE.Vector3,this.vertexNormals=n instanceof Array?n:[],this.color=r instanceof THREE.Color?r:new THREE.Color,this.vertexColors=r instanceof Array?r:[],this.vertexTangents=[],this.materialIndex=void 0!==o?o:0,this.centroid=new THREE.Vector3},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var t=new THREE.Face3(this.a,this.b,this.c);t.normal.copy(this.normal),t.color.copy(this.color),t.centroid.copy(this.centroid),t.materialIndex=this.materialIndex;var e,i;for(e=0,i=this.vertexNormals.length;i>e;e++)t.vertexNormals[e]=this.vertexNormals[e].clone();for(e=0,i=this.vertexColors.length;i>e;e++)t.vertexColors[e]=this.vertexColors[e].clone();for(e=0,i=this.vertexTangents.length;i>e;e++)t.vertexTangents[e]=this.vertexTangents[e].clone();return t}},THREE.Face4=function(t,e,i,n,r,o,a){this.a=t,this.b=e,this.c=i,this.d=n,this.normal=r instanceof THREE.Vector3?r:new THREE.Vector3,this.vertexNormals=r instanceof Array?r:[],this.color=o instanceof THREE.Color?o:new THREE.Color,this.vertexColors=o instanceof Array?o:[],this.vertexTangents=[],this.materialIndex=void 0!==a?a:0,this.centroid=new THREE.Vector3},THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var t=new THREE.Face4(this.a,this.b,this.c,this.d);t.normal.copy(this.normal),t.color.copy(this.color),t.centroid.copy(this.centroid),t.materialIndex=this.materialIndex;var e,i;for(e=0,i=this.vertexNormals.length;i>e;e++)t.vertexNormals[e]=this.vertexNormals[e].clone();for(e=0,i=this.vertexColors.length;i>e;e++)t.vertexColors[e]=this.vertexColors[e].clone();for(e=0,i=this.vertexTangents.length;i>e;e++)t.vertexTangents[e]=this.vertexTangents[e].clone();return t}},THREE.Geometry=function(){this.id=THREE.GeometryIdCount++,this.name="",this.vertices=[],this.colors=[],this.normals=[],this.faces=[],this.faceUvs=[[]],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.buffersNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(t){for(var e=(new THREE.Matrix3).getNormalMatrix(t),i=0,n=this.vertices.length;n>i;i++){var r=this.vertices[i];r.applyMatrix4(t)}for(var i=0,n=this.faces.length;n>i;i++){var o=this.faces[i];o.normal.applyMatrix3(e).normalize();for(var a=0,s=o.vertexNormals.length;s>a;a++)o.vertexNormals[a].applyMatrix3(e).normalize();o.centroid.applyMatrix4(t)}},computeCentroids:function(){var t,e,i;for(t=0,e=this.faces.length;e>t;t++)i=this.faces[t],i.centroid.set(0,0,0),i instanceof THREE.Face3?(i.centroid.add(this.vertices[i.a]),i.centroid.add(this.vertices[i.b]),i.centroid.add(this.vertices[i.c]),i.centroid.divideScalar(3)):i instanceof THREE.Face4&&(i.centroid.add(this.vertices[i.a]),i.centroid.add(this.vertices[i.b]),i.centroid.add(this.vertices[i.c]),i.centroid.add(this.vertices[i.d]),i.centroid.divideScalar(4))},computeFaceNormals:function(){for(var t=new THREE.Vector3,e=new THREE.Vector3,i=0,n=this.faces.length;n>i;i++){var r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){var e,i,n,r,o,a;if(void 0===this.__tmpVertices){for(this.__tmpVertices=new Array(this.vertices.length),a=this.__tmpVertices,e=0,i=this.vertices.length;i>e;e++)a[e]=new THREE.Vector3;for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],o instanceof THREE.Face3?o.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:o instanceof THREE.Face4&&(o.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else for(a=this.__tmpVertices,e=0,i=this.vertices.length;i>e;e++)a[e].set(0,0,0);if(t){var s,l,c,h,u=new THREE.Vector3,f=new THREE.Vector3,d=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3;for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],o instanceof THREE.Face3?(s=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c],u.subVectors(c,l),f.subVectors(s,l),u.cross(f),a[o.a].add(u),a[o.b].add(u),a[o.c].add(u)):o instanceof THREE.Face4&&(s=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c],h=this.vertices[o.d],d.subVectors(h,l),f.subVectors(s,l),d.cross(f),a[o.a].add(d),a[o.b].add(d),a[o.d].add(d),p.subVectors(h,c),m.subVectors(l,c),p.cross(m),a[o.b].add(p),a[o.c].add(p),a[o.d].add(p))}else for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],o instanceof THREE.Face3?(a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal)):o instanceof THREE.Face4&&(a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal),a[o.d].add(o.normal));for(e=0,i=this.vertices.length;i>e;e++)a[e].normalize();for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],o instanceof THREE.Face3?(o.vertexNormals[0].copy(a[o.a]),o.vertexNormals[1].copy(a[o.b]),o.vertexNormals[2].copy(a[o.c])):o instanceof THREE.Face4&&(o.vertexNormals[0].copy(a[o.a]),o.vertexNormals[1].copy(a[o.b]),o.vertexNormals[2].copy(a[o.c]),o.vertexNormals[3].copy(a[o.d]))},computeMorphNormals:function(){var t,e,i,n,r;for(i=0,n=this.faces.length;n>i;i++)for(r=this.faces[i],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;e>t;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var o=new THREE.Geometry;for(o.faces=this.faces,t=0,e=this.morphTargets.length;e>t;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals,l,c;for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],l=new THREE.Vector3,c=r instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},a.push(l),s.push(c)}var h=this.morphNormals[t];o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals();var l,c;for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],l=h.faceNormals[i],c=h.vertexNormals[i],l.copy(r.normal),r instanceof THREE.Face3?(c.a.copy(r.vertexNormals[0]),c.b.copy(r.vertexNormals[1]),c.c.copy(r.vertexNormals[2])):(c.a.copy(r.vertexNormals[0]),c.b.copy(r.vertexNormals[1]),c.c.copy(r.vertexNormals[2]),c.d.copy(r.vertexNormals[3]))}for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){function t(t,e,i,n,r,o,a){h=t.vertices[e],u=t.vertices[i],f=t.vertices[n],d=c[r],p=c[o],m=c[a],g=u.x-h.x,v=f.x-h.x,E=u.y-h.y,y=f.y-h.y,x=u.z-h.z,T=f.z-h.z,b=p.x-d.x,_=m.x-d.x,w=p.y-d.y,R=m.y-d.y,H=1/(b*R-_*w),D.set((R*g-w*v)*H,(R*E-w*y)*H,(R*x-w*T)*H),P.set((b*v-_*g)*H,(b*y-_*E)*H,(b*T-_*x)*H),C[e].add(D),C[i].add(D),C[n].add(D),A[e].add(P),A[i].add(P),A[n].add(P)}var e,i,n,r,o,a,s,l,c,h,u,f,d,p,m,g,v,E,y,x,T,b,_,w,R,H,M,S,C=[],A=[],D=new THREE.Vector3,P=new THREE.Vector3,k=new THREE.Vector3,L=new THREE.Vector3,N=new THREE.Vector3,F;for(n=0,r=this.vertices.length;r>n;n++)C[n]=new THREE.Vector3,A[n]=new THREE.Vector3;for(e=0,i=this.faces.length;i>e;e++)l=this.faces[e],c=this.faceVertexUvs[0][e],l instanceof THREE.Face3?t(this,l.a,l.b,l.c,0,1,2):l instanceof THREE.Face4&&(t(this,l.a,l.b,l.d,0,1,3),t(this,l.b,l.c,l.d,1,2,3));var I=["a","b","c","d"];for(e=0,i=this.faces.length;i>e;e++)for(l=this.faces[e],o=0;o<l.vertexNormals.length;o++)N.copy(l.vertexNormals[o]),s=l[I[o]],M=C[s],k.copy(M),k.sub(N.multiplyScalar(N.dot(M))).normalize(),L.crossVectors(l.vertexNormals[o],M),S=L.dot(A[s]),F=0>S?-1:1,l.vertexTangents[o]=new THREE.Vector4(k.x,k.y,k.z,F);this.hasTangents=!0},computeLineDistances:function(){for(var t=0,e=this.vertices,i=0,n=e.length;n>i;i++)i>0&&(t+=e[i].distanceTo(e[i-1])),this.lineDistances[i]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromCenterAndPoints(this.boundingSphere.center,this.vertices)},mergeVertices:function(){var t={},e=[],i=[],n,r,o=4,a=Math.pow(10,o),s,l,c,h,u,f,d,p;for(this.__tmpVertices=void 0,s=0,l=this.vertices.length;l>s;s++)n=this.vertices[s],r=[Math.round(n.x*a),Math.round(n.y*a),Math.round(n.z*a)].join("_"),void 0===t[r]?(t[r]=s,e.push(this.vertices[s]),i[s]=e.length-1):i[s]=i[t[r]];var m=[];for(s=0,l=this.faces.length;l>s;s++)if(c=this.faces[s],c instanceof THREE.Face3){c.a=i[c.a],c.b=i[c.b],c.c=i[c.c],h=[c.a,c.b,c.c];
for(var g=-1,v=0;3>v;v++)if(h[v]==h[(v+1)%3]){g=v,m.push(s);break}}else if(c instanceof THREE.Face4){c.a=i[c.a],c.b=i[c.b],c.c=i[c.c],c.d=i[c.d],h=[c.a,c.b,c.c,c.d];for(var g=-1,v=0;4>v;v++)h[v]==h[(v+1)%4]&&(g>=0&&m.push(s),g=v);if(g>=0){h.splice(g,1);var E=new THREE.Face3(h[0],h[1],h[2],c.normal,c.color,c.materialIndex);for(f=0,d=this.faceVertexUvs.length;d>f;f++)p=this.faceVertexUvs[f][s],p&&p.splice(g,1);c.vertexNormals&&c.vertexNormals.length>0&&(E.vertexNormals=c.vertexNormals,E.vertexNormals.splice(g,1)),c.vertexColors&&c.vertexColors.length>0&&(E.vertexColors=c.vertexColors,E.vertexColors.splice(g,1)),this.faces[s]=E}}for(s=m.length-1;s>=0;s--)for(this.faces.splice(s,1),f=0,d=this.faceVertexUvs.length;d>f;f++)this.faceVertexUvs[f].splice(s,1);var y=this.vertices.length-e.length;return this.vertices=e,y},clone:function(){for(var t=new THREE.Geometry,e=this.vertices,i=0,n=e.length;n>i;i++)t.vertices.push(e[i].clone());for(var r=this.faces,i=0,n=r.length;n>i;i++)t.faces.push(r[i].clone());for(var o=this.faceVertexUvs[0],i=0,n=o.length;n>i;i++){for(var a=o[i],s=[],l=0,c=a.length;c>l;l++)s.push(new THREE.Vector2(a[l].x,a[l].y));t.faceVertexUvs[0].push(s)}return t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.GeometryIdCount=0,THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++,this.attributes={},this.dynamic=!1,this.offsets=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.morphTargets=[]},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(t){var e,i;if(this.attributes.position&&(e=this.attributes.position.array),this.attributes.normal&&(i=this.attributes.normal.array),void 0!==e&&(t.multiplyVector3Array(e),this.verticesNeedUpdate=!0),void 0!==i){var n=(new THREE.Matrix3).getNormalMatrix(t);n.multiplyVector3Array(i),this.normalizeNormals(),this.normalsNeedUpdate=!0}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var t=this.attributes.position.array;if(t){var e=this.boundingBox,i,n,r;t.length>=3&&(e.min.x=e.max.x=t[0],e.min.y=e.max.y=t[1],e.min.z=e.max.z=t[2]);for(var o=3,a=t.length;a>o;o+=3)i=t[o],n=t[o+1],r=t[o+2],i<e.min.x?e.min.x=i:i>e.max.x&&(e.max.x=i),n<e.min.y?e.min.y=n:n>e.max.y&&(e.max.y=n),r<e.min.z?e.min.z=r:r>e.max.z&&(e.max.z=r)}(void 0===t||0===t.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0))},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var t=this.attributes.position.array;if(t){for(var e,i=0,n,r,o,a=0,s=t.length;s>a;a+=3)n=t[a],r=t[a+1],o=t[a+2],e=n*n+r*r+o*o,e>i&&(i=e);this.boundingSphere.radius=Math.sqrt(i)}},computeVertexNormals:function(){if(this.attributes.position){var t,e,i,n,r=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(r),numItems:r};else for(t=0,e=this.attributes.normal.array.length;e>t;t++)this.attributes.normal.array[t]=0;var o=this.attributes.position.array,a=this.attributes.normal.array,s,l,c,h,u,f,d=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3,g=new THREE.Vector3,v=new THREE.Vector3;if(this.attributes.index){var E=this.attributes.index.array,y=this.offsets;for(i=0,n=y.length;n>i;++i){var x=y[i].start,T=y[i].count,b=y[i].index;for(t=x,e=x+T;e>t;t+=3)s=b+E[t],l=b+E[t+1],c=b+E[t+2],h=o[3*s],u=o[3*s+1],f=o[3*s+2],d.set(h,u,f),h=o[3*l],u=o[3*l+1],f=o[3*l+2],p.set(h,u,f),h=o[3*c],u=o[3*c+1],f=o[3*c+2],m.set(h,u,f),g.subVectors(m,p),v.subVectors(d,p),g.cross(v),a[3*s]+=g.x,a[3*s+1]+=g.y,a[3*s+2]+=g.z,a[3*l]+=g.x,a[3*l+1]+=g.y,a[3*l+2]+=g.z,a[3*c]+=g.x,a[3*c+1]+=g.y,a[3*c+2]+=g.z}}else for(t=0,e=o.length;e>t;t+=9)h=o[t],u=o[t+1],f=o[t+2],d.set(h,u,f),h=o[t+3],u=o[t+4],f=o[t+5],p.set(h,u,f),h=o[t+6],u=o[t+7],f=o[t+8],m.set(h,u,f),g.subVectors(m,p),v.subVectors(d,p),g.cross(v),a[t]=g.x,a[t+1]=g.y,a[t+2]=g.z,a[t+3]=g.x,a[t+4]=g.y,a[t+5]=g.z,a[t+6]=g.x,a[t+7]=g.y,a[t+8]=g.z;this.normalizeNormals(),this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var t=this.attributes.normal.array,e,i,n,r,o=0,a=t.length;a>o;o+=3)e=t[o],i=t[o+1],n=t[o+2],r=1/Math.sqrt(e*e+i*i+n*n),t[o]*=r,t[o+1]*=r,t[o+2]*=r},computeTangents:function(){function t(t,e,i){f=n[3*t],d=n[3*t+1],p=n[3*t+2],m=n[3*e],g=n[3*e+1],v=n[3*e+2],E=n[3*i],y=n[3*i+1],x=n[3*i+2],T=o[2*t],b=o[2*t+1],_=o[2*e],w=o[2*e+1],R=o[2*i],H=o[2*i+1],M=m-f,S=E-f,C=g-d,A=y-d,D=v-p,P=x-p,k=_-T,L=R-T,N=w-b,F=H-b,I=1/(k*F-L*N),z.set((F*M-N*S)*I,(F*C-N*A)*I,(F*D-N*P)*I),O.set((k*S-L*M)*I,(k*A-L*C)*I,(k*P-L*D)*I),c[t].add(z),c[e].add(z),c[i].add(z),h[t].add(O),h[e].add(O),h[i].add(O)}function e(t){te.x=r[3*t],te.y=r[3*t+1],te.z=r[3*t+2],ee.copy(te),ne=c[t],Z.copy(ne),Z.sub(te.multiplyScalar(te.dot(ne))).normalize(),J.crossVectors(ee,ne),re=J.dot(h[t]),ie=0>re?-1:1,l[4*t]=Z.x,l[4*t+1]=Z.y,l[4*t+2]=Z.z,l[4*t+3]=ie}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)return void console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");var i=this.attributes.index.array,n=this.attributes.position.array,r=this.attributes.normal.array,o=this.attributes.uv.array,a=n.length/3;if(void 0===this.attributes.tangent){var s=4*a;this.attributes.tangent={itemSize:4,array:new Float32Array(s),numItems:s}}for(var l=this.attributes.tangent.array,c=[],h=[],u=0;a>u;u++)c[u]=new THREE.Vector3,h[u]=new THREE.Vector3;var f,d,p,m,g,v,E,y,x,T,b,_,w,R,H,M,S,C,A,D,P,k,L,N,F,I,z=new THREE.Vector3,O=new THREE.Vector3,U,B,V,W,j,G,X,q=this.offsets;for(V=0,W=q.length;W>V;++V){var Y=q[V].start,K=q[V].count,Q=q[V].index;for(U=Y,B=Y+K;B>U;U+=3)j=Q+i[U],G=Q+i[U+1],X=Q+i[U+2],t(j,G,X)}var Z=new THREE.Vector3,J=new THREE.Vector3,te=new THREE.Vector3,ee=new THREE.Vector3,ie,ne,re;for(V=0,W=q.length;W>V;++V){var Y=q[V].start,K=q[V].count,Q=q[V].index;for(U=Y,B=Y+K;B>U;U+=3)j=Q+i[U],G=Q+i[U+1],X=Q+i[U+2],e(j),e(G),e(X)}this.hasTangents=!0,this.tangentsNeedUpdate=!0},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4,this.projectionMatrixInverse=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.lookAt=function(){var t=new THREE.Matrix4;return function(e){t.lookAt(this.position,e,this.up),this.useQuaternion===!0?this.quaternion.setFromRotationMatrix(t):this.rotation.setEulerFromRotationMatrix(t,this.eulerOrder)}}(),THREE.OrthographicCamera=function(t,e,i,n,r,o){THREE.Camera.call(this),this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.PerspectiveCamera=function(t,e,i,n){THREE.Camera.call(this),this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.setLens=function(t,e){void 0===e&&(e=24),this.fov=2*THREE.Math.radToDeg(Math.atan(e/(2*t))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(t,e,i,n,r,o){this.fullWidth=t,this.fullHeight=e,this.x=i,this.y=n,this.width=r,this.height=o,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var t=this.fullWidth/this.fullHeight,e=Math.tan(THREE.Math.degToRad(.5*this.fov))*this.near,i=-e,n=t*i,r=t*e,o=Math.abs(r-n),a=Math.abs(e-i);this.projectionMatrix.makeFrustum(n+this.x*o/this.fullWidth,n+(this.x+this.width)*o/this.fullWidth,e-(this.y+this.height)*a/this.fullHeight,e-this.y*a/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.Light=function(t){THREE.Object3D.call(this),this.color=new THREE.Color(t)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.clone=function(t){return void 0===t&&(t=new THREE.Light),THREE.Object3D.prototype.clone.call(this,t),t.color.copy(this.color),t},THREE.AmbientLight=function(t){THREE.Light.call(this,t)},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.clone=function(){var t=new THREE.AmbientLight;return THREE.Light.prototype.clone.call(this,t),t},THREE.AreaLight=function(t,e){THREE.Light.call(this,t),this.normal=new THREE.Vector3(0,-1,0),this.right=new THREE.Vector3(1,0,0),this.intensity=void 0!==e?e:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},THREE.AreaLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight=function(t,e){THREE.Light.call(this,t),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==e?e:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.clone=function(){var t=new THREE.DirectionalLight;return THREE.Light.prototype.clone.call(this,t),t.target=this.target.clone(),t.intensity=this.intensity,t.castShadow=this.castShadow,t.onlyShadow=this.onlyShadow,t},THREE.HemisphereLight=function(t,e,i){THREE.Light.call(this,t),this.position.set(0,100,0),this.groundColor=new THREE.Color(e),this.intensity=void 0!==i?i:1},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.clone=function(){var t=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,t),t.groundColor.copy(this.groundColor),t.intensity=this.intensity,t},THREE.PointLight=function(t,e,i){THREE.Light.call(this,t),this.intensity=void 0!==e?e:1,this.distance=void 0!==i?i:0},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.clone=function(){var t=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,t),t.intensity=this.intensity,t.distance=this.distance,t},THREE.SpotLight=function(t,e,i,n,r){THREE.Light.call(this,t),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==e?e:1,this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.exponent=void 0!==r?r:10,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.clone=function(){var t=new THREE.SpotLight;return THREE.Light.prototype.clone.call(this,t),t.target=this.target.clone(),t.intensity=this.intensity,t.distance=this.distance,t.angle=this.angle,t.exponent=this.exponent,t.castShadow=this.castShadow,t.onlyShadow=this.onlyShadow,t},THREE.Loader=function(t){this.showStatus=t,this.statusDomElement=t?THREE.Loader.prototype.addStatusElement():null,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var t=document.createElement("div");return t.style.position="absolute",t.style.right="0px",t.style.top="0px",t.style.fontSize="0.8em",t.style.textAlign="left",t.style.background="rgba(0,0,0,0.25)",t.style.color="#fff",t.style.width="120px",t.style.padding="0.5em 0.5em 0.5em 0.5em",t.style.zIndex=1e3,t.innerHTML="Loading ...",t},updateProgress:function(t){var e="Loaded ";e+=t.total?(100*t.loaded/t.total).toFixed(0)+"%":(t.loaded/1e3).toFixed(2)+" KB",this.statusDomElement.innerHTML=e},extractUrlBase:function(t){var e=t.split("/");return e.pop(),(e.length<1?".":e.join("/"))+"/"},initMaterials:function(t,e){for(var i=[],n=0;n<t.length;++n)i[n]=THREE.Loader.prototype.createMaterial(t[n],e);return i},needsTangents:function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];if(n instanceof THREE.ShaderMaterial)return!0}return!1},createMaterial:function(t,e){function i(t){var e=Math.log(t)/Math.LN2;return Math.floor(e)==e}function n(t){var e=Math.log(t)/Math.LN2;return Math.pow(2,Math.round(e))}function r(t,e){var r=new Image;r.onload=function(){if(i(this.width)&&i(this.height))t.image=this;else{var e=n(this.width),r=n(this.height);t.image.width=e,t.image.height=r,t.image.getContext("2d").drawImage(this,0,0,e,r)}t.needsUpdate=!0},r.crossOrigin=s.crossOrigin,r.src=e}function o(t,i,n,o,a,s,l){var c=/\.dds$/i.test(n),h=e+"/"+n;if(c){var u=THREE.ImageUtils.loadCompressedTexture(h);t[i]=u}else{var u=document.createElement("canvas");t[i]=new THREE.Texture(u)}if(t[i].sourceFile=n,o&&(t[i].repeat.set(o[0],o[1]),1!==o[0]&&(t[i].wrapS=THREE.RepeatWrapping),1!==o[1]&&(t[i].wrapT=THREE.RepeatWrapping)),a&&t[i].offset.set(a[0],a[1]),s){var f={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};void 0!==f[s[0]]&&(t[i].wrapS=f[s[0]]),void 0!==f[s[1]]&&(t[i].wrapT=f[s[1]])}l&&(t[i].anisotropy=l),c||r(t[i],h)}function a(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]}var s=this,l="MeshLambertMaterial",c={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(t.shading){var h=t.shading.toLowerCase();"phong"===h?l="MeshPhongMaterial":"basic"===h&&(l="MeshBasicMaterial")}if(void 0!==t.blending&&void 0!==THREE[t.blending]&&(c.blending=THREE[t.blending]),(void 0!==t.transparent||t.opacity<1)&&(c.transparent=t.transparent),void 0!==t.depthTest&&(c.depthTest=t.depthTest),void 0!==t.depthWrite&&(c.depthWrite=t.depthWrite),void 0!==t.visible&&(c.visible=t.visible),void 0!==t.flipSided&&(c.side=THREE.BackSide),void 0!==t.doubleSided&&(c.side=THREE.DoubleSide),void 0!==t.wireframe&&(c.wireframe=t.wireframe),void 0!==t.vertexColors&&("face"===t.vertexColors?c.vertexColors=THREE.FaceColors:t.vertexColors&&(c.vertexColors=THREE.VertexColors)),t.colorDiffuse?c.color=a(t.colorDiffuse):t.DbgColor&&(c.color=t.DbgColor),t.colorSpecular&&(c.specular=a(t.colorSpecular)),t.colorAmbient&&(c.ambient=a(t.colorAmbient)),t.transparency&&(c.opacity=t.transparency),t.specularCoef&&(c.shininess=t.specularCoef),t.mapDiffuse&&e&&o(c,"map",t.mapDiffuse,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy),t.mapLight&&e&&o(c,"lightMap",t.mapLight,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy),t.mapBump&&e&&o(c,"bumpMap",t.mapBump,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy),t.mapNormal&&e&&o(c,"normalMap",t.mapNormal,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy),t.mapSpecular&&e&&o(c,"specularMap",t.mapSpecular,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy),t.mapBumpScale&&(c.bumpScale=t.mapBumpScale),t.mapNormal){var u=THREE.ShaderLib.normalmap,f=THREE.UniformsUtils.clone(u.uniforms);f.tNormal.value=c.normalMap,t.mapNormalFactor&&f.uNormalScale.value.set(t.mapNormalFactor,t.mapNormalFactor),c.map&&(f.tDiffuse.value=c.map,f.enableDiffuse.value=!0),c.specularMap&&(f.tSpecular.value=c.specularMap,f.enableSpecular.value=!0),c.lightMap&&(f.tAO.value=c.lightMap,f.enableAO.value=!0),f.uDiffuseColor.value.setHex(c.color),f.uSpecularColor.value.setHex(c.specular),f.uAmbientColor.value.setHex(c.ambient),f.uShininess.value=c.shininess,void 0!==c.opacity&&(f.uOpacity.value=c.opacity);var d={fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:f,lights:!0,fog:!0},p=new THREE.ShaderMaterial(d);c.transparent&&(p.transparent=!0)}else var p=new THREE[l](c);return void 0!==t.DbgName&&(p.name=t.DbgName),p}},THREE.ImageLoader=function(){this.crossOrigin=null},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(t,e){var i=this;void 0===e&&(e=new Image),e.addEventListener("load",function(){i.dispatchEvent({type:"load",content:e})},!1),e.addEventListener("error",function(){i.dispatchEvent({type:"error",message:"Couldn't load URL ["+t+"]"})},!1),i.crossOrigin&&(e.crossOrigin=i.crossOrigin),e.src=t}},THREE.JSONLoader=function(t){THREE.Loader.call(this,t),this.withCredentials=!1},THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype),THREE.JSONLoader.prototype.load=function(t,e,i){var n=this;i=i&&"string"==typeof i?i:this.extractUrlBase(t),this.onLoadStart(),this.loadAjaxJSON(this,t,e,i)},THREE.JSONLoader.prototype.loadAjaxJSON=function(t,e,i,n,r){var o=new XMLHttpRequest,a=0;o.onreadystatechange=function(){if(o.readyState===o.DONE)if(200===o.status||0===o.status){if(o.responseText){var s=JSON.parse(o.responseText),l=t.parse(s,n);i(l.geometry,l.materials)}else console.warn("THREE.JSONLoader: ["+e+"] seems to be unreachable or file there is empty");t.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+e+"] ["+o.status+"]");else o.readyState===o.LOADING?r&&(0===a&&(a=o.getResponseHeader("Content-Length")),r({total:a,loaded:o.responseText.length})):o.readyState===o.HEADERS_RECEIVED&&void 0!==r&&(a=o.getResponseHeader("Content-Length"))},o.open("GET",e,!0),o.withCredentials=this.withCredentials,o.send(null)},THREE.JSONLoader.prototype.parse=function(t,e){function i(e){function i(t,e){return t&1<<e}var n,r,o,s,l,c,h,u,f,d,p,m,g,v,E,y,x,T,b,_,w,R,H,M,S,C,A,D=t.faces,P=t.vertices,k=t.normals,L=t.colors,N=0;for(n=0;n<t.uvs.length;n++)t.uvs[n].length&&N++;for(n=0;N>n;n++)a.faceUvs[n]=[],a.faceVertexUvs[n]=[];for(s=0,l=P.length;l>s;)_=new THREE.Vector3,_.x=P[s++]*e,_.y=P[s++]*e,_.z=P[s++]*e,a.vertices.push(_);for(s=0,l=D.length;l>s;){if(p=D[s++],m=i(p,0),g=i(p,1),v=i(p,2),E=i(p,3),y=i(p,4),x=i(p,5),T=i(p,6),b=i(p,7),m?(w=new THREE.Face4,w.a=D[s++],w.b=D[s++],w.c=D[s++],w.d=D[s++],c=4):(w=new THREE.Face3,w.a=D[s++],w.b=D[s++],w.c=D[s++],c=3),g&&(d=D[s++],w.materialIndex=d),o=a.faces.length,v)for(n=0;N>n;n++)M=t.uvs[n],f=D[s++],C=M[2*f],A=M[2*f+1],a.faceUvs[n][o]=new THREE.Vector2(C,A);if(E)for(n=0;N>n;n++){for(M=t.uvs[n],S=[],r=0;c>r;r++)f=D[s++],C=M[2*f],A=M[2*f+1],S[r]=new THREE.Vector2(C,A);a.faceVertexUvs[n][o]=S}if(y&&(u=3*D[s++],H=new THREE.Vector3,H.x=k[u++],H.y=k[u++],H.z=k[u],w.normal=H),x)for(n=0;c>n;n++)u=3*D[s++],H=new THREE.Vector3,H.x=k[u++],H.y=k[u++],H.z=k[u],w.vertexNormals.push(H);if(T&&(h=D[s++],R=new THREE.Color(L[h]),w.color=R),b)for(n=0;c>n;n++)h=D[s++],R=new THREE.Color(L[h]),w.vertexColors.push(R);a.faces.push(w)}}function n(){var e,i,n,r,o,s,l,c,h,u;if(t.skinWeights)for(e=0,i=t.skinWeights.length;i>e;e+=2)n=t.skinWeights[e],r=t.skinWeights[e+1],o=0,s=0,a.skinWeights.push(new THREE.Vector4(n,r,o,s));if(t.skinIndices)for(e=0,i=t.skinIndices.length;i>e;e+=2)l=t.skinIndices[e],c=t.skinIndices[e+1],h=0,u=0,a.skinIndices.push(new THREE.Vector4(l,c,h,u));a.bones=t.bones,a.animation=t.animation}function r(e){if(void 0!==t.morphTargets){var i,n,r,o,s,l;for(i=0,n=t.morphTargets.length;n>i;i++)for(a.morphTargets[i]={},a.morphTargets[i].name=t.morphTargets[i].name,a.morphTargets[i].vertices=[],s=a.morphTargets[i].vertices,l=t.morphTargets[i].vertices,r=0,o=l.length;o>r;r+=3){var c=new THREE.Vector3;c.x=l[r]*e,c.y=l[r+1]*e,c.z=l[r+2]*e,s.push(c)}}if(void 0!==t.morphColors){var i,n,h,u,f,d,p;for(i=0,n=t.morphColors.length;n>i;i++)for(a.morphColors[i]={},a.morphColors[i].name=t.morphColors[i].name,a.morphColors[i].colors=[],f=a.morphColors[i].colors,d=t.morphColors[i].colors,h=0,u=d.length;u>h;h+=3)p=new THREE.Color(16755200),p.setRGB(d[h],d[h+1],d[h+2]),f.push(p)}}var o=this,a=new THREE.Geometry,s=void 0!==t.scale?1/t.scale:1;if(i(s),n(),r(s),a.computeCentroids(),a.computeFaceNormals(),void 0===t.materials)return{geometry:a};var l=this.initMaterials(t.materials,e);return this.needsTangents(l)&&a.computeTangents(),{geometry:a,materials:l}},THREE.LoadingMonitor=function(){var t=this,e=0,i=0,n=function(n){e++,t.dispatchEvent({type:"progress",loaded:e,total:i}),e===i&&t.dispatchEvent({type:"load"})};this.add=function(t){i++,t.addEventListener("load",n,!1)}},THREE.LoadingMonitor.prototype={constructor:THREE.LoadingMonitor,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent},THREE.GeometryLoader=function(){},THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(t){var e=this,i=new XMLHttpRequest;i.addEventListener("load",function(t){var i=e.parse(JSON.parse(t.target.responseText));e.dispatchEvent({type:"load",content:i})},!1),i.addEventListener("progress",function(t){e.dispatchEvent({type:"progress",loaded:t.loaded,total:t.total})},!1),i.addEventListener("error",function(){e.dispatchEvent({type:"error",message:"Couldn't load URL ["+t+"]"})},!1),i.open("GET",t,!0),i.send(null)},parse:function(t){}},THREE.MaterialLoader=function(){},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(t){var e=this,i=new XMLHttpRequest;i.addEventListener("load",function(t){var i=e.parse(JSON.parse(t.target.responseText));e.dispatchEvent({type:"load",content:i})},!1),i.addEventListener("progress",function(t){e.dispatchEvent({type:"progress",loaded:t.loaded,total:t.total})},!1),i.addEventListener("error",function(){e.dispatchEvent({type:"error",message:"Couldn't load URL ["+t+"]"})},!1),i.open("GET",t,!0),i.send(null)},parse:function(t){var e;switch(t.type){case"MeshBasicMaterial":e=new THREE.MeshBasicMaterial({color:t.color,opacity:t.opacity,transparent:t.transparent,wireframe:t.wireframe});break;case"MeshLambertMaterial":e=new THREE.MeshLambertMaterial({color:t.color,ambient:t.ambient,emissive:t.emissive,opacity:t.opacity,transparent:t.transparent,wireframe:t.wireframe});break;case"MeshPhongMaterial":e=new THREE.MeshPhongMaterial({color:t.color,ambient:t.ambient,emissive:t.emissive,specular:t.specular,shininess:t.shininess,opacity:t.opacity,transparent:t.transparent,wireframe:t.wireframe});break;case"MeshNormalMaterial":e=new THREE.MeshNormalMaterial({opacity:t.opacity,transparent:t.transparent,wireframe:t.wireframe});break;case"MeshDepthMaterial":e=new THREE.MeshDepthMaterial({opacity:t.opacity,transparent:t.transparent,wireframe:t.wireframe})}return e}},THREE.SceneLoader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){},this.callbackSync=function(){},this.callbackProgress=function(){},this.geometryHandlerMap={},this.hierarchyHandlerMap={},this.addGeometryHandler("ascii",THREE.JSONLoader)},THREE.SceneLoader.prototype.constructor=THREE.SceneLoader,THREE.SceneLoader.prototype.load=function(t,e){var i=this,n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status||0===n.status){var r=JSON.parse(n.responseText);i.parse(r,e,t)}else console.error("THREE.SceneLoader: Couldn't load ["+t+"] ["+n.status+"]")},n.open("GET",t,!0),n.send(null)},THREE.SceneLoader.prototype.addGeometryHandler=function(t,e){this.geometryHandlerMap[t]={loaderClass:e}},THREE.SceneLoader.prototype.addHierarchyHandler=function(t,e){this.hierarchyHandlerMap[t]={loaderClass:e}},THREE.SceneLoader.prototype.parse=function(t,e,i){function n(t,e){return"relativeToHTML"==e?t:p+"/"+t}function r(){o(C.scene,D.objects)}function o(t,e){var i,r,a,s,l,h;for(var u in e)if(void 0===C.objects[u]){var f=e[u],p=null;if(f.type&&f.type in d.hierarchyHandlerMap){if(void 0===f.loading){var E={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1},y={};for(var x in f)x in E||(y[x]=f[x]);g=C.materials[f.material],f.loading=!0;var T=d.hierarchyHandlerMap[f.type].loaderObject;T.options?T.load(n(f.url,D.urlBaseType),c(u,t,g,f)):T.load(n(f.url,D.urlBaseType),c(u,t,g,f),y)}}else if(void 0!==f.geometry){if(m=C.geometries[f.geometry]){var R=!1;if(g=C.materials[f.material],R=g instanceof THREE.ShaderMaterial,a=f.position,s=f.rotation,l=f.scale,i=f.matrix,h=f.quaternion,f.material||(g=new THREE.MeshFaceMaterial(C.face_materials[f.geometry])),g instanceof THREE.MeshFaceMaterial&&0===g.materials.length&&(g=new THREE.MeshFaceMaterial(C.face_materials[f.geometry])),g instanceof THREE.MeshFaceMaterial)for(var H=0;H<g.materials.length;H++)R=R||g.materials[H]instanceof THREE.ShaderMaterial;R&&m.computeTangents(),f.skin?p=new THREE.SkinnedMesh(m,g):f.morph?(p=new THREE.MorphAnimMesh(m,g),void 0!==f.duration&&(p.duration=f.duration),void 0!==f.time&&(p.time=f.time),void 0!==f.mirroredLoop&&(p.mirroredLoop=f.mirroredLoop),g.morphNormals&&m.computeMorphNormals()):p=new THREE.Mesh(m,g),p.name=u,i?(p.matrixAutoUpdate=!1,p.matrix.set(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])):(p.position.set(a[0],a[1],a[2]),h?(p.quaternion.set(h[0],h[1],h[2],h[3]),p.useQuaternion=!0):p.rotation.set(s[0],s[1],s[2]),p.scale.set(l[0],l[1],l[2])),p.visible=f.visible,p.castShadow=f.castShadow,p.receiveShadow=f.receiveShadow,t.add(p),C.objects[u]=p}}else"DirectionalLight"===f.type||"PointLight"===f.type||"AmbientLight"===f.type?(_=void 0!==f.color?f.color:16777215,w=void 0!==f.intensity?f.intensity:1,"DirectionalLight"===f.type?(a=f.direction,b=new THREE.DirectionalLight(_,w),b.position.set(a[0],a[1],a[2]),f.target&&(A.push({object:b,targetName:f.target}),b.target=null)):"PointLight"===f.type?(a=f.position,r=f.distance,b=new THREE.PointLight(_,w,r),b.position.set(a[0],a[1],a[2])):"AmbientLight"===f.type&&(b=new THREE.AmbientLight(_)),t.add(b),b.name=u,C.lights[u]=b,C.objects[u]=b):"PerspectiveCamera"===f.type||"OrthographicCamera"===f.type?(a=f.position,s=f.rotation,h=f.quaternion,"PerspectiveCamera"===f.type?v=new THREE.PerspectiveCamera(f.fov,f.aspect,f.near,f.far):"OrthographicCamera"===f.type&&(v=new THREE.OrthographicCamera(f.left,f.right,f.top,f.bottom,f.near,f.far)),v.name=u,v.position.set(a[0],a[1],a[2]),void 0!==h?(v.quaternion.set(h[0],h[1],h[2],h[3]),v.useQuaternion=!0):void 0!==s&&v.rotation.set(s[0],s[1],s[2]),t.add(v),C.cameras[u]=v,C.objects[u]=v):(a=f.position,s=f.rotation,l=f.scale,h=f.quaternion,p=new THREE.Object3D,p.name=u,p.position.set(a[0],a[1],a[2]),h?(p.quaternion.set(h[0],h[1],h[2],h[3]),p.useQuaternion=!0):p.rotation.set(s[0],s[1],s[2]),p.scale.set(l[0],l[1],l[2]),p.visible=void 0!==f.visible?f.visible:!1,t.add(p),C.objects[u]=p,C.empties[u]=p);if(p){if(void 0!==f.userData)for(var M in f.userData){var S=f.userData[M];p.userData[M]=S}if(void 0!==f.groups)for(var H=0;H<f.groups.length;H++){var P=f.groups[H];void 0===C.groups[P]&&(C.groups[P]=[]),C.groups[P].push(u)}void 0!==f.children&&o(p,f.children)}}}function a(t,e,i){C.geometries[i]=t,C.face_materials[i]=e,r()}function s(t,e,i,n,o){var a=o.position,s=o.rotation,l=o.quaternion,c=o.scale;t.position.set(a[0],a[1],a[2]),l?(t.quaternion.set(l[0],l[1],l[2],l[3]),t.useQuaternion=!0):t.rotation.set(s[0],s[1],s[2]),t.scale.set(c[0],c[1],c[2]),n&&t.traverse(function(t){t.material=n});var h=void 0!==o.visible?o.visible:!0;t.traverse(function(t){t.visible=h}),i.add(t),t.name=e,C.objects[e]=t,r()}function l(t){return function(e,i){e.name=t,a(e,i,t),R-=1,d.onLoadComplete(),u()}}function c(t,e,i,n){return function(r){var o;o=r.content?r.content:r.dae?r.scene:r,s(o,t,e,i,n),R-=1,d.onLoadComplete(),u()}}function h(t){return function(e,i){e.name=t,C.geometries[t]=e,C.face_materials[t]=i}}function u(){var t={totalModels:M,totalTextures:S,loadedModels:M-R,loadedTextures:S-H};d.callbackProgress(t,C),d.onLoadProgress(),0===R&&0===H&&(f(),e(C))}function f(){for(var t=0;t<A.length;t++){var e=A[t],i=C.objects[e.targetName];i?e.object.target=i:(e.object.target=new THREE.Object3D,C.scene.add(e.object.target)),e.object.target.userData.targetInverse=e.object}}var d=this,p=THREE.Loader.prototype.extractUrlBase(i),m,g,v,E,y,x,T,b,_,w,R,H,M,S,C,A=[],D=t;for(var P in this.geometryHandlerMap){var k=this.geometryHandlerMap[P].loaderClass;this.geometryHandlerMap[P].loaderObject=new k}for(var P in this.hierarchyHandlerMap){var k=this.hierarchyHandlerMap[P].loaderClass;this.hierarchyHandlerMap[P].loaderObject=new k}if(R=0,H=0,C={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}},D.transform){var L=D.transform.position,N=D.transform.rotation,F=D.transform.scale;L&&C.scene.position.set(L[0],L[1],L[2]),N&&C.scene.rotation.set(N[0],N[1],N[2]),F&&C.scene.scale.set(F[0],F[1],F[2]),(L||N||F)&&(C.scene.updateMatrix(),C.scene.updateMatrixWorld())}var I=function(t){H-=t,u(),d.onLoadComplete()},z=function(t){return function(){I(t)}},O,U;for(O in D.fogs)U=D.fogs[O],"linear"===U.type?E=new THREE.Fog(0,U.near,U.far):"exp2"===U.type&&(E=new THREE.FogExp2(0,U.density)),T=U.color,E.color.setRGB(T[0],T[1],T[2]),C.fogs[O]=E;var B,V;for(B in D.geometries)V=D.geometries[B],V.type in this.geometryHandlerMap&&(R+=1,d.onLoadStart());var W,j;for(W in D.objects)j=D.objects[W],j.type&&j.type in this.hierarchyHandlerMap&&(R+=1,d.onLoadStart());M=R;for(B in D.geometries)if(V=D.geometries[B],"cube"===V.type)m=new THREE.CubeGeometry(V.width,V.height,V.depth,V.widthSegments,V.heightSegments,V.depthSegments),m.name=B,C.geometries[B]=m;else if("plane"===V.type)m=new THREE.PlaneGeometry(V.width,V.height,V.widthSegments,V.heightSegments),m.name=B,C.geometries[B]=m;else if("sphere"===V.type)m=new THREE.SphereGeometry(V.radius,V.widthSegments,V.heightSegments),m.name=B,C.geometries[B]=m;else if("cylinder"===V.type)m=new THREE.CylinderGeometry(V.topRad,V.botRad,V.height,V.radSegs,V.heightSegs),m.name=B,C.geometries[B]=m;else if("torus"===V.type)m=new THREE.TorusGeometry(V.radius,V.tube,V.segmentsR,V.segmentsT),m.name=B,C.geometries[B]=m;else if("icosahedron"===V.type)m=new THREE.IcosahedronGeometry(V.radius,V.subdivisions),m.name=B,C.geometries[B]=m;else if(V.type in this.geometryHandlerMap){var G={};for(var X in V)"type"!==X&&"url"!==X&&(G[X]=V[X]);var q=this.geometryHandlerMap[V.type].loaderObject;q.load(n(V.url,D.urlBaseType),l(B),G)}else if("embedded"===V.type){var Y=D.embeds[V.id],K="";
if(Y.metadata=D.metadata,Y){var Q=this.geometryHandlerMap.ascii.loaderObject,Z=Q.parse(Y,K);h(B)(Z.geometry,Z.materials)}}var J,te;for(J in D.textures)if(te=D.textures[J],te.url instanceof Array){H+=te.url.length;for(var ee=0;ee<te.url.length;ee++)d.onLoadStart()}else H+=1,d.onLoadStart();S=H;for(J in D.textures){if(te=D.textures[J],void 0!==te.mapping&&void 0!==THREE[te.mapping]&&(te.mapping=new THREE[te.mapping]),te.url instanceof Array){for(var ie=te.url.length,ne=[],re=0;ie>re;re++)ne[re]=n(te.url[re],D.urlBaseType);var oe=/\.dds$/i.test(ne[0]);y=oe?THREE.ImageUtils.loadCompressedTextureCube(ne,te.mapping,z(ie)):THREE.ImageUtils.loadTextureCube(ne,te.mapping,z(ie))}else{var oe=/\.dds$/i.test(te.url),ae=n(te.url,D.urlBaseType),se=z(1);if(y=oe?THREE.ImageUtils.loadCompressedTexture(ae,te.mapping,se):THREE.ImageUtils.loadTexture(ae,te.mapping,se),void 0!==THREE[te.minFilter]&&(y.minFilter=THREE[te.minFilter]),void 0!==THREE[te.magFilter]&&(y.magFilter=THREE[te.magFilter]),te.anisotropy&&(y.anisotropy=te.anisotropy),te.repeat&&(y.repeat.set(te.repeat[0],te.repeat[1]),1!==te.repeat[0]&&(y.wrapS=THREE.RepeatWrapping),1!==te.repeat[1]&&(y.wrapT=THREE.RepeatWrapping)),te.offset&&y.offset.set(te.offset[0],te.offset[1]),te.wrap){var le={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};void 0!==le[te.wrap[0]]&&(y.wrapS=le[te.wrap[0]]),void 0!==le[te.wrap[1]]&&(y.wrapT=le[te.wrap[1]])}}C.textures[J]=y}var ce,he,ue;for(ce in D.materials){he=D.materials[ce];for(ue in he.parameters)if("envMap"===ue||"map"===ue||"lightMap"===ue||"bumpMap"===ue)he.parameters[ue]=C.textures[he.parameters[ue]];else if("shading"===ue)he.parameters[ue]="flat"===he.parameters[ue]?THREE.FlatShading:THREE.SmoothShading;else if("side"===ue)he.parameters[ue]="double"==he.parameters[ue]?THREE.DoubleSide:"back"==he.parameters[ue]?THREE.BackSide:THREE.FrontSide;else if("blending"===ue)he.parameters[ue]=he.parameters[ue]in THREE?THREE[he.parameters[ue]]:THREE.NormalBlending;else if("combine"===ue)he.parameters[ue]=he.parameters[ue]in THREE?THREE[he.parameters[ue]]:THREE.MultiplyOperation;else if("vertexColors"===ue)"face"==he.parameters[ue]?he.parameters[ue]=THREE.FaceColors:he.parameters[ue]&&(he.parameters[ue]=THREE.VertexColors);else if("wrapRGB"===ue){var fe=he.parameters[ue];he.parameters[ue]=new THREE.Vector3(fe[0],fe[1],fe[2])}if(void 0!==he.parameters.opacity&&he.parameters.opacity<1&&(he.parameters.transparent=!0),he.parameters.normalMap){var de=THREE.ShaderLib.normalmap,pe=THREE.UniformsUtils.clone(de.uniforms),me=he.parameters.color,ge=he.parameters.specular,ve=he.parameters.ambient,Ee=he.parameters.shininess;pe.tNormal.value=C.textures[he.parameters.normalMap],he.parameters.normalScale&&pe.uNormalScale.value.set(he.parameters.normalScale[0],he.parameters.normalScale[1]),he.parameters.map&&(pe.tDiffuse.value=he.parameters.map,pe.enableDiffuse.value=!0),he.parameters.envMap&&(pe.tCube.value=he.parameters.envMap,pe.enableReflection.value=!0,pe.uReflectivity.value=he.parameters.reflectivity),he.parameters.lightMap&&(pe.tAO.value=he.parameters.lightMap,pe.enableAO.value=!0),he.parameters.specularMap&&(pe.tSpecular.value=C.textures[he.parameters.specularMap],pe.enableSpecular.value=!0),he.parameters.displacementMap&&(pe.tDisplacement.value=C.textures[he.parameters.displacementMap],pe.enableDisplacement.value=!0,pe.uDisplacementBias.value=he.parameters.displacementBias,pe.uDisplacementScale.value=he.parameters.displacementScale),pe.uDiffuseColor.value.setHex(me),pe.uSpecularColor.value.setHex(ge),pe.uAmbientColor.value.setHex(ve),pe.uShininess.value=Ee,he.parameters.opacity&&(pe.uOpacity.value=he.parameters.opacity);var ye={fragmentShader:de.fragmentShader,vertexShader:de.vertexShader,uniforms:pe,lights:!0,fog:!0};g=new THREE.ShaderMaterial(ye)}else g=new THREE[he.type](he.parameters);g.name=ce,C.materials[ce]=g}for(ce in D.materials)if(he=D.materials[ce],he.parameters.materials){for(var xe=[],re=0;re<he.parameters.materials.length;re++){var Te=he.parameters.materials[re];xe.push(C.materials[Te])}C.materials[ce].materials=xe}r(),C.cameras&&D.defaults.camera&&(C.currentCamera=C.cameras[D.defaults.camera]),C.fogs&&D.defaults.fog&&(C.scene.fog=C.fogs[D.defaults.fog]),d.callbackSync(C),u()},THREE.TextureLoader=function(){this.crossOrigin=null},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(t){var e=this,i=new Image;i.addEventListener("load",function(){var t=new THREE.Texture(i);t.needsUpdate=!0,e.dispatchEvent({type:"load",content:t})},!1),i.addEventListener("error",function(){e.dispatchEvent({type:"error",message:"Couldn't load URL ["+t+"]"})},!1),e.crossOrigin&&(i.crossOrigin=e.crossOrigin),i.src=t}},THREE.Material=function(){this.id=THREE.MaterialIdCount++,this.name="",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=!1,this.visible=!0,this.needsUpdate=!0},THREE.Material.prototype={constructor:THREE.Material,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i){if(e in this){var n=this[e];n instanceof THREE.Color?n.set(i):n instanceof THREE.Vector3&&i instanceof THREE.Vector3?n.copy(i):this[e]=i}}else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},clone:function(t){return void 0===t&&(t=new THREE.Material),t.name=this.name,t.side=this.side,t.opacity=this.opacity,t.transparent=this.transparent,t.blending=this.blending,t.blendSrc=this.blendSrc,t.blendDst=this.blendDst,t.blendEquation=this.blendEquation,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.polygonOffset=this.polygonOffset,t.polygonOffsetFactor=this.polygonOffsetFactor,t.polygonOffsetUnits=this.polygonOffsetUnits,t.alphaTest=this.alphaTest,t.overdraw=this.overdraw,t.visible=this.visible,t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.setValues(t)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.clone=function(){var t=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.linewidth=this.linewidth,t.linecap=this.linecap,t.linejoin=this.linejoin,t.vertexColors=this.vertexColors,t.fog=this.fog,t},THREE.LineDashedMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(t)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.clone=function(){var t=new THREE.LineDashedMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.linewidth=this.linewidth,t.scale=this.scale,t.dashSize=this.dashSize,t.gapSize=this.gapSize,t.vertexColors=this.vertexColors,t.fog=this.fog,t},THREE.MeshBasicMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(t)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.clone=function(){var t=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.lightMap=this.lightMap,t.specularMap=this.specularMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t},THREE.MeshLambertMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.clone=function(){var t=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.ambient.copy(this.ambient),t.emissive.copy(this.emissive),t.wrapAround=this.wrapAround,t.wrapRGB.copy(this.wrapRGB),t.map=this.map,t.lightMap=this.lightMap,t.specularMap=this.specularMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.MeshPhongMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.perPixel=!0,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.clone=function(){var t=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.ambient.copy(this.ambient),t.emissive.copy(this.emissive),t.specular.copy(this.specular),t.shininess=this.shininess,t.metal=this.metal,t.perPixel=this.perPixel,t.wrapAround=this.wrapAround,t.wrapRGB.copy(this.wrapRGB),t.map=this.map,t.lightMap=this.lightMap,t.bumpMap=this.bumpMap,t.bumpScale=this.bumpScale,t.normalMap=this.normalMap,t.normalScale.copy(this.normalScale),t.specularMap=this.specularMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.MeshDepthMaterial=function(t){THREE.Material.call(this),this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.clone=function(){var t=new THREE.MeshDepthMaterial;return THREE.Material.prototype.clone.call(this,t),t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t},THREE.MeshNormalMaterial=function(t){THREE.Material.call(this,t),this.shading=THREE.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.clone=function(){var t=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,t),t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t},THREE.MeshFaceMaterial=function(t){this.materials=t instanceof Array?t:[]},THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))},THREE.ParticleBasicMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=!1,this.fog=!0,this.setValues(t)},THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleBasicMaterial.prototype.clone=function(){var t=new THREE.ParticleBasicMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.size=this.size,t.sizeAttenuation=this.sizeAttenuation,t.vertexColors=this.vertexColors,t.fog=this.fog,t},THREE.ParticleCanvasMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.program=function(t,e){},this.setValues(t)},THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleCanvasMaterial.prototype.clone=function(){var t=new THREE.ParticleCanvasMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.program=this.program,t},THREE.ShaderMaterial=function(t){THREE.Material.call(this),this.fragmentShader="void main() {}",this.vertexShader="void main() {}",this.uniforms={},this.defines={},this.attributes=null,this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.clone=function(){var t=new THREE.ShaderMaterial;return THREE.Material.prototype.clone.call(this,t),t.fragmentShader=this.fragmentShader,t.vertexShader=this.vertexShader,t.uniforms=THREE.UniformsUtils.clone(this.uniforms),t.attributes=this.attributes,t.defines=this.defines,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.fog=this.fog,t.lights=this.lights,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.SpriteMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=new THREE.Texture,this.useScreenCoordinates=!0,this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.scaleByViewport=!this.sizeAttenuation,this.alignment=THREE.SpriteAlignment.center.clone(),this.fog=!1,this.uvOffset=new THREE.Vector2(0,0),this.uvScale=new THREE.Vector2(1,1),this.setValues(t),t=t||{},void 0===t.depthTest&&(this.depthTest=!this.useScreenCoordinates),void 0===t.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates),void 0===t.scaleByViewport&&(this.scaleByViewport=!this.sizeAttenuation)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.clone=function(){var t=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.useScreenCoordinates=this.useScreenCoordinates,t.sizeAttenuation=this.sizeAttenuation,t.scaleByViewport=this.scaleByViewport,t.alignment.copy(this.alignment),t.uvOffset.copy(this.uvOffset),t.uvScale.copy(this.uvScale),t.fog=this.fog,t},THREE.SpriteAlignment={},THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1),THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1),THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1),THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0),THREE.SpriteAlignment.center=new THREE.Vector2(0,0),THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0),THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1),THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1),THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1),THREE.Texture=function(t,e,i,n,r,o,a,s,l){this.id=THREE.TextureIdCount++,this.name="",this.image=t,this.mipmaps=[],this.mapping=void 0!==e?e:new THREE.UVMapping,this.wrapS=void 0!==i?i:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==n?n:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==r?r:THREE.LinearFilter,this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:THREE.RGBAFormat,this.type=void 0!==s?s:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.needsUpdate=!1,this.onUpdate=null},THREE.Texture.prototype={constructor:THREE.Texture,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(t){return void 0===t&&(t=new THREE.Texture),t.image=this.image,t.mipmaps=this.mipmaps.slice(0),t.mapping=this.mapping,t.wrapS=this.wrapS,t.wrapT=this.wrapT,t.magFilter=this.magFilter,t.minFilter=this.minFilter,t.anisotropy=this.anisotropy,t.format=this.format,t.type=this.type,t.offset.copy(this.offset),t.repeat.copy(this.repeat),t.generateMipmaps=this.generateMipmaps,t.premultiplyAlpha=this.premultiplyAlpha,t.flipY=this.flipY,t.unpackAlignment=this.unpackAlignment,t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.TextureIdCount=0,THREE.CompressedTexture=function(t,e,i,n,r,o,a,s,l,c,h){THREE.Texture.call(this,null,o,a,s,l,c,n,r,h),this.image={width:e,height:i},this.mipmaps=t,this.generateMipmaps=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.clone=function(){var t=new THREE.CompressedTexture;return THREE.Texture.prototype.clone.call(this,t),t},THREE.DataTexture=function(t,e,i,n,r,o,a,s,l,c,h){THREE.Texture.call(this,null,o,a,s,l,c,n,r,h),this.image={data:t,width:e,height:i}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.clone=function(){var t=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,t),t},THREE.Particle=function(t){THREE.Object3D.call(this),this.material=t},THREE.Particle.prototype=Object.create(THREE.Object3D.prototype),THREE.Particle.prototype.clone=function(t){return void 0===t&&(t=new THREE.Particle(this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.ParticleSystem=function(t,e){THREE.Object3D.call(this),this.geometry=t,this.material=void 0!==e?e:new THREE.ParticleBasicMaterial({color:16777215*Math.random()}),this.sortParticles=!1,this.geometry&&null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.frustumCulled=!1},THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype),THREE.ParticleSystem.prototype.clone=function(t){return void 0===t&&(t=new THREE.ParticleSystem(this.geometry,this.material)),t.sortParticles=this.sortParticles,THREE.Object3D.prototype.clone.call(this,t),t},THREE.Line=function(t,e,i){THREE.Object3D.call(this),this.geometry=t,this.material=void 0!==e?e:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==i?i:THREE.LineStrip,this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.clone=function(t){return void 0===t&&(t=new THREE.Line(this.geometry,this.material,this.type)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Mesh=function(t,e){THREE.Object3D.call(this),this.geometry=null,this.material=null,this.setGeometry(t),this.setMaterial(e)},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.setGeometry=function(t){void 0!==t&&(this.geometry=t,null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.updateMorphTargets())},THREE.Mesh.prototype.setMaterial=function(t){this.material=void 0!==t?t:new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0})},THREE.Mesh.prototype.updateMorphTargets=function(){if(this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;e>t;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.clone=function(t){return void 0===t&&(t=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Bone=function(t){THREE.Object3D.call(this),this.skin=t,this.skinMatrix=new THREE.Matrix4},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.update=function(t,e){this.matrixAutoUpdate&&(e|=this.updateMatrix()),(e||this.matrixWorldNeedsUpdate)&&(t?this.skinMatrix.multiplyMatrices(t,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);var i,n,r=this.children.length;for(n=0;r>n;n++)this.children[n].update(this.skinMatrix,e)},THREE.SkinnedMesh=function(t,e,i){THREE.Mesh.call(this,t,e),this.useVertexTexture=void 0!==i?i:!0,this.identityMatrix=new THREE.Matrix4,this.bones=[],this.boneMatrices=[];var n,r,o,a,s,l;if(this.geometry&&void 0!==this.geometry.bones){for(n=0;n<this.geometry.bones.length;n++)o=this.geometry.bones[n],a=o.pos,s=o.rotq,l=o.scl,r=this.addBone(),r.name=o.name,r.position.set(a[0],a[1],a[2]),r.quaternion.set(s[0],s[1],s[2],s[3]),r.useQuaternion=!0,void 0!==l?r.scale.set(l[0],l[1],l[2]):r.scale.set(1,1,1);for(n=0;n<this.bones.length;n++)o=this.geometry.bones[n],r=this.bones[n],-1===o.parent?this.add(r):this.bones[o.parent].add(r);var c=this.bones.length;if(this.useVertexTexture){var h;h=c>256?64:c>64?32:c>16?16:8,this.boneTextureWidth=h,this.boneTextureHeight=h,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1}else this.boneMatrices=new Float32Array(16*c);this.pose()}},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.addBone=function(t){return void 0===t&&(t=new THREE.Bone(this)),this.bones.push(t),t},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,i=this.children.length;i>e;e++){var n=this.children[e];n instanceof THREE.Bone?n.update(this.identityMatrix,!1):n.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[];for(var r=0,o=this.bones.length;o>r;r++){var a=new THREE.Matrix4;a.getInverse(this.bones[r].skinMatrix),this.boneInverses.push(a)}}for(var r=0,o=this.bones.length;o>r;r++)THREE.SkinnedMesh.offsetMatrix.multiplyMatrices(this.bones[r].skinMatrix,this.boneInverses[r]),THREE.SkinnedMesh.offsetMatrix.flattenToArrayOffset(this.boneMatrices,16*r);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)},THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);for(var t=0;t<this.geometry.skinIndices.length;t++){var e=this.geometry.skinWeights[t],i=1/e.lengthManhattan();1/0!==i?e.multiplyScalar(i):e.set(1)}},THREE.SkinnedMesh.prototype.clone=function(t){return void 0===t&&(t=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),THREE.Mesh.prototype.clone.call(this,t),t},THREE.SkinnedMesh.offsetMatrix=new THREE.Matrix4,THREE.MorphAnimMesh=function(t,e){THREE.Mesh.call(this,t,e),this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphAnimMesh.prototype.setFrameRange=function(t,e){this.startKeyframe=t,this.endKeyframe=e,this.length=this.endKeyframe-this.startKeyframe+1},THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},THREE.MorphAnimMesh.prototype.parseAnimations=function(){var t=this.geometry;t.animations||(t.animations={});for(var e,i=t.animations,n=/([a-z]+)(\d+)/,r=0,o=t.morphTargets.length;o>r;r++){var a=t.morphTargets[r],s=a.name.match(n);if(s&&s.length>1){var l=s[1],c=s[2];i[l]||(i[l]={start:1/0,end:-1/0});var h=i[l];r<h.start&&(h.start=r),r>h.end&&(h.end=r),e||(e=l)}}t.firstAnimation=e},THREE.MorphAnimMesh.prototype.setAnimationLabel=function(t,e,i){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[t]={start:e,end:i}},THREE.MorphAnimMesh.prototype.playAnimation=function(t,e){var i=this.geometry.animations[t];i?(this.setFrameRange(i.start,i.end),this.duration=1e3*((i.end-i.start)/e),this.time=0):console.warn("animation["+t+"] undefined")},THREE.MorphAnimMesh.prototype.updateAnimation=function(t){var e=this.duration/this.length;this.time+=this.direction*t,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var i=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/e),0,this.length-1);i!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[i]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=i);var n=this.time%e/e;this.directionBackwards&&(n=1-n),this.morphTargetInfluences[this.currentKeyframe]=n,this.morphTargetInfluences[this.lastKeyframe]=1-n},THREE.MorphAnimMesh.prototype.clone=function(t){return void 0===t&&(t=new THREE.MorphAnimMesh(this.geometry,this.material)),t.duration=this.duration,t.mirroredLoop=this.mirroredLoop,t.time=this.time,t.lastKeyframe=this.lastKeyframe,t.currentKeyframe=this.currentKeyframe,t.direction=this.direction,t.directionBackwards=this.directionBackwards,THREE.Mesh.prototype.clone.call(this,t),t},THREE.Ribbon=function(t,e){THREE.Object3D.call(this),this.geometry=t,this.material=e},THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype),THREE.Ribbon.prototype.clone=function(t){return void 0===t&&(t=new THREE.Ribbon(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=0;i<this.objects.length&&!(e<this.objects[i].distance);i++);this.objects.splice(i,0,{distance:e,object:t}),this.add(t)},THREE.LOD.prototype.getObjectForDistance=function(t){for(var e=1,i=this.objects.length;i>e&&!(t<this.objects[e].distance);e++);return this.objects[e-1].object},THREE.LOD.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i){if(this.objects.length>1){t.getPositionFromMatrix(i.matrixWorld),e.getPositionFromMatrix(this.matrixWorld);var n=t.distanceTo(e);this.objects[0].object.visible=!0;for(var r=1,o=this.objects.length;o>r&&n>=this.objects[r].distance;r++)this.objects[r-1].object.visible=!1,this.objects[r].object.visible=!0;for(;o>r;r++)this.objects[r].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(){},THREE.Sprite=function(t){THREE.Object3D.call(this),this.material=void 0!==t?t:new THREE.SpriteMaterial,this.rotation3d=this.rotation,this.rotation=0},THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation),this.quaternion.setFromEuler(this.rotation3d,this.eulerOrder),this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},THREE.Sprite.prototype.clone=function(t){return void 0===t&&(t=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Scene=function(){THREE.Object3D.call(this),this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.__addObject=function(t){if(t instanceof THREE.Light)-1===this.__lights.indexOf(t)&&this.__lights.push(t),t.target&&void 0===t.target.parent&&this.add(t.target);else if(!(t instanceof THREE.Camera||t instanceof THREE.Bone)&&-1===this.__objects.indexOf(t)){this.__objects.push(t),this.__objectsAdded.push(t);var e=this.__objectsRemoved.indexOf(t);-1!==e&&this.__objectsRemoved.splice(e,1)}for(var i=0;i<t.children.length;i++)this.__addObject(t.children[i])},THREE.Scene.prototype.__removeObject=function(t){if(t instanceof THREE.Light){var e=this.__lights.indexOf(t);-1!==e&&this.__lights.splice(e,1)}else if(!(t instanceof THREE.Camera)){var e=this.__objects.indexOf(t);if(-1!==e){this.__objects.splice(e,1),this.__objectsRemoved.push(t);var i=this.__objectsAdded.indexOf(t);-1!==i&&this.__objectsAdded.splice(i,1)}}for(var n=0;n<t.children.length;n++)this.__removeObject(t.children[n])},THREE.Fog=function(t,e,i){this.name="",this.color=new THREE.Color(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(t,e){this.name="",this.color=new THREE.Color(t),this.density=void 0!==e?e:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.CanvasRenderer=function(t){function e(t){_!==t&&(x.globalAlpha=t,_=t)}function i(t){w!==t&&(t===THREE.NormalBlending?x.globalCompositeOperation="source-over":t===THREE.AdditiveBlending?x.globalCompositeOperation="lighter":t===THREE.SubtractiveBlending&&(x.globalCompositeOperation="darker"),w=t)}function n(t){M!==t&&(x.lineWidth=t,M=t)}function r(t){S!==t&&(x.lineCap=t,S=t)
}function o(t){C!==t&&(x.lineJoin=t,C=t)}function a(t){R!==t&&(x.strokeStyle=t,R=t)}function s(t){H!==t&&(x.fillStyle=t,H=t)}function l(t,e){(A!==t||D!==e)&&(x.setLineDash([t,e]),A=t,D=e)}console.log("THREE.CanvasRenderer",THREE.REVISION);var c=THREE.Math.smoothstep;t=t||{};var h=this,u,f,d,p=new THREE.Projector,m=void 0!==t.canvas?t.canvas:document.createElement("canvas"),g,v,E,y,x=m.getContext("2d"),T=new THREE.Color(0),b=0,_=1,w=0,R=null,H=null,M=null,S=null,C=null,A=null,D=0,P,k,L,N,F=new THREE.RenderableVertex,I=new THREE.RenderableVertex,z,O,U,B,V,W,j,G,X,q,Y,K,Q=new THREE.Color,Z=new THREE.Color,J=new THREE.Color,te=new THREE.Color,ee=new THREE.Color,ie=new THREE.Color,ne=new THREE.Color,re=new THREE.Color,oe={},ae={},se,le,ce,he,ue,fe,de,pe,me,ge,ve=new THREE.Box2,Ee=new THREE.Box2,ye=new THREE.Box2,xe=new THREE.Color,Te=new THREE.Color,be=new THREE.Color,_e=new THREE.Vector3,we,Re,He,Me,Se,Ce,Ae=16;we=document.createElement("canvas"),we.width=we.height=2,Re=we.getContext("2d"),Re.fillStyle="rgba(0,0,0,1)",Re.fillRect(0,0,2,2),He=Re.getImageData(0,0,2,2),Me=He.data,Se=document.createElement("canvas"),Se.width=Se.height=Ae,Ce=Se.getContext("2d"),Ce.translate(-Ae/2,-Ae/2),Ce.scale(Ae,Ae),Ae--,void 0===x.setLineDash&&(x.setLineDash=void 0!==x.mozDash?function(t){x.mozDash=null!==t[0]?t:null}:function(){}),this.domElement=m,this.devicePixelRatio=void 0!==t.devicePixelRatio?t.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setSize=function(t,e,i){g=t*this.devicePixelRatio,v=e*this.devicePixelRatio,E=Math.floor(g/2),y=Math.floor(v/2),m.width=g,m.height=v,1!==this.devicePixelRatio&&i!==!1&&(m.style.width=t+"px",m.style.height=e+"px"),ve.set(new THREE.Vector2(-E,-y),new THREE.Vector2(E,y)),Ee.set(new THREE.Vector2(-E,-y),new THREE.Vector2(E,y)),_=1,w=0,R=null,H=null,M=null,S=null,C=null},this.setClearColor=function(t,e){T.set(t),b=void 0!==e?e:1,Ee.set(new THREE.Vector2(-E,-y),new THREE.Vector2(E,y))},this.setClearColorHex=function(t,e){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(t,e)},this.getMaxAnisotropy=function(){return 0},this.clear=function(){x.setTransform(1,0,0,-1,E,y),Ee.empty()===!1&&(Ee.intersect(ve),Ee.expandByScalar(2),1>b&&x.clearRect(0|Ee.min.x,0|Ee.min.y,Ee.max.x-Ee.min.x|0,Ee.max.y-Ee.min.y|0),b>0&&(i(THREE.NormalBlending),e(1),s("rgba("+Math.floor(255*T.r)+","+Math.floor(255*T.g)+","+Math.floor(255*T.b)+","+b+")"),x.fillRect(0|Ee.min.x,0|Ee.min.y,Ee.max.x-Ee.min.x|0,Ee.max.y-Ee.min.y|0)),Ee.makeEmpty())},this.render=function(t,m){function g(){xe.setRGB(0,0,0),Te.setRGB(0,0,0),be.setRGB(0,0,0);for(var t=0,e=d.length;e>t;t++){var i=d[t],n=i.color;i instanceof THREE.AmbientLight?xe.add(n):i instanceof THREE.DirectionalLight?Te.add(n):i instanceof THREE.PointLight&&be.add(n)}}function v(t,e,i){for(var n=0,r=d.length;r>n;n++){var o=d[n];if(re.copy(o.color),o instanceof THREE.DirectionalLight){var a=_e.getPositionFromMatrix(o.matrixWorld).normalize(),s=e.dot(a);if(0>=s)continue;s*=o.intensity,i.add(re.multiplyScalar(s))}else if(o instanceof THREE.PointLight){var a=_e.getPositionFromMatrix(o.matrixWorld),s=e.dot(_e.subVectors(a,t).normalize());if(0>=s)continue;if(s*=0==o.distance?1:1-Math.min(t.distanceTo(a)/o.distance,1),0==s)continue;s*=o.intensity,i.add(re.multiplyScalar(s))}}}function T(t,n,r){e(r.opacity),i(r.blending);var o,l,c,h,u,f,d;if(r instanceof THREE.ParticleBasicMaterial)if(null===r.map){if(c=n.object.scale.x,h=n.object.scale.y,c*=n.scale.x*E,h*=n.scale.y*y,ye.min.set(t.x-c,t.y-h),ye.max.set(t.x+c,t.y+h),ve.isIntersectionBox(ye)===!1)return void ye.makeEmpty();s(r.color.getStyle()),x.save(),x.translate(t.x,t.y),x.rotate(-n.rotation),x.scale(c,h),x.fillRect(-1,-1,2,2),x.restore()}else{if(u=r.map.image,f=u.width>>1,d=u.height>>1,c=n.scale.x*E,h=n.scale.y*y,o=c*f,l=h*d,ye.min.set(t.x-o,t.y-l),ye.max.set(t.x+o,t.y+l),ve.isIntersectionBox(ye)===!1)return void ye.makeEmpty();x.save(),x.translate(t.x,t.y),x.rotate(-n.rotation),x.scale(c,-h),x.translate(-f,-d),x.drawImage(u,0,0),x.restore()}else if(r instanceof THREE.ParticleCanvasMaterial){if(o=n.scale.x*E,l=n.scale.y*y,ye.min.set(t.x-o,t.y-l),ye.max.set(t.x+o,t.y+l),ve.isIntersectionBox(ye)===!1)return void ye.makeEmpty();a(r.color.getStyle()),s(r.color.getStyle()),x.save(),x.translate(t.x,t.y),x.rotate(-n.rotation),x.scale(o,l),r.program(x),x.restore()}}function b(t,s,c,h){if(e(h.opacity),i(h.blending),x.beginPath(),x.moveTo(t.positionScreen.x,t.positionScreen.y),x.lineTo(s.positionScreen.x,s.positionScreen.y),h instanceof THREE.LineBasicMaterial){if(n(h.linewidth),r(h.linecap),o(h.linejoin),h.vertexColors!==THREE.VertexColors)a(h.color.getStyle());else{var u=c.vertexColors[0].getStyle(),f=c.vertexColors[1].getStyle();if(u===f)a(u);else{try{var d=x.createLinearGradient(t.positionScreen.x,t.positionScreen.y,s.positionScreen.x,s.positionScreen.y);d.addColorStop(0,u),d.addColorStop(1,f)}catch(p){d=u}a(d)}}x.stroke(),ye.expandByScalar(2*h.linewidth)}else h instanceof THREE.LineDashedMaterial&&(n(h.linewidth),r(h.linecap),o(h.linejoin),a(h.color.getStyle()),l(h.dashSize,h.gapSize),x.stroke(),ye.expandByScalar(2*h.linewidth),l(null,null))}function _(t,n,r,o,a,s,l,u){if(h.info.render.vertices+=3,h.info.render.faces++,e(u.opacity),i(u.blending),z=t.positionScreen.x,O=t.positionScreen.y,U=n.positionScreen.x,B=n.positionScreen.y,V=r.positionScreen.x,W=r.positionScreen.y,R(z,O,U,B,V,W),(u instanceof THREE.MeshLambertMaterial||u instanceof THREE.MeshPhongMaterial)&&null===u.map)ie.copy(u.color),ne.copy(u.emissive),u.vertexColors===THREE.FaceColors&&ie.multiply(l.color),u.wireframe===!1&&u.shading==THREE.SmoothShading&&3==l.vertexNormalsLength?(Z.copy(xe),J.copy(xe),te.copy(xe),v(l.v1.positionWorld,l.vertexNormalsModel[0],Z),v(l.v2.positionWorld,l.vertexNormalsModel[1],J),v(l.v3.positionWorld,l.vertexNormalsModel[2],te),Z.multiply(ie).add(ne),J.multiply(ie).add(ne),te.multiply(ie).add(ne),ee.addColors(J,te).multiplyScalar(.5),ce=D(Z,J,te,ee),A(z,O,U,B,V,W,0,0,1,0,0,1,ce)):(Q.copy(xe),v(l.centroidModel,l.normalModel,Q),Q.multiply(ie).add(ne),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q));else if(u instanceof THREE.MeshBasicMaterial||u instanceof THREE.MeshLambertMaterial||u instanceof THREE.MeshPhongMaterial)null!==u.map?u.map.mapping instanceof THREE.UVMapping&&(he=l.uvs[0],C(z,O,U,B,V,W,he[o].x,he[o].y,he[a].x,he[a].y,he[s].x,he[s].y,u.map)):null!==u.envMap?u.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(_e.copy(l.vertexNormalsModelView[o]),ue=.5*_e.x+.5,fe=.5*_e.y+.5,_e.copy(l.vertexNormalsModelView[a]),de=.5*_e.x+.5,pe=.5*_e.y+.5,_e.copy(l.vertexNormalsModelView[s]),me=.5*_e.x+.5,ge=.5*_e.y+.5,C(z,O,U,B,V,W,ue,fe,de,pe,me,ge,u.envMap)):(Q.copy(u.color),u.vertexColors===THREE.FaceColors&&Q.multiply(l.color),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q));else if(u instanceof THREE.MeshDepthMaterial)se=m.near,le=m.far,Z.r=Z.g=Z.b=1-c(t.positionScreen.z*t.positionScreen.w,se,le),J.r=J.g=J.b=1-c(n.positionScreen.z*n.positionScreen.w,se,le),te.r=te.g=te.b=1-c(r.positionScreen.z*r.positionScreen.w,se,le),ee.addColors(J,te).multiplyScalar(.5),ce=D(Z,J,te,ee),A(z,O,U,B,V,W,0,0,1,0,0,1,ce);else if(u instanceof THREE.MeshNormalMaterial){var f;u.shading==THREE.FlatShading?(f=l.normalModelView,Q.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q)):u.shading==THREE.SmoothShading&&(f=l.vertexNormalsModelView[o],Z.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),f=l.vertexNormalsModelView[a],J.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),f=l.vertexNormalsModelView[s],te.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),ee.addColors(J,te).multiplyScalar(.5),ce=D(Z,J,te,ee),A(z,O,U,B,V,W,0,0,1,0,0,1,ce))}}function w(t,n,r,o,a,s,l,u){if(h.info.render.vertices+=4,h.info.render.faces++,e(u.opacity),i(u.blending),void 0!==u.map&&null!==u.map||void 0!==u.envMap&&null!==u.envMap)return _(t,n,o,0,1,3,l,u),void _(a,r,s,1,2,3,l,u);if(z=t.positionScreen.x,O=t.positionScreen.y,U=n.positionScreen.x,B=n.positionScreen.y,V=r.positionScreen.x,W=r.positionScreen.y,j=o.positionScreen.x,G=o.positionScreen.y,X=a.positionScreen.x,q=a.positionScreen.y,Y=s.positionScreen.x,K=s.positionScreen.y,u instanceof THREE.MeshLambertMaterial||u instanceof THREE.MeshPhongMaterial)ie.copy(u.color),ne.copy(u.emissive),u.vertexColors===THREE.FaceColors&&ie.multiply(l.color),u.wireframe===!1&&u.shading==THREE.SmoothShading&&4==l.vertexNormalsLength?(Z.copy(xe),J.copy(xe),te.copy(xe),ee.copy(xe),v(l.v1.positionWorld,l.vertexNormalsModel[0],Z),v(l.v2.positionWorld,l.vertexNormalsModel[1],J),v(l.v4.positionWorld,l.vertexNormalsModel[3],te),v(l.v3.positionWorld,l.vertexNormalsModel[2],ee),Z.multiply(ie).add(ne),J.multiply(ie).add(ne),te.multiply(ie).add(ne),ee.multiply(ie).add(ne),ce=D(Z,J,te,ee),R(z,O,U,B,j,G),A(z,O,U,B,j,G,0,0,1,0,0,1,ce),R(X,q,V,W,Y,K),A(X,q,V,W,Y,K,1,0,1,1,0,1,ce)):(Q.copy(xe),v(l.centroidModel,l.normalModel,Q),Q.multiply(ie).add(ne),H(z,O,U,B,V,W,j,G),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q));else if(u instanceof THREE.MeshBasicMaterial)Q.copy(u.color),u.vertexColors===THREE.FaceColors&&Q.multiply(l.color),H(z,O,U,B,V,W,j,G),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q);else if(u instanceof THREE.MeshNormalMaterial){var f;u.shading==THREE.FlatShading?(f=l.normalModelView,Q.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),H(z,O,U,B,V,W,j,G),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q)):u.shading==THREE.SmoothShading&&(f=l.vertexNormalsModelView[0],Z.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),f=l.vertexNormalsModelView[1],J.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),f=l.vertexNormalsModelView[3],te.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),f=l.vertexNormalsModelView[2],ee.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),ce=D(Z,J,te,ee),R(z,O,U,B,j,G),A(z,O,U,B,j,G,0,0,1,0,0,1,ce),R(X,q,V,W,Y,K),A(X,q,V,W,Y,K,1,0,1,1,0,1,ce))}else u instanceof THREE.MeshDepthMaterial&&(se=m.near,le=m.far,Z.r=Z.g=Z.b=1-c(t.positionScreen.z*t.positionScreen.w,se,le),J.r=J.g=J.b=1-c(n.positionScreen.z*n.positionScreen.w,se,le),te.r=te.g=te.b=1-c(o.positionScreen.z*o.positionScreen.w,se,le),ee.r=ee.g=ee.b=1-c(r.positionScreen.z*r.positionScreen.w,se,le),ce=D(Z,J,te,ee),R(z,O,U,B,j,G),A(z,O,U,B,j,G,0,0,1,0,0,1,ce),R(X,q,V,W,Y,K),A(X,q,V,W,Y,K,1,0,1,1,0,1,ce))}function R(t,e,i,n,r,o){x.beginPath(),x.moveTo(t,e),x.lineTo(i,n),x.lineTo(r,o),x.closePath()}function H(t,e,i,n,r,o,a,s){x.beginPath(),x.moveTo(t,e),x.lineTo(i,n),x.lineTo(r,o),x.lineTo(a,s),x.closePath()}function M(t,e,i,s){n(e),r(i),o(s),a(t.getStyle()),x.stroke(),ye.expandByScalar(2*e)}function S(t){s(t.getStyle()),x.fill()}function C(t,e,i,n,r,o,a,l,c,h,u,f,d){if(!(d instanceof THREE.DataTexture||void 0===d.image||0==d.image.width)){if(d.needsUpdate===!0){var p=d.wrapS==THREE.RepeatWrapping,m=d.wrapT==THREE.RepeatWrapping;oe[d.id]=x.createPattern(d.image,p===!0&&m===!0?"repeat":p===!0&&m===!1?"repeat-x":p===!1&&m===!0?"repeat-y":"no-repeat"),d.needsUpdate=!1}s(void 0===oe[d.id]?"rgba(0,0,0,1)":oe[d.id]);var g,v,E,y,T,b,_,w,R=d.offset.x/d.repeat.x,H=d.offset.y/d.repeat.y,M=d.image.width*d.repeat.x,C=d.image.height*d.repeat.y;if(a=(a+R)*M,l=(1-l+H)*C,c=(c+R)*M,h=(1-h+H)*C,u=(u+R)*M,f=(1-f+H)*C,i-=t,n-=e,r-=t,o-=e,c-=a,h-=l,u-=a,f-=l,_=c*f-u*h,0===_){if(void 0===ae[d.id]){var A=document.createElement("canvas");A.width=d.image.width,A.height=d.image.height;var D=A.getContext("2d");D.drawImage(d.image,0,0),ae[d.id]=D.getImageData(0,0,d.image.width,d.image.height).data}var P=ae[d.id],k=4*(Math.floor(a)+Math.floor(l)*d.image.width);return Q.setRGB(P[k]/255,P[k+1]/255,P[k+2]/255),void S(Q)}w=1/_,g=(f*i-h*r)*w,v=(f*n-h*o)*w,E=(c*r-u*i)*w,y=(c*o-u*n)*w,T=t-g*a-E*l,b=e-v*a-y*l,x.save(),x.transform(g,v,E,y,T,b),x.fill(),x.restore()}}function A(t,e,i,n,r,o,a,s,l,c,h,u,f){var d,p,m,g,v,E,y,T,b=f.width-1,_=f.height-1;a*=b,s*=_,l*=b,c*=_,h*=b,u*=_,i-=t,n-=e,r-=t,o-=e,l-=a,c-=s,h-=a,u-=s,y=l*u-h*c,T=1/y,d=(u*i-c*r)*T,p=(u*n-c*o)*T,m=(l*r-h*i)*T,g=(l*o-h*n)*T,v=t-d*a-m*s,E=e-p*a-g*s,x.save(),x.transform(d,p,m,g,v,E),x.clip(),x.drawImage(f,0,0),x.restore()}function D(t,e,i,n){return Me[0]=255*t.r|0,Me[1]=255*t.g|0,Me[2]=255*t.b|0,Me[4]=255*e.r|0,Me[5]=255*e.g|0,Me[6]=255*e.b|0,Me[8]=255*i.r|0,Me[9]=255*i.g|0,Me[10]=255*i.b|0,Me[12]=255*n.r|0,Me[13]=255*n.g|0,Me[14]=255*n.b|0,Re.putImageData(He,0,0),Ce.drawImage(we,0,0),Se}function Ae(t,e){var i=e.x-t.x,n=e.y-t.y,r=i*i+n*n,o;0!==r&&(o=1/Math.sqrt(r),i*=o,n*=o,e.x+=i,e.y+=n,t.x-=i,t.y-=n)}if(m instanceof THREE.Camera==!1)return void console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");this.autoClear===!0&&this.clear(),x.setTransform(1,0,0,-1,E,y),h.info.render.vertices=0,h.info.render.faces=0,u=p.projectScene(t,m,this.sortObjects,this.sortElements),f=u.elements,d=u.lights,g();for(var De=0,Pe=f.length;Pe>De;De++){var ke=f[De],Le=ke.material;if(void 0!==Le&&Le.visible!==!1){if(ye.makeEmpty(),ke instanceof THREE.RenderableParticle)P=ke,P.x*=E,P.y*=y,T(P,ke,Le);else if(ke instanceof THREE.RenderableLine)P=ke.v1,k=ke.v2,P.positionScreen.x*=E,P.positionScreen.y*=y,k.positionScreen.x*=E,k.positionScreen.y*=y,ye.setFromPoints([P.positionScreen,k.positionScreen]),ve.isIntersectionBox(ye)===!0&&b(P,k,ke,Le);else if(ke instanceof THREE.RenderableFace3){if(P=ke.v1,k=ke.v2,L=ke.v3,P.positionScreen.z<-1||P.positionScreen.z>1)continue;if(k.positionScreen.z<-1||k.positionScreen.z>1)continue;if(L.positionScreen.z<-1||L.positionScreen.z>1)continue;P.positionScreen.x*=E,P.positionScreen.y*=y,k.positionScreen.x*=E,k.positionScreen.y*=y,L.positionScreen.x*=E,L.positionScreen.y*=y,Le.overdraw===!0&&(Ae(P.positionScreen,k.positionScreen),Ae(k.positionScreen,L.positionScreen),Ae(L.positionScreen,P.positionScreen)),ye.setFromPoints([P.positionScreen,k.positionScreen,L.positionScreen]),ve.isIntersectionBox(ye)===!0&&_(P,k,L,0,1,2,ke,Le)}else if(ke instanceof THREE.RenderableFace4){if(P=ke.v1,k=ke.v2,L=ke.v3,N=ke.v4,P.positionScreen.z<-1||P.positionScreen.z>1)continue;if(k.positionScreen.z<-1||k.positionScreen.z>1)continue;if(L.positionScreen.z<-1||L.positionScreen.z>1)continue;if(N.positionScreen.z<-1||N.positionScreen.z>1)continue;P.positionScreen.x*=E,P.positionScreen.y*=y,k.positionScreen.x*=E,k.positionScreen.y*=y,L.positionScreen.x*=E,L.positionScreen.y*=y,N.positionScreen.x*=E,N.positionScreen.y*=y,F.positionScreen.copy(k.positionScreen),I.positionScreen.copy(N.positionScreen),Le.overdraw===!0&&(Ae(P.positionScreen,k.positionScreen),Ae(k.positionScreen,N.positionScreen),Ae(N.positionScreen,P.positionScreen),Ae(L.positionScreen,F.positionScreen),Ae(L.positionScreen,I.positionScreen)),ye.setFromPoints([P.positionScreen,k.positionScreen,L.positionScreen,N.positionScreen]),ve.isIntersectionBox(ye)===!0&&w(P,k,L,N,F,I,ke,Le)}Ee.union(ye)}}x.setTransform(1,0,0,1,0,0)}},THREE.ShaderChunk={fog_pars_fragment:["#ifdef USE_FOG","uniform vec3 fogColor;","#ifdef FOG_EXP2","uniform float fogDensity;","#else","uniform float fogNear;","uniform float fogFar;","#endif","#endif"].join("\n"),fog_fragment:["#ifdef USE_FOG","float depth = gl_FragCoord.z / gl_FragCoord.w;","#ifdef FOG_EXP2","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","#else","float fogFactor = smoothstep( fogNear, fogFar, depth );","#endif","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","#endif"].join("\n"),envmap_pars_fragment:["#ifdef USE_ENVMAP","uniform float reflectivity;","uniform samplerCube envMap;","uniform float flipEnvMap;","uniform int combine;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","uniform bool useRefract;","uniform float refractionRatio;","#else","varying vec3 vReflect;","#endif","#endif"].join("\n"),envmap_fragment:["#ifdef USE_ENVMAP","vec3 reflectVec;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","reflectVec = refract( cameraToVertex, normal, refractionRatio );","} else { ","reflectVec = reflect( cameraToVertex, normal );","}","#else","reflectVec = vReflect;","#endif","#ifdef DOUBLE_SIDED","float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );","vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#else","vec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#endif","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","if ( combine == 1 ) {","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );","} else if ( combine == 2 ) {","gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;","} else {","gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );","}","#endif"].join("\n"),envmap_pars_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","varying vec3 vReflect;","uniform float refractionRatio;","uniform bool useRefract;","#endif"].join("\n"),worldpos_vertex:["#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )","#ifdef USE_SKINNING","vec4 worldPosition = modelMatrix * skinned;","#endif","#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );","#endif","#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","#endif","#endif"].join("\n"),envmap_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;","worldNormal = normalize( worldNormal );","vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, worldNormal, refractionRatio );","} else {","vReflect = reflect( cameraToVertex, worldNormal );","}","#endif"].join("\n"),map_particle_pars_fragment:["#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_particle_fragment:["#ifdef USE_MAP","gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );","#endif"].join("\n"),map_pars_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","uniform vec4 offsetRepeat;","#endif"].join("\n"),map_pars_fragment:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","#endif","#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","#endif"].join("\n"),map_fragment:["#ifdef USE_MAP","vec4 texelColor = texture2D( map, vUv );","#ifdef GAMMA_INPUT","texelColor.xyz *= texelColor.xyz;","#endif","gl_FragColor = gl_FragColor * texelColor;","#endif"].join("\n"),lightmap_pars_fragment:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","uniform sampler2D lightMap;","#endif"].join("\n"),lightmap_pars_vertex:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","#endif"].join("\n"),lightmap_fragment:["#ifdef USE_LIGHTMAP","gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );","#endif"].join("\n"),lightmap_vertex:["#ifdef USE_LIGHTMAP","vUv2 = uv2;","#endif"].join("\n"),bumpmap_pars_fragment:["#ifdef USE_BUMPMAP","uniform sampler2D bumpMap;","uniform float bumpScale;","vec2 dHdxy_fwd() {","vec2 dSTdx = dFdx( vUv );","vec2 dSTdy = dFdy( vUv );","float Hll = bumpScale * texture2D( bumpMap, vUv ).x;","float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","return vec2( dBx, dBy );","}","vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","vec3 vSigmaX = dFdx( surf_pos );","vec3 vSigmaY = dFdy( surf_pos );","vec3 vN = surf_norm;","vec3 R1 = cross( vSigmaY, vN );","vec3 R2 = cross( vN, vSigmaX );","float fDet = dot( vSigmaX, R1 );","vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","return normalize( abs( fDet ) * surf_norm - vGrad );","}","#endif"].join("\n"),normalmap_pars_fragment:["#ifdef USE_NORMALMAP","uniform sampler2D normalMap;","uniform vec2 normalScale;","vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {","vec3 q0 = dFdx( eye_pos.xyz );","vec3 q1 = dFdy( eye_pos.xyz );","vec2 st0 = dFdx( vUv.st );","vec2 st1 = dFdy( vUv.st );","vec3 S = normalize(  q0 * st1.t - q1 * st0.t );","vec3 T = normalize( -q0 * st1.s + q1 * st0.s );","vec3 N = normalize( surf_norm );","vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;","mapN.xy = normalScale * mapN.xy;","mat3 tsn = mat3( S, T, N );","return normalize( tsn * mapN );","}","#endif"].join("\n"),specularmap_pars_fragment:["#ifdef USE_SPECULARMAP","uniform sampler2D specularMap;","#endif"].join("\n"),specularmap_fragment:["float specularStrength;","#ifdef USE_SPECULARMAP","vec4 texelSpecular = texture2D( specularMap, vUv );","specularStrength = texelSpecular.r;","#else","specularStrength = 1.0;","#endif"].join("\n"),lights_lambert_pars_vertex:["uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif"].join("\n"),lights_lambert_vertex:["vLightFront = vec3( 0.0 );","#ifdef DOUBLE_SIDED","vLightBack = vec3( 0.0 );","#endif","transformedNormal = normalize( transformedNormal );","#if MAX_DIR_LIGHTS > 0","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, dirVector );","vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += directionalLightColor[ i ] * directionalLightWeighting;","#ifdef DOUBLE_SIDED","vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;","#endif","}","#endif","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;","#ifdef DOUBLE_SIDED","vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;","#ifdef DOUBLE_SIDED","vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_HEMI_LIGHTS > 0","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;","vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","#ifdef DOUBLE_SIDED","vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );","#endif","}","#endif","vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;","#ifdef DOUBLE_SIDED","vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;","#endif"].join("\n"),lights_phong_pars_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif"].join("\n"),lights_phong_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","vPointLight[ i ] = vec4( lVector, lDistance );","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","vSpotLight[ i ] = vec4( lVector, lDistance );","}","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","vWorldPosition = worldPosition.xyz;","#endif"].join("\n"),lights_phong_pars_fragment:["uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#else","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#else","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vViewPosition;","varying vec3 vNormal;"].join("\n"),lights_phong_fragment:["vec3 normal = normalize( vNormal );","vec3 viewPosition = normalize( vViewPosition );","#ifdef DOUBLE_SIDED","normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );","#endif","#ifdef USE_NORMALMAP","normal = perturbNormal2Arb( -vViewPosition, normal );","#elif defined( USE_BUMPMAP )","normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse  = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vPointLight[ i ].xyz );","float lDistance = vPointLight[ i ].w;","#endif","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dotProduct, 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dotProduct, 0.0 );","#endif","pointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;","vec3 pointHalfVector = normalize( lVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;","#else","pointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse  = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vSpotLight[ i ].xyz );","float lDistance = vSpotLight[ i ].w;","#endif","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dotProduct, 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dotProduct, 0.0 );","#endif","spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;","vec3 spotHalfVector = normalize( lVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;","#else","spotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse  = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, dirVector );","#ifdef WRAP_AROUND","float dirDiffuseWeightFull = max( dotProduct, 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dotProduct, 0.0 );","#endif","dirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += diffuse * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;","#endif"].join("\n"),color_pars_fragment:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_fragment:["#ifdef USE_COLOR","gl_FragColor = gl_FragColor * vec4( vColor, opacity );","#endif"].join("\n"),color_pars_vertex:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_vertex:["#ifdef USE_COLOR","#ifdef GAMMA_INPUT","vColor = color * color;","#else","vColor = color;","#endif","#endif"].join("\n"),skinning_pars_vertex:["#ifdef USE_SKINNING","#ifdef BONE_TEXTURE","uniform sampler2D boneTexture;","mat4 getBoneMatrix( const in float i ) {","float j = i * 4.0;","float x = mod( j, N_BONE_PIXEL_X );","float y = floor( j / N_BONE_PIXEL_X );","const float dx = 1.0 / N_BONE_PIXEL_X;","const float dy = 1.0 / N_BONE_PIXEL_Y;","y = dy * ( y + 0.5 );","vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );","vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );","vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );","vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );","mat4 bone = mat4( v1, v2, v3, v4 );","return bone;","}","#else","uniform mat4 boneGlobalMatrices[ MAX_BONES ];","mat4 getBoneMatrix( const in float i ) {","mat4 bone = boneGlobalMatrices[ int(i) ];","return bone;","}","#endif","#endif"].join("\n"),skinbase_vertex:["#ifdef USE_SKINNING","mat4 boneMatX = getBoneMatrix( skinIndex.x );","mat4 boneMatY = getBoneMatrix( skinIndex.y );","#endif"].join("\n"),skinning_vertex:["#ifdef USE_SKINNING","#ifdef USE_MORPHTARGETS","vec4 skinVertex = vec4( morphed, 1.0 );","#else","vec4 skinVertex = vec4( position, 1.0 );","#endif","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","#endif"].join("\n"),morphtarget_pars_vertex:["#ifdef USE_MORPHTARGETS","#ifndef USE_MORPHNORMALS","uniform float morphTargetInfluences[ 8 ];","#else","uniform float morphTargetInfluences[ 4 ];","#endif","#endif"].join("\n"),morphtarget_vertex:["#ifdef USE_MORPHTARGETS","vec3 morphed = vec3( 0.0 );","morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];","morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];","morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];","morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];","#ifndef USE_MORPHNORMALS","morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];","morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];","morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];","morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];","#endif","morphed += position;","#endif"].join("\n"),default_vertex:["vec4 mvPosition;","#ifdef USE_SKINNING","mvPosition = modelViewMatrix * skinned;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( morphed, 1.0 );","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;"].join("\n"),morphnormal_vertex:["#ifdef USE_MORPHNORMALS","vec3 morphedNormal = vec3( 0.0 );","morphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];","morphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];","morphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];","morphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];","morphedNormal += normal;","#endif"].join("\n"),skinnormal_vertex:["#ifdef USE_SKINNING","mat4 skinMatrix = skinWeight.x * boneMatX;","skinMatrix 	+= skinWeight.y * boneMatY;","#ifdef USE_MORPHNORMALS","vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );","#else","vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );","#endif","#endif"].join("\n"),defaultnormal_vertex:["vec3 objectNormal;","#ifdef USE_SKINNING","objectNormal = skinnedNormal.xyz;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )","objectNormal = morphedNormal;","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )","objectNormal = normal;","#endif","#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","vec3 transformedNormal = normalMatrix * objectNormal;"].join("\n"),shadowmap_pars_fragment:["#ifdef USE_SHADOWMAP","uniform sampler2D shadowMap[ MAX_SHADOWS ];","uniform vec2 shadowMapSize[ MAX_SHADOWS ];","uniform float shadowDarkness[ MAX_SHADOWS ];","uniform float shadowBias[ MAX_SHADOWS ];","varying vec4 vShadowCoord[ MAX_SHADOWS ];","float unpackDepth( const in vec4 rgba_depth ) {","const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );","float depth = dot( rgba_depth, bit_shift );","return depth;","}","#endif"].join("\n"),shadowmap_fragment:["#ifdef USE_SHADOWMAP","#ifdef SHADOWMAP_DEBUG","vec3 frustumColors[3];","frustumColors[0] = vec3( 1.0, 0.5, 0.0 );","frustumColors[1] = vec3( 0.0, 1.0, 0.8 );","frustumColors[2] = vec3( 0.0, 0.5, 1.0 );","#endif","#ifdef SHADOWMAP_CASCADE","int inFrustumCount = 0;","#endif","float fDepth;","vec3 shadowColor = vec3( 1.0 );","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;","bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );","bool inFrustum = all( inFrustumVec );","#ifdef SHADOWMAP_CASCADE","inFrustumCount += int( inFrustum );","bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );","#else","bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );","#endif","bool frustumTest = all( frustumTestVec );","if ( frustumTest ) {","shadowCoord.z += shadowBias[ i ];","#if defined( SHADOWMAP_TYPE_PCF )","float shadow = 0.0;","const float shadowDelta = 1.0 / 9.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.25 * xPixelOffset;","float dy0 = -1.25 * yPixelOffset;","float dx1 = 1.25 * xPixelOffset;","float dy1 = 1.25 * yPixelOffset;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#elif defined( SHADOWMAP_TYPE_PCF_SOFT )","float shadow = 0.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.0 * xPixelOffset;","float dy0 = -1.0 * yPixelOffset;","float dx1 = 1.0 * xPixelOffset;","float dy1 = 1.0 * yPixelOffset;","mat3 shadowKernel;","mat3 depthKernel;","depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","vec3 shadowZ = vec3( shadowCoord.z );","shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));","shadowKernel[0] *= vec3(0.25);","shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));","shadowKernel[1] *= vec3(0.25);","shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));","shadowKernel[2] *= vec3(0.25);","vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );","shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );","shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );","vec4 shadowValues;","shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );","shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );","shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );","shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );","shadow = dot( shadowValues, vec4( 1.0 ) );","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#else","vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );","float fDepth = unpackDepth( rgbaDepth );","if ( fDepth < shadowCoord.z )","shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );","#endif","}","#ifdef SHADOWMAP_DEBUG","#ifdef SHADOWMAP_CASCADE","if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];","#else","if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];","#endif","#endif","}","#ifdef GAMMA_OUTPUT","shadowColor *= shadowColor;","#endif","gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;","#endif"].join("\n"),shadowmap_pars_vertex:["#ifdef USE_SHADOWMAP","varying vec4 vShadowCoord[ MAX_SHADOWS ];","uniform mat4 shadowMatrix[ MAX_SHADOWS ];","#endif"].join("\n"),shadowmap_vertex:["#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif"].join("\n"),alphatest_fragment:["#ifdef ALPHATEST","if ( gl_FragColor.a < ALPHATEST ) discard;","#endif"].join("\n"),linear_to_gamma_fragment:["#ifdef GAMMA_OUTPUT","gl_FragColor.xyz = sqrt( gl_FragColor.xyz );","#endif"].join("\n")},THREE.UniformsUtils={merge:function(t){var e,i,n,r={};
for(e=0;e<t.length;e++){n=this.clone(t[e]);for(i in n)r[i]=n[i]}return r},clone:function(t){var e,i,n,r,o={};for(e in t){o[e]={};for(i in t[e])r=t[e][i],o[e][i]=r instanceof THREE.Color||r instanceof THREE.Vector2||r instanceof THREE.Vector3||r instanceof THREE.Vector4||r instanceof THREE.Matrix4||r instanceof THREE.Texture?r.clone():r instanceof Array?r.slice():r}return o}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED","if ( gl_FrontFacing )","gl_FragColor.xyz *= vLightFront;","else","gl_FragColor.xyz *= vLightBack;","#else","gl_FragColor.xyz *= vLightFront;","#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#ifdef USE_SIZEATTENUATION","gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","#else","gl_PointSize = size;","#endif","gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {","gl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {","if ( mod( vLineDistance, totalSize ) > dashSize ) {","discard;","}","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;","void main() {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float color = 1.0 - smoothstep( mNear, mFar, depth );","gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {","vNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;","void main() {","gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );","}"].join("\n")},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:.98},uReflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;","uniform vec3 uDiffuseColor;","uniform vec3 uSpecularColor;","uniform float uShininess;","uniform float uOpacity;","uniform bool enableDiffuse;","uniform bool enableSpecular;","uniform bool enableAO;","uniform bool enableReflection;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tAO;","uniform samplerCube tCube;","uniform vec2 uNormalScale;","uniform bool useRefract;","uniform float uRefractionRatio;","uniform float uReflectivity;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {","gl_FragColor = vec4( vec3( 1.0 ), uOpacity );","vec3 specularTex = vec3( 1.0 );","vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( enableDiffuse ) {","#ifdef GAMMA_INPUT","vec4 texelColor = texture2D( tDiffuse, vUv );","texelColor.xyz *= texelColor.xyz;","gl_FragColor = gl_FragColor * texelColor;","#else","gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );","#endif","}","if( enableAO ) {","#ifdef GAMMA_INPUT","vec4 aoColor = texture2D( tAO, vUv );","aoColor.xyz *= aoColor.xyz;","gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;","#else","gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;","#endif","}","if( enableSpecular )","specularTex = texture2D( tSpecular, vUv ).xyz;","mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );","vec3 finalNormal = tsb * normalTex;","#ifdef FLIP_SIDED","finalNormal = -finalNormal;","#endif","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 pointVector = lPosition.xyz + vViewPosition.xyz;","float pointDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );","pointVector = normalize( pointVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","#endif","pointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;","vec3 pointHalfVector = normalize( pointVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;","#else","pointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 spotVector = lPosition.xyz + vViewPosition.xyz;","float spotDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );","spotVector = normalize( spotVector );","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );","#endif","spotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;","vec3 spotHalfVector = normalize( spotVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;","#else","spotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","#ifdef WRAP_AROUND","float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );","float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","#endif","dirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += uDiffuseColor * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;","#endif","if ( enableReflection ) {","vec3 vReflect;","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, normal, uRefractionRatio );","} else {","vReflect = reflect( cameraToVertex, normal );","}","vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );","}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uOffset;","uniform vec2 uRepeat;","uniform bool enableDisplacement;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING","vNormal = normalize( normalMatrix * skinnedNormal.xyz );","vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );","vTangent = normalize( normalMatrix * skinnedTangent.xyz );","#else","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","#endif","vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );","vUv = uv * uRepeat + uOffset;","vec3 displacedPosition;","#ifdef VERTEX_TEXTURES","if ( enableDisplacement ) {","vec3 dv = texture2D( tDisplacement, uv ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","displacedPosition = position + normalize( normal ) * df;","} else {","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","}","#else","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","#endif","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","gl_Position = projectionMatrix * mvPosition;","vWorldPosition = worldPosition.xyz;","vViewPosition = -mvPosition.xyz;","#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif","}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;","void main() {","gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );","}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:["vec4 pack_depth( const in float depth ) {","const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","const vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","vec4 res = fract( depth * bit_shift );","res -= res.xxyz * bit_mask;","return res;","}","void main() {","gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","}"].join("\n")}},THREE.WebGLRenderer=function(t){function e(t){t.__webglVertexBuffer=Ti.createBuffer(),t.__webglColorBuffer=Ti.createBuffer(),Oe.info.memory.geometries++}function i(t){t.__webglVertexBuffer=Ti.createBuffer(),t.__webglColorBuffer=Ti.createBuffer(),t.__webglLineDistanceBuffer=Ti.createBuffer(),Oe.info.memory.geometries++}function n(t){t.__webglVertexBuffer=Ti.createBuffer(),t.__webglColorBuffer=Ti.createBuffer(),t.__webglNormalBuffer=Ti.createBuffer(),Oe.info.memory.geometries++}function r(t){t.__webglVertexBuffer=Ti.createBuffer(),t.__webglNormalBuffer=Ti.createBuffer(),t.__webglTangentBuffer=Ti.createBuffer(),t.__webglColorBuffer=Ti.createBuffer(),t.__webglUVBuffer=Ti.createBuffer(),t.__webglUV2Buffer=Ti.createBuffer(),t.__webglSkinIndicesBuffer=Ti.createBuffer(),t.__webglSkinWeightsBuffer=Ti.createBuffer(),t.__webglFaceBuffer=Ti.createBuffer(),t.__webglLineBuffer=Ti.createBuffer();var e,i;if(t.numMorphTargets)for(t.__webglMorphTargetsBuffers=[],e=0,i=t.numMorphTargets;i>e;e++)t.__webglMorphTargetsBuffers.push(Ti.createBuffer());if(t.numMorphNormals)for(t.__webglMorphNormalsBuffers=[],e=0,i=t.numMorphNormals;i>e;e++)t.__webglMorphNormalsBuffers.push(Ti.createBuffer());Oe.info.memory.geometries++}function o(t){if(t.__webglCustomAttributesList)for(var e in t.__webglCustomAttributesList)Ti.deleteBuffer(t.__webglCustomAttributesList[e].buffer)}function a(t,e){var i=t.vertices.length,n=e.material;if(n.attributes){void 0===t.__webglCustomAttributesList&&(t.__webglCustomAttributesList=[]);for(var r in n.attributes){var o=n.attributes[r];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var a=1;"v2"===o.type?a=2:"v3"===o.type?a=3:"v4"===o.type?a=4:"c"===o.type&&(a=3),o.size=a,o.array=new Float32Array(i*a),o.buffer=Ti.createBuffer(),o.buffer.belongsToAttribute=r,o.needsUpdate=!0}t.__webglCustomAttributesList.push(o)}}}function s(t,e){var i=t.vertices.length;t.__vertexArray=new Float32Array(3*i),t.__colorArray=new Float32Array(3*i),t.__sortArray=[],t.__webglParticleCount=i,a(t,e)}function l(t,e){var i=t.vertices.length;t.__vertexArray=new Float32Array(3*i),t.__colorArray=new Float32Array(3*i),t.__lineDistanceArray=new Float32Array(1*i),t.__webglLineCount=i,a(t,e)}function c(t,e){var i=t.vertices.length;t.__vertexArray=new Float32Array(3*i),t.__colorArray=new Float32Array(3*i),t.__normalArray=new Float32Array(3*i),t.__webglVertexCount=i,a(t,e)}function h(t,e){var i=e.geometry,n=t.faces3,r=t.faces4,o=3*n.length+4*r.length,a=1*n.length+2*r.length,s=3*n.length+4*r.length,l=u(e,t),c=m(l),h=d(l),f=p(l);t.__vertexArray=new Float32Array(3*o),h&&(t.__normalArray=new Float32Array(3*o)),i.hasTangents&&(t.__tangentArray=new Float32Array(4*o)),f&&(t.__colorArray=new Float32Array(3*o)),c&&((i.faceUvs.length>0||i.faceVertexUvs.length>0)&&(t.__uvArray=new Float32Array(2*o)),(i.faceUvs.length>1||i.faceVertexUvs.length>1)&&(t.__uv2Array=new Float32Array(2*o))),e.geometry.skinWeights.length&&e.geometry.skinIndices.length&&(t.__skinIndexArray=new Float32Array(4*o),t.__skinWeightArray=new Float32Array(4*o)),t.__faceArray=new Uint16Array(3*a),t.__lineArray=new Uint16Array(2*s);var g,v;if(t.numMorphTargets)for(t.__morphTargetsArrays=[],g=0,v=t.numMorphTargets;v>g;g++)t.__morphTargetsArrays.push(new Float32Array(3*o));if(t.numMorphNormals)for(t.__morphNormalsArrays=[],g=0,v=t.numMorphNormals;v>g;g++)t.__morphNormalsArrays.push(new Float32Array(3*o));if(t.__webglFaceCount=3*a,t.__webglLineCount=2*s,l.attributes){void 0===t.__webglCustomAttributesList&&(t.__webglCustomAttributesList=[]);for(var E in l.attributes){var y=l.attributes[E],x={};for(var T in y)x[T]=y[T];if(!x.__webglInitialized||x.createUniqueBuffers){x.__webglInitialized=!0;var b=1;"v2"===x.type?b=2:"v3"===x.type?b=3:"v4"===x.type?b=4:"c"===x.type&&(b=3),x.size=b,x.array=new Float32Array(o*b),x.buffer=Ti.createBuffer(),x.buffer.belongsToAttribute=E,y.needsUpdate=!0,x.__original=y}t.__webglCustomAttributesList.push(x)}}t.__inittedArrays=!0}function u(t,e){return t.material instanceof THREE.MeshFaceMaterial?t.material.materials[e.materialIndex]:t.material}function f(t){return t&&void 0!==t.shading&&t.shading===THREE.SmoothShading}function d(t){return t instanceof THREE.MeshBasicMaterial&&!t.envMap||t instanceof THREE.MeshDepthMaterial?!1:f(t)?THREE.SmoothShading:THREE.FlatShading}function p(t){return t.vertexColors?t.vertexColors:!1}function m(t){return t.map||t.lightMap||t.bumpMap||t.normalMap||t.specularMap||t instanceof THREE.ShaderMaterial?!0:!1}function g(t){var e,i,n;for(e in t.attributes)n="index"===e?Ti.ELEMENT_ARRAY_BUFFER:Ti.ARRAY_BUFFER,i=t.attributes[e],i.buffer=Ti.createBuffer(),Ti.bindBuffer(n,i.buffer),Ti.bufferData(n,i.array,Ti.STATIC_DRAW)}function v(t,e,i){var n,r,o,a,s,l,c=t.vertices,h=c.length,u=t.colors,f=u.length,d=t.__vertexArray,p=t.__colorArray,m=t.__sortArray,g=t.verticesNeedUpdate,v=t.elementsNeedUpdate,E=t.colorsNeedUpdate,y=t.__webglCustomAttributesList,x,T,b,_,w,R,M;
if(i.sortParticles){for(gi.copy(mi),gi.multiply(i.matrixWorld),n=0;h>n;n++)o=c[n],vi.copy(o),vi.applyProjection(gi),m[n]=[vi.z,n];for(m.sort(H),n=0;h>n;n++)o=c[m[n][1]],a=3*n,d[a]=o.x,d[a+1]=o.y,d[a+2]=o.z;for(r=0;f>r;r++)a=3*r,l=u[m[r][1]],p[a]=l.r,p[a+1]=l.g,p[a+2]=l.b;if(y)for(x=0,T=y.length;T>x;x++)if(M=y[x],void 0===M.boundTo||"vertices"===M.boundTo)if(a=0,w=M.value.length,1===M.size)for(_=0;w>_;_++)s=m[_][1],M.array[_]=M.value[s];else if(2===M.size)for(_=0;w>_;_++)s=m[_][1],R=M.value[s],M.array[a]=R.x,M.array[a+1]=R.y,a+=2;else if(3===M.size)if("c"===M.type)for(_=0;w>_;_++)s=m[_][1],R=M.value[s],M.array[a]=R.r,M.array[a+1]=R.g,M.array[a+2]=R.b,a+=3;else for(_=0;w>_;_++)s=m[_][1],R=M.value[s],M.array[a]=R.x,M.array[a+1]=R.y,M.array[a+2]=R.z,a+=3;else if(4===M.size)for(_=0;w>_;_++)s=m[_][1],R=M.value[s],M.array[a]=R.x,M.array[a+1]=R.y,M.array[a+2]=R.z,M.array[a+3]=R.w,a+=4}else{if(g)for(n=0;h>n;n++)o=c[n],a=3*n,d[a]=o.x,d[a+1]=o.y,d[a+2]=o.z;if(E)for(r=0;f>r;r++)l=u[r],a=3*r,p[a]=l.r,p[a+1]=l.g,p[a+2]=l.b;if(y)for(x=0,T=y.length;T>x;x++)if(M=y[x],M.needsUpdate&&(void 0===M.boundTo||"vertices"===M.boundTo))if(w=M.value.length,a=0,1===M.size)for(_=0;w>_;_++)M.array[_]=M.value[_];else if(2===M.size)for(_=0;w>_;_++)R=M.value[_],M.array[a]=R.x,M.array[a+1]=R.y,a+=2;else if(3===M.size)if("c"===M.type)for(_=0;w>_;_++)R=M.value[_],M.array[a]=R.r,M.array[a+1]=R.g,M.array[a+2]=R.b,a+=3;else for(_=0;w>_;_++)R=M.value[_],M.array[a]=R.x,M.array[a+1]=R.y,M.array[a+2]=R.z,a+=3;else if(4===M.size)for(_=0;w>_;_++)R=M.value[_],M.array[a]=R.x,M.array[a+1]=R.y,M.array[a+2]=R.z,M.array[a+3]=R.w,a+=4}if((g||i.sortParticles)&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglVertexBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,d,e)),(E||i.sortParticles)&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglColorBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,p,e)),y)for(x=0,T=y.length;T>x;x++)M=y[x],(M.needsUpdate||i.sortParticles)&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,M.buffer),Ti.bufferData(Ti.ARRAY_BUFFER,M.array,e))}function E(t,e){var i,n,r,o,a,s,l=t.vertices,c=t.colors,h=t.lineDistances,u=l.length,f=c.length,d=h.length,p=t.__vertexArray,m=t.__colorArray,g=t.__lineDistanceArray,v=t.verticesNeedUpdate,E=t.colorsNeedUpdate,y=t.lineDistancesNeedUpdate,x=t.__webglCustomAttributesList,T,b,_,w,R,H,M;if(v){for(i=0;u>i;i++)o=l[i],a=3*i,p[a]=o.x,p[a+1]=o.y,p[a+2]=o.z;Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglVertexBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,p,e)}if(E){for(n=0;f>n;n++)s=c[n],a=3*n,m[a]=s.r,m[a+1]=s.g,m[a+2]=s.b;Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglColorBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,m,e)}if(y){for(r=0;d>r;r++)g[r]=h[r];Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglLineDistanceBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,g,e)}if(x)for(T=0,b=x.length;b>T;T++)if(M=x[T],M.needsUpdate&&(void 0===M.boundTo||"vertices"===M.boundTo)){if(a=0,R=M.value.length,1===M.size)for(w=0;R>w;w++)M.array[w]=M.value[w];else if(2===M.size)for(w=0;R>w;w++)H=M.value[w],M.array[a]=H.x,M.array[a+1]=H.y,a+=2;else if(3===M.size)if("c"===M.type)for(w=0;R>w;w++)H=M.value[w],M.array[a]=H.r,M.array[a+1]=H.g,M.array[a+2]=H.b,a+=3;else for(w=0;R>w;w++)H=M.value[w],M.array[a]=H.x,M.array[a+1]=H.y,M.array[a+2]=H.z,a+=3;else if(4===M.size)for(w=0;R>w;w++)H=M.value[w],M.array[a]=H.x,M.array[a+1]=H.y,M.array[a+2]=H.z,M.array[a+3]=H.w,a+=4;Ti.bindBuffer(Ti.ARRAY_BUFFER,M.buffer),Ti.bufferData(Ti.ARRAY_BUFFER,M.array,e)}}function y(t,e){var i,n,r,o,a,s,l,c,h,u,f,d,p,m=t.vertices,g=t.colors,v=t.normals,E=m.length,y=g.length,x=v.length,T=t.__vertexArray,b=t.__colorArray,_=t.__normalArray,w=t.verticesNeedUpdate,R=t.colorsNeedUpdate,H=t.normalsNeedUpdate,M=t.__webglCustomAttributesList;if(w){for(i=0;E>i;i++)o=m[i],a=3*i,T[a]=o.x,T[a+1]=o.y,T[a+2]=o.z;Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglVertexBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,T,e)}if(R){for(n=0;y>n;n++)s=g[n],a=3*n,b[a]=s.r,b[a+1]=s.g,b[a+2]=s.b;Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglColorBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,b,e)}if(H){for(r=0;x>r;r++)l=v[r],a=3*r,_[a]=l.x,_[a+1]=l.y,_[a+2]=l.z;Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglNormalBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,_,e)}if(M)for(c=0,h=M.length;h>c;c++)if(d=M[c],d.needsUpdate&&(void 0===d.boundTo||"vertices"===d.boundTo)){if(a=0,f=d.value.length,1===d.size)for(u=0;f>u;u++)d.array[u]=d.value[u];else if(2===d.size)for(u=0;f>u;u++)p=d.value[u],d.array[a]=p.x,d.array[a+1]=p.y,a+=2;else if(3===d.size)if("c"===d.type)for(u=0;f>u;u++)p=d.value[u],d.array[a]=p.r,d.array[a+1]=p.g,d.array[a+2]=p.b,a+=3;else for(u=0;f>u;u++)p=d.value[u],d.array[a]=p.x,d.array[a+1]=p.y,d.array[a+2]=p.z,a+=3;else if(4===d.size)for(u=0;f>u;u++)p=d.value[u],d.array[a]=p.x,d.array[a+1]=p.y,d.array[a+2]=p.z,d.array[a+3]=p.w,a+=4;Ti.bindBuffer(Ti.ARRAY_BUFFER,d.buffer),Ti.bufferData(Ti.ARRAY_BUFFER,d.array,e)}}function x(t,e,i,n,r){if(t.__inittedArrays){var o=d(r),a=p(r),s=m(r),l=o===THREE.SmoothShading,c,h,u,f,g,v,E,y,x,T,b,_,w,R,H,M,S,C,A,D,P,k,L,N,F,I,z,O,U,B,V,W,j,G,X,q,Y,K,Q,Z,J,te,ee,ie,ne,re,oe,ae,se,le,ce,he,ue,fe,de,pe,me,ge,ve=0,Ee=0,ye=0,xe=0,Te=0,be=0,_e=0,we=0,Re=0,He=0,Me=0,Se=0,Ce=0,Ae,De=t.__vertexArray,Pe=t.__uvArray,ke=t.__uv2Array,Le=t.__normalArray,Ne=t.__tangentArray,Fe=t.__colorArray,Ie=t.__skinIndexArray,ze=t.__skinWeightArray,Oe=t.__morphTargetsArrays,Ue=t.__morphNormalsArrays,Be=t.__webglCustomAttributesList,Ve,We=t.__faceArray,je=t.__lineArray,Ge=e.geometry,Xe=Ge.verticesNeedUpdate,qe=Ge.elementsNeedUpdate,Ye=Ge.uvsNeedUpdate,Ke=Ge.normalsNeedUpdate,$e=Ge.tangentsNeedUpdate,Qe=Ge.colorsNeedUpdate,Ze=Ge.morphTargetsNeedUpdate,Je=Ge.vertices,ti=t.faces3,ei=t.faces4,ii=Ge.faces,ni=Ge.faceVertexUvs[0],ri=Ge.faceVertexUvs[1],oi=Ge.colors,ai=Ge.skinIndices,si=Ge.skinWeights,li=Ge.morphTargets,ci=Ge.morphNormals;if(Xe){for(c=0,h=ti.length;h>c;c++)f=ii[ti[c]],w=Je[f.a],R=Je[f.b],H=Je[f.c],De[Ee]=w.x,De[Ee+1]=w.y,De[Ee+2]=w.z,De[Ee+3]=R.x,De[Ee+4]=R.y,De[Ee+5]=R.z,De[Ee+6]=H.x,De[Ee+7]=H.y,De[Ee+8]=H.z,Ee+=9;for(c=0,h=ei.length;h>c;c++)f=ii[ei[c]],w=Je[f.a],R=Je[f.b],H=Je[f.c],M=Je[f.d],De[Ee]=w.x,De[Ee+1]=w.y,De[Ee+2]=w.z,De[Ee+3]=R.x,De[Ee+4]=R.y,De[Ee+5]=R.z,De[Ee+6]=H.x,De[Ee+7]=H.y,De[Ee+8]=H.z,De[Ee+9]=M.x,De[Ee+10]=M.y,De[Ee+11]=M.z,Ee+=12;Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglVertexBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,De,i)}if(Ze)for(he=0,ue=li.length;ue>he;he++){for(Me=0,c=0,h=ti.length;h>c;c++)pe=ti[c],f=ii[pe],w=li[he].vertices[f.a],R=li[he].vertices[f.b],H=li[he].vertices[f.c],fe=Oe[he],fe[Me]=w.x,fe[Me+1]=w.y,fe[Me+2]=w.z,fe[Me+3]=R.x,fe[Me+4]=R.y,fe[Me+5]=R.z,fe[Me+6]=H.x,fe[Me+7]=H.y,fe[Me+8]=H.z,r.morphNormals&&(l?(me=ci[he].vertexNormals[pe],P=me.a,k=me.b,L=me.c):(P=ci[he].faceNormals[pe],k=P,L=P),de=Ue[he],de[Me]=P.x,de[Me+1]=P.y,de[Me+2]=P.z,de[Me+3]=k.x,de[Me+4]=k.y,de[Me+5]=k.z,de[Me+6]=L.x,de[Me+7]=L.y,de[Me+8]=L.z),Me+=9;for(c=0,h=ei.length;h>c;c++)pe=ei[c],f=ii[pe],w=li[he].vertices[f.a],R=li[he].vertices[f.b],H=li[he].vertices[f.c],M=li[he].vertices[f.d],fe=Oe[he],fe[Me]=w.x,fe[Me+1]=w.y,fe[Me+2]=w.z,fe[Me+3]=R.x,fe[Me+4]=R.y,fe[Me+5]=R.z,fe[Me+6]=H.x,fe[Me+7]=H.y,fe[Me+8]=H.z,fe[Me+9]=M.x,fe[Me+10]=M.y,fe[Me+11]=M.z,r.morphNormals&&(l?(me=ci[he].vertexNormals[pe],P=me.a,k=me.b,L=me.c,N=me.d):(P=ci[he].faceNormals[pe],k=P,L=P,N=P),de=Ue[he],de[Me]=P.x,de[Me+1]=P.y,de[Me+2]=P.z,de[Me+3]=k.x,de[Me+4]=k.y,de[Me+5]=k.z,de[Me+6]=L.x,de[Me+7]=L.y,de[Me+8]=L.z,de[Me+9]=N.x,de[Me+10]=N.y,de[Me+11]=N.z),Me+=12;Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[he]),Ti.bufferData(Ti.ARRAY_BUFFER,Oe[he],i),r.morphNormals&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[he]),Ti.bufferData(Ti.ARRAY_BUFFER,Ue[he],i))}if(si.length){for(c=0,h=ti.length;h>c;c++)f=ii[ti[c]],U=si[f.a],B=si[f.b],V=si[f.c],ze[He]=U.x,ze[He+1]=U.y,ze[He+2]=U.z,ze[He+3]=U.w,ze[He+4]=B.x,ze[He+5]=B.y,ze[He+6]=B.z,ze[He+7]=B.w,ze[He+8]=V.x,ze[He+9]=V.y,ze[He+10]=V.z,ze[He+11]=V.w,j=ai[f.a],G=ai[f.b],X=ai[f.c],Ie[He]=j.x,Ie[He+1]=j.y,Ie[He+2]=j.z,Ie[He+3]=j.w,Ie[He+4]=G.x,Ie[He+5]=G.y,Ie[He+6]=G.z,Ie[He+7]=G.w,Ie[He+8]=X.x,Ie[He+9]=X.y,Ie[He+10]=X.z,Ie[He+11]=X.w,He+=12;for(c=0,h=ei.length;h>c;c++)f=ii[ei[c]],U=si[f.a],B=si[f.b],V=si[f.c],W=si[f.d],ze[He]=U.x,ze[He+1]=U.y,ze[He+2]=U.z,ze[He+3]=U.w,ze[He+4]=B.x,ze[He+5]=B.y,ze[He+6]=B.z,ze[He+7]=B.w,ze[He+8]=V.x,ze[He+9]=V.y,ze[He+10]=V.z,ze[He+11]=V.w,ze[He+12]=W.x,ze[He+13]=W.y,ze[He+14]=W.z,ze[He+15]=W.w,j=ai[f.a],G=ai[f.b],X=ai[f.c],q=ai[f.d],Ie[He]=j.x,Ie[He+1]=j.y,Ie[He+2]=j.z,Ie[He+3]=j.w,Ie[He+4]=G.x,Ie[He+5]=G.y,Ie[He+6]=G.z,Ie[He+7]=G.w,Ie[He+8]=X.x,Ie[He+9]=X.y,Ie[He+10]=X.z,Ie[He+11]=X.w,Ie[He+12]=q.x,Ie[He+13]=q.y,Ie[He+14]=q.z,Ie[He+15]=q.w,He+=16;He>0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglSkinIndicesBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,Ie,i),Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglSkinWeightsBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,ze,i))}if(Qe&&a){for(c=0,h=ti.length;h>c;c++)f=ii[ti[c]],y=f.vertexColors,x=f.color,3===y.length&&a===THREE.VertexColors?(F=y[0],I=y[1],z=y[2]):(F=x,I=x,z=x),Fe[Re]=F.r,Fe[Re+1]=F.g,Fe[Re+2]=F.b,Fe[Re+3]=I.r,Fe[Re+4]=I.g,Fe[Re+5]=I.b,Fe[Re+6]=z.r,Fe[Re+7]=z.g,Fe[Re+8]=z.b,Re+=9;for(c=0,h=ei.length;h>c;c++)f=ii[ei[c]],y=f.vertexColors,x=f.color,4===y.length&&a===THREE.VertexColors?(F=y[0],I=y[1],z=y[2],O=y[3]):(F=x,I=x,z=x,O=x),Fe[Re]=F.r,Fe[Re+1]=F.g,Fe[Re+2]=F.b,Fe[Re+3]=I.r,Fe[Re+4]=I.g,Fe[Re+5]=I.b,Fe[Re+6]=z.r,Fe[Re+7]=z.g,Fe[Re+8]=z.b,Fe[Re+9]=O.r,Fe[Re+10]=O.g,Fe[Re+11]=O.b,Re+=12;Re>0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglColorBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,Fe,i))}if($e&&Ge.hasTangents){for(c=0,h=ti.length;h>c;c++)f=ii[ti[c]],T=f.vertexTangents,S=T[0],C=T[1],A=T[2],Ne[_e]=S.x,Ne[_e+1]=S.y,Ne[_e+2]=S.z,Ne[_e+3]=S.w,Ne[_e+4]=C.x,Ne[_e+5]=C.y,Ne[_e+6]=C.z,Ne[_e+7]=C.w,Ne[_e+8]=A.x,Ne[_e+9]=A.y,Ne[_e+10]=A.z,Ne[_e+11]=A.w,_e+=12;for(c=0,h=ei.length;h>c;c++)f=ii[ei[c]],T=f.vertexTangents,S=T[0],C=T[1],A=T[2],D=T[3],Ne[_e]=S.x,Ne[_e+1]=S.y,Ne[_e+2]=S.z,Ne[_e+3]=S.w,Ne[_e+4]=C.x,Ne[_e+5]=C.y,Ne[_e+6]=C.z,Ne[_e+7]=C.w,Ne[_e+8]=A.x,Ne[_e+9]=A.y,Ne[_e+10]=A.z,Ne[_e+11]=A.w,Ne[_e+12]=D.x,Ne[_e+13]=D.y,Ne[_e+14]=D.z,Ne[_e+15]=D.w,_e+=16;Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglTangentBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,Ne,i)}if(Ke&&o){for(c=0,h=ti.length;h>c;c++)if(f=ii[ti[c]],g=f.vertexNormals,v=f.normal,3===g.length&&l)for(oe=0;3>oe;oe++)se=g[oe],Le[be]=se.x,Le[be+1]=se.y,Le[be+2]=se.z,be+=3;else for(oe=0;3>oe;oe++)Le[be]=v.x,Le[be+1]=v.y,Le[be+2]=v.z,be+=3;for(c=0,h=ei.length;h>c;c++)if(f=ii[ei[c]],g=f.vertexNormals,v=f.normal,4===g.length&&l)for(oe=0;4>oe;oe++)se=g[oe],Le[be]=se.x,Le[be+1]=se.y,Le[be+2]=se.z,be+=3;else for(oe=0;4>oe;oe++)Le[be]=v.x,Le[be+1]=v.y,Le[be+2]=v.z,be+=3;Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglNormalBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,Le,i)}if(Ye&&ni&&s){for(c=0,h=ti.length;h>c;c++)if(u=ti[c],b=ni[u],void 0!==b)for(oe=0;3>oe;oe++)le=b[oe],Pe[ye]=le.x,Pe[ye+1]=le.y,ye+=2;for(c=0,h=ei.length;h>c;c++)if(u=ei[c],b=ni[u],void 0!==b)for(oe=0;4>oe;oe++)le=b[oe],Pe[ye]=le.x,Pe[ye+1]=le.y,ye+=2;ye>0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglUVBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,Pe,i))}if(Ye&&ri&&s){for(c=0,h=ti.length;h>c;c++)if(u=ti[c],_=ri[u],void 0!==_)for(oe=0;3>oe;oe++)ce=_[oe],ke[xe]=ce.x,ke[xe+1]=ce.y,xe+=2;for(c=0,h=ei.length;h>c;c++)if(u=ei[c],_=ri[u],void 0!==_)for(oe=0;4>oe;oe++)ce=_[oe],ke[xe]=ce.x,ke[xe+1]=ce.y,xe+=2;xe>0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglUV2Buffer),Ti.bufferData(Ti.ARRAY_BUFFER,ke,i))}if(qe){for(c=0,h=ti.length;h>c;c++)We[Te]=ve,We[Te+1]=ve+1,We[Te+2]=ve+2,Te+=3,je[we]=ve,je[we+1]=ve+1,je[we+2]=ve,je[we+3]=ve+2,je[we+4]=ve+1,je[we+5]=ve+2,we+=6,ve+=3;for(c=0,h=ei.length;h>c;c++)We[Te]=ve,We[Te+1]=ve+1,We[Te+2]=ve+3,We[Te+3]=ve+1,We[Te+4]=ve+2,We[Te+5]=ve+3,Te+=6,je[we]=ve,je[we+1]=ve+1,je[we+2]=ve,je[we+3]=ve+3,je[we+4]=ve+1,je[we+5]=ve+2,je[we+6]=ve+2,je[we+7]=ve+3,we+=8,ve+=4;Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,t.__webglFaceBuffer),Ti.bufferData(Ti.ELEMENT_ARRAY_BUFFER,We,i),Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,t.__webglLineBuffer),Ti.bufferData(Ti.ELEMENT_ARRAY_BUFFER,je,i)}if(Be)for(oe=0,ae=Be.length;ae>oe;oe++)if(Ve=Be[oe],Ve.__original.needsUpdate){if(Se=0,Ce=0,1===Ve.size){if(void 0===Ve.boundTo||"vertices"===Ve.boundTo){for(c=0,h=ti.length;h>c;c++)f=ii[ti[c]],Ve.array[Se]=Ve.value[f.a],Ve.array[Se+1]=Ve.value[f.b],Ve.array[Se+2]=Ve.value[f.c],Se+=3;for(c=0,h=ei.length;h>c;c++)f=ii[ei[c]],Ve.array[Se]=Ve.value[f.a],Ve.array[Se+1]=Ve.value[f.b],Ve.array[Se+2]=Ve.value[f.c],Ve.array[Se+3]=Ve.value[f.d],Se+=4}else if("faces"===Ve.boundTo){for(c=0,h=ti.length;h>c;c++)Ae=Ve.value[ti[c]],Ve.array[Se]=Ae,Ve.array[Se+1]=Ae,Ve.array[Se+2]=Ae,Se+=3;for(c=0,h=ei.length;h>c;c++)Ae=Ve.value[ei[c]],Ve.array[Se]=Ae,Ve.array[Se+1]=Ae,Ve.array[Se+2]=Ae,Ve.array[Se+3]=Ae,Se+=4}}else if(2===Ve.size){if(void 0===Ve.boundTo||"vertices"===Ve.boundTo){for(c=0,h=ti.length;h>c;c++)f=ii[ti[c]],w=Ve.value[f.a],R=Ve.value[f.b],H=Ve.value[f.c],Ve.array[Se]=w.x,Ve.array[Se+1]=w.y,Ve.array[Se+2]=R.x,Ve.array[Se+3]=R.y,Ve.array[Se+4]=H.x,Ve.array[Se+5]=H.y,Se+=6;for(c=0,h=ei.length;h>c;c++)f=ii[ei[c]],w=Ve.value[f.a],R=Ve.value[f.b],H=Ve.value[f.c],M=Ve.value[f.d],Ve.array[Se]=w.x,Ve.array[Se+1]=w.y,Ve.array[Se+2]=R.x,Ve.array[Se+3]=R.y,Ve.array[Se+4]=H.x,Ve.array[Se+5]=H.y,Ve.array[Se+6]=M.x,Ve.array[Se+7]=M.y,Se+=8}else if("faces"===Ve.boundTo){for(c=0,h=ti.length;h>c;c++)Ae=Ve.value[ti[c]],w=Ae,R=Ae,H=Ae,Ve.array[Se]=w.x,Ve.array[Se+1]=w.y,Ve.array[Se+2]=R.x,Ve.array[Se+3]=R.y,Ve.array[Se+4]=H.x,Ve.array[Se+5]=H.y,Se+=6;for(c=0,h=ei.length;h>c;c++)Ae=Ve.value[ei[c]],w=Ae,R=Ae,H=Ae,M=Ae,Ve.array[Se]=w.x,Ve.array[Se+1]=w.y,Ve.array[Se+2]=R.x,Ve.array[Se+3]=R.y,Ve.array[Se+4]=H.x,Ve.array[Se+5]=H.y,Ve.array[Se+6]=M.x,Ve.array[Se+7]=M.y,Se+=8}}else if(3===Ve.size){var hi;if(hi="c"===Ve.type?["r","g","b"]:["x","y","z"],void 0===Ve.boundTo||"vertices"===Ve.boundTo){for(c=0,h=ti.length;h>c;c++)f=ii[ti[c]],w=Ve.value[f.a],R=Ve.value[f.b],H=Ve.value[f.c],Ve.array[Se]=w[hi[0]],Ve.array[Se+1]=w[hi[1]],Ve.array[Se+2]=w[hi[2]],Ve.array[Se+3]=R[hi[0]],Ve.array[Se+4]=R[hi[1]],Ve.array[Se+5]=R[hi[2]],Ve.array[Se+6]=H[hi[0]],Ve.array[Se+7]=H[hi[1]],Ve.array[Se+8]=H[hi[2]],Se+=9;for(c=0,h=ei.length;h>c;c++)f=ii[ei[c]],w=Ve.value[f.a],R=Ve.value[f.b],H=Ve.value[f.c],M=Ve.value[f.d],Ve.array[Se]=w[hi[0]],Ve.array[Se+1]=w[hi[1]],Ve.array[Se+2]=w[hi[2]],Ve.array[Se+3]=R[hi[0]],Ve.array[Se+4]=R[hi[1]],Ve.array[Se+5]=R[hi[2]],Ve.array[Se+6]=H[hi[0]],Ve.array[Se+7]=H[hi[1]],Ve.array[Se+8]=H[hi[2]],Ve.array[Se+9]=M[hi[0]],Ve.array[Se+10]=M[hi[1]],Ve.array[Se+11]=M[hi[2]],Se+=12}else if("faces"===Ve.boundTo){for(c=0,h=ti.length;h>c;c++)Ae=Ve.value[ti[c]],w=Ae,R=Ae,H=Ae,Ve.array[Se]=w[hi[0]],Ve.array[Se+1]=w[hi[1]],Ve.array[Se+2]=w[hi[2]],Ve.array[Se+3]=R[hi[0]],Ve.array[Se+4]=R[hi[1]],Ve.array[Se+5]=R[hi[2]],Ve.array[Se+6]=H[hi[0]],Ve.array[Se+7]=H[hi[1]],Ve.array[Se+8]=H[hi[2]],Se+=9;for(c=0,h=ei.length;h>c;c++)Ae=Ve.value[ei[c]],w=Ae,R=Ae,H=Ae,M=Ae,Ve.array[Se]=w[hi[0]],Ve.array[Se+1]=w[hi[1]],Ve.array[Se+2]=w[hi[2]],Ve.array[Se+3]=R[hi[0]],Ve.array[Se+4]=R[hi[1]],Ve.array[Se+5]=R[hi[2]],Ve.array[Se+6]=H[hi[0]],Ve.array[Se+7]=H[hi[1]],Ve.array[Se+8]=H[hi[2]],Ve.array[Se+9]=M[hi[0]],Ve.array[Se+10]=M[hi[1]],Ve.array[Se+11]=M[hi[2]],Se+=12}else if("faceVertices"===Ve.boundTo){for(c=0,h=ti.length;h>c;c++)Ae=Ve.value[ti[c]],w=Ae[0],R=Ae[1],H=Ae[2],Ve.array[Se]=w[hi[0]],Ve.array[Se+1]=w[hi[1]],Ve.array[Se+2]=w[hi[2]],Ve.array[Se+3]=R[hi[0]],Ve.array[Se+4]=R[hi[1]],Ve.array[Se+5]=R[hi[2]],Ve.array[Se+6]=H[hi[0]],Ve.array[Se+7]=H[hi[1]],Ve.array[Se+8]=H[hi[2]],Se+=9;for(c=0,h=ei.length;h>c;c++)Ae=Ve.value[ei[c]],w=Ae[0],R=Ae[1],H=Ae[2],M=Ae[3],Ve.array[Se]=w[hi[0]],Ve.array[Se+1]=w[hi[1]],Ve.array[Se+2]=w[hi[2]],Ve.array[Se+3]=R[hi[0]],Ve.array[Se+4]=R[hi[1]],Ve.array[Se+5]=R[hi[2]],Ve.array[Se+6]=H[hi[0]],Ve.array[Se+7]=H[hi[1]],Ve.array[Se+8]=H[hi[2]],Ve.array[Se+9]=M[hi[0]],Ve.array[Se+10]=M[hi[1]],Ve.array[Se+11]=M[hi[2]],Se+=12}}else if(4===Ve.size)if(void 0===Ve.boundTo||"vertices"===Ve.boundTo){for(c=0,h=ti.length;h>c;c++)f=ii[ti[c]],w=Ve.value[f.a],R=Ve.value[f.b],H=Ve.value[f.c],Ve.array[Se]=w.x,Ve.array[Se+1]=w.y,Ve.array[Se+2]=w.z,Ve.array[Se+3]=w.w,Ve.array[Se+4]=R.x,Ve.array[Se+5]=R.y,Ve.array[Se+6]=R.z,Ve.array[Se+7]=R.w,Ve.array[Se+8]=H.x,Ve.array[Se+9]=H.y,Ve.array[Se+10]=H.z,Ve.array[Se+11]=H.w,Se+=12;for(c=0,h=ei.length;h>c;c++)f=ii[ei[c]],w=Ve.value[f.a],R=Ve.value[f.b],H=Ve.value[f.c],M=Ve.value[f.d],Ve.array[Se]=w.x,Ve.array[Se+1]=w.y,Ve.array[Se+2]=w.z,Ve.array[Se+3]=w.w,Ve.array[Se+4]=R.x,Ve.array[Se+5]=R.y,Ve.array[Se+6]=R.z,Ve.array[Se+7]=R.w,Ve.array[Se+8]=H.x,Ve.array[Se+9]=H.y,Ve.array[Se+10]=H.z,Ve.array[Se+11]=H.w,Ve.array[Se+12]=M.x,Ve.array[Se+13]=M.y,Ve.array[Se+14]=M.z,Ve.array[Se+15]=M.w,Se+=16}else if("faces"===Ve.boundTo){for(c=0,h=ti.length;h>c;c++)Ae=Ve.value[ti[c]],w=Ae,R=Ae,H=Ae,Ve.array[Se]=w.x,Ve.array[Se+1]=w.y,Ve.array[Se+2]=w.z,Ve.array[Se+3]=w.w,Ve.array[Se+4]=R.x,Ve.array[Se+5]=R.y,Ve.array[Se+6]=R.z,Ve.array[Se+7]=R.w,Ve.array[Se+8]=H.x,Ve.array[Se+9]=H.y,Ve.array[Se+10]=H.z,Ve.array[Se+11]=H.w,Se+=12;for(c=0,h=ei.length;h>c;c++)Ae=Ve.value[ei[c]],w=Ae,R=Ae,H=Ae,M=Ae,Ve.array[Se]=w.x,Ve.array[Se+1]=w.y,Ve.array[Se+2]=w.z,Ve.array[Se+3]=w.w,Ve.array[Se+4]=R.x,Ve.array[Se+5]=R.y,Ve.array[Se+6]=R.z,Ve.array[Se+7]=R.w,Ve.array[Se+8]=H.x,Ve.array[Se+9]=H.y,Ve.array[Se+10]=H.z,Ve.array[Se+11]=H.w,Ve.array[Se+12]=M.x,Ve.array[Se+13]=M.y,Ve.array[Se+14]=M.z,Ve.array[Se+15]=M.w,Se+=16}else if("faceVertices"===Ve.boundTo){for(c=0,h=ti.length;h>c;c++)Ae=Ve.value[ti[c]],w=Ae[0],R=Ae[1],H=Ae[2],Ve.array[Se]=w.x,Ve.array[Se+1]=w.y,Ve.array[Se+2]=w.z,Ve.array[Se+3]=w.w,Ve.array[Se+4]=R.x,Ve.array[Se+5]=R.y,Ve.array[Se+6]=R.z,Ve.array[Se+7]=R.w,Ve.array[Se+8]=H.x,Ve.array[Se+9]=H.y,Ve.array[Se+10]=H.z,Ve.array[Se+11]=H.w,Se+=12;for(c=0,h=ei.length;h>c;c++)Ae=Ve.value[ei[c]],w=Ae[0],R=Ae[1],H=Ae[2],M=Ae[3],Ve.array[Se]=w.x,Ve.array[Se+1]=w.y,Ve.array[Se+2]=w.z,Ve.array[Se+3]=w.w,Ve.array[Se+4]=R.x,Ve.array[Se+5]=R.y,Ve.array[Se+6]=R.z,Ve.array[Se+7]=R.w,Ve.array[Se+8]=H.x,Ve.array[Se+9]=H.y,Ve.array[Se+10]=H.z,Ve.array[Se+11]=H.w,Ve.array[Se+12]=M.x,Ve.array[Se+13]=M.y,Ve.array[Se+14]=M.z,Ve.array[Se+15]=M.w,Se+=16}Ti.bindBuffer(Ti.ARRAY_BUFFER,Ve.buffer),Ti.bufferData(Ti.ARRAY_BUFFER,Ve.array,i)}n&&(delete t.__inittedArrays,delete t.__colorArray,delete t.__normalArray,delete t.__tangentArray,delete t.__uvArray,delete t.__uv2Array,delete t.__faceArray,delete t.__vertexArray,delete t.__lineArray,delete t.__skinIndexArray,delete t.__skinWeightArray)}}function T(t,e,i){var n=t.attributes,r,o;for(r in n)o=n[r],o.needsUpdate&&("index"===r?(Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,o.buffer),Ti.bufferData(Ti.ELEMENT_ARRAY_BUFFER,o.array,e)):(Ti.bindBuffer(Ti.ARRAY_BUFFER,o.buffer),Ti.bufferData(Ti.ARRAY_BUFFER,o.array,e)),o.needsUpdate=!1),i&&!o.dynamic&&delete o.array}function b(t){di[t]||(Ti.enableVertexAttribArray(t),di[t]=!0)}function _(){for(var t in di)di[t]&&(Ti.disableVertexAttribArray(t),di[t]=!1)}function w(t,e,i){var n=t.program.attributes;if(-1!==i.morphTargetBase&&n.position>=0?(Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[i.morphTargetBase]),b(n.position),Ti.vertexAttribPointer(n.position,3,Ti.FLOAT,!1,0,0)):n.position>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglVertexBuffer),b(n.position),Ti.vertexAttribPointer(n.position,3,Ti.FLOAT,!1,0,0)),i.morphTargetForcedOrder.length)for(var r=0,o=i.morphTargetForcedOrder,a=i.morphTargetInfluences;r<t.numSupportedMorphTargets&&r<o.length;)n["morphTarget"+r]>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[o[r]]),b(n["morphTarget"+r]),Ti.vertexAttribPointer(n["morphTarget"+r],3,Ti.FLOAT,!1,0,0)),n["morphNormal"+r]>=0&&t.morphNormals&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[o[r]]),b(n["morphNormal"+r]),Ti.vertexAttribPointer(n["morphNormal"+r],3,Ti.FLOAT,!1,0,0)),i.__webglMorphTargetInfluences[r]=a[o[r]],r++;else{var s,l=[],a=i.morphTargetInfluences,c,h=a.length;for(c=0;h>c;c++)s=a[c],s>0&&l.push([s,c]);l.length>t.numSupportedMorphTargets?(l.sort(H),l.length=t.numSupportedMorphTargets):l.length>t.numSupportedMorphNormals?l.sort(H):0===l.length&&l.push([0,0]);for(var u,r=0;r<t.numSupportedMorphTargets;)l[r]?(u=l[r][1],n["morphTarget"+r]>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[u]),b(n["morphTarget"+r]),Ti.vertexAttribPointer(n["morphTarget"+r],3,Ti.FLOAT,!1,0,0)),n["morphNormal"+r]>=0&&t.morphNormals&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[u]),b(n["morphNormal"+r]),Ti.vertexAttribPointer(n["morphNormal"+r],3,Ti.FLOAT,!1,0,0)),i.__webglMorphTargetInfluences[r]=a[u]):i.__webglMorphTargetInfluences[r]=0,r++}null!==t.program.uniforms.morphTargetInfluences&&Ti.uniform1fv(t.program.uniforms.morphTargetInfluences,i.__webglMorphTargetInfluences)}function R(t,e){return t.z!==e.z?e.z-t.z:t.id-e.id}function H(t,e){return e[0]-t[0]}function M(t,e,i){if(t.length)for(var n=0,r=t.length;r>n;n++)Ve=null,Xe=null,Qe=-1,ei=-1,ii=-1,Ke=-1,$e=-1,Ge=-1,je=-1,yi=!0,t[n].render(e,i,ui,fi),Ve=null,Xe=null,Qe=-1,ei=-1,ii=-1,Ke=-1,$e=-1,Ge=-1,je=-1,yi=!0}function S(t,e,i,n,r,o,a,s){var l,c,h,u,f,d,p;e?(f=t.length-1,d=-1,p=-1):(f=0,d=t.length,p=1);for(var m=f;m!==d;m+=p)if(l=t[m],l.render){if(c=l.object,h=l.buffer,s)u=s;else{if(u=l[i],!u)continue;a&&Oe.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst),Oe.setDepthTest(u.depthTest),Oe.setDepthWrite(u.depthWrite),le(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits)}Oe.setMaterialFaces(u),h instanceof THREE.BufferGeometry?Oe.renderBufferDirect(n,r,o,u,h,c):Oe.renderBuffer(n,r,o,u,h,c)}}function C(t,e,i,n,r,o,a){for(var s,l,c,h,u=0,f=t.length;f>u;u++)if(s=t[u],l=s.object,l.visible){if(a)c=a;else{if(c=s[e],!c)continue;o&&Oe.setBlending(c.blending,c.blendEquation,c.blendSrc,c.blendDst),Oe.setDepthTest(c.depthTest),Oe.setDepthWrite(c.depthWrite),le(c.polygonOffset,c.polygonOffsetFactor,c.polygonOffsetUnits)}Oe.renderImmediateObject(i,n,r,c,l)}}function A(t){var e=t.object,i=e.material;i.transparent?(t.transparent=i,t.opaque=null):(t.opaque=i,t.transparent=null)}function D(t){var e=t.object,i=t.buffer,n,r,o;o=e.material,o instanceof THREE.MeshFaceMaterial?(r=i.materialIndex,n=o.materials[r],n.transparent?(t.transparent=n,t.opaque=null):(t.opaque=n,t.transparent=null)):(n=o,n&&(n.transparent?(t.transparent=n,t.opaque=null):(t.opaque=n,t.transparent=null)))}function P(t,e){var i,n,r,o,a,s,l={},c=t.morphTargets.length,h=t.morphNormals.length,u=e instanceof THREE.MeshFaceMaterial;for(t.geometryGroups={},i=0,n=t.faces.length;n>i;i++)r=t.faces[i],o=u?r.materialIndex:0,void 0===l[o]&&(l[o]={hash:o,counter:0}),s=l[o].hash+"_"+l[o].counter,void 0===t.geometryGroups[s]&&(t.geometryGroups[s]={faces3:[],faces4:[],materialIndex:o,vertices:0,numMorphTargets:c,numMorphNormals:h}),a=r instanceof THREE.Face3?3:4,t.geometryGroups[s].vertices+a>65535&&(l[o].counter+=1,s=l[o].hash+"_"+l[o].counter,void 0===t.geometryGroups[s]&&(t.geometryGroups[s]={faces3:[],faces4:[],materialIndex:o,vertices:0,numMorphTargets:c,numMorphNormals:h})),r instanceof THREE.Face3?t.geometryGroups[s].faces3.push(i):t.geometryGroups[s].faces4.push(i),t.geometryGroups[s].vertices+=a;t.geometryGroupsList=[];for(var f in t.geometryGroups)t.geometryGroups[f].id=qe++,t.geometryGroupsList.push(t.geometryGroups[f])}function k(t,o){var a,u,f,d;if(void 0===t.__webglInit)if(t.__webglInit=!0,t._modelViewMatrix=new THREE.Matrix4,t._normalMatrix=new THREE.Matrix3,void 0!==t.geometry&&void 0===t.geometry.__webglInit&&(t.geometry.__webglInit=!0,t.geometry.addEventListener("dispose",Yi)),u=t.geometry,void 0===u);else if(u instanceof THREE.BufferGeometry)g(u);else if(t instanceof THREE.Mesh){f=t.material,void 0===u.geometryGroups&&P(u,f);for(a in u.geometryGroups)d=u.geometryGroups[a],d.__webglVertexBuffer||(r(d),h(d,t),u.verticesNeedUpdate=!0,u.morphTargetsNeedUpdate=!0,u.elementsNeedUpdate=!0,u.uvsNeedUpdate=!0,u.normalsNeedUpdate=!0,u.tangentsNeedUpdate=!0,u.colorsNeedUpdate=!0)}else t instanceof THREE.Ribbon?u.__webglVertexBuffer||(n(u),c(u,t),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0,u.normalsNeedUpdate=!0):t instanceof THREE.Line?u.__webglVertexBuffer||(i(u),l(u,t),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0,u.lineDistancesNeedUpdate=!0):t instanceof THREE.ParticleSystem&&(u.__webglVertexBuffer||(e(u),s(u,t),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0));if(void 0===t.__webglActive){if(t instanceof THREE.Mesh){if(u=t.geometry,u instanceof THREE.BufferGeometry)L(o.__webglObjects,u,t);else if(u instanceof THREE.Geometry)for(a in u.geometryGroups)d=u.geometryGroups[a],L(o.__webglObjects,d,t)}else t instanceof THREE.Ribbon||t instanceof THREE.Line||t instanceof THREE.ParticleSystem?(u=t.geometry,L(o.__webglObjects,u,t)):t instanceof THREE.ImmediateRenderObject||t.immediateRenderCallback?N(o.__webglObjectsImmediate,t):t instanceof THREE.Sprite?o.__webglSprites.push(t):t instanceof THREE.LensFlare&&o.__webglFlares.push(t);t.__webglActive=!0}}function L(t,e,i){t.push({buffer:e,object:i,opaque:null,transparent:null})}function N(t,e){t.push({object:e,opaque:null,transparent:null})}function F(t){var e=t.geometry,i,n,r;if(e instanceof THREE.BufferGeometry)T(e,Ti.DYNAMIC_DRAW,!e.dynamic);else if(t instanceof THREE.Mesh){for(var o=0,a=e.geometryGroupsList.length;a>o;o++)i=e.geometryGroupsList[o],r=u(t,i),e.buffersNeedUpdate&&h(i,t),n=r.attributes&&I(r),(e.verticesNeedUpdate||e.morphTargetsNeedUpdate||e.elementsNeedUpdate||e.uvsNeedUpdate||e.normalsNeedUpdate||e.colorsNeedUpdate||e.tangentsNeedUpdate||n)&&x(i,t,Ti.DYNAMIC_DRAW,!e.dynamic,r);e.verticesNeedUpdate=!1,e.morphTargetsNeedUpdate=!1,e.elementsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.tangentsNeedUpdate=!1,e.buffersNeedUpdate=!1,r.attributes&&z(r)}else t instanceof THREE.Ribbon?(r=u(t,e),n=r.attributes&&I(r),(e.verticesNeedUpdate||e.colorsNeedUpdate||e.normalsNeedUpdate||n)&&y(e,Ti.DYNAMIC_DRAW),e.verticesNeedUpdate=!1,e.colorsNeedUpdate=!1,e.normalsNeedUpdate=!1,r.attributes&&z(r)):t instanceof THREE.Line?(r=u(t,e),n=r.attributes&&I(r),(e.verticesNeedUpdate||e.colorsNeedUpdate||e.lineDistancesNeedUpdate||n)&&E(e,Ti.DYNAMIC_DRAW),e.verticesNeedUpdate=!1,e.colorsNeedUpdate=!1,e.lineDistancesNeedUpdate=!1,r.attributes&&z(r)):t instanceof THREE.ParticleSystem&&(r=u(t,e),n=r.attributes&&I(r),(e.verticesNeedUpdate||e.colorsNeedUpdate||t.sortParticles||n)&&v(e,Ti.DYNAMIC_DRAW,t),e.verticesNeedUpdate=!1,e.colorsNeedUpdate=!1,r.attributes&&z(r))}function I(t){for(var e in t.attributes)if(t.attributes[e].needsUpdate)return!0;return!1}function z(t){for(var e in t.attributes)t.attributes[e].needsUpdate=!1}function O(t,e){t instanceof THREE.Mesh||t instanceof THREE.ParticleSystem||t instanceof THREE.Ribbon||t instanceof THREE.Line?U(e.__webglObjects,t):t instanceof THREE.Sprite?B(e.__webglSprites,t):t instanceof THREE.LensFlare?B(e.__webglFlares,t):(t instanceof THREE.ImmediateRenderObject||t.immediateRenderCallback)&&U(e.__webglObjectsImmediate,t),delete t.__webglActive}function U(t,e){for(var i=t.length-1;i>=0;i--)t[i].object===e&&t.splice(i,1)}function B(t,e){for(var i=t.length-1;i>=0;i--)t[i]===e&&t.splice(i,1)}function V(t,e){t.uniforms=THREE.UniformsUtils.clone(e.uniforms),t.vertexShader=e.vertexShader,t.fragmentShader=e.fragmentShader}function W(t,e,i,n,r){Ye=0,n.needsUpdate&&(n.program&&en(n),Oe.initMaterial(n,e,i,r),n.needsUpdate=!1),n.morphTargets&&(r.__webglMorphTargetInfluences||(r.__webglMorphTargetInfluences=new Float32Array(Oe.maxMorphTargets)));var o=!1,a=n.program,s=a.uniforms,l=n.uniforms;if(a!==Ve&&(Ti.useProgram(a),Ve=a,o=!0),n.id!==je&&(je=n.id,o=!0),(o||t!==Xe)&&(Ti.uniformMatrix4fv(s.projectionMatrix,!1,t.projectionMatrix.elements),t!==Xe&&(Xe=t)),n.skinning)if(Pi&&r.useVertexTexture){if(null!==s.boneTexture){var c=ee();Ti.uniform1i(s.boneTexture,c),Oe.setTexture(r.boneTexture,c)}}else null!==s.boneGlobalMatrices&&Ti.uniformMatrix4fv(s.boneGlobalMatrices,!1,r.boneMatrices);return o&&(i&&n.fog&&Y(l,i),(n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n.lights)&&(yi&&(ae(a,e),yi=!1),Z(l,xi)),(n instanceof THREE.MeshBasicMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.MeshPhongMaterial)&&j(l,n),n instanceof THREE.LineBasicMaterial?G(l,n):n instanceof THREE.LineDashedMaterial?(G(l,n),X(l,n)):n instanceof THREE.ParticleBasicMaterial?q(l,n):n instanceof THREE.MeshPhongMaterial?K(l,n):n instanceof THREE.MeshLambertMaterial?Q(l,n):n instanceof THREE.MeshDepthMaterial?(l.mNear.value=t.near,l.mFar.value=t.far,l.opacity.value=n.opacity):n instanceof THREE.MeshNormalMaterial&&(l.opacity.value=n.opacity),r.receiveShadow&&!n._shadowPass&&J(l,e),ie(a,n.uniformsList),(n instanceof THREE.ShaderMaterial||n instanceof THREE.MeshPhongMaterial||n.envMap)&&null!==s.cameraPosition&&(vi.getPositionFromMatrix(t.matrixWorld),Ti.uniform3f(s.cameraPosition,vi.x,vi.y,vi.z)),(n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.ShaderMaterial||n.skinning)&&null!==s.viewMatrix&&Ti.uniformMatrix4fv(s.viewMatrix,!1,t.matrixWorldInverse.elements)),te(s,r),null!==s.modelMatrix&&Ti.uniformMatrix4fv(s.modelMatrix,!1,r.matrixWorld.elements),a}function j(t,e){t.opacity.value=e.opacity,Oe.gammaInput?t.diffuse.value.copyGammaToLinear(e.color):t.diffuse.value=e.color,t.map.value=e.map,t.lightMap.value=e.lightMap,t.specularMap.value=e.specularMap,e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale));var i;if(e.map?i=e.map:e.specularMap?i=e.specularMap:e.normalMap?i=e.normalMap:e.bumpMap&&(i=e.bumpMap),void 0!==i){var n=i.offset,r=i.repeat;t.offsetRepeat.value.set(n.x,n.y,r.x,r.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,t.reflectivity.value=Oe.gammaInput?e.reflectivity:e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.combine.value=e.combine,t.useRefract.value=e.envMap&&e.envMap.mapping instanceof THREE.CubeRefractionMapping}function G(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function X(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function q(t,e){t.psColor.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size,t.scale.value=Ae.height/2,t.map.value=e.map}function Y(t,e){t.fogColor.value=e.color,e instanceof THREE.Fog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e instanceof THREE.FogExp2&&(t.fogDensity.value=e.density)}function K(t,e){t.shininess.value=e.shininess,Oe.gammaInput?(t.ambient.value.copyGammaToLinear(e.ambient),t.emissive.value.copyGammaToLinear(e.emissive),t.specular.value.copyGammaToLinear(e.specular)):(t.ambient.value=e.ambient,t.emissive.value=e.emissive,t.specular.value=e.specular),e.wrapAround&&t.wrapRGB.value.copy(e.wrapRGB)}function Q(t,e){Oe.gammaInput?(t.ambient.value.copyGammaToLinear(e.ambient),t.emissive.value.copyGammaToLinear(e.emissive)):(t.ambient.value=e.ambient,t.emissive.value=e.emissive),e.wrapAround&&t.wrapRGB.value.copy(e.wrapRGB)}function Z(t,e){t.ambientLightColor.value=e.ambient,t.directionalLightColor.value=e.directional.colors,t.directionalLightDirection.value=e.directional.positions,t.pointLightColor.value=e.point.colors,t.pointLightPosition.value=e.point.positions,t.pointLightDistance.value=e.point.distances,t.spotLightColor.value=e.spot.colors,t.spotLightPosition.value=e.spot.positions,t.spotLightDistance.value=e.spot.distances,t.spotLightDirection.value=e.spot.directions,t.spotLightAngleCos.value=e.spot.anglesCos,t.spotLightExponent.value=e.spot.exponents,t.hemisphereLightSkyColor.value=e.hemi.skyColors,t.hemisphereLightGroundColor.value=e.hemi.groundColors,t.hemisphereLightDirection.value=e.hemi.positions}function J(t,e){if(t.shadowMatrix)for(var i=0,n=0,r=e.length;r>n;n++){var o=e[n];o.castShadow&&(o instanceof THREE.SpotLight||o instanceof THREE.DirectionalLight&&!o.shadowCascade)&&(t.shadowMap.value[i]=o.shadowMap,t.shadowMapSize.value[i]=o.shadowMapSize,t.shadowMatrix.value[i]=o.shadowMatrix,t.shadowDarkness.value[i]=o.shadowDarkness,t.shadowBias.value[i]=o.shadowBias,i++)
}}function te(t,e){Ti.uniformMatrix4fv(t.modelViewMatrix,!1,e._modelViewMatrix.elements),t.normalMatrix&&Ti.uniformMatrix3fv(t.normalMatrix,!1,e._normalMatrix.elements)}function ee(){var t=Ye;return t>=Hi&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+Hi),Ye+=1,t}function ie(t,e){var i,n,r,o,a,s,l,c,h,u,f;for(h=0,u=e.length;u>h;h++)if(o=t.uniforms[e[h][1]])if(i=e[h][0],r=i.type,n=i.value,"i"===r)Ti.uniform1i(o,n);else if("f"===r)Ti.uniform1f(o,n);else if("v2"===r)Ti.uniform2f(o,n.x,n.y);else if("v3"===r)Ti.uniform3f(o,n.x,n.y,n.z);else if("v4"===r)Ti.uniform4f(o,n.x,n.y,n.z,n.w);else if("c"===r)Ti.uniform3f(o,n.r,n.g,n.b);else if("iv1"===r)Ti.uniform1iv(o,n);else if("iv"===r)Ti.uniform3iv(o,n);else if("fv1"===r)Ti.uniform1fv(o,n);else if("fv"===r)Ti.uniform3fv(o,n);else if("v2v"===r){for(void 0===i._array&&(i._array=new Float32Array(2*n.length)),l=0,c=n.length;c>l;l++)f=2*l,i._array[f]=n[l].x,i._array[f+1]=n[l].y;Ti.uniform2fv(o,i._array)}else if("v3v"===r){for(void 0===i._array&&(i._array=new Float32Array(3*n.length)),l=0,c=n.length;c>l;l++)f=3*l,i._array[f]=n[l].x,i._array[f+1]=n[l].y,i._array[f+2]=n[l].z;Ti.uniform3fv(o,i._array)}else if("v4v"===r){for(void 0===i._array&&(i._array=new Float32Array(4*n.length)),l=0,c=n.length;c>l;l++)f=4*l,i._array[f]=n[l].x,i._array[f+1]=n[l].y,i._array[f+2]=n[l].z,i._array[f+3]=n[l].w;Ti.uniform4fv(o,i._array)}else if("m4"===r)void 0===i._array&&(i._array=new Float32Array(16)),n.flattenToArray(i._array),Ti.uniformMatrix4fv(o,!1,i._array);else if("m4v"===r){for(void 0===i._array&&(i._array=new Float32Array(16*n.length)),l=0,c=n.length;c>l;l++)n[l].flattenToArrayOffset(i._array,16*l);Ti.uniformMatrix4fv(o,!1,i._array)}else if("t"===r){if(a=n,s=ee(),Ti.uniform1i(o,s),!a)continue;a.image instanceof Array&&6===a.image.length?Ee(a,s):a instanceof THREE.WebGLRenderTargetCube?ye(a,s):Oe.setTexture(a,s)}else if("tv"===r){for(void 0===i._array&&(i._array=[]),l=0,c=i.value.length;c>l;l++)i._array[l]=ee();for(Ti.uniform1iv(o,i._array),l=0,c=i.value.length;c>l;l++)a=i.value[l],s=i._array[l],a&&Oe.setTexture(a,s)}}function ne(t,e){t._modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,t.matrixWorld),t._normalMatrix.getNormalMatrix(t._modelViewMatrix)}function re(t,e,i,n){t[e]=i.r*i.r*n,t[e+1]=i.g*i.g*n,t[e+2]=i.b*i.b*n}function oe(t,e,i,n){t[e]=i.r*n,t[e+1]=i.g*n,t[e+2]=i.b*n}function ae(t,e){var i,n,r,o,a=0,s=0,l=0,c,h,u,f,d,p,m,g=xi,v=g.directional.colors,E=g.directional.positions,y=g.point.colors,x=g.point.positions,T=g.point.distances,b=g.spot.colors,_=g.spot.positions,w=g.spot.distances,R=g.spot.directions,H=g.spot.anglesCos,M=g.spot.exponents,S=g.hemi.skyColors,C=g.hemi.groundColors,A=g.hemi.positions,D=0,P=0,k=0,L=0,N=0,F=0,I=0,z=0,O=0,U=0,B=0,V=0;for(i=0,n=e.length;n>i;i++)if(r=e[i],!r.onlyShadow)if(c=r.color,f=r.intensity,m=r.distance,r instanceof THREE.AmbientLight){if(!r.visible)continue;Oe.gammaInput?(a+=c.r*c.r,s+=c.g*c.g,l+=c.b*c.b):(a+=c.r,s+=c.g,l+=c.b)}else if(r instanceof THREE.DirectionalLight){if(N+=1,!r.visible)continue;if(Ei.getPositionFromMatrix(r.matrixWorld),vi.getPositionFromMatrix(r.target.matrixWorld),Ei.sub(vi),Ei.normalize(),0===Ei.x&&0===Ei.y&&0===Ei.z)continue;O=3*D,E[O]=Ei.x,E[O+1]=Ei.y,E[O+2]=Ei.z,Oe.gammaInput?re(v,O,c,f*f):oe(v,O,c,f),D+=1}else if(r instanceof THREE.PointLight){if(F+=1,!r.visible)continue;U=3*P,Oe.gammaInput?re(y,U,c,f*f):oe(y,U,c,f),vi.getPositionFromMatrix(r.matrixWorld),x[U]=vi.x,x[U+1]=vi.y,x[U+2]=vi.z,T[P]=m,P+=1}else if(r instanceof THREE.SpotLight){if(I+=1,!r.visible)continue;B=3*k,Oe.gammaInput?re(b,B,c,f*f):oe(b,B,c,f),vi.getPositionFromMatrix(r.matrixWorld),_[B]=vi.x,_[B+1]=vi.y,_[B+2]=vi.z,w[k]=m,Ei.copy(vi),vi.getPositionFromMatrix(r.target.matrixWorld),Ei.sub(vi),Ei.normalize(),R[B]=Ei.x,R[B+1]=Ei.y,R[B+2]=Ei.z,H[k]=Math.cos(r.angle),M[k]=r.exponent,k+=1}else if(r instanceof THREE.HemisphereLight){if(z+=1,!r.visible)continue;if(Ei.getPositionFromMatrix(r.matrixWorld),Ei.normalize(),0===Ei.x&&0===Ei.y&&0===Ei.z)continue;V=3*L,A[V]=Ei.x,A[V+1]=Ei.y,A[V+2]=Ei.z,h=r.color,u=r.groundColor,Oe.gammaInput?(d=f*f,re(S,V,h,d),re(C,V,u,d)):(oe(S,V,h,f),oe(C,V,u,f)),L+=1}for(i=3*D,n=Math.max(v.length,3*N);n>i;i++)v[i]=0;for(i=3*P,n=Math.max(y.length,3*F);n>i;i++)y[i]=0;for(i=3*k,n=Math.max(b.length,3*I);n>i;i++)b[i]=0;for(i=3*L,n=Math.max(S.length,3*z);n>i;i++)S[i]=0;for(i=3*L,n=Math.max(C.length,3*z);n>i;i++)C[i]=0;g.directional.length=D,g.point.length=P,g.spot.length=k,g.hemi.length=L,g.ambient[0]=a,g.ambient[1]=s,g.ambient[2]=l}function se(t){t!==ai&&(Ti.lineWidth(t),ai=t)}function le(t,e,i){ni!==t&&(t?Ti.enable(Ti.POLYGON_OFFSET_FILL):Ti.disable(Ti.POLYGON_OFFSET_FILL),ni=t),!t||ri===e&&oi===i||(Ti.polygonOffset(e,i),ri=e,oi=i)}function ce(t){var e,i,n=[];for(var r in t)e=t[r],e!==!1&&(i="#define "+r+" "+e,n.push(i));return n.join("\n")}function he(t,e,i,n,r,o,a){var s,l,c,h,u,f=[];t?f.push(t):(f.push(e),f.push(i));for(c in o)f.push(c),f.push(o[c]);for(s in a)f.push(s),f.push(a[s]);for(u=f.join(),s=0,l=Ue.length;l>s;s++){var d=Ue[s];if(d.code===u)return d.usedTimes++,d.program}var p="SHADOWMAP_TYPE_BASIC";a.shadowMapType===THREE.PCFShadowMap?p="SHADOWMAP_TYPE_PCF":a.shadowMapType===THREE.PCFSoftShadowMap&&(p="SHADOWMAP_TYPE_PCF_SOFT");var m=ce(o);h=Ti.createProgram();var g=["precision "+De+" float;",m,Di?"#define VERTEX_TEXTURES":"",Oe.gammaInput?"#define GAMMA_INPUT":"",Oe.gammaOutput?"#define GAMMA_OUTPUT":"",Oe.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,"#define MAX_BONES "+a.maxBones,a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.lightMap?"#define USE_LIGHTMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.vertexColors?"#define USE_COLOR":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.boneTextureWidth?"#define N_BONE_PIXEL_X "+a.boneTextureWidth.toFixed(1):"",a.boneTextureHeight?"#define N_BONE_PIXEL_Y "+a.boneTextureHeight.toFixed(1):"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals?"#define USE_MORPHNORMALS":"",a.perPixel?"#define PHONG_PER_PIXEL":"",a.wrapAround?"#define WRAP_AROUND":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+p:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",a.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","attribute vec3 morphTarget0;","attribute vec3 morphTarget1;","attribute vec3 morphTarget2;","attribute vec3 morphTarget3;","#ifdef USE_MORPHNORMALS","attribute vec3 morphNormal0;","attribute vec3 morphNormal1;","attribute vec3 morphNormal2;","attribute vec3 morphNormal3;","#else","attribute vec3 morphTarget4;","attribute vec3 morphTarget5;","attribute vec3 morphTarget6;","attribute vec3 morphTarget7;","#endif","#endif","#ifdef USE_SKINNING","attribute vec4 skinIndex;","attribute vec4 skinWeight;","#endif",""].join("\n"),v=["precision "+De+" float;",a.bumpMap||a.normalMap?"#extension GL_OES_standard_derivatives : enable":"",m,"#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,a.alphaTest?"#define ALPHATEST "+a.alphaTest:"",Oe.gammaInput?"#define GAMMA_INPUT":"",Oe.gammaOutput?"#define GAMMA_OUTPUT":"",Oe.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.lightMap?"#define USE_LIGHTMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.vertexColors?"#define USE_COLOR":"",a.metal?"#define METAL":"",a.perPixel?"#define PHONG_PER_PIXEL":"",a.wrapAround?"#define WRAP_AROUND":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+p:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",a.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n"),E=pe("vertex",g+i),y=pe("fragment",v+e);Ti.attachShader(h,E),Ti.attachShader(h,y),Ti.linkProgram(h),Ti.getProgramParameter(h,Ti.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+Ti.getProgramParameter(h,Ti.VALIDATE_STATUS)+", gl error ["+Ti.getError()+"]"),Ti.deleteShader(y),Ti.deleteShader(E),h.uniforms={},h.attributes={};var x,T,b,_;x=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences"],x.push(a.useVertexTexture?"boneTexture":"boneGlobalMatrices");for(T in n)x.push(T);for(ue(h,x),x=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"],_=0;_<a.maxMorphTargets;_++)x.push("morphTarget"+_);for(_=0;_<a.maxMorphNormals;_++)x.push("morphNormal"+_);for(b in r)x.push(b);return fe(h,x),h.id=Be++,Ue.push({program:h,code:u,usedTimes:1}),Oe.info.memory.programs=Ue.length,h}function ue(t,e){var i,n,r;for(i=0,n=e.length;n>i;i++)r=e[i],t.uniforms[r]=Ti.getUniformLocation(t,r)}function fe(t,e){var i,n,r;for(i=0,n=e.length;n>i;i++)r=e[i],t.attributes[r]=Ti.getAttribLocation(t,r)}function de(t){for(var e=t.split("\n"),i=0,n=e.length;n>i;i++)e[i]=i+1+": "+e[i];return e.join("\n")}function pe(t,e){var i;return"fragment"===t?i=Ti.createShader(Ti.FRAGMENT_SHADER):"vertex"===t&&(i=Ti.createShader(Ti.VERTEX_SHADER)),Ti.shaderSource(i,e),Ti.compileShader(i),Ti.getShaderParameter(i,Ti.COMPILE_STATUS)?i:(console.error(Ti.getShaderInfoLog(i)),console.error(de(e)),null)}function me(t){return 0===(t&t-1)}function ge(t,e,i){i?(Ti.texParameteri(t,Ti.TEXTURE_WRAP_S,we(e.wrapS)),Ti.texParameteri(t,Ti.TEXTURE_WRAP_T,we(e.wrapT)),Ti.texParameteri(t,Ti.TEXTURE_MAG_FILTER,we(e.magFilter)),Ti.texParameteri(t,Ti.TEXTURE_MIN_FILTER,we(e.minFilter))):(Ti.texParameteri(t,Ti.TEXTURE_WRAP_S,Ti.CLAMP_TO_EDGE),Ti.texParameteri(t,Ti.TEXTURE_WRAP_T,Ti.CLAMP_TO_EDGE),Ti.texParameteri(t,Ti.TEXTURE_MAG_FILTER,_e(e.magFilter)),Ti.texParameteri(t,Ti.TEXTURE_MIN_FILTER,_e(e.minFilter))),wi&&e.type!==THREE.FloatType&&(e.anisotropy>1||e.__oldAnisotropy)&&(Ti.texParameterf(t,wi.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,Ai)),e.__oldAnisotropy=e.anisotropy)}function ve(t,e){if(t.width<=e&&t.height<=e)return t;var i=Math.max(t.width,t.height),n=Math.floor(t.width*e/i),r=Math.floor(t.height*e/i),o=document.createElement("canvas");o.width=n,o.height=r;var a=o.getContext("2d");return a.drawImage(t,0,0,t.width,t.height,0,0,n,r),o}function Ee(t,e){if(6===t.image.length)if(t.needsUpdate){t.image.__webglTextureCube||(t.image.__webglTextureCube=Ti.createTexture(),Oe.info.memory.textures++),Ti.activeTexture(Ti.TEXTURE0+e),Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,t.image.__webglTextureCube),Ti.pixelStorei(Ti.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var i=t instanceof THREE.CompressedTexture,n=[],r=0;6>r;r++)n[r]=Oe.autoScaleCubemaps&&!i?ve(t.image[r],Ci):t.image[r];var o=n[0],a=me(o.width)&&me(o.height),s=we(t.format),l=we(t.type);ge(Ti.TEXTURE_CUBE_MAP,t,a);for(var r=0;6>r;r++)if(i)for(var c,h=n[r].mipmaps,u=0,f=h.length;f>u;u++)c=h[u],Ti.compressedTexImage2D(Ti.TEXTURE_CUBE_MAP_POSITIVE_X+r,u,s,c.width,c.height,0,c.data);else Ti.texImage2D(Ti.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,s,s,l,n[r]);t.generateMipmaps&&a&&Ti.generateMipmap(Ti.TEXTURE_CUBE_MAP),t.needsUpdate=!1,t.onUpdate&&t.onUpdate()}else Ti.activeTexture(Ti.TEXTURE0+e),Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,t.image.__webglTextureCube)}function ye(t,e){Ti.activeTexture(Ti.TEXTURE0+e),Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,t.__webglTexture)}function xe(t,e,i){Ti.bindFramebuffer(Ti.FRAMEBUFFER,t),Ti.framebufferTexture2D(Ti.FRAMEBUFFER,Ti.COLOR_ATTACHMENT0,i,e.__webglTexture,0)}function Te(t,e){Ti.bindRenderbuffer(Ti.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(Ti.renderbufferStorage(Ti.RENDERBUFFER,Ti.DEPTH_COMPONENT16,e.width,e.height),Ti.framebufferRenderbuffer(Ti.FRAMEBUFFER,Ti.DEPTH_ATTACHMENT,Ti.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(Ti.renderbufferStorage(Ti.RENDERBUFFER,Ti.DEPTH_STENCIL,e.width,e.height),Ti.framebufferRenderbuffer(Ti.FRAMEBUFFER,Ti.DEPTH_STENCIL_ATTACHMENT,Ti.RENDERBUFFER,t)):Ti.renderbufferStorage(Ti.RENDERBUFFER,Ti.RGBA4,e.width,e.height)}function be(t){t instanceof THREE.WebGLRenderTargetCube?(Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,t.__webglTexture),Ti.generateMipmap(Ti.TEXTURE_CUBE_MAP),Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,null)):(Ti.bindTexture(Ti.TEXTURE_2D,t.__webglTexture),Ti.generateMipmap(Ti.TEXTURE_2D),Ti.bindTexture(Ti.TEXTURE_2D,null))}function _e(t){return t===THREE.NearestFilter||t===THREE.NearestMipMapNearestFilter||t===THREE.NearestMipMapLinearFilter?Ti.NEAREST:Ti.LINEAR}function we(t){if(t===THREE.RepeatWrapping)return Ti.REPEAT;if(t===THREE.ClampToEdgeWrapping)return Ti.CLAMP_TO_EDGE;if(t===THREE.MirroredRepeatWrapping)return Ti.MIRRORED_REPEAT;if(t===THREE.NearestFilter)return Ti.NEAREST;if(t===THREE.NearestMipMapNearestFilter)return Ti.NEAREST_MIPMAP_NEAREST;if(t===THREE.NearestMipMapLinearFilter)return Ti.NEAREST_MIPMAP_LINEAR;if(t===THREE.LinearFilter)return Ti.LINEAR;if(t===THREE.LinearMipMapNearestFilter)return Ti.LINEAR_MIPMAP_NEAREST;if(t===THREE.LinearMipMapLinearFilter)return Ti.LINEAR_MIPMAP_LINEAR;if(t===THREE.UnsignedByteType)return Ti.UNSIGNED_BYTE;if(t===THREE.UnsignedShort4444Type)return Ti.UNSIGNED_SHORT_4_4_4_4;if(t===THREE.UnsignedShort5551Type)return Ti.UNSIGNED_SHORT_5_5_5_1;if(t===THREE.UnsignedShort565Type)return Ti.UNSIGNED_SHORT_5_6_5;if(t===THREE.ByteType)return Ti.BYTE;if(t===THREE.ShortType)return Ti.SHORT;if(t===THREE.UnsignedShortType)return Ti.UNSIGNED_SHORT;if(t===THREE.IntType)return Ti.INT;if(t===THREE.UnsignedIntType)return Ti.UNSIGNED_INT;if(t===THREE.FloatType)return Ti.FLOAT;if(t===THREE.AlphaFormat)return Ti.ALPHA;if(t===THREE.RGBFormat)return Ti.RGB;if(t===THREE.RGBAFormat)return Ti.RGBA;if(t===THREE.LuminanceFormat)return Ti.LUMINANCE;if(t===THREE.LuminanceAlphaFormat)return Ti.LUMINANCE_ALPHA;if(t===THREE.AddEquation)return Ti.FUNC_ADD;if(t===THREE.SubtractEquation)return Ti.FUNC_SUBTRACT;if(t===THREE.ReverseSubtractEquation)return Ti.FUNC_REVERSE_SUBTRACT;if(t===THREE.ZeroFactor)return Ti.ZERO;if(t===THREE.OneFactor)return Ti.ONE;if(t===THREE.SrcColorFactor)return Ti.SRC_COLOR;if(t===THREE.OneMinusSrcColorFactor)return Ti.ONE_MINUS_SRC_COLOR;if(t===THREE.SrcAlphaFactor)return Ti.SRC_ALPHA;if(t===THREE.OneMinusSrcAlphaFactor)return Ti.ONE_MINUS_SRC_ALPHA;if(t===THREE.DstAlphaFactor)return Ti.DST_ALPHA;if(t===THREE.OneMinusDstAlphaFactor)return Ti.ONE_MINUS_DST_ALPHA;if(t===THREE.DstColorFactor)return Ti.DST_COLOR;if(t===THREE.OneMinusDstColorFactor)return Ti.ONE_MINUS_DST_COLOR;if(t===THREE.SrcAlphaSaturateFactor)return Ti.SRC_ALPHA_SATURATE;if(void 0!==Ri){if(t===THREE.RGB_S3TC_DXT1_Format)return Ri.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===THREE.RGBA_S3TC_DXT1_Format)return Ri.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===THREE.RGBA_S3TC_DXT3_Format)return Ri.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===THREE.RGBA_S3TC_DXT5_Format)return Ri.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}function Re(t){if(Pi&&t&&t.useVertexTexture)return 1024;var e=Ti.getParameter(Ti.MAX_VERTEX_UNIFORM_VECTORS),i=Math.floor((e-20)/4),n=i;return void 0!==t&&t instanceof THREE.SkinnedMesh&&(n=Math.min(t.bones.length,n),n<t.bones.length&&console.warn("WebGLRenderer: too many bones - "+t.bones.length+", this GPU supports just "+n+" (try OpenGL instead of ANGLE)")),n}function He(t){var e,i,n,r,o,a,s;for(r=o=a=s=0,e=0,i=t.length;i>e;e++)n=t[e],n.onlyShadow||(n instanceof THREE.DirectionalLight&&r++,n instanceof THREE.PointLight&&o++,n instanceof THREE.SpotLight&&a++,n instanceof THREE.HemisphereLight&&s++);return{directional:r,point:o,spot:a,hemi:s}}function Me(t){var e,i,n,r=0;for(e=0,i=t.length;i>e;e++)n=t[e],n.castShadow&&(n instanceof THREE.SpotLight&&r++,n instanceof THREE.DirectionalLight&&!n.shadowCascade&&r++);return r}function Se(){try{if(!(Ti=Ae.getContext("experimental-webgl",{alpha:Pe,premultipliedAlpha:ke,antialias:Le,stencil:Ne,preserveDrawingBuffer:Fe})))throw"Error creating WebGL context."}catch(t){console.error(t)}bi=Ti.getExtension("OES_texture_float"),_i=Ti.getExtension("OES_standard_derivatives"),wi=Ti.getExtension("EXT_texture_filter_anisotropic")||Ti.getExtension("MOZ_EXT_texture_filter_anisotropic")||Ti.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),Ri=Ti.getExtension("WEBGL_compressed_texture_s3tc")||Ti.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||Ti.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),bi||console.log("THREE.WebGLRenderer: Float textures not supported."),_i||console.log("THREE.WebGLRenderer: Standard derivatives not supported."),wi||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported."),Ri||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported."),void 0===Ti.getShaderPrecisionFormat&&(Ti.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}function Ce(){Ti.clearColor(0,0,0,1),Ti.clearDepth(1),Ti.clearStencil(0),Ti.enable(Ti.DEPTH_TEST),Ti.depthFunc(Ti.LEQUAL),Ti.frontFace(Ti.CCW),Ti.cullFace(Ti.BACK),Ti.enable(Ti.CULL_FACE),Ti.enable(Ti.BLEND),Ti.blendEquation(Ti.FUNC_ADD),Ti.blendFunc(Ti.SRC_ALPHA,Ti.ONE_MINUS_SRC_ALPHA),Ti.clearColor(Ie.r,Ie.g,Ie.b,ze)}console.log("THREE.WebGLRenderer",THREE.REVISION),t=t||{};var Ae=void 0!==t.canvas?t.canvas:document.createElement("canvas"),De=void 0!==t.precision?t.precision:"highp",Pe=void 0!==t.alpha?t.alpha:!0,ke=void 0!==t.premultipliedAlpha?t.premultipliedAlpha:!0,Le=void 0!==t.antialias?t.antialias:!1,Ne=void 0!==t.stencil?t.stencil:!0,Fe=void 0!==t.preserveDrawingBuffer?t.preserveDrawingBuffer:!1,Ie=new THREE.Color(0),ze=0;void 0!==t.clearColor&&(console.warn("DEPRECATED: clearColor in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),Ie.setHex(t.clearColor)),void 0!==t.clearAlpha&&(console.warn("DEPRECATED: clearAlpha in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),ze=t.clearAlpha),this.domElement=Ae,this.context=null,this.devicePixelRatio=void 0!==t.devicePixelRatio?t.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.autoUpdateObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyBasedShading=!1,this.shadowMapEnabled=!1,this.shadowMapAutoUpdate=!0,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.renderPluginsPre=[],this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var Oe=this,Ue=[],Be=0,Ve=null,We=null,je=-1,Ge=null,Xe=null,qe=0,Ye=0,Ke=-1,$e=-1,Qe=-1,Ze=-1,Je=-1,ti=-1,ei=-1,ii=-1,ni=null,ri=null,oi=null,ai=null,si=0,li=0,ci=0,hi=0,ui=0,fi=0,di={},pi=new THREE.Frustum,mi=new THREE.Matrix4,gi=new THREE.Matrix4,vi=new THREE.Vector3,Ei=new THREE.Vector3,yi=!0,xi={ambient:[0,0,0],directional:{length:0,colors:new Array,positions:new Array},point:{length:0,colors:new Array,positions:new Array,distances:new Array},spot:{length:0,colors:new Array,positions:new Array,distances:new Array,directions:new Array,anglesCos:new Array,exponents:new Array},hemi:{length:0,skyColors:new Array,groundColors:new Array,positions:new Array}},Ti,bi,_i,wi,Ri;Se(),Ce(),this.context=Ti;var Hi=Ti.getParameter(Ti.MAX_TEXTURE_IMAGE_UNITS),Mi=Ti.getParameter(Ti.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Si=Ti.getParameter(Ti.MAX_TEXTURE_SIZE),Ci=Ti.getParameter(Ti.MAX_CUBE_MAP_TEXTURE_SIZE),Ai=wi?Ti.getParameter(wi.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,Di=Mi>0,Pi=Di&&bi,ki=Ri?Ti.getParameter(Ti.COMPRESSED_TEXTURE_FORMATS):[],Li=Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.HIGH_FLOAT),Ni=Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.MEDIUM_FLOAT),Fi=Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.LOW_FLOAT),Ii=Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.HIGH_FLOAT),zi=Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.MEDIUM_FLOAT),Oi=Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.LOW_FLOAT),Ui=Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.HIGH_INT),Bi=Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.MEDIUM_INT),Vi=Ti.getShaderPrecisionFormat(Ti.VERTEX_SHADER,Ti.LOW_INT),Wi=Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.HIGH_INT),ji=Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.MEDIUM_INT),Gi=Ti.getShaderPrecisionFormat(Ti.FRAGMENT_SHADER,Ti.LOW_INT),Xi=Li.precision>0&&Ii.precision>0,qi=Ni.precision>0&&zi.precision>0;"highp"!==De||Xi||(qi?(De="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(De="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==De||qi||(De="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),this.getContext=function(){return Ti},this.supportsVertexTextures=function(){return Di},this.supportsFloatTextures=function(){return bi},this.supportsStandardDerivatives=function(){return _i},this.supportsCompressedTextureS3TC=function(){return Ri},this.getMaxAnisotropy=function(){return Ai},this.getPrecision=function(){return De},this.setSize=function(t,e,i){Ae.width=t*this.devicePixelRatio,Ae.height=e*this.devicePixelRatio,1!==this.devicePixelRatio&&i!==!1&&(Ae.style.width=t+"px",Ae.style.height=e+"px"),this.setViewport(0,0,Ae.width,Ae.height)},this.setViewport=function(t,e,i,n){si=void 0!==t?t:0,li=void 0!==e?e:0,ci=void 0!==i?i:Ae.width,hi=void 0!==n?n:Ae.height,Ti.viewport(si,li,ci,hi)},this.setScissor=function(t,e,i,n){Ti.scissor(t,e,i,n)},this.enableScissorTest=function(t){t?Ti.enable(Ti.SCISSOR_TEST):Ti.disable(Ti.SCISSOR_TEST)},this.setClearColor=function(t,e){Ie.set(t),ze=void 0!==e?e:1,Ti.clearColor(Ie.r,Ie.g,Ie.b,ze)},this.setClearColorHex=function(t,e){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(t,e)},this.getClearColor=function(){return Ie},this.getClearAlpha=function(){return ze},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=Ti.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=Ti.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=Ti.STENCIL_BUFFER_BIT),Ti.clear(n)},this.clearTarget=function(t,e,i,n){this.setRenderTarget(t),this.clear(e,i,n)},this.addPostPlugin=function(t){t.init(this),this.renderPluginsPost.push(t)},this.addPrePlugin=function(t){t.init(this),this.renderPluginsPre.push(t)},this.updateShadowMap=function(t,e){Ve=null,Qe=-1,ei=-1,ii=-1,Ge=-1,je=-1,yi=!0,Ke=-1,$e=-1,this.shadowMapPlugin.update(t,e)};var Yi=function(t){var e=t.target;e.removeEventListener("dispose",Yi),Zi(e),Oe.info.memory.geometries--},Ki=function(t){var e=t.target;e.removeEventListener("dispose",Ki),Ji(e),Oe.info.memory.textures--},$i=function(t){var e=t.target;e.removeEventListener("dispose",$i),tn(e),Oe.info.memory.textures--},Qi=function(t){var e=t.target;e.removeEventListener("dispose",Qi),en(e)},Zi=function(t){if(t.__webglInit=void 0,void 0!==t.__webglVertexBuffer&&Ti.deleteBuffer(t.__webglVertexBuffer),void 0!==t.__webglNormalBuffer&&Ti.deleteBuffer(t.__webglNormalBuffer),void 0!==t.__webglTangentBuffer&&Ti.deleteBuffer(t.__webglTangentBuffer),void 0!==t.__webglColorBuffer&&Ti.deleteBuffer(t.__webglColorBuffer),void 0!==t.__webglUVBuffer&&Ti.deleteBuffer(t.__webglUVBuffer),void 0!==t.__webglUV2Buffer&&Ti.deleteBuffer(t.__webglUV2Buffer),void 0!==t.__webglSkinIndicesBuffer&&Ti.deleteBuffer(t.__webglSkinIndicesBuffer),void 0!==t.__webglSkinWeightsBuffer&&Ti.deleteBuffer(t.__webglSkinWeightsBuffer),void 0!==t.__webglFaceBuffer&&Ti.deleteBuffer(t.__webglFaceBuffer),void 0!==t.__webglLineBuffer&&Ti.deleteBuffer(t.__webglLineBuffer),void 0!==t.__webglLineDistanceBuffer&&Ti.deleteBuffer(t.__webglLineDistanceBuffer),void 0!==t.geometryGroups)for(var e in t.geometryGroups){var i=t.geometryGroups[e];if(void 0!==i.numMorphTargets)for(var n=0,r=i.numMorphTargets;r>n;n++)Ti.deleteBuffer(i.__webglMorphTargetsBuffers[n]);if(void 0!==i.numMorphNormals)for(var n=0,r=i.numMorphNormals;r>n;n++)Ti.deleteBuffer(i.__webglMorphNormalsBuffers[n]);o(i)}o(t)},Ji=function(t){if(t.image&&t.image.__webglTextureCube)Ti.deleteTexture(t.image.__webglTextureCube);else{if(!t.__webglInit)return;t.__webglInit=!1,Ti.deleteTexture(t.__webglTexture)}},tn=function(t){if(t&&t.__webglTexture)if(Ti.deleteTexture(t.__webglTexture),t instanceof THREE.WebGLRenderTargetCube)for(var e=0;6>e;e++)Ti.deleteFramebuffer(t.__webglFramebuffer[e]),Ti.deleteRenderbuffer(t.__webglRenderbuffer[e]);else Ti.deleteFramebuffer(t.__webglFramebuffer),Ti.deleteRenderbuffer(t.__webglRenderbuffer)},en=function(t){var e=t.program;if(void 0!==e){t.program=void 0;var i,n,r,o=!1;for(i=0,n=Ue.length;n>i;i++)if(r=Ue[i],r.program===e){r.usedTimes--,0===r.usedTimes&&(o=!0);break}if(o===!0){var a=[];for(i=0,n=Ue.length;n>i;i++)r=Ue[i],r.program!==e&&a.push(r);Ue=a,Ti.deleteProgram(e),Oe.info.memory.programs--}}};this.renderBufferImmediate=function(t,e,i){if(t.hasPositions&&!t.__webglVertexBuffer&&(t.__webglVertexBuffer=Ti.createBuffer()),t.hasNormals&&!t.__webglNormalBuffer&&(t.__webglNormalBuffer=Ti.createBuffer()),t.hasUvs&&!t.__webglUvBuffer&&(t.__webglUvBuffer=Ti.createBuffer()),t.hasColors&&!t.__webglColorBuffer&&(t.__webglColorBuffer=Ti.createBuffer()),t.hasPositions&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglVertexBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,t.positionArray,Ti.DYNAMIC_DRAW),Ti.enableVertexAttribArray(e.attributes.position),Ti.vertexAttribPointer(e.attributes.position,3,Ti.FLOAT,!1,0,0)),t.hasNormals){if(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglNormalBuffer),i.shading===THREE.FlatShading){var n,r,o,a,s,l,c,h,u,f,d,p,m,g,v=3*t.count;for(g=0;v>g;g+=9)m=t.normalArray,a=m[g],c=m[g+1],f=m[g+2],s=m[g+3],h=m[g+4],d=m[g+5],l=m[g+6],u=m[g+7],p=m[g+8],n=(a+s+l)/3,r=(c+h+u)/3,o=(f+d+p)/3,m[g]=n,m[g+1]=r,m[g+2]=o,m[g+3]=n,m[g+4]=r,m[g+5]=o,m[g+6]=n,m[g+7]=r,m[g+8]=o}Ti.bufferData(Ti.ARRAY_BUFFER,t.normalArray,Ti.DYNAMIC_DRAW),Ti.enableVertexAttribArray(e.attributes.normal),Ti.vertexAttribPointer(e.attributes.normal,3,Ti.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglUvBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,t.uvArray,Ti.DYNAMIC_DRAW),Ti.enableVertexAttribArray(e.attributes.uv),Ti.vertexAttribPointer(e.attributes.uv,2,Ti.FLOAT,!1,0,0)),t.hasColors&&i.vertexColors!==THREE.NoColors&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,t.__webglColorBuffer),Ti.bufferData(Ti.ARRAY_BUFFER,t.colorArray,Ti.DYNAMIC_DRAW),Ti.enableVertexAttribArray(e.attributes.color),Ti.vertexAttribPointer(e.attributes.color,3,Ti.FLOAT,!1,0,0)),Ti.drawArrays(Ti.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,n,r,o){if(n.visible!==!1){var a,s,l,c,h,u,f,d,p,m,g;a=W(t,e,i,n,o),s=a.attributes,f=r.attributes;var v=!1,E=n.wireframe?1:0,y=16777215*r.id+2*a.id+E;if(y!==Ge&&(Ge=y,v=!0),v&&_(),o instanceof THREE.Mesh){var x=f.index;if(x){var T=r.offsets;T.length>1&&(v=!0);for(var w=0,R=T.length;R>w;w++){var H=T[w].index;if(v){for(p in f)"index"!==p&&(m=s[p],d=f[p],g=d.itemSize,m>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,d.buffer),b(m),Ti.vertexAttribPointer(m,g,Ti.FLOAT,!1,0,H*g*4)));Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,x.buffer)}Ti.drawElements(Ti.TRIANGLES,T[w].count,Ti.UNSIGNED_SHORT,2*T[w].start),Oe.info.render.calls++,Oe.info.render.vertices+=T[w].count,Oe.info.render.faces+=T[w].count/3}}else{if(v)for(p in f)"index"!==p&&(m=s[p],d=f[p],g=d.itemSize,m>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,d.buffer),b(m),Ti.vertexAttribPointer(m,g,Ti.FLOAT,!1,0,0)));var M=r.attributes.position;Ti.drawArrays(Ti.TRIANGLES,0,M.numItems/3),Oe.info.render.calls++,Oe.info.render.vertices+=M.numItems/3,Oe.info.render.faces+=M.numItems/3/3}}else if(o instanceof THREE.ParticleSystem){if(v){for(p in f)m=s[p],d=f[p],g=d.itemSize,m>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,d.buffer),b(m),Ti.vertexAttribPointer(m,g,Ti.FLOAT,!1,0,0));var M=f.position;Ti.drawArrays(Ti.POINTS,0,M.numItems/3),Oe.info.render.calls++,Oe.info.render.points+=M.numItems/3}}else if(o instanceof THREE.Line&&v){for(p in f)m=s[p],d=f[p],g=d.itemSize,m>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,d.buffer),b(m),Ti.vertexAttribPointer(m,g,Ti.FLOAT,!1,0,0));se(n.linewidth);var M=f.position;Ti.drawArrays(Ti.LINE_STRIP,0,M.numItems/3),Oe.info.render.calls++,Oe.info.render.points+=M.numItems}}},this.renderBuffer=function(t,e,i,n,r,o){if(n.visible!==!1){var a,s,l,c,h,u,f,d;a=W(t,e,i,n,o),s=a.attributes;var p=!1,m=n.wireframe?1:0,g=16777215*r.id+2*a.id+m;if(g!==Ge&&(Ge=g,p=!0),p&&_(),!n.morphTargets&&s.position>=0?p&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,r.__webglVertexBuffer),b(s.position),Ti.vertexAttribPointer(s.position,3,Ti.FLOAT,!1,0,0)):o.morphTargetBase&&w(n,r,o),p){if(r.__webglCustomAttributesList)for(f=0,d=r.__webglCustomAttributesList.length;d>f;f++)u=r.__webglCustomAttributesList[f],s[u.buffer.belongsToAttribute]>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,u.buffer),b(s[u.buffer.belongsToAttribute]),Ti.vertexAttribPointer(s[u.buffer.belongsToAttribute],u.size,Ti.FLOAT,!1,0,0));s.color>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,r.__webglColorBuffer),b(s.color),Ti.vertexAttribPointer(s.color,3,Ti.FLOAT,!1,0,0)),s.normal>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,r.__webglNormalBuffer),b(s.normal),Ti.vertexAttribPointer(s.normal,3,Ti.FLOAT,!1,0,0)),s.tangent>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,r.__webglTangentBuffer),b(s.tangent),Ti.vertexAttribPointer(s.tangent,4,Ti.FLOAT,!1,0,0)),s.uv>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,r.__webglUVBuffer),b(s.uv),Ti.vertexAttribPointer(s.uv,2,Ti.FLOAT,!1,0,0)),s.uv2>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,r.__webglUV2Buffer),b(s.uv2),Ti.vertexAttribPointer(s.uv2,2,Ti.FLOAT,!1,0,0)),n.skinning&&s.skinIndex>=0&&s.skinWeight>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,r.__webglSkinIndicesBuffer),b(s.skinIndex),Ti.vertexAttribPointer(s.skinIndex,4,Ti.FLOAT,!1,0,0),Ti.bindBuffer(Ti.ARRAY_BUFFER,r.__webglSkinWeightsBuffer),b(s.skinWeight),Ti.vertexAttribPointer(s.skinWeight,4,Ti.FLOAT,!1,0,0)),s.lineDistance>=0&&(Ti.bindBuffer(Ti.ARRAY_BUFFER,r.__webglLineDistanceBuffer),b(s.lineDistance),Ti.vertexAttribPointer(s.lineDistance,1,Ti.FLOAT,!1,0,0))}o instanceof THREE.Mesh?(n.wireframe?(se(n.wireframeLinewidth),p&&Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,r.__webglLineBuffer),Ti.drawElements(Ti.LINES,r.__webglLineCount,Ti.UNSIGNED_SHORT,0)):(p&&Ti.bindBuffer(Ti.ELEMENT_ARRAY_BUFFER,r.__webglFaceBuffer),Ti.drawElements(Ti.TRIANGLES,r.__webglFaceCount,Ti.UNSIGNED_SHORT,0)),Oe.info.render.calls++,Oe.info.render.vertices+=r.__webglFaceCount,Oe.info.render.faces+=r.__webglFaceCount/3):o instanceof THREE.Line?(c=o.type===THREE.LineStrip?Ti.LINE_STRIP:Ti.LINES,se(n.linewidth),Ti.drawArrays(c,0,r.__webglLineCount),Oe.info.render.calls++):o instanceof THREE.ParticleSystem?(Ti.drawArrays(Ti.POINTS,0,r.__webglParticleCount),Oe.info.render.calls++,Oe.info.render.points+=r.__webglParticleCount):o instanceof THREE.Ribbon&&(Ti.drawArrays(Ti.TRIANGLE_STRIP,0,r.__webglVertexCount),Oe.info.render.calls++)}},this.render=function(t,e,i,n){if(e instanceof THREE.Camera==!1)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");var r,o,a,s,l,c=t.__lights,h=t.fog;for(je=-1,yi=!0,t.autoUpdate===!0&&t.updateMatrixWorld(),void 0===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),mi.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),pi.setFromMatrix(mi),this.autoUpdateObjects&&this.initWebGLObjects(t),M(this.renderPluginsPre,t,e),Oe.info.render.calls=0,Oe.info.render.vertices=0,Oe.info.render.faces=0,Oe.info.render.points=0,this.setRenderTarget(i),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),l=t.__webglObjects,r=0,o=l.length;o>r;r++)a=l[r],s=a.object,a.id=r,a.render=!1,s.visible&&((s instanceof THREE.Mesh||s instanceof THREE.ParticleSystem)&&s.frustumCulled&&!pi.intersectsObject(s)||(ne(s,e),D(a),a.render=!0,this.sortObjects===!0&&(null!==s.renderDepth?a.z=s.renderDepth:(vi.getPositionFromMatrix(s.matrixWorld),vi.applyProjection(mi),a.z=vi.z))));
for(this.sortObjects&&l.sort(R),l=t.__webglObjectsImmediate,r=0,o=l.length;o>r;r++)a=l[r],s=a.object,s.visible&&(ne(s,e),A(a));if(t.overrideMaterial){var u=t.overrideMaterial;this.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst),this.setDepthTest(u.depthTest),this.setDepthWrite(u.depthWrite),le(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits),S(t.__webglObjects,!1,"",e,c,h,!0,u),C(t.__webglObjectsImmediate,"",e,c,h,!1,u)}else{var u=null;this.setBlending(THREE.NoBlending),S(t.__webglObjects,!0,"opaque",e,c,h,!1,u),C(t.__webglObjectsImmediate,"opaque",e,c,h,!1,u),S(t.__webglObjects,!1,"transparent",e,c,h,!0,u),C(t.__webglObjectsImmediate,"transparent",e,c,h,!0,u)}M(this.renderPluginsPost,t,e),i&&i.generateMipmaps&&i.minFilter!==THREE.NearestFilter&&i.minFilter!==THREE.LinearFilter&&be(i),this.setDepthTest(!0),this.setDepthWrite(!0)},this.renderImmediateObject=function(t,e,i,n,r){var o=W(t,e,i,n,r);Ge=-1,Oe.setMaterialFaces(n),r.immediateRenderCallback?r.immediateRenderCallback(o,Ti,pi):r.render(function(t){Oe.renderBufferImmediate(t,o,n)})},this.initWebGLObjects=function(t){for(t.__webglObjects||(t.__webglObjects=[],t.__webglObjectsImmediate=[],t.__webglSprites=[],t.__webglFlares=[]);t.__objectsAdded.length;)k(t.__objectsAdded[0],t),t.__objectsAdded.splice(0,1);for(;t.__objectsRemoved.length;)O(t.__objectsRemoved[0],t),t.__objectsRemoved.splice(0,1);for(var e=0,i=t.__webglObjects.length;i>e;e++){var n=t.__webglObjects[e].object;void 0===n.__webglInit&&(void 0!==n.__webglActive&&O(n,t),k(n,t)),F(n)}},this.initMaterial=function(t,e,i,n){t.addEventListener("dispose",Qi);var r,o,a,s,l,c,h,u,f;t instanceof THREE.MeshDepthMaterial?f="depth":t instanceof THREE.MeshNormalMaterial?f="normal":t instanceof THREE.MeshBasicMaterial?f="basic":t instanceof THREE.MeshLambertMaterial?f="lambert":t instanceof THREE.MeshPhongMaterial?f="phong":t instanceof THREE.LineBasicMaterial?f="basic":t instanceof THREE.LineDashedMaterial?f="dashed":t instanceof THREE.ParticleBasicMaterial&&(f="particle_basic"),f&&V(t,THREE.ShaderLib[f]),c=He(e),u=Me(e),h=Re(n),l={map:!!t.map,envMap:!!t.envMap,lightMap:!!t.lightMap,bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,specularMap:!!t.specularMap,vertexColors:t.vertexColors,fog:i,useFog:t.fog,fogExp:i instanceof THREE.FogExp2,sizeAttenuation:t.sizeAttenuation,skinning:t.skinning,maxBones:h,useVertexTexture:Pi&&n&&n.useVertexTexture,boneTextureWidth:n&&n.boneTextureWidth,boneTextureHeight:n&&n.boneTextureHeight,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:c.directional,maxPointLights:c.point,maxSpotLights:c.spot,maxHemiLights:c.hemi,maxShadows:u,shadowMapEnabled:this.shadowMapEnabled&&n.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:t.alphaTest,metal:t.metal,perPixel:t.perPixel,wrapAround:t.wrapAround,doubleSided:t.side===THREE.DoubleSide,flipSided:t.side===THREE.BackSide},t.program=he(f,t.fragmentShader,t.vertexShader,t.uniforms,t.attributes,t.defines,l);var d=t.program.attributes;if(t.morphTargets){t.numSupportedMorphTargets=0;var p,m="morphTarget";for(s=0;s<this.maxMorphTargets;s++)p=m+s,d[p]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;var p,m="morphNormal";for(s=0;s<this.maxMorphNormals;s++)p=m+s,d[p]>=0&&t.numSupportedMorphNormals++}t.uniformsList=[];for(r in t.uniforms)t.uniformsList.push([t.uniforms[r],r])},this.setFaceCulling=function(t,e){t===THREE.CullFaceNone?Ti.disable(Ti.CULL_FACE):(Ti.frontFace(e===THREE.FrontFaceDirectionCW?Ti.CW:Ti.CCW),Ti.cullFace(t===THREE.CullFaceBack?Ti.BACK:t===THREE.CullFaceFront?Ti.FRONT:Ti.FRONT_AND_BACK),Ti.enable(Ti.CULL_FACE))},this.setMaterialFaces=function(t){var e=t.side===THREE.DoubleSide,i=t.side===THREE.BackSide;Ke!==e&&(e?Ti.disable(Ti.CULL_FACE):Ti.enable(Ti.CULL_FACE),Ke=e),$e!==i&&(Ti.frontFace(i?Ti.CW:Ti.CCW),$e=i)},this.setDepthTest=function(t){ei!==t&&(t?Ti.enable(Ti.DEPTH_TEST):Ti.disable(Ti.DEPTH_TEST),ei=t)},this.setDepthWrite=function(t){ii!==t&&(Ti.depthMask(t),ii=t)},this.setBlending=function(t,e,i,n){t!==Qe&&(t===THREE.NoBlending?Ti.disable(Ti.BLEND):t===THREE.AdditiveBlending?(Ti.enable(Ti.BLEND),Ti.blendEquation(Ti.FUNC_ADD),Ti.blendFunc(Ti.SRC_ALPHA,Ti.ONE)):t===THREE.SubtractiveBlending?(Ti.enable(Ti.BLEND),Ti.blendEquation(Ti.FUNC_ADD),Ti.blendFunc(Ti.ZERO,Ti.ONE_MINUS_SRC_COLOR)):t===THREE.MultiplyBlending?(Ti.enable(Ti.BLEND),Ti.blendEquation(Ti.FUNC_ADD),Ti.blendFunc(Ti.ZERO,Ti.SRC_COLOR)):t===THREE.CustomBlending?Ti.enable(Ti.BLEND):(Ti.enable(Ti.BLEND),Ti.blendEquationSeparate(Ti.FUNC_ADD,Ti.FUNC_ADD),Ti.blendFuncSeparate(Ti.SRC_ALPHA,Ti.ONE_MINUS_SRC_ALPHA,Ti.ONE,Ti.ONE_MINUS_SRC_ALPHA)),Qe=t),t===THREE.CustomBlending?(e!==Ze&&(Ti.blendEquation(we(e)),Ze=e),(i!==Je||n!==ti)&&(Ti.blendFunc(we(i),we(n)),Je=i,ti=n)):(Ze=null,Je=null,ti=null)},this.setTexture=function(t,e){if(t.needsUpdate){t.__webglInit||(t.__webglInit=!0,t.addEventListener("dispose",Ki),t.__webglTexture=Ti.createTexture(),Oe.info.memory.textures++),Ti.activeTexture(Ti.TEXTURE0+e),Ti.bindTexture(Ti.TEXTURE_2D,t.__webglTexture),Ti.pixelStorei(Ti.UNPACK_FLIP_Y_WEBGL,t.flipY),Ti.pixelStorei(Ti.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Ti.pixelStorei(Ti.UNPACK_ALIGNMENT,t.unpackAlignment);var i=t.image,n=me(i.width)&&me(i.height),r=we(t.format),o=we(t.type);ge(Ti.TEXTURE_2D,t,n);var a,s=t.mipmaps;if(t instanceof THREE.DataTexture)if(s.length>0&&n){for(var l=0,c=s.length;c>l;l++)a=s[l],Ti.texImage2D(Ti.TEXTURE_2D,l,r,a.width,a.height,0,r,o,a.data);t.generateMipmaps=!1}else Ti.texImage2D(Ti.TEXTURE_2D,0,r,i.width,i.height,0,r,o,i.data);else if(t instanceof THREE.CompressedTexture)for(var l=0,c=s.length;c>l;l++)a=s[l],Ti.compressedTexImage2D(Ti.TEXTURE_2D,l,r,a.width,a.height,0,a.data);else if(s.length>0&&n){for(var l=0,c=s.length;c>l;l++)a=s[l],Ti.texImage2D(Ti.TEXTURE_2D,l,r,r,o,a);t.generateMipmaps=!1}else Ti.texImage2D(Ti.TEXTURE_2D,0,r,r,o,t.image);t.generateMipmaps&&n&&Ti.generateMipmap(Ti.TEXTURE_2D),t.needsUpdate=!1,t.onUpdate&&t.onUpdate()}else Ti.activeTexture(Ti.TEXTURE0+e),Ti.bindTexture(Ti.TEXTURE_2D,t.__webglTexture)},this.setRenderTarget=function(t){var e=t instanceof THREE.WebGLRenderTargetCube;if(t&&!t.__webglFramebuffer){void 0===t.depthBuffer&&(t.depthBuffer=!0),void 0===t.stencilBuffer&&(t.stencilBuffer=!0),t.addEventListener("dispose",$i),t.__webglTexture=Ti.createTexture(),Oe.info.memory.textures++;var i=me(t.width)&&me(t.height),n=we(t.format),r=we(t.type);if(e){t.__webglFramebuffer=[],t.__webglRenderbuffer=[],Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,t.__webglTexture),ge(Ti.TEXTURE_CUBE_MAP,t,i);for(var o=0;6>o;o++)t.__webglFramebuffer[o]=Ti.createFramebuffer(),t.__webglRenderbuffer[o]=Ti.createRenderbuffer(),Ti.texImage2D(Ti.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,n,t.width,t.height,0,n,r,null),xe(t.__webglFramebuffer[o],t,Ti.TEXTURE_CUBE_MAP_POSITIVE_X+o),Te(t.__webglRenderbuffer[o],t);i&&Ti.generateMipmap(Ti.TEXTURE_CUBE_MAP)}else t.__webglFramebuffer=Ti.createFramebuffer(),t.__webglRenderbuffer=t.shareDepthFrom?t.shareDepthFrom.__webglRenderbuffer:Ti.createRenderbuffer(),Ti.bindTexture(Ti.TEXTURE_2D,t.__webglTexture),ge(Ti.TEXTURE_2D,t,i),Ti.texImage2D(Ti.TEXTURE_2D,0,n,t.width,t.height,0,n,r,null),xe(t.__webglFramebuffer,t,Ti.TEXTURE_2D),t.shareDepthFrom?t.depthBuffer&&!t.stencilBuffer?Ti.framebufferRenderbuffer(Ti.FRAMEBUFFER,Ti.DEPTH_ATTACHMENT,Ti.RENDERBUFFER,t.__webglRenderbuffer):t.depthBuffer&&t.stencilBuffer&&Ti.framebufferRenderbuffer(Ti.FRAMEBUFFER,Ti.DEPTH_STENCIL_ATTACHMENT,Ti.RENDERBUFFER,t.__webglRenderbuffer):Te(t.__webglRenderbuffer,t),i&&Ti.generateMipmap(Ti.TEXTURE_2D);e?Ti.bindTexture(Ti.TEXTURE_CUBE_MAP,null):Ti.bindTexture(Ti.TEXTURE_2D,null),Ti.bindRenderbuffer(Ti.RENDERBUFFER,null),Ti.bindFramebuffer(Ti.FRAMEBUFFER,null)}var a,s,l,c,h;t?(a=e?t.__webglFramebuffer[t.activeCubeFace]:t.__webglFramebuffer,s=t.width,l=t.height,c=0,h=0):(a=null,s=ci,l=hi,c=si,h=li),a!==We&&(Ti.bindFramebuffer(Ti.FRAMEBUFFER,a),Ti.viewport(c,h,s,l),We=a),ui=s,fi=l},this.shadowMapPlugin=new THREE.ShadowMapPlugin,this.addPrePlugin(this.shadowMapPlugin),this.addPostPlugin(new THREE.SpritePlugin),this.addPostPlugin(new THREE.LensFlarePlugin)},THREE.WebGLRenderTarget=function(t,e,i){this.width=t,this.height=e,i=i||{},this.wrapS=void 0!==i.wrapS?i.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==i.wrapT?i.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==i.magFilter?i.magFilter:THREE.LinearFilter,this.minFilter=void 0!==i.minFilter?i.minFilter:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==i.format?i.format:THREE.RGBAFormat,this.type=void 0!==i.type?i.type:THREE.UnsignedByteType,this.depthBuffer=void 0!==i.depthBuffer?i.depthBuffer:!0,this.stencilBuffer=void 0!==i.stencilBuffer?i.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(){var t=new THREE.WebGLRenderTarget(this.width,this.height);return t.wrapS=this.wrapS,t.wrapT=this.wrapT,t.magFilter=this.magFilter,t.minFilter=this.minFilter,t.anisotropy=this.anisotropy,t.offset.copy(this.offset),t.repeat.copy(this.repeat),t.format=this.format,t.type=this.type,t.depthBuffer=this.depthBuffer,t.stencilBuffer=this.stencilBuffer,t.generateMipmaps=this.generateMipmaps,t.shareDepthFrom=this.shareDepthFrom,t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.WebGLRenderTargetCube=function(t,e,i){THREE.WebGLRenderTarget.call(this,t,e,i),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(t){this.positionWorld.copy(t.positionWorld),this.positionScreen.copy(t.positionScreen)},THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.color=null,this.material=null,this.uvs=[[]],this.z=null},THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.v4=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.color=null,this.material=null,this.uvs=[[]],this.z=null},THREE.RenderableObject=function(){this.object=null,this.z=null},THREE.RenderableParticle=function(){this.object=null,this.x=null,this.y=null,this.z=null,this.rotation=null,this.scale=new THREE.Vector2,this.material=null},THREE.RenderableLine=function(){this.z=null,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null},THREE.GeometryUtils={merge:function(t,e,i){var n,r,o=t.vertices.length,a=t.faceVertexUvs[0].length,s=e instanceof THREE.Mesh?e.geometry:e,l=t.vertices,c=s.vertices,h=t.faces,u=s.faces,f=t.faceVertexUvs[0],d=s.faceVertexUvs[0];void 0===i&&(i=0),e instanceof THREE.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,r=(new THREE.Matrix3).getNormalMatrix(n));for(var p=0,m=c.length;m>p;p++){var g=c[p],v=g.clone();n&&v.applyMatrix4(n),l.push(v)}for(p=0,m=u.length;m>p;p++){var E=u[p],y,x,T,b=E.vertexNormals,_=E.vertexColors;E instanceof THREE.Face3?y=new THREE.Face3(E.a+o,E.b+o,E.c+o):E instanceof THREE.Face4&&(y=new THREE.Face4(E.a+o,E.b+o,E.c+o,E.d+o)),y.normal.copy(E.normal),r&&y.normal.applyMatrix3(r).normalize();for(var w=0,R=b.length;R>w;w++)x=b[w].clone(),r&&x.applyMatrix3(r).normalize(),y.vertexNormals.push(x);y.color.copy(E.color);for(var w=0,R=_.length;R>w;w++)T=_[w],y.vertexColors.push(T.clone());y.materialIndex=E.materialIndex+i,y.centroid.copy(E.centroid),n&&y.centroid.applyMatrix4(n),h.push(y)}for(p=0,m=d.length;m>p;p++){for(var H=d[p],M=[],w=0,R=H.length;R>w;w++)M.push(new THREE.Vector2(H[w].x,H[w].y));f.push(M)}},removeMaterials:function(t,e){for(var i={},n=0,r=e.length;r>n;n++)i[e[n]]=!0;for(var o,a=[],n=0,r=t.faces.length;r>n;n++)o=t.faces[n],o.materialIndex in i||a.push(o);t.faces=a},randomPointInTriangle:function(t,e,i){var n,r,o,a=new THREE.Vector3,s=THREE.GeometryUtils.__v1;return n=THREE.GeometryUtils.random(),r=THREE.GeometryUtils.random(),n+r>1&&(n=1-n,r=1-r),o=1-n-r,a.copy(t),a.multiplyScalar(n),s.copy(e),s.multiplyScalar(r),a.add(s),s.copy(i),s.multiplyScalar(o),a.add(s),a},randomPointInFace:function(t,e,i){var n,r,o,a;if(t instanceof THREE.Face3)return n=e.vertices[t.a],r=e.vertices[t.b],o=e.vertices[t.c],THREE.GeometryUtils.randomPointInTriangle(n,r,o);if(t instanceof THREE.Face4){n=e.vertices[t.a],r=e.vertices[t.b],o=e.vertices[t.c],a=e.vertices[t.d];var s,l;i?t._area1&&t._area2?(s=t._area1,l=t._area2):(s=THREE.GeometryUtils.triangleArea(n,r,a),l=THREE.GeometryUtils.triangleArea(r,o,a),t._area1=s,t._area2=l):(s=THREE.GeometryUtils.triangleArea(n,r,a),l=THREE.GeometryUtils.triangleArea(r,o,a));var c=THREE.GeometryUtils.random()*(s+l);return s>c?THREE.GeometryUtils.randomPointInTriangle(n,r,a):THREE.GeometryUtils.randomPointInTriangle(r,o,a)}},randomPointsInGeometry:function(t,e){function i(t){function e(i,n){if(i>n)return i;var r=i+Math.floor((n-i)/2);return c[r]>t?e(i,r-1):c[r]<t?e(r+1,n):r}var i=e(0,c.length-1);return i}var n,r,o=t.faces,a=t.vertices,s=o.length,l=0,c=[],h,u,f,d;for(r=0;s>r;r++)n=o[r],n instanceof THREE.Face3?(h=a[n.a],u=a[n.b],f=a[n.c],n._area=THREE.GeometryUtils.triangleArea(h,u,f)):n instanceof THREE.Face4&&(h=a[n.a],u=a[n.b],f=a[n.c],d=a[n.d],n._area1=THREE.GeometryUtils.triangleArea(h,u,d),n._area2=THREE.GeometryUtils.triangleArea(u,f,d),n._area=n._area1+n._area2),l+=n._area,c[r]=l;var p,m,g=[],v={};for(r=0;e>r;r++)p=THREE.GeometryUtils.random()*l,m=i(p),g[r]=THREE.GeometryUtils.randomPointInFace(o[m],t,!0),v[m]?v[m]+=1:v[m]=1;return g},triangleArea:function(t,e,i){var n=THREE.GeometryUtils.__v1,r=THREE.GeometryUtils.__v2;return n.subVectors(e,t),r.subVectors(i,t),n.cross(r),.5*n.length()},center:function(t){t.computeBoundingBox();var e=t.boundingBox,i=new THREE.Vector3;return i.addVectors(e.min,e.max),i.multiplyScalar(-.5),t.applyMatrix((new THREE.Matrix4).makeTranslation(i.x,i.y,i.z)),t.computeBoundingBox(),i},normalizeUVs:function(t){for(var e=t.faceVertexUvs[0],i=0,n=e.length;n>i;i++)for(var r=e[i],o=0,a=r.length;a>o;o++)1!==r[o].x&&(r[o].x=r[o].x-Math.floor(r[o].x)),1!==r[o].y&&(r[o].y=r[o].y-Math.floor(r[o].y))},triangulateQuads:function(t){var e,i,n,r,o=[],a=[],s=[];for(e=0,i=t.faceUvs.length;i>e;e++)a[e]=[];for(e=0,i=t.faceVertexUvs.length;i>e;e++)s[e]=[];for(e=0,i=t.faces.length;i>e;e++){var l=t.faces[e];if(l instanceof THREE.Face4){var c=l.a,h=l.b,u=l.c,f=l.d,d=new THREE.Face3,p=new THREE.Face3;for(d.color.copy(l.color),p.color.copy(l.color),d.materialIndex=l.materialIndex,p.materialIndex=l.materialIndex,d.a=c,d.b=h,d.c=f,p.a=h,p.b=u,p.c=f,4===l.vertexColors.length&&(d.vertexColors[0]=l.vertexColors[0].clone(),d.vertexColors[1]=l.vertexColors[1].clone(),d.vertexColors[2]=l.vertexColors[3].clone(),p.vertexColors[0]=l.vertexColors[1].clone(),p.vertexColors[1]=l.vertexColors[2].clone(),p.vertexColors[2]=l.vertexColors[3].clone()),o.push(d,p),n=0,r=t.faceVertexUvs.length;r>n;n++)if(t.faceVertexUvs[n].length){var m=t.faceVertexUvs[n][e],g=m[0],v=m[1],E=m[2],y=m[3],x=[g.clone(),v.clone(),y.clone()],T=[v.clone(),E.clone(),y.clone()];s[n].push(x,T)}for(n=0,r=t.faceUvs.length;r>n;n++)if(t.faceUvs[n].length){var b=t.faceUvs[n][e];a[n].push(b,b)}}else{for(o.push(l),n=0,r=t.faceUvs.length;r>n;n++)a[n].push(t.faceUvs[n][e]);for(n=0,r=t.faceVertexUvs.length;r>n;n++)s[n].push(t.faceVertexUvs[n][e])}}t.faces=o,t.faceUvs=a,t.faceVertexUvs=s,t.computeCentroids(),t.computeFaceNormals(),t.computeVertexNormals(),t.hasTangents&&t.computeTangents()},setMaterialIndex:function(t,e,i,n){for(var r=t.faces,o=i||0,a=n||r.length-1,s=o;a>=s;s++)r[s].materialIndex=e}},THREE.GeometryUtils.random=THREE.Math.random16,THREE.GeometryUtils.__v1=new THREE.Vector3,THREE.GeometryUtils.__v2=new THREE.Vector3,THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(t,e,i,n){var r=new Image,o=new THREE.Texture(r,e),a=new THREE.ImageLoader;return a.addEventListener("load",function(t){o.image=t.content,o.needsUpdate=!0,i&&i(o)}),a.addEventListener("error",function(t){n&&n(t.message)}),a.crossOrigin=this.crossOrigin,a.load(t,r),o.sourceFile=t,o},loadCompressedTexture:function(t,e,i,n){var r=new THREE.CompressedTexture;r.mapping=e;var o=new XMLHttpRequest;return o.onload=function(){var t=o.response,e=THREE.ImageUtils.parseDDS(t,!0);r.format=e.format,r.mipmaps=e.mipmaps,r.image.width=e.width,r.image.height=e.height,r.generateMipmaps=!1,r.needsUpdate=!0,i&&i(r)},o.onerror=n,o.open("GET",t,!0),o.responseType="arraybuffer",o.send(null),r},loadTextureCube:function(t,e,i,n){var r=[];r.loadCount=0;var o=new THREE.Texture;o.image=r,void 0!==e&&(o.mapping=e),o.flipY=!1;for(var a=0,s=t.length;s>a;++a){var l=new Image;r[a]=l,l.onload=function(){r.loadCount+=1,6===r.loadCount&&(o.needsUpdate=!0,i&&i(o))},l.onerror=n,l.crossOrigin=this.crossOrigin,l.src=t[a]}return o},loadCompressedTextureCube:function(t,e,i,n){var r=[];r.loadCount=0;var o=new THREE.CompressedTexture;o.image=r,void 0!==e&&(o.mapping=e),o.flipY=!1,o.generateMipmaps=!1;var a=function(t,e){return function(){var n=t.response,a=THREE.ImageUtils.parseDDS(n,!0);e.format=a.format,e.mipmaps=a.mipmaps,e.width=a.width,e.height=a.height,r.loadCount+=1,6===r.loadCount&&(o.format=a.format,o.needsUpdate=!0,i&&i(o))}};if(t instanceof Array)for(var s=0,l=t.length;l>s;++s){var c={};r[s]=c;var h=new XMLHttpRequest;h.onload=a(h,c),h.onerror=n;var u=t[s];h.open("GET",u,!0),h.responseType="arraybuffer",h.send(null)}else{var u=t,h=new XMLHttpRequest;h.onload=function(){var t=h.response,e=THREE.ImageUtils.parseDDS(t,!0);if(e.isCubemap){for(var n=e.mipmaps.length/e.mipmapCount,a=0;n>a;a++){r[a]={mipmaps:[]};for(var s=0;s<e.mipmapCount;s++)r[a].mipmaps.push(e.mipmaps[a*e.mipmapCount+s]),r[a].format=e.format,r[a].width=e.width,r[a].height=e.height}o.format=e.format,o.needsUpdate=!0,i&&i(o)}},h.onerror=n,h.open("GET",u,!0),h.responseType="arraybuffer",h.send(null)}return o},parseDDS:function(t,e){function i(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}function n(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}var r={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},o=542327876,a=1,s=2,l=4,c=8,h=4096,u=131072,f=524288,d=8388608,p=8,m=4194304,g=4096,v=512,E=1024,y=2048,x=4096,T=8192,b=16384,_=32768,w=2097152,R=1,H=2,M=4,S=64,C=512,A=131072,D=i("DXT1"),P=i("DXT3"),k=i("DXT5"),L=31,N=0,F=1,I=2,z=3,O=4,U=7,B=20,V=21,W=27,j=28,G=29,X=30,q=new Int32Array(t,0,L);if(q[N]!==o)return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),r;if(!q[B]&M)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),r;var Y,K=q[V];switch(K){case D:Y=8,r.format=THREE.RGB_S3TC_DXT1_Format;break;case P:Y=16,r.format=THREE.RGBA_S3TC_DXT3_Format;break;case k:Y=16,r.format=THREE.RGBA_S3TC_DXT5_Format;break;default:return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",n(K)),r}r.mipmapCount=1,q[I]&u&&e!==!1&&(r.mipmapCount=Math.max(1,q[U])),r.isCubemap=q[j]&v?!0:!1,r.width=q[O],r.height=q[z];for(var Q=q[F]+4,Z=r.width,J=r.height,te=r.isCubemap?6:1,ee=0;te>ee;ee++){for(var ie=0;ie<r.mipmapCount;ie++){var ne=Math.max(4,Z)/4*Math.max(4,J)/4*Y,re=new Uint8Array(t,Q,ne),oe={data:re,width:Z,height:J};r.mipmaps.push(oe),Q+=ne,Z=Math.max(.5*Z,1),J=Math.max(.5*J,1)}Z=r.width,J=r.height}return r},getNormalMap:function(t,e){var i=function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},n=function(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2]]},r=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return[t[0]/e,t[1]/e,t[2]/e]};e=1|e;var o=t.width,a=t.height,s=document.createElement("canvas");s.width=o,s.height=a;var l=s.getContext("2d");l.drawImage(t,0,0);for(var c=l.getImageData(0,0,o,a).data,h=l.createImageData(o,a),u=h.data,f=0;o>f;f++)for(var d=0;a>d;d++){var p=0>d-1?0:d-1,m=d+1>a-1?a-1:d+1,g=0>f-1?0:f-1,v=f+1>o-1?o-1:f+1,E=[],y=[0,0,c[4*(d*o+f)]/255*e];E.push([-1,0,c[4*(d*o+g)]/255*e]),E.push([-1,-1,c[4*(p*o+g)]/255*e]),E.push([0,-1,c[4*(p*o+f)]/255*e]),E.push([1,-1,c[4*(p*o+v)]/255*e]),E.push([1,0,c[4*(d*o+v)]/255*e]),E.push([1,1,c[4*(m*o+v)]/255*e]),E.push([0,1,c[4*(m*o+f)]/255*e]),E.push([-1,1,c[4*(m*o+g)]/255*e]);for(var x=[],T=E.length,b=0;T>b;b++){var _=E[b],w=E[(b+1)%T];_=n(_,y),w=n(w,y),x.push(r(i(_,w)))}for(var R=[0,0,0],b=0;b<x.length;b++)R[0]+=x[b][0],R[1]+=x[b][1],R[2]+=x[b][2];R[0]/=x.length,R[1]/=x.length,R[2]/=x.length;var H=4*(d*o+f);u[H]=(R[0]+1)/2*255|0,u[H+1]=(R[1]+1)/2*255|0,u[H+2]=255*R[2]|0,u[H+3]=255}return l.putImageData(h,0,0),s},generateDataTexture:function(t,e,i){for(var n=t*e,r=new Uint8Array(3*n),o=Math.floor(255*i.r),a=Math.floor(255*i.g),s=Math.floor(255*i.b),l=0;n>l;l++)r[3*l]=o,r[3*l+1]=a,r[3*l+2]=s;var c=new THREE.DataTexture(r,t,e,THREE.RGBFormat);return c.needsUpdate=!0,c}},THREE.SceneUtils={createMultiMaterialObject:function(t,e){for(var i=new THREE.Object3D,n=0,r=e.length;r>n;n++)i.add(new THREE.Mesh(t,e[n]));return i},detach:function(t,e,i){t.applyMatrix(e.matrixWorld),e.remove(t),i.add(t)},attach:function(t,e,i){var n=new THREE.Matrix4;n.getInverse(i.matrixWorld),t.applyMatrix(n),e.remove(t),i.add(t)}},THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(t){var e=t.familyName.toLowerCase(),i=this;i.faces[e]=i.faces[e]||{},i.faces[e][t.cssFontWeight]=i.faces[e][t.cssFontWeight]||{},i.faces[e][t.cssFontWeight][t.cssFontStyle]=t;var n=i.faces[e][t.cssFontWeight][t.cssFontStyle]=t;return t},drawText:function(t){var e=[],i=[],n,r,o=this.getFace(),a=this.size/o.resolution,s=0,l=String(t).split(""),c=l.length,h=[];for(n=0;c>n;n++){var u=new THREE.Path,f=this.extractGlyphPoints(l[n],o,a,s,u);s+=f.offset,h.push(f.path)}var d=s/2;return{paths:h,offset:d}},extractGlyphPoints:function(t,e,i,n,r){var o=[],a,s,l,c,h,u,f,d,p,m,g,v,E,y,x,T,b,_,w,R=e.glyphs[t]||e.glyphs["?"];if(R){if(R.o)for(c=R._cachedOutline||(R._cachedOutline=R.o.split(" ")),u=c.length,f=i,d=i,a=0;u>a;)switch(h=c[a++]){case"m":p=c[a++]*f+n,m=c[a++]*d,r.moveTo(p,m);break;case"l":p=c[a++]*f+n,m=c[a++]*d,r.lineTo(p,m);break;case"q":if(g=c[a++]*f+n,v=c[a++]*d,x=c[a++]*f+n,T=c[a++]*d,r.quadraticCurveTo(x,T,g,v),w=o[o.length-1])for(E=w.x,y=w.y,s=1,l=this.divisions;l>=s;s++)var H=s/l,M=THREE.Shape.Utils.b2(H,E,x,g),S=THREE.Shape.Utils.b2(H,y,T,v);break;case"b":if(g=c[a++]*f+n,v=c[a++]*d,x=c[a++]*f+n,T=c[a++]*-d,b=c[a++]*f+n,_=c[a++]*-d,r.bezierCurveTo(g,v,x,T,b,_),w=o[o.length-1])for(E=w.x,y=w.y,s=1,l=this.divisions;l>=s;s++)var H=s/l,M=THREE.Shape.Utils.b3(H,E,x,b,g),S=THREE.Shape.Utils.b3(H,y,T,_,v)}return{offset:R.ha*i,path:r}}}},THREE.FontUtils.generateShapes=function(t,e){e=e||{};var i=void 0!==e.size?e.size:100,n=void 0!==e.curveSegments?e.curveSegments:4,r=void 0!==e.font?e.font:"helvetiker",o=void 0!==e.weight?e.weight:"normal",a=void 0!==e.style?e.style:"normal";THREE.FontUtils.size=i,THREE.FontUtils.divisions=n,THREE.FontUtils.face=r,THREE.FontUtils.weight=o,THREE.FontUtils.style=a;for(var s=THREE.FontUtils.drawText(t),l=s.paths,c=[],h=0,u=l.length;u>h;h++)Array.prototype.push.apply(c,l[h].toShapes());return c},function(t){var e=1e-10,i=function(t,e){var i=t.length;if(3>i)return null;var o=[],a=[],s=[],l,c,h;if(n(t)>0)for(c=0;i>c;c++)a[c]=c;else for(c=0;i>c;c++)a[c]=i-1-c;var u=i,f=2*u;for(c=u-1;u>2;){if(f--<=0)return console.log("Warning, unable to triangulate polygon!"),e?s:o;if(l=c,l>=u&&(l=0),c=l+1,c>=u&&(c=0),h=c+1,h>=u&&(h=0),r(t,l,c,h,u,a)){var d,p,m,g,v;for(d=a[l],p=a[c],m=a[h],o.push([t[d],t[p],t[m]]),s.push([a[l],a[c],a[h]]),g=c,v=c+1;u>v;g++,v++)a[g]=a[v];u--,f=2*u}}return e?s:o},n=function(t){for(var e=t.length,i=0,n=e-1,r=0;e>r;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},r=function(t,i,n,r,o,a){var s,l,c,h,u,f,d,p,m;if(l=t[a[i]].x,c=t[a[i]].y,h=t[a[n]].x,u=t[a[n]].y,f=t[a[r]].x,d=t[a[r]].y,e>(h-l)*(d-c)-(u-c)*(f-l))return!1;var g,v,E,y,x,T,b,_,w,R,H,M,S,C,A;for(g=f-h,v=d-u,E=l-f,y=c-d,x=h-l,T=u-c,s=0;o>s;s++)if(s!==i&&s!==n&&s!==r&&(p=t[a[s]].x,m=t[a[s]].y,b=p-l,_=m-c,w=p-h,R=m-u,H=p-f,M=m-d,A=g*R-v*w,S=x*_-T*b,C=E*M-y*H,A>=0&&C>=0&&S>=0))return!1;return!0};return t.Triangulate=i,t.Triangulate.area=n,t}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.Curve=function(){},THREE.Curve.prototype.getPoint=function(t){return console.log("Warning, getPoint() not implemented!"),null},THREE.Curve.prototype.getPointAt=function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},THREE.Curve.prototype.getPoints=function(t){t||(t=5);var e,i=[];for(e=0;t>=e;e++)i.push(this.getPoint(e/t));return i},THREE.Curve.prototype.getSpacedPoints=function(t){t||(t=5);var e,i=[];for(e=0;t>=e;e++)i.push(this.getPointAt(e/t));return i},THREE.Curve.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},THREE.Curve.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e=[],i,n=this.getPoint(0),r,o=0;for(e.push(0),r=1;t>=r;r++)i=this.getPoint(r/t),o+=i.distanceTo(n),e.push(o),n=i;return this.cacheArcLengths=e,e},THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},THREE.Curve.prototype.getUtoTmapping=function(t,e){var i=this.getLengths(),n=0,r=i.length,o;o=e?e:t*i[r-1];for(var a=0,s=r-1,l;s>=a;)if(n=Math.floor(a+(s-a)/2),l=i[n]-o,0>l)a=n+1;else{if(!(l>0)){s=n;break}s=n-1}if(n=s,i[n]==o){var c=n/(r-1);return c}var h=i[n],u=i[n+1],f=u-h,d=(o-h)/f,c=(n+d)/(r-1);return c},THREE.Curve.prototype.getTangent=function(t){var e=1e-4,i=t-e,n=t+e;0>i&&(i=0),n>1&&(n=1);var r=this.getPoint(i),o=this.getPoint(n),a=o.clone().sub(r);return a.normalize()},THREE.Curve.prototype.getTangentAt=function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},THREE.LineCurve=function(t,e){this.v1=t,this.v2=e},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},THREE.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t)},THREE.LineCurve.prototype.getTangent=function(t){var e=this.v2.clone().sub(this.v1);return e.normalize()},THREE.QuadraticBezierCurve=function(t,e,i){this.v0=t,this.v1=e,this.v2=i},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.getPoint=function(t){var e,i;return e=THREE.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),i=THREE.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),new THREE.Vector2(e,i)},THREE.QuadraticBezierCurve.prototype.getTangent=function(t){var e,i;e=THREE.Curve.Utils.tangentQuadraticBezier(t,this.v0.x,this.v1.x,this.v2.x),i=THREE.Curve.Utils.tangentQuadraticBezier(t,this.v0.y,this.v1.y,this.v2.y);var n=new THREE.Vector2(e,i);return n.normalize(),n},THREE.CubicBezierCurve=function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.getPoint=function(t){var e,i;return e=THREE.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new THREE.Vector2(e,i)},THREE.CubicBezierCurve.prototype.getTangent=function(t){var e,i;e=THREE.Curve.Utils.tangentCubicBezier(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Curve.Utils.tangentCubicBezier(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var n=new THREE.Vector2(e,i);return n.normalize(),n},THREE.SplineCurve=function(t){this.points=void 0==t?[]:t},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.getPoint=function(t){var e=new THREE.Vector2,i=[],n=this.points,r,o,a;return r=(n.length-1)*t,o=Math.floor(r),a=r-o,i[0]=0==o?o:o-1,i[1]=o,i[2]=o>n.length-2?n.length-1:o+1,i[3]=o>n.length-3?n.length-1:o+2,e.x=THREE.Curve.Utils.interpolate(n[i[0]].x,n[i[1]].x,n[i[2]].x,n[i[3]].x,a),e.y=THREE.Curve.Utils.interpolate(n[i[0]].y,n[i[1]].y,n[i[2]].y,n[i[3]].y,a),e},THREE.EllipseCurve=function(t,e,i,n,r,o,a){this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.getPoint=function(t){var e=this.aEndAngle-this.aStartAngle;this.aClockwise||(t=1-t);var i=this.aStartAngle+t*e,n=this.aX+this.xRadius*Math.cos(i),r=this.aY+this.yRadius*Math.sin(i);return new THREE.Vector2(n,r)},THREE.ArcCurve=function(t,e,i,n,r,o){THREE.EllipseCurve.call(this,t,e,i,i,n,r,o)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.Curve.Utils={tangentQuadraticBezier:function(t,e,i,n){return 2*(1-t)*(i-e)+2*t*(n-i)},tangentCubicBezier:function(t,e,i,n,r){return-3*e*(1-t)*(1-t)+3*i*(1-t)*(1-t)-6*t*i*(1-t)+6*t*n*(1-t)-3*t*t*n+3*t*t*r},tangentSpline:function(t,e,i,n,r){var o=6*t*t-6*t,a=3*t*t-4*t+1,s=-6*t*t+6*t,l=3*t*t-2*t;return o+a+s+l},interpolate:function(t,e,i,n,r){var o=.5*(i-t),a=.5*(n-e),s=r*r,l=r*s;return(2*e-2*i+o+a)*l+(-3*e+3*i-2*o-a)*s+o*r+e}},THREE.Curve.create=function(t,e){return t.prototype=Object.create(THREE.Curve.prototype),t.prototype.getPoint=e,t},THREE.LineCurve3=THREE.Curve.create(function(t,e){this.v1=t,this.v2=e},function(t){var e=new THREE.Vector3;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(t,e,i){this.v0=t,this.v1=e,this.v2=i},function(t){var e,i,n;return e=THREE.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),i=THREE.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),n=THREE.Shape.Utils.b2(t,this.v0.z,this.v1.z,this.v2.z),new THREE.Vector3(e,i,n)}),THREE.CubicBezierCurve3=THREE.Curve.create(function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},function(t){var e,i,n;return e=THREE.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),n=THREE.Shape.Utils.b3(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new THREE.Vector3(e,i,n)}),THREE.SplineCurve3=THREE.Curve.create(function(t){this.points=void 0==t?[]:t},function(t){var e=new THREE.Vector3,i=[],n=this.points,r,o,a;r=(n.length-1)*t,o=Math.floor(r),a=r-o,i[0]=0==o?o:o-1,i[1]=o,i[2]=o>n.length-2?n.length-1:o+1,i[3]=o>n.length-3?n.length-1:o+2;var s=n[i[0]],l=n[i[1]],c=n[i[2]],h=n[i[3]];return e.x=THREE.Curve.Utils.interpolate(s.x,l.x,c.x,h.x,a),e.y=THREE.Curve.Utils.interpolate(s.y,l.y,c.y,h.y,a),e.z=THREE.Curve.Utils.interpolate(s.z,l.z,c.z,h.z,a),e}),THREE.ClosedSplineCurve3=THREE.Curve.create(function(t){this.points=void 0==t?[]:t
},function(t){var e=new THREE.Vector3,i=[],n=this.points,r,o,a;return r=(n.length-0)*t,o=Math.floor(r),a=r-o,o+=o>0?0:(Math.floor(Math.abs(o)/n.length)+1)*n.length,i[0]=(o-1)%n.length,i[1]=o%n.length,i[2]=(o+1)%n.length,i[3]=(o+2)%n.length,e.x=THREE.Curve.Utils.interpolate(n[i[0]].x,n[i[1]].x,n[i[2]].x,n[i[3]].x,a),e.y=THREE.Curve.Utils.interpolate(n[i[0]].y,n[i[1]].y,n[i[2]].y,n[i[3]].y,a),e.z=THREE.Curve.Utils.interpolate(n[i[0]].z,n[i[1]].z,n[i[2]].z,n[i[3]].z,a),e}),THREE.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.add=function(t){this.curves.push(t)},THREE.CurvePath.prototype.checkConnection=function(){},THREE.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new THREE.LineCurve(e,t))},THREE.CurvePath.prototype.getPoint=function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0,r,o;n<i.length;){if(i[n]>=e){r=i[n]-e,o=this.curves[n];var a=1-r/o.getLength();return o.getPointAt(a);break}n++}return null},THREE.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var t=[],e=0,i,n=this.curves.length;for(i=0;n>i;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},THREE.CurvePath.prototype.getBoundingBox=function(){var t=this.getPoints(),e,i,n,r,o,a;e=i=Number.NEGATIVE_INFINITY,r=o=Number.POSITIVE_INFINITY;var s,l,c,h,u=t[0]instanceof THREE.Vector3;for(h=u?new THREE.Vector3:new THREE.Vector2,l=0,c=t.length;c>l;l++)s=t[l],s.x>e?e=s.x:s.x<r&&(r=s.x),s.y>i?i=s.y:s.y<o&&(o=s.y),u&&(s.z>n?n=s.z:s.z<a&&(a=s.z)),h.add(s);var f={minX:r,minY:o,maxX:e,maxY:i,centroid:h.divideScalar(c)};return u&&(f.maxZ=n,f.minZ=a),f},THREE.CurvePath.prototype.createPointsGeometry=function(t){var e=this.getPoints(t,!0);return this.createGeometry(e)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(t){var e=this.getSpacedPoints(t,!0);return this.createGeometry(e)},THREE.CurvePath.prototype.createGeometry=function(t){for(var e=new THREE.Geometry,i=0;i<t.length;i++)e.vertices.push(new THREE.Vector3(t[i].x,t[i].y,t[i].z||0));return e},THREE.CurvePath.prototype.addWrapPath=function(t){this.bends.push(t)},THREE.CurvePath.prototype.getTransformedPoints=function(t,e){var i=this.getPoints(t),n,r;for(e||(e=this.bends),n=0,r=e.length;r>n;n++)i=this.getWrapPoints(i,e[n]);return i},THREE.CurvePath.prototype.getTransformedSpacedPoints=function(t,e){var i=this.getSpacedPoints(t),n,r;for(e||(e=this.bends),n=0,r=e.length;r>n;n++)i=this.getWrapPoints(i,e[n]);return i},THREE.CurvePath.prototype.getWrapPoints=function(t,e){var i=this.getBoundingBox(),n,r,o,a,s,l;for(n=0,r=t.length;r>n;n++){o=t[n],a=o.x,s=o.y,l=a/i.maxX,l=e.getUtoTmapping(l,a);var c=e.getPoint(l),h=e.getNormalVector(l).multiplyScalar(s);o.x=c.x+h.x,o.y=c.y+h.y}return t},THREE.Gyroscope=function(){THREE.Object3D.call(this)},THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype),THREE.Gyroscope.prototype.updateMatrixWorld=function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.rotationWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.rotationObject,this.scaleObject),this.matrixWorld.makeFromPositionQuaternionScale(this.translationWorld,this.rotationObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,i=this.children.length;i>e;e++)this.children[e].updateMatrixWorld(t)},THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3,THREE.Gyroscope.prototype.translationObject=new THREE.Vector3,THREE.Gyroscope.prototype.rotationWorld=new THREE.Quaternion,THREE.Gyroscope.prototype.rotationObject=new THREE.Quaternion,THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3,THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3,THREE.Path=function(t){THREE.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},THREE.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;i>e;e++)this.lineTo(t[e].x,t[e].y)},THREE.Path.prototype.moveTo=function(t,e){var i=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:i})},THREE.Path.prototype.lineTo=function(t,e){var i=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,r=n[n.length-2],o=n[n.length-1],a=new THREE.LineCurve(new THREE.Vector2(r,o),new THREE.Vector2(t,e));this.curves.push(a),this.actions.push({action:THREE.PathActions.LINE_TO,args:i})},THREE.Path.prototype.quadraticCurveTo=function(t,e,i,n){var r=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,a=o[o.length-2],s=o[o.length-1],l=new THREE.QuadraticBezierCurve(new THREE.Vector2(a,s),new THREE.Vector2(t,e),new THREE.Vector2(i,n));this.curves.push(l),this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:r})},THREE.Path.prototype.bezierCurveTo=function(t,e,i,n,r,o){var a=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,l=s[s.length-2],c=s[s.length-1],h=new THREE.CubicBezierCurve(new THREE.Vector2(l,c),new THREE.Vector2(t,e),new THREE.Vector2(i,n),new THREE.Vector2(r,o));this.curves.push(h),this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:a})},THREE.Path.prototype.splineThru=function(t){var e=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,n=i[i.length-2],r=i[i.length-1],o=[new THREE.Vector2(n,r)];Array.prototype.push.apply(o,t);var a=new THREE.SplineCurve(o);this.curves.push(a),this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:e})},THREE.Path.prototype.arc=function(t,e,i,n,r,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],l=a[a.length-1];this.absarc(t+s,e+l,i,n,r,o)},THREE.Path.prototype.absarc=function(t,e,i,n,r,o){this.absellipse(t,e,i,i,n,r,o)},THREE.Path.prototype.ellipse=function(t,e,i,n,r,o,a){var s=this.actions[this.actions.length-1].args,l=s[s.length-2],c=s[s.length-1];this.absellipse(t+l,e+c,i,n,r,o,a)},THREE.Path.prototype.absellipse=function(t,e,i,n,r,o,a){var s=Array.prototype.slice.call(arguments),l=new THREE.EllipseCurve(t,e,i,n,r,o,a);this.curves.push(l);var c=l.getPoint(a?1:0);s.push(c.x),s.push(c.y),this.actions.push({action:THREE.PathActions.ELLIPSE,args:s})},THREE.Path.prototype.getSpacedPoints=function(t,e){t||(t=40);for(var i=[],n=0;t>n;n++)i.push(this.getPoint(n/t));return i},THREE.Path.prototype.getPoints=function(t,e){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(t,e);t=t||12;var i=[],n,r,o,a,s,l,c,h,u,f,d,p,m,g,v,E,y,x;for(n=0,r=this.actions.length;r>n;n++)switch(o=this.actions[n],a=o.action,s=o.args,a){case THREE.PathActions.MOVE_TO:i.push(new THREE.Vector2(s[0],s[1]));break;case THREE.PathActions.LINE_TO:i.push(new THREE.Vector2(s[0],s[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:for(l=s[2],c=s[3],f=s[0],d=s[1],i.length>0?(g=i[i.length-1],p=g.x,m=g.y):(g=this.actions[n-1].args,p=g[g.length-2],m=g[g.length-1]),v=1;t>=v;v++)E=v/t,y=THREE.Shape.Utils.b2(E,p,f,l),x=THREE.Shape.Utils.b2(E,m,d,c),i.push(new THREE.Vector2(y,x));break;case THREE.PathActions.BEZIER_CURVE_TO:for(l=s[4],c=s[5],f=s[0],d=s[1],h=s[2],u=s[3],i.length>0?(g=i[i.length-1],p=g.x,m=g.y):(g=this.actions[n-1].args,p=g[g.length-2],m=g[g.length-1]),v=1;t>=v;v++)E=v/t,y=THREE.Shape.Utils.b3(E,p,f,h,l),x=THREE.Shape.Utils.b3(E,m,d,u,c),i.push(new THREE.Vector2(y,x));break;case THREE.PathActions.CSPLINE_THRU:g=this.actions[n-1].args;var T=new THREE.Vector2(g[g.length-2],g[g.length-1]),b=[T],_=t*s[0].length;b=b.concat(s[0]);var w=new THREE.SplineCurve(b);for(v=1;_>=v;v++)i.push(w.getPointAt(v/_));break;case THREE.PathActions.ARC:var R=s[0],H=s[1],M=s[2],S=s[3],C=s[4],A=!!s[5],D=C-S,P,k=2*t;for(v=1;k>=v;v++)E=v/k,A||(E=1-E),P=S+E*D,y=R+M*Math.cos(P),x=H+M*Math.sin(P),i.push(new THREE.Vector2(y,x));break;case THREE.PathActions.ELLIPSE:var R=s[0],H=s[1],L=s[2],N=s[3],S=s[4],C=s[5],A=!!s[6],D=C-S,P,k=2*t;for(v=1;k>=v;v++)E=v/k,A||(E=1-E),P=S+E*D,y=R+L*Math.cos(P),x=H+N*Math.sin(P),i.push(new THREE.Vector2(y,x))}var F=i[i.length-1],I=1e-10;return Math.abs(F.x-i[0].x)<I&&Math.abs(F.y-i[0].y)<I&&i.splice(i.length-1,1),e&&i.push(i[0]),i},THREE.Path.prototype.toShapes=function(){var t,e,i,n,r,o=[],a=new THREE.Path;for(t=0,e=this.actions.length;e>t;t++)i=this.actions[t],r=i.args,n=i.action,n==THREE.PathActions.MOVE_TO&&0!=a.actions.length&&(o.push(a),a=new THREE.Path),a[n].apply(a,r);if(0!=a.actions.length&&o.push(a),0==o.length)return[];var s,l,c=[],h=!THREE.Shape.Utils.isClockWise(o[0].getPoints());if(1==o.length)return s=o[0],l=new THREE.Shape,l.actions=s.actions,l.curves=s.curves,c.push(l),c;if(h)for(l=new THREE.Shape,t=0,e=o.length;e>t;t++)s=o[t],THREE.Shape.Utils.isClockWise(s.getPoints())?(l.actions=s.actions,l.curves=s.curves,c.push(l),l=new THREE.Shape):l.holes.push(s);else{for(t=0,e=o.length;e>t;t++)s=o[t],THREE.Shape.Utils.isClockWise(s.getPoints())?(l&&c.push(l),l=new THREE.Shape,l.actions=s.actions,l.curves=s.curves):l.holes.push(s);c.push(l)}return c},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.extrude=function(t){var e=new THREE.ExtrudeGeometry(this,t);return e},THREE.Shape.prototype.makeGeometry=function(t){var e=new THREE.ShapeGeometry(this,t);return e},THREE.Shape.prototype.getPointsHoles=function(t){var e,i=this.holes.length,n=[];for(e=0;i>e;e++)n[e]=this.holes[e].getTransformedPoints(t,this.bends);return n},THREE.Shape.prototype.getSpacedPointsHoles=function(t){var e,i=this.holes.length,n=[];for(e=0;i>e;e++)n[e]=this.holes[e].getTransformedSpacedPoints(t,this.bends);return n},THREE.Shape.prototype.extractAllPoints=function(t){return{shape:this.getTransformedPoints(t),holes:this.getPointsHoles(t)}},THREE.Shape.prototype.extractPoints=function(t){return this.useSpacedPoints?this.extractAllSpacedPoints(t):this.extractAllPoints(t)},THREE.Shape.prototype.extractAllSpacedPoints=function(t){return{shape:this.getTransformedSpacedPoints(t),holes:this.getSpacedPointsHoles(t)}},THREE.Shape.Utils={removeHoles:function(t,e){var i=t.concat(),n=i.concat(),r,o,a,s,l,c,h,u,f,d,p,m,g,v,E,y,x,T,b,_,w=[];for(f=0;f<e.length;f++){for(p=e[f],Array.prototype.push.apply(n,p),m=Number.POSITIVE_INFINITY,d=0;d<p.length;d++){E=p[d];var R=[];for(v=0;v<i.length;v++)y=i[v],g=E.distanceToSquared(y),R.push(g),m>g&&(m=g,l=d,c=v)}r=c-1>=0?c-1:i.length-1,a=l-1>=0?l-1:p.length-1;var H=[p[l],i[c],i[r]],M=THREE.FontUtils.Triangulate.area(H),S=[p[l],p[a],i[c]],C=THREE.FontUtils.Triangulate.area(S),A=1,D=-1,P=c,k=l;c+=A,l+=D,0>c&&(c+=i.length),c%=i.length,0>l&&(l+=p.length),l%=p.length,r=c-1>=0?c-1:i.length-1,a=l-1>=0?l-1:p.length-1,H=[p[l],i[c],i[r]];var L=THREE.FontUtils.Triangulate.area(H);S=[p[l],p[a],i[c]];var N=THREE.FontUtils.Triangulate.area(S);M+C>L+N&&(c=P,l=k,0>c&&(c+=i.length),c%=i.length,0>l&&(l+=p.length),l%=p.length,r=c-1>=0?c-1:i.length-1,a=l-1>=0?l-1:p.length-1),x=i.slice(0,c),T=i.slice(c),b=p.slice(l),_=p.slice(0,l);var F=[p[l],i[c],i[r]],I=[p[l],p[a],i[c]];w.push(F),w.push(I),i=x.concat(b).concat(_).concat(T)}return{shape:i,isolatedPts:w,allpoints:n}},triangulateShape:function(t,e){var i=THREE.Shape.Utils.removeHoles(t,e),n=i.shape,r=i.allpoints,o=i.isolatedPts,a=THREE.FontUtils.Triangulate(n,!1),s,l,c,h,u,f,d={},p={};for(s=0,l=r.length;l>s;s++)u=r[s].x+":"+r[s].y,void 0!==d[u]&&console.log("Duplicate point",u),d[u]=s;for(s=0,l=a.length;l>s;s++)for(h=a[s],c=0;3>c;c++)u=h[c].x+":"+h[c].y,f=d[u],void 0!==f&&(h[c]=f);for(s=0,l=o.length;l>s;s++)for(h=o[s],c=0;3>c;c++)u=h[c].x+":"+h[c].y,f=d[u],void 0!==f&&(h[c]=f);return a.concat(o)},isClockWise:function(t){return THREE.FontUtils.Triangulate.area(t)<0},b2p0:function(t,e){var i=1-t;return i*i*e},b2p1:function(t,e){return 2*(1-t)*t*e},b2p2:function(t,e){return t*t*e},b2:function(t,e,i,n){return this.b2p0(t,e)+this.b2p1(t,i)+this.b2p2(t,n)},b3p0:function(t,e){var i=1-t;return i*i*i*e},b3p1:function(t,e){var i=1-t;return 3*i*i*t*e},b3p2:function(t,e){var i=1-t;return 3*i*t*t*e},b3p3:function(t,e){return t*t*t*e},b3:function(t,e,i,n,r){return this.b3p0(t,e)+this.b3p1(t,i)+this.b3p2(t,n)+this.b3p3(t,r)}},THREE.AnimationHandler=function(){var t=[],e={},i={};i.update=function(e){for(var i=0;i<t.length;i++)t[i].update(e)},i.addToUpdate=function(e){-1===t.indexOf(e)&&t.push(e)},i.removeFromUpdate=function(e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)},i.add=function(t){void 0!==e[t.name]&&console.log("THREE.AnimationHandler.add: Warning! "+t.name+" already exists in library. Overwriting."),e[t.name]=t,r(t)},i.get=function(t){return"string"==typeof t?e[t]?e[t]:(console.log("THREE.AnimationHandler.get: Couldn't find animation "+t),null):void 0},i.parse=function(t){var e=[];if(t instanceof THREE.SkinnedMesh)for(var i=0;i<t.bones.length;i++)e.push(t.bones[i]);else n(t,e);return e};var n=function(t,e){e.push(t);for(var i=0;i<t.children.length;i++)n(t.children[i],e)},r=function(t){if(t.initialized!==!0){for(var e=0;e<t.hierarchy.length;e++){for(var i=0;i<t.hierarchy[e].keys.length;i++)if(t.hierarchy[e].keys[i].time<0&&(t.hierarchy[e].keys[i].time=0),void 0!==t.hierarchy[e].keys[i].rot&&!(t.hierarchy[e].keys[i].rot instanceof THREE.Quaternion)){var n=t.hierarchy[e].keys[i].rot;t.hierarchy[e].keys[i].rot=new THREE.Quaternion(n[0],n[1],n[2],n[3])}if(t.hierarchy[e].keys.length&&void 0!==t.hierarchy[e].keys[0].morphTargets){for(var r={},i=0;i<t.hierarchy[e].keys.length;i++)for(var o=0;o<t.hierarchy[e].keys[i].morphTargets.length;o++){var a=t.hierarchy[e].keys[i].morphTargets[o];r[a]=-1}t.hierarchy[e].usedMorphTargets=r;for(var i=0;i<t.hierarchy[e].keys.length;i++){var s={};for(var a in r){for(var o=0;o<t.hierarchy[e].keys[i].morphTargets.length;o++)if(t.hierarchy[e].keys[i].morphTargets[o]===a){s[a]=t.hierarchy[e].keys[i].morphTargetsInfluences[o];break}o===t.hierarchy[e].keys[i].morphTargets.length&&(s[a]=0)}t.hierarchy[e].keys[i].morphTargetsInfluences=s}}for(var i=1;i<t.hierarchy[e].keys.length;i++)t.hierarchy[e].keys[i].time===t.hierarchy[e].keys[i-1].time&&(t.hierarchy[e].keys.splice(i,1),i--);for(var i=0;i<t.hierarchy[e].keys.length;i++)t.hierarchy[e].keys[i].index=i}var l=parseInt(t.length*t.fps,10);t.JIT={},t.JIT.hierarchy=[];for(var e=0;e<t.hierarchy.length;e++)t.JIT.hierarchy.push(new Array(l));t.initialized=!0}};return i.LINEAR=0,i.CATMULLROM=1,i.CATMULLROM_FORWARD=2,i}(),THREE.Animation=function(t,e,i){this.root=t,this.data=THREE.AnimationHandler.get(e),this.hierarchy=THREE.AnimationHandler.parse(t),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.interpolationType=void 0!==i?i:THREE.AnimationHandler.LINEAR,this.points=[],this.target=new THREE.Vector3},THREE.Animation.prototype.play=function(t,e){if(this.isPlaying===!1){this.isPlaying=!0,this.loop=void 0!==t?t:!0,this.currentTime=void 0!==e?e:0;var i,n=this.hierarchy.length,r;for(i=0;n>i;i++){r=this.hierarchy[i],this.interpolationType!==THREE.AnimationHandler.CATMULLROM_FORWARD&&(r.useQuaternion=!0),r.matrixAutoUpdate=!0,void 0===r.animationCache&&(r.animationCache={},r.animationCache.prevKey={pos:0,rot:0,scl:0},r.animationCache.nextKey={pos:0,rot:0,scl:0},r.animationCache.originalMatrix=r instanceof THREE.Bone?r.skinMatrix:r.matrix);var o=r.animationCache.prevKey,a=r.animationCache.nextKey;o.pos=this.data.hierarchy[i].keys[0],o.rot=this.data.hierarchy[i].keys[0],o.scl=this.data.hierarchy[i].keys[0],a.pos=this.getNextKeyWith("pos",i,1),a.rot=this.getNextKeyWith("rot",i,1),a.scl=this.getNextKeyWith("scl",i,1)}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.Animation.prototype.pause=function(){this.isPaused===!0?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.Animation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this)},THREE.Animation.prototype.update=function(t){if(this.isPlaying!==!1){var e=["pos","rot","scl"],i,n,r,o,a,s,l,c,h,u,f=this.data.JIT.hierarchy,d,p,m,g,v;this.currentTime+=t*this.timeScale,p=this.currentTime,d=this.currentTime=this.currentTime%this.data.length,u=parseInt(Math.min(d*this.data.fps,this.data.length*this.data.fps),10);for(var E=0,y=this.hierarchy.length;y>E;E++){c=this.hierarchy[E],h=c.animationCache;for(var x=0;3>x;x++){if(i=e[x],s=h.prevKey[i],l=h.nextKey[i],l.time<=p){if(p>d){if(!this.loop)return void this.stop();for(s=this.data.hierarchy[E].keys[0],l=this.getNextKeyWith(i,E,1);l.time<d;)s=l,l=this.getNextKeyWith(i,E,l.index+1)}else do s=l,l=this.getNextKeyWith(i,E,l.index+1);while(l.time<d);h.prevKey[i]=s,h.nextKey[i]=l}c.matrixAutoUpdate=!0,c.matrixWorldNeedsUpdate=!0,n=(d-s.time)/(l.time-s.time),o=s[i],a=l[i],(0>n||n>1)&&(console.log("THREE.Animation.update: Warning! Scale out of bounds:"+n+" on bone "+E),n=0>n?0:1),"pos"===i?(r=c.position,this.interpolationType===THREE.AnimationHandler.LINEAR?(r.x=o[0]+(a[0]-o[0])*n,r.y=o[1]+(a[1]-o[1])*n,r.z=o[2]+(a[2]-o[2])*n):(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)&&(this.points[0]=this.getPrevKeyWith("pos",E,s.index-1).pos,this.points[1]=o,this.points[2]=a,this.points[3]=this.getNextKeyWith("pos",E,l.index+1).pos,n=.33*n+.33,m=this.interpolateCatmullRom(this.points,n),r.x=m[0],r.y=m[1],r.z=m[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(g=this.interpolateCatmullRom(this.points,1.01*n),this.target.set(g[0],g[1],g[2]),this.target.sub(r),this.target.y=0,this.target.normalize(),v=Math.atan2(this.target.x,this.target.z),c.rotation.set(0,v,0)))):"rot"===i?THREE.Quaternion.slerp(o,a,c.quaternion,n):"scl"===i&&(r=c.scale,r.x=o[0]+(a[0]-o[0])*n,r.y=o[1]+(a[1]-o[1])*n,r.z=o[2]+(a[2]-o[2])*n)}}}},THREE.Animation.prototype.interpolateCatmullRom=function(t,e){var i=[],n=[],r,o,a,s,l,c,h,u,f;return r=(t.length-1)*e,o=Math.floor(r),a=r-o,i[0]=0===o?o:o-1,i[1]=o,i[2]=o>t.length-2?o:o+1,i[3]=o>t.length-3?o:o+2,c=t[i[0]],h=t[i[1]],u=t[i[2]],f=t[i[3]],s=a*a,l=a*s,n[0]=this.interpolate(c[0],h[0],u[0],f[0],a,s,l),n[1]=this.interpolate(c[1],h[1],u[1],f[1],a,s,l),n[2]=this.interpolate(c[2],h[2],u[2],f[2],a,s,l),n},THREE.Animation.prototype.interpolate=function(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e},THREE.Animation.prototype.getNextKeyWith=function(t,e,i){var n=this.data.hierarchy[e].keys;for(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?i=i<n.length-1?i:n.length-1:i%=n.length;i<n.length;i++)if(void 0!==n[i][t])return n[i];return this.data.hierarchy[e].keys[0]},THREE.Animation.prototype.getPrevKeyWith=function(t,e,i){var n=this.data.hierarchy[e].keys;for(i=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?i>0?i:0:i>=0?i:i+n.length;i>=0;i--)if(void 0!==n[i][t])return n[i];return this.data.hierarchy[e].keys[n.length-1]},THREE.KeyFrameAnimation=function(t,e,i){this.root=t,this.data=THREE.AnimationHandler.get(e),this.hierarchy=THREE.AnimationHandler.parse(t),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.JITCompile=void 0!==i?i:!0;for(var n=0,r=this.hierarchy.length;r>n;n++){var o=this.data.hierarchy[n].keys,a=this.data.hierarchy[n].sids,s=this.hierarchy[n];if(o.length&&a){for(var l=0;l<a.length;l++){var c=a[l],h=this.getNextKeyWith(c,n,0);h&&h.apply(c)}s.matrixAutoUpdate=!1,this.data.hierarchy[n].node.updateMatrix(),s.matrixWorldNeedsUpdate=!0}}},THREE.KeyFrameAnimation.prototype.play=function(t,e){if(!this.isPlaying){this.isPlaying=!0,this.loop=void 0!==t?t:!0,this.currentTime=void 0!==e?e:0,this.startTimeMs=e,this.startTime=1e7,this.endTime=-this.startTime;var i,n=this.hierarchy.length,r,o;for(i=0;n>i;i++){r=this.hierarchy[i],o=this.data.hierarchy[i],r.useQuaternion=!0,void 0===o.animationCache&&(o.animationCache={},o.animationCache.prevKey=null,o.animationCache.nextKey=null,o.animationCache.originalMatrix=r instanceof THREE.Bone?r.skinMatrix:r.matrix);var a=this.data.hierarchy[i].keys;a.length&&(o.animationCache.prevKey=a[0],o.animationCache.nextKey=a[1],this.startTime=Math.min(a[0].time,this.startTime),this.endTime=Math.max(a[a.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.KeyFrameAnimation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this);for(var t=0;t<this.data.hierarchy.length;t++){var e=this.hierarchy[t],i=this.data.hierarchy[t];if(void 0!==i.animationCache){var n=i.animationCache.originalMatrix;e instanceof THREE.Bone?(n.copy(e.skinMatrix),e.skinMatrix=n):(n.copy(e.matrix),e.matrix=n),delete i.animationCache}}},THREE.KeyFrameAnimation.prototype.update=function(t){if(this.isPlaying){var e,i,n,r,o,a=this.data.JIT.hierarchy,s,l,c;if(this.currentTime+=t*this.timeScale,l=this.currentTime,s=this.currentTime=this.currentTime%this.data.length,s<this.startTimeMs&&(s=this.currentTime=this.startTimeMs+s),o=parseInt(Math.min(s*this.data.fps,this.data.length*this.data.fps),10),c=l>s,c&&!this.loop){for(var h=0,u=this.hierarchy.length;u>h;h++){var f=this.data.hierarchy[h].keys,d=this.data.hierarchy[h].sids,p=f.length-1,m=this.hierarchy[h];if(f.length){for(var g=0;g<d.length;g++){var v=d[g],E=this.getPrevKeyWith(v,h,p);E&&E.apply(v)}this.data.hierarchy[h].node.updateMatrix(),m.matrixWorldNeedsUpdate=!0}}return void this.stop()}if(!(s<this.startTime)){for(var h=0,u=this.hierarchy.length;u>h;h++){n=this.hierarchy[h],r=this.data.hierarchy[h];var f=r.keys,y=r.animationCache;if(this.JITCompile&&void 0!==a[h][o])n instanceof THREE.Bone?(n.skinMatrix=a[h][o],n.matrixWorldNeedsUpdate=!1):(n.matrix=a[h][o],n.matrixWorldNeedsUpdate=!0);else if(f.length){if(this.JITCompile&&y&&(n instanceof THREE.Bone?n.skinMatrix=y.originalMatrix:n.matrix=y.originalMatrix),e=y.prevKey,i=y.nextKey,e&&i){if(i.time<=l){if(c&&this.loop)for(e=f[0],i=f[1];i.time<s;)e=i,i=f[e.index+1];else if(!c)for(var x=f.length-1;i.time<s&&i.index!==x;)e=i,i=f[e.index+1];y.prevKey=e,y.nextKey=i}i.time>=s?e.interpolate(i,s):e.interpolate(i,i.time)}this.data.hierarchy[h].node.updateMatrix(),n.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===a[0][o]){this.hierarchy[0].updateMatrixWorld(!0);for(var h=0;h<this.hierarchy.length;h++)a[h][o]=this.hierarchy[h]instanceof THREE.Bone?this.hierarchy[h].skinMatrix.clone():this.hierarchy[h].matrix.clone()}}}},THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(t,e,i){var n=this.data.hierarchy[e].keys;for(i%=n.length;i<n.length;i++)if(n[i].hasTarget(t))return n[i];return n[0]},THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(t,e,i){var n=this.data.hierarchy[e].keys;for(i=i>=0?i:i+n.length;i>=0;i--)if(n[i].hasTarget(t))return n[i];return n[n.length-1]},THREE.CubeCamera=function(t,e,i){THREE.Object3D.call(this);var n=90,r=1,o=new THREE.PerspectiveCamera(n,r,t,e);o.up.set(0,-1,0),o.lookAt(new THREE.Vector3(1,0,0)),this.add(o);var a=new THREE.PerspectiveCamera(n,r,t,e);a.up.set(0,-1,0),a.lookAt(new THREE.Vector3(-1,0,0)),this.add(a);var s=new THREE.PerspectiveCamera(n,r,t,e);s.up.set(0,0,1),s.lookAt(new THREE.Vector3(0,1,0)),this.add(s);var l=new THREE.PerspectiveCamera(n,r,t,e);l.up.set(0,0,-1),l.lookAt(new THREE.Vector3(0,-1,0)),this.add(l);var c=new THREE.PerspectiveCamera(n,r,t,e);c.up.set(0,-1,0),c.lookAt(new THREE.Vector3(0,0,1)),this.add(c);var h=new THREE.PerspectiveCamera(n,r,t,e);h.up.set(0,-1,0),h.lookAt(new THREE.Vector3(0,0,-1)),this.add(h),this.renderTarget=new THREE.WebGLRenderTargetCube(i,i,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(t,e){var i=this.renderTarget,n=i.generateMipmaps;i.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,o,i),i.activeCubeFace=1,t.render(e,a,i),i.activeCubeFace=2,t.render(e,s,i),i.activeCubeFace=3,t.render(e,l,i),i.activeCubeFace=4,t.render(e,c,i),i.generateMipmaps=n,i.activeCubeFace=5,t.render(e,h,i)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CombinedCamera=function(t,e,i,n,r,o,a){THREE.Camera.call(this),this.fov=i,this.left=-t/2,this.right=t/2,this.top=e/2,this.bottom=-e/2,this.cameraO=new THREE.OrthographicCamera(t/-2,t/2,e/2,e/-2,o,a),this.cameraP=new THREE.PerspectiveCamera(i,t/e,n,r),this.zoom=1,this.toPerspective();var s=t/e},THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype),THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near,this.far=this.cameraP.far,this.cameraP.fov=this.fov/this.zoom,this.cameraP.updateProjectionMatrix(),this.projectionMatrix=this.cameraP.projectionMatrix,this.inPerspectiveMode=!0,this.inOrthographicMode=!1},THREE.CombinedCamera.prototype.toOrthographic=function(){var t=this.fov,e=this.cameraP.aspect,i=this.cameraP.near,n=this.cameraP.far,r=(i+n)/2,o=Math.tan(t/2)*r,a=2*o,s=a*e,l=s/2;o/=this.zoom,l/=this.zoom,this.cameraO.left=-l,this.cameraO.right=l,this.cameraO.top=o,this.cameraO.bottom=-o,this.cameraO.updateProjectionMatrix(),this.near=this.cameraO.near,this.far=this.cameraO.far,this.projectionMatrix=this.cameraO.projectionMatrix,this.inPerspectiveMode=!1,this.inOrthographicMode=!0},THREE.CombinedCamera.prototype.setSize=function(t,e){this.cameraP.aspect=t/e,this.left=-t/2,this.right=t/2,this.top=e/2,this.bottom=-e/2},THREE.CombinedCamera.prototype.setFov=function(t){this.fov=t,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())},THREE.CombinedCamera.prototype.setLens=function(t,e){void 0===e&&(e=24);var i=2*THREE.Math.radToDeg(Math.atan(e/(2*t)));return this.setFov(i),i},THREE.CombinedCamera.prototype.setZoom=function(t){this.zoom=t,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0,this.rotation.y=Math.PI,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0,this.rotation.y=-Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0,this.rotation.y=Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CircleGeometry=function(t,e,i,n){THREE.Geometry.call(this),t=t||50,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI,e=void 0!==e?Math.max(3,e):8;var r,o=[],a=new THREE.Vector3,s=new THREE.Vector2(.5,.5);for(this.vertices.push(a),o.push(s),r=0;e>=r;r++){var l=new THREE.Vector3,c=i+r/e*n;l.x=t*Math.cos(c),l.y=t*Math.sin(c),this.vertices.push(l),o.push(new THREE.Vector2((l.x/t+1)/2,(l.y/t+1)/2))}var h=new THREE.Vector3(0,0,1);for(r=1;e>=r;r++){var u=r,f=r+1,d=0;this.faces.push(new THREE.Face3(u,f,d,[h,h,h])),this.faceVertexUvs[0].push([o[r],o[r+1],s])}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,t)},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CubeGeometry=function(t,e,i,n,r,o){function a(t,e,i,n,r,o,a,l){var c,h,u,f=s.widthSegments,d=s.heightSegments,p=r/2,m=o/2,g=s.vertices.length;"x"===t&&"y"===e||"y"===t&&"x"===e?c="z":"x"===t&&"z"===e||"z"===t&&"x"===e?(c="y",d=s.depthSegments):("z"===t&&"y"===e||"y"===t&&"z"===e)&&(c="x",f=s.depthSegments);var v=f+1,E=d+1,y=r/f,x=o/d,T=new THREE.Vector3;for(T[c]=a>0?1:-1,u=0;E>u;u++)for(h=0;v>h;h++){var b=new THREE.Vector3;b[t]=(h*y-p)*i,b[e]=(u*x-m)*n,b[c]=a,s.vertices.push(b)}for(u=0;d>u;u++)for(h=0;f>h;h++){var _=h+v*u,w=h+v*(u+1),R=h+1+v*(u+1),H=h+1+v*u,M=new THREE.Face4(_+g,w+g,R+g,H+g);M.normal.copy(T),M.vertexNormals.push(T.clone(),T.clone(),T.clone(),T.clone()),M.materialIndex=l,s.faces.push(M),s.faceVertexUvs[0].push([new THREE.Vector2(h/f,1-u/d),new THREE.Vector2(h/f,1-(u+1)/d),new THREE.Vector2((h+1)/f,1-(u+1)/d),new THREE.Vector2((h+1)/f,1-u/d)])}}THREE.Geometry.call(this);var s=this;this.width=t,this.height=e,this.depth=i,this.widthSegments=n||1,this.heightSegments=r||1,this.depthSegments=o||1;var l=this.width/2,c=this.height/2,h=this.depth/2;a("z","y",-1,-1,this.depth,this.height,l,0),a("z","y",1,-1,this.depth,this.height,-l,1),a("x","z",1,1,this.width,this.depth,c,2),a("x","z",1,-1,this.width,this.depth,-c,3),a("x","y",1,-1,this.width,this.height,h,4),a("x","y",-1,-1,this.width,this.height,-h,5),this.computeCentroids(),this.mergeVertices()},THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry=function(t,e,i,n,r,o){THREE.Geometry.call(this),this.radiusTop=t=void 0!==t?t:20,this.radiusBottom=e=void 0!==e?e:20,this.height=i=void 0!==i?i:100,this.radiusSegments=n=n||8,this.heightSegments=r=r||1,this.openEnded=o=void 0!==o?o:!1;var a=i/2,s,l,c=[],h=[];for(l=0;r>=l;l++){var u=[],f=[],d=l/r,p=d*(e-t)+t;for(s=0;n>=s;s++){var m=s/n,g=new THREE.Vector3;g.x=p*Math.sin(m*Math.PI*2),g.y=-d*i+a,g.z=p*Math.cos(m*Math.PI*2),this.vertices.push(g),u.push(this.vertices.length-1),f.push(new THREE.Vector2(m,1-d))}c.push(u),h.push(f)}var v=(e-t)/i,E,y;for(s=0;n>s;s++)for(0!==t?(E=this.vertices[c[0][s]].clone(),y=this.vertices[c[0][s+1]].clone()):(E=this.vertices[c[1][s]].clone(),y=this.vertices[c[1][s+1]].clone()),E.setY(Math.sqrt(E.x*E.x+E.z*E.z)*v).normalize(),y.setY(Math.sqrt(y.x*y.x+y.z*y.z)*v).normalize(),l=0;r>l;l++){var x=c[l][s],T=c[l+1][s],b=c[l+1][s+1],_=c[l][s+1],w=E.clone(),R=E.clone(),H=y.clone(),M=y.clone(),S=h[l][s].clone(),C=h[l+1][s].clone(),A=h[l+1][s+1].clone(),D=h[l][s+1].clone();this.faces.push(new THREE.Face4(x,T,b,_,[w,R,H,M])),this.faceVertexUvs[0].push([S,C,A,D])}if(o===!1&&t>0)for(this.vertices.push(new THREE.Vector3(0,a,0)),s=0;n>s;s++){var x=c[0][s],T=c[0][s+1],b=this.vertices.length-1,w=new THREE.Vector3(0,1,0),R=new THREE.Vector3(0,1,0),H=new THREE.Vector3(0,1,0),S=h[0][s].clone(),C=h[0][s+1].clone(),A=new THREE.Vector2(C.u,0);this.faces.push(new THREE.Face3(x,T,b,[w,R,H])),this.faceVertexUvs[0].push([S,C,A])}if(o===!1&&e>0)for(this.vertices.push(new THREE.Vector3(0,-a,0)),s=0;n>s;s++){var x=c[l][s+1],T=c[l][s],b=this.vertices.length-1,w=new THREE.Vector3(0,-1,0),R=new THREE.Vector3(0,-1,0),H=new THREE.Vector3(0,-1,0),S=h[l][s+1].clone(),C=h[l][s].clone(),A=new THREE.Vector2(C.u,1);this.faces.push(new THREE.Face3(x,T,b,[w,R,H])),this.faceVertexUvs[0].push([S,C,A])}this.computeCentroids(),this.computeFaceNormals()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry=function(t,e){return"undefined"==typeof t?void(t=[]):(THREE.Geometry.call(this),t=t instanceof Array?t:[t],this.shapebb=t[t.length-1].getBoundingBox(),this.addShapeList(t,e),this.computeCentroids(),void this.computeFaceNormals())
},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var i=t.length,n=0;i>n;n++){var r=t[n];this.addShape(r,e)}},THREE.ExtrudeGeometry.prototype.addShape=function(t,e){function i(t,e,i){return e||console.log("die"),e.clone().multiplyScalar(i).add(t)}function n(t,e,i){return o(t,e,i)}function r(t,e,i){var n=Math.atan2(e.y-t.y,e.x-t.x),r=Math.atan2(i.y-t.y,i.x-t.x);n>r&&(r+=2*Math.PI);var o=(n+r)/2,a=-Math.cos(o),s=-Math.sin(o),l=new THREE.Vector2(a,s);return l}function o(t,e,i){var n=THREE.ExtrudeGeometry.__v1,o=THREE.ExtrudeGeometry.__v2,a=THREE.ExtrudeGeometry.__v3,s=THREE.ExtrudeGeometry.__v4,l=THREE.ExtrudeGeometry.__v5,c=THREE.ExtrudeGeometry.__v6,h,u,f,d,p,m;return n.set(t.x-e.x,t.y-e.y),o.set(t.x-i.x,t.y-i.y),h=n.normalize(),u=o.normalize(),a.set(-h.y,h.x),s.set(u.y,-u.x),l.copy(t).add(a),c.copy(t).add(s),l.equals(c)?s.clone():(l.copy(e).add(a),c.copy(i).add(s),f=h.dot(s),d=c.sub(l).dot(s),0===f&&(console.log("Either infinite or no solutions!"),console.log(0===d?"Its finite solutions.":"Too bad, no solutions.")),p=d/f,0>p?r(t,e,i):(m=h.multiplyScalar(p).add(l),m.sub(t).clone()))}function a(){if(g){var t=0,e=q*t;for(ee=0;K>ee;ee++)Y=U[ee],h(Y[2]+e,Y[1]+e,Y[0]+e,!0);for(t=E+2*m,e=q*t,ee=0;K>ee;ee++)Y=U[ee],h(Y[0]+e,Y[1]+e,Y[2]+e,!1)}else{for(ee=0;K>ee;ee++)Y=U[ee],h(Y[2],Y[1],Y[0],!0);for(ee=0;K>ee;ee++)Y=U[ee],h(Y[0]+q*E,Y[1]+q*E,Y[2]+q*E,!1)}}function s(){var t=0;for(l(B,t),t+=B.length,D=0,P=z.length;P>D;D++)A=z[D],l(A,t),t+=A.length}function l(t,e){var i,n;for(ee=t.length;--ee>=0;){i=ee,n=ee-1,0>n&&(n=t.length-1);var r=0,o=E+2*m;for(r=0;o>r;r++){var a=q*r,s=q*(r+1),l=e+i+a,c=e+n+a,h=e+n+s,f=e+i+s;u(l,c,h,f,t,r,o,i,n)}}}function c(t,e,i){k.vertices.push(new THREE.Vector3(t,e,i))}function h(i,n,r,o){i+=N,n+=N,r+=N,k.faces.push(new THREE.Face3(i,n,r,null,null,b));var a=o?w.generateBottomUV(k,t,e,i,n,r):w.generateTopUV(k,t,e,i,n,r);k.faceVertexUvs[0].push(a)}function u(i,n,r,o,a,s,l,c,h){i+=N,n+=N,r+=N,o+=N,k.faces.push(new THREE.Face4(i,n,r,o,null,null,_));var u=w.generateSideWallUV(k,t,a,e,i,n,r,o,s,l,c,h);k.faceVertexUvs[0].push(u)}var f=void 0!==e.amount?e.amount:100,d=void 0!==e.bevelThickness?e.bevelThickness:6,p=void 0!==e.bevelSize?e.bevelSize:d-2,m=void 0!==e.bevelSegments?e.bevelSegments:3,g=void 0!==e.bevelEnabled?e.bevelEnabled:!0,v=void 0!==e.curveSegments?e.curveSegments:12,E=void 0!==e.steps?e.steps:1,y=e.extrudePath,x,T=!1,b=e.material,_=e.extrudeMaterial,w=void 0!==e.UVGenerator?e.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,R=this.shapebb,H,M,S,C;y&&(x=y.getSpacedPoints(E),T=!0,g=!1,H=void 0!==e.frames?e.frames:new THREE.TubeGeometry.FrenetFrames(y,E,!1),M=new THREE.Vector3,S=new THREE.Vector3,C=new THREE.Vector3),g||(m=0,d=0,p=0);var A,D,P,k=this,L=[],N=this.vertices.length,F=t.extractPoints(v),I=F.shape,z=F.holes,O=!THREE.Shape.Utils.isClockWise(I);if(O){for(I=I.reverse(),D=0,P=z.length;P>D;D++)A=z[D],THREE.Shape.Utils.isClockWise(A)&&(z[D]=A.reverse());O=!1}var U=THREE.Shape.Utils.triangulateShape(I,z),B=I;for(D=0,P=z.length;P>D;D++)A=z[D],I=I.concat(A);for(var V,W,j,G,X,q=I.length,Y,K=U.length,Q,Z=B.length,J=180/Math.PI,te=[],ee=0,ie=B.length,ne=ie-1,re=ee+1;ie>ee;ee++,ne++,re++){ne===ie&&(ne=0),re===ie&&(re=0);var oe=B[ee],ae=B[ne],se=B[re];te[ee]=n(B[ee],B[ne],B[re])}var le=[],ce,he=te.concat();for(D=0,P=z.length;P>D;D++){for(A=z[D],ce=[],ee=0,ie=A.length,ne=ie-1,re=ee+1;ie>ee;ee++,ne++,re++)ne===ie&&(ne=0),re===ie&&(re=0),ce[ee]=n(A[ee],A[ne],A[re]);le.push(ce),he=he.concat(ce)}for(V=0;m>V;V++){for(j=V/m,G=d*(1-j),W=p*Math.sin(j*Math.PI/2),ee=0,ie=B.length;ie>ee;ee++)X=i(B[ee],te[ee],W),c(X.x,X.y,-G);for(D=0,P=z.length;P>D;D++)for(A=z[D],ce=le[D],ee=0,ie=A.length;ie>ee;ee++)X=i(A[ee],ce[ee],W),c(X.x,X.y,-G)}for(W=p,ee=0;q>ee;ee++)X=g?i(I[ee],he[ee],W):I[ee],T?(S.copy(H.normals[0]).multiplyScalar(X.x),M.copy(H.binormals[0]).multiplyScalar(X.y),C.copy(x[0]).add(S).add(M),c(C.x,C.y,C.z)):c(X.x,X.y,0);var ue;for(ue=1;E>=ue;ue++)for(ee=0;q>ee;ee++)X=g?i(I[ee],he[ee],W):I[ee],T?(S.copy(H.normals[ue]).multiplyScalar(X.x),M.copy(H.binormals[ue]).multiplyScalar(X.y),C.copy(x[ue]).add(S).add(M),c(C.x,C.y,C.z)):c(X.x,X.y,f/E*ue);for(V=m-1;V>=0;V--){for(j=V/m,G=d*(1-j),W=p*Math.sin(j*Math.PI/2),ee=0,ie=B.length;ie>ee;ee++)X=i(B[ee],te[ee],W),c(X.x,X.y,f+G);for(D=0,P=z.length;P>D;D++)for(A=z[D],ce=le[D],ee=0,ie=A.length;ie>ee;ee++)X=i(A[ee],ce[ee],W),T?c(X.x,X.y+x[E-1].y,x[E-1].x+G):c(X.x,X.y,f+G)}a(),s()},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(t,e,i,n,r,o){var a=t.vertices[n].x,s=t.vertices[n].y,l=t.vertices[r].x,c=t.vertices[r].y,h=t.vertices[o].x,u=t.vertices[o].y;return[new THREE.Vector2(a,s),new THREE.Vector2(l,c),new THREE.Vector2(h,u)]},generateBottomUV:function(t,e,i,n,r,o){return this.generateTopUV(t,e,i,n,r,o)},generateSideWallUV:function(t,e,i,n,r,o,a,s,l,c,h,u){var f=t.vertices[r].x,d=t.vertices[r].y,p=t.vertices[r].z,m=t.vertices[o].x,g=t.vertices[o].y,v=t.vertices[o].z,E=t.vertices[a].x,y=t.vertices[a].y,x=t.vertices[a].z,T=t.vertices[s].x,b=t.vertices[s].y,_=t.vertices[s].z;return Math.abs(d-g)<.01?[new THREE.Vector2(f,1-p),new THREE.Vector2(m,1-v),new THREE.Vector2(E,1-x),new THREE.Vector2(T,1-_)]:[new THREE.Vector2(d,1-p),new THREE.Vector2(g,1-v),new THREE.Vector2(y,1-x),new THREE.Vector2(b,1-_)]}},THREE.ExtrudeGeometry.__v1=new THREE.Vector2,THREE.ExtrudeGeometry.__v2=new THREE.Vector2,THREE.ExtrudeGeometry.__v3=new THREE.Vector2,THREE.ExtrudeGeometry.__v4=new THREE.Vector2,THREE.ExtrudeGeometry.__v5=new THREE.Vector2,THREE.ExtrudeGeometry.__v6=new THREE.Vector2,THREE.ShapeGeometry=function(t,e){THREE.Geometry.call(this),t instanceof Array==!1&&(t=[t]),this.shapebb=t[t.length-1].getBoundingBox(),this.addShapeList(t,e),this.computeCentroids(),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.addShapeList=function(t,e){for(var i=0,n=t.length;n>i;i++)this.addShape(t[i],e);return this},THREE.ShapeGeometry.prototype.addShape=function(t,e){void 0===e&&(e={});var i=void 0!==e.curveSegments?e.curveSegments:12,n=e.material,r=void 0===e.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:e.UVGenerator,o=this.shapebb,a,s,l,c,h=this.vertices.length,u=t.extractPoints(i),f=u.shape,d=u.holes,p=!THREE.Shape.Utils.isClockWise(f);if(p){for(f=f.reverse(),a=0,s=d.length;s>a;a++)l=d[a],THREE.Shape.Utils.isClockWise(l)&&(d[a]=l.reverse());p=!1}var m=THREE.Shape.Utils.triangulateShape(f,d),g=f;for(a=0,s=d.length;s>a;a++)l=d[a],f=f.concat(l);var v,E=f.length,y,x=m.length,T,b=g.length;for(a=0;E>a;a++)v=f[a],this.vertices.push(new THREE.Vector3(v.x,v.y,0));for(a=0;x>a;a++){y=m[a];var _=y[0]+h,w=y[1]+h,R=y[2]+h;this.faces.push(new THREE.Face3(_,w,R,null,null,n)),this.faceVertexUvs[0].push(r.generateBottomUV(this,t,e,_,w,R))}},THREE.LatheGeometry=function(t,e,i,n){THREE.Geometry.call(this),e=e||12,i=i||0,n=n||2*Math.PI;for(var r=1/(t.length-1),o=1/e,a=0,s=e;s>=a;a++)for(var l=i+a*o*n,c=Math.cos(l),h=Math.sin(l),u=0,f=t.length;f>u;u++){var d=t[u],p=new THREE.Vector3;p.x=c*d.x-h*d.y,p.y=h*d.x+c*d.y,p.z=d.z,this.vertices.push(p)}for(var m=t.length,a=0,s=e;s>a;a++)for(var u=0,f=t.length-1;f>u;u++){var g=u+m*a,v=g,E=g+m,c=g+1+m,y=g+1;this.faces.push(new THREE.Face4(v,E,c,y));var x=a*o,T=u*r,b=x+o,_=T+r;this.faceVertexUvs[0].push([new THREE.Vector2(x,T),new THREE.Vector2(b,T),new THREE.Vector2(b,_),new THREE.Vector2(x,_)])}this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry=function(t,e,i,n){THREE.Geometry.call(this),this.width=t,this.height=e,this.widthSegments=i||1,this.heightSegments=n||1;var r,o,a=t/2,s=e/2,l=this.widthSegments,c=this.heightSegments,h=l+1,u=c+1,f=this.width/l,d=this.height/c,p=new THREE.Vector3(0,0,1);for(o=0;u>o;o++)for(r=0;h>r;r++){var m=r*f-a,g=o*d-s;this.vertices.push(new THREE.Vector3(m,-g,0))}for(o=0;c>o;o++)for(r=0;l>r;r++){var v=r+h*o,E=r+h*(o+1),y=r+1+h*(o+1),x=r+1+h*o,T=new THREE.Face4(v,E,y,x);T.normal.copy(p),T.vertexNormals.push(p.clone(),p.clone(),p.clone(),p.clone()),this.faces.push(T),this.faceVertexUvs[0].push([new THREE.Vector2(r/l,1-o/c),new THREE.Vector2(r/l,1-(o+1)/c),new THREE.Vector2((r+1)/l,1-(o+1)/c),new THREE.Vector2((r+1)/l,1-o/c)])}this.computeCentroids()},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry=function(t,e,i,n,r,o){THREE.Geometry.call(this),t=t||0,e=e||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8,n=void 0!==n?Math.max(3,n):8;var a,s,l=[],c=t,h=(e-t)/n;for(a=0;n>=a;a++){for(s=0;i>=s;s++){var u=new THREE.Vector3,f=r+s/i*o;u.x=c*Math.cos(f),u.y=c*Math.sin(f),this.vertices.push(u),l.push(new THREE.Vector2((u.x/c+1)/2,-(u.y/c+1)/2+1))}c+=h}var d=new THREE.Vector3(0,0,1);for(a=0;n>a;a++){var p=a*i;for(s=0;i>=s;s++){var f=s+p,m=f+a,g=f+i+a,v=f+i+1+a;this.faces.push(new THREE.Face3(m,g,v,[d,d,d])),this.faceVertexUvs[0].push([l[m],l[g],l[v]]),m=f+a,g=f+i+1+a,v=f+1+a,this.faces.push(new THREE.Face3(m,g,v,[d,d,d])),this.faceVertexUvs[0].push([l[m],l[g],l[v]])}}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry=function(t,e,i,n,r,o,a){THREE.Geometry.call(this),this.radius=t=t||50,this.widthSegments=e=Math.max(3,Math.floor(e)||8),this.heightSegments=i=Math.max(2,Math.floor(i)||6),this.phiStart=n=void 0!==n?n:0,this.phiLength=r=void 0!==r?r:2*Math.PI,this.thetaStart=o=void 0!==o?o:0,this.thetaLength=a=void 0!==a?a:Math.PI;var s,l,c=[],h=[];for(l=0;i>=l;l++){var u=[],f=[];for(s=0;e>=s;s++){var d=s/e,p=l/i,m=new THREE.Vector3;m.x=-t*Math.cos(n+d*r)*Math.sin(o+p*a),m.y=t*Math.cos(o+p*a),m.z=t*Math.sin(n+d*r)*Math.sin(o+p*a),this.vertices.push(m),u.push(this.vertices.length-1),f.push(new THREE.Vector2(d,1-p))}c.push(u),h.push(f)}for(l=0;l<this.heightSegments;l++)for(s=0;s<this.widthSegments;s++){var g=c[l][s+1],v=c[l][s],E=c[l+1][s],y=c[l+1][s+1],x=this.vertices[g].clone().normalize(),T=this.vertices[v].clone().normalize(),b=this.vertices[E].clone().normalize(),_=this.vertices[y].clone().normalize(),w=h[l][s+1].clone(),R=h[l][s].clone(),H=h[l+1][s].clone(),M=h[l+1][s+1].clone();Math.abs(this.vertices[g].y)===this.radius?(this.faces.push(new THREE.Face3(g,E,y,[x,b,_])),this.faceVertexUvs[0].push([w,H,M])):Math.abs(this.vertices[E].y)===this.radius?(this.faces.push(new THREE.Face3(g,v,E,[x,T,b])),this.faceVertexUvs[0].push([w,R,H])):(this.faces.push(new THREE.Face4(g,v,E,y,[x,T,b,_])),this.faceVertexUvs[0].push([w,R,H,M]))}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,t)},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TextGeometry=function(t,e){e=e||{};var i=THREE.FontUtils.generateShapes(t,e);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,i,e)},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TorusGeometry=function(t,e,i,n,r){THREE.Geometry.call(this);var o=this;this.radius=t||100,this.tube=e||40,this.radialSegments=i||8,this.tubularSegments=n||6,this.arc=r||2*Math.PI;for(var a=new THREE.Vector3,s=[],l=[],c=0;c<=this.radialSegments;c++)for(var h=0;h<=this.tubularSegments;h++){var u=h/this.tubularSegments*this.arc,f=c/this.radialSegments*Math.PI*2;a.x=this.radius*Math.cos(u),a.y=this.radius*Math.sin(u);var d=new THREE.Vector3;d.x=(this.radius+this.tube*Math.cos(f))*Math.cos(u),d.y=(this.radius+this.tube*Math.cos(f))*Math.sin(u),d.z=this.tube*Math.sin(f),this.vertices.push(d),s.push(new THREE.Vector2(h/this.tubularSegments,c/this.radialSegments)),l.push(d.clone().sub(a).normalize())}for(var c=1;c<=this.radialSegments;c++)for(var h=1;h<=this.tubularSegments;h++){var p=(this.tubularSegments+1)*c+h-1,m=(this.tubularSegments+1)*(c-1)+h-1,g=(this.tubularSegments+1)*(c-1)+h,v=(this.tubularSegments+1)*c+h,E=new THREE.Face4(p,m,g,v,[l[p],l[m],l[g],l[v]]);E.normal.add(l[p]),E.normal.add(l[m]),E.normal.add(l[g]),E.normal.add(l[v]),E.normal.normalize(),this.faces.push(E),this.faceVertexUvs[0].push([s[p].clone(),s[m].clone(),s[g].clone(),s[v].clone()])}this.computeCentroids()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry=function(t,e,i,n,r,o,a){function s(t,e,i){return c.vertices.push(new THREE.Vector3(t,e,i))-1}function l(t,e,i,n,r,o){var a=Math.cos(t),s=Math.cos(e),l=Math.sin(t),c=i/n*t,h=Math.cos(c),u=r*(2+h)*.5*a,f=r*(2+h)*l*.5,d=o*r*Math.sin(c)*.5;return new THREE.Vector3(u,f,d)}THREE.Geometry.call(this);var c=this;this.radius=t||100,this.tube=e||40,this.radialSegments=i||64,this.tubularSegments=n||8,this.p=r||2,this.q=o||3,this.heightScale=a||1,this.grid=new Array(this.radialSegments);for(var h=new THREE.Vector3,u=new THREE.Vector3,f=new THREE.Vector3,d=0;d<this.radialSegments;++d){this.grid[d]=new Array(this.tubularSegments);for(var p=0;p<this.tubularSegments;++p){var m=d/this.radialSegments*2*this.p*Math.PI,g=p/this.tubularSegments*2*Math.PI,v=l(m,g,this.q,this.p,this.radius,this.heightScale),E=l(m+.01,g,this.q,this.p,this.radius,this.heightScale),y,x;h.subVectors(E,v),u.addVectors(E,v),f.crossVectors(h,u),u.crossVectors(f,h),f.normalize(),u.normalize(),y=-this.tube*Math.cos(g),x=this.tube*Math.sin(g),v.x+=y*u.x+x*f.x,v.y+=y*u.y+x*f.y,v.z+=y*u.z+x*f.z,this.grid[d][p]=s(v.x,v.y,v.z)}}for(var d=0;d<this.radialSegments;++d)for(var p=0;p<this.tubularSegments;++p){var T=(d+1)%this.radialSegments,b=(p+1)%this.tubularSegments,_=this.grid[d][p],w=this.grid[T][p],R=this.grid[T][b],H=this.grid[d][b],M=new THREE.Vector2(d/this.radialSegments,p/this.tubularSegments),S=new THREE.Vector2((d+1)/this.radialSegments,p/this.tubularSegments),C=new THREE.Vector2((d+1)/this.radialSegments,(p+1)/this.tubularSegments),A=new THREE.Vector2(d/this.radialSegments,(p+1)/this.tubularSegments);this.faces.push(new THREE.Face4(_,w,R,H)),this.faceVertexUvs[0].push([M,S,C,A])}this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry=function(t,e,i,n,r,o){function a(t,e,i){return s.vertices.push(new THREE.Vector3(t,e,i))-1}THREE.Geometry.call(this),this.path=t,this.segments=e||64,this.radius=i||1,this.radiusSegments=n||8,this.closed=r||!1,o&&(this.debug=new THREE.Object3D),this.grid=[];var s=this,l,c,h,u=this.segments+1,f,d,p,m,g,v,E,y,x,T,b,_=new THREE.Vector3,w,R,H,M,S,C,A,D,P,k,L,N,F=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed),I=F.tangents,z=F.normals,O=F.binormals;for(this.tangents=I,this.normals=z,this.binormals=O,w=0;u>w;w++)for(this.grid[w]=[],E=w/(u-1),b=t.getPointAt(E),l=I[w],c=z[w],h=O[w],this.debug&&(this.debug.add(new THREE.ArrowHelper(l,b,i,255)),this.debug.add(new THREE.ArrowHelper(c,b,i,16711680)),this.debug.add(new THREE.ArrowHelper(h,b,i,65280))),R=0;R<this.radiusSegments;R++)y=R/this.radiusSegments*2*Math.PI,x=-this.radius*Math.cos(y),T=this.radius*Math.sin(y),_.copy(b),_.x+=x*c.x+T*h.x,_.y+=x*c.y+T*h.y,_.z+=x*c.z+T*h.z,this.grid[w][R]=a(_.x,_.y,_.z);for(w=0;w<this.segments;w++)for(R=0;R<this.radiusSegments;R++)H=this.closed?(w+1)%this.segments:w+1,M=(R+1)%this.radiusSegments,S=this.grid[w][R],C=this.grid[H][R],A=this.grid[H][M],D=this.grid[w][M],P=new THREE.Vector2(w/this.segments,R/this.radiusSegments),k=new THREE.Vector2((w+1)/this.segments,R/this.radiusSegments),L=new THREE.Vector2((w+1)/this.segments,(R+1)/this.radiusSegments),N=new THREE.Vector2(w/this.segments,(R+1)/this.radiusSegments),this.faces.push(new THREE.Face4(S,C,A,D)),this.faceVertexUvs[0].push([P,k,L,N]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.FrenetFrames=function(t,e,i){function n(t){h[0]=new THREE.Vector3,u[0]=new THREE.Vector3,void 0===t&&(t=new THREE.Vector3(0,0,1)),h[0].crossVectors(t,c[0]).normalize(),u[0].crossVectors(c[0],h[0]).normalize()}function r(){var e=t.getTangentAt(g);h[0]=(new THREE.Vector3).subVectors(e,c[0]).normalize(),u[0]=(new THREE.Vector3).crossVectors(c[0],h[0]),h[0].crossVectors(u[0],c[0]).normalize(),u[0].crossVectors(c[0],h[0]).normalize()}function o(){h[0]=new THREE.Vector3,u[0]=new THREE.Vector3,v=Number.MAX_VALUE,E=Math.abs(c[0].x),y=Math.abs(c[0].y),x=Math.abs(c[0].z),v>=E&&(v=E,s.set(1,0,0)),v>=y&&(v=y,s.set(0,1,0)),v>=x&&s.set(0,0,1),f.crossVectors(c[0],s).normalize(),h[0].crossVectors(c[0],f),u[0].crossVectors(c[0],h[0])}var a=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3,c=[],h=[],u=[],f=new THREE.Vector3,d=new THREE.Matrix4,p=e+1,m,g=1e-4,v,E,y,x,T,b,_;for(this.tangents=c,this.normals=h,this.binormals=u,T=0;p>T;T++)b=T/(p-1),c[T]=t.getTangentAt(b),c[T].normalize();for(o(),T=1;p>T;T++)h[T]=h[T-1].clone(),u[T]=u[T-1].clone(),f.crossVectors(c[T-1],c[T]),f.length()>g&&(f.normalize(),m=Math.acos(c[T-1].dot(c[T])),h[T].applyMatrix4(d.makeRotationAxis(f,m))),u[T].crossVectors(c[T],h[T]);if(i)for(m=Math.acos(h[0].dot(h[p-1])),m/=p-1,c[0].dot(f.crossVectors(h[0],h[p-1]))>0&&(m=-m),T=1;p>T;T++)h[T].applyMatrix4(d.makeRotationAxis(c[T],m*T)),u[T].crossVectors(c[T],h[T])},THREE.PolyhedronGeometry=function(t,e,i,n){function r(t){var e=t.normalize().clone();e.index=h.vertices.push(e)-1;var i=s(t)/2/Math.PI+.5,n=l(t)/Math.PI+.5;return e.uv=new THREE.Vector2(i,1-n),e}function o(t,e,i){var n=new THREE.Face3(t.index,e.index,i.index,[t.clone(),e.clone(),i.clone()]);n.centroid.add(t).add(e).add(i).divideScalar(3),n.normal.copy(n.centroid).normalize(),h.faces.push(n);var r=s(n.centroid);h.faceVertexUvs[0].push([c(t.uv,t,r),c(e.uv,e,r),c(i.uv,i,r)])}function a(t,e){for(var i=Math.pow(2,e),n=Math.pow(4,e),a=r(h.vertices[t.a]),s=r(h.vertices[t.b]),l=r(h.vertices[t.c]),c=[],u=0;i>=u;u++){c[u]=[];for(var f=r(a.clone().lerp(l,u/i)),d=r(s.clone().lerp(l,u/i)),p=i-u,m=0;p>=m;m++)c[u][m]=0==m&&u==i?f:r(f.clone().lerp(d,m/p))}for(var u=0;i>u;u++)for(var m=0;2*(i-u)-1>m;m++){var g=Math.floor(m/2);m%2==0?o(c[u][g+1],c[u+1][g],c[u][g]):o(c[u][g+1],c[u+1][g+1],c[u+1][g])}}function s(t){return Math.atan2(t.z,-t.x)}function l(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}function c(t,e,i){return 0>i&&1===t.x&&(t=new THREE.Vector2(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new THREE.Vector2(i/2/Math.PI+.5,t.y)),t.clone()}THREE.Geometry.call(this),i=i||1,n=n||0;for(var h=this,u=0,f=t.length;f>u;u++)r(new THREE.Vector3(t[u][0],t[u][1],t[u][2]));for(var d=[],p=this.vertices,m=[],u=0,f=e.length;f>u;u++){var g=p[e[u][0]],v=p[e[u][1]],E=p[e[u][2]];m[u]=new THREE.Face3(g.index,v.index,E.index,[g.clone(),v.clone(),E.clone()])}for(var u=0,f=m.length;f>u;u++)a(m[u],n);for(var u=0,f=this.faceVertexUvs[0].length;f>u;u++){var y=this.faceVertexUvs[0][u],x=y[0].x,T=y[1].x,b=y[2].x,_=Math.max(x,Math.max(T,b)),w=Math.min(x,Math.min(T,b));_>.9&&.1>w&&(.2>x&&(y[0].x+=1),.2>T&&(y[1].x+=1),.2>b&&(y[2].x+=1))}this.mergeVertices();for(var u=0,f=this.vertices.length;f>u;u++)this.vertices[u].multiplyScalar(i);this.computeCentroids(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,i)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.IcosahedronGeometry=function(t,e){this.radius=t,this.detail=e;var i=(1+Math.sqrt(5))/2,n=[[-1,i,0],[1,i,0],[-1,-i,0],[1,-i,0],[0,-1,i],[0,1,i],[0,-1,-i],[0,1,-i],[i,0,-1],[i,0,1],[-i,0,-1],[-i,0,1]],r=[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]];THREE.PolyhedronGeometry.call(this,n,r,t,e)},THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.OctahedronGeometry=function(t,e){var i=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],n=[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]];THREE.PolyhedronGeometry.call(this,i,n,t,e)},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TetrahedronGeometry=function(t,e){var i=[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],n=[[2,1,0],[0,3,2],[1,3,0],[2,3,1]];THREE.PolyhedronGeometry.call(this,i,n,t,e)},THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry=function(t,e,i,n){THREE.Geometry.call(this);var r=this.vertices,o=this.faces,a=this.faceVertexUvs[0];n=void 0===n?!1:n;var s,l,c,h,u,f,d=i+1,p=e+1;for(s=0;i>=s;s++)for(f=s/i,c=0;e>=c;c++)u=c/e,h=t(u,f),r.push(h);var m,g,v,E,y,x,T,b;for(s=0;i>s;s++)for(c=0;e>c;c++)m=s*p+c,g=s*p+c+1,v=(s+1)*p+c,E=(s+1)*p+c+1,y=new THREE.Vector2(c/e,s/i),x=new THREE.Vector2((c+1)/e,s/i),T=new THREE.Vector2(c/e,(s+1)/i),b=new THREE.Vector2((c+1)/e,(s+1)/i),n?(o.push(new THREE.Face3(m,g,v)),o.push(new THREE.Face3(g,E,v)),a.push([y,x,T]),a.push([x,b,T])):(o.push(new THREE.Face4(m,g,E,v)),a.push([y,x,b,T]));this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ConvexGeometry=function(t){function e(e){var n=t[e].clone(),a=n.length();n.x+=a*o(),n.y+=a*o(),n.z+=a*o();for(var l=[],c=0;c<s.length;){var h=s[c];if(i(h,n)){for(var u=0;3>u;u++){for(var f=[h[u],h[(u+1)%3]],d=!0,p=0;p<l.length;p++)if(r(l[p],f)){l[p]=l[l.length-1],l.pop(),d=!1;break}d&&l.push(f)}s[c]=s[s.length-1],s.pop()}else c++}for(var p=0;p<l.length;p++)s.push([l[p][0],l[p][1],e])}function i(e,i){var r=t[e[0]],o=t[e[1]],a=t[e[2]],s=n(r,o,a),l=s.dot(r);return s.dot(i)>=l}function n(t,e,i){var n=new THREE.Vector3,r=new THREE.Vector3;return n.subVectors(i,e),r.subVectors(t,e),n.cross(r),n.normalize(),n}function r(t,e){return t[0]===e[1]&&t[1]===e[0]}function o(){return 2*(Math.random()-.5)*1e-6}function a(t){var e=t.length();return new THREE.Vector2(t.x/e,t.y/e)}THREE.Geometry.call(this);for(var s=[[0,1,2],[0,2,1]],l=3;l<t.length;l++)e(l);for(var c=0,h=new Array(t.length),l=0;l<s.length;l++)for(var u=s[l],f=0;3>f;f++)void 0===h[u[f]]&&(h[u[f]]=c++,this.vertices.push(t[u[f]])),u[f]=h[u[f]];for(var l=0;l<s.length;l++)this.faces.push(new THREE.Face3(s[l][0],s[l][1],s[l][2]));for(var l=0;l<this.faces.length;l++){var u=this.faces[l];this.faceVertexUvs[0].push([a(this.vertices[u.a]),a(this.vertices[u.b]),a(this.vertices[u.c])])}this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ConvexGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.AxisHelper=function(t){t=t||1;var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3,new THREE.Vector3(t,0,0),new THREE.Vector3,new THREE.Vector3(0,t,0),new THREE.Vector3,new THREE.Vector3(0,0,t)),e.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));var i=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,e,i,THREE.LinePieces)},THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype),THREE.ArrowHelper=function(t,e,i,n){THREE.Object3D.call(this),void 0===n&&(n=16776960),void 0===i&&(i=1),this.position=e,this.useQuaternion=!0;var r=new THREE.Geometry;r.vertices.push(new THREE.Vector3(0,0,0)),r.vertices.push(new THREE.Vector3(0,1,0)),this.line=new THREE.Line(r,new THREE.LineBasicMaterial({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line);var o=new THREE.CylinderGeometry(0,.05,.25,5,1);o.applyMatrix((new THREE.Matrix4).makeTranslation(0,.875,0)),this.cone=new THREE.Mesh(o,new THREE.MeshBasicMaterial({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i)},THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.setDirection=function(){var t=new THREE.Vector3,e;return function(i){i.y>.999?this.quaternion.set(0,0,0,1):i.y<-.999?this.quaternion.set(1,0,0,0):(t.set(i.z,0,-i.x).normalize(),e=Math.acos(i.y),this.quaternion.setFromAxisAngle(t,e))}}(),THREE.ArrowHelper.prototype.setLength=function(t){this.scale.set(t,t,t)},THREE.ArrowHelper.prototype.setColor=function(t){this.line.material.color.setHex(t),this.cone.material.color.setHex(t)},THREE.BoxHelper=function(t){t=t||1;var e=new THREE.Geometry,i=[new THREE.Vector3(t,t,t),new THREE.Vector3(-t,t,t),new THREE.Vector3(-t,-t,t),new THREE.Vector3(t,-t,t),new THREE.Vector3(t,t,-t),new THREE.Vector3(-t,t,-t),new THREE.Vector3(-t,-t,-t),new THREE.Vector3(t,-t,-t)];e.vertices.push(i[0],i[1],i[1],i[2],i[2],i[3],i[3],i[0],i[4],i[5],i[5],i[6],i[6],i[7],i[7],i[4],i[0],i[4],i[1],i[5],i[2],i[6],i[3],i[7]),this.vertices=i,THREE.Line.call(this,e,new THREE.LineBasicMaterial,THREE.LinePieces)},THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype),THREE.BoxHelper.prototype.update=function(t){var e=t.geometry;null===e.boundingBox&&e.computeBoundingBox();var i=e.boundingBox.min,n=e.boundingBox.max,r=this.vertices;r[0].set(n.x,n.y,n.z),r[1].set(i.x,n.y,n.z),r[2].set(i.x,i.y,n.z),r[3].set(n.x,i.y,n.z),r[4].set(n.x,n.y,i.z),r[5].set(i.x,n.y,i.z),r[6].set(i.x,i.y,i.z),r[7].set(n.x,i.y,i.z),this.geometry.computeBoundingSphere(),this.geometry.verticesNeedUpdate=!0,this.matrixAutoUpdate=!1,this.matrixWorld=t.matrixWorld},THREE.CameraHelper=function(t){function e(t,e,n){i(t,n),i(e,n)}function i(t,e){n.vertices.push(new THREE.Vector3),n.colors.push(new THREE.Color(e)),void 0===o[t]&&(o[t]=[]),o[t].push(n.vertices.length-1)}THREE.Line.call(this);var n=new THREE.Geometry,r=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),o={},a=16755200,s=16711680,l=43775,c=16777215,h=3355443;e("n1","n2",a),e("n2","n4",a),e("n4","n3",a),e("n3","n1",a),e("f1","f2",a),e("f2","f4",a),e("f4","f3",a),e("f3","f1",a),e("n1","f1",a),e("n2","f2",a),e("n3","f3",a),e("n4","f4",a),e("p","n1",s),e("p","n2",s),e("p","n3",s),e("p","n4",s),e("u1","u2",l),e("u2","u3",l),e("u3","u1",l),e("c","t",c),e("p","c",h),e("cn1","cn2",h),e("cn3","cn4",h),e("cf1","cf2",h),e("cf3","cf4",h),THREE.Line.call(this,n,r,THREE.LinePieces),this.camera=t,this.matrixWorld=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype),THREE.CameraHelper.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Camera,i=new THREE.Projector;return function(){function n(n,o,a,s){t.set(o,a,s),i.unprojectVector(t,e);var l=r.pointMap[n];if(void 0!==l)for(var c=0,h=l.length;h>c;c++)r.geometry.vertices[l[c]].copy(t)}var r=this,o=1,a=1;e.projectionMatrix.copy(this.camera.projectionMatrix),n("c",0,0,-1),n("t",0,0,1),n("n1",-o,-a,-1),n("n2",o,-a,-1),n("n3",-o,a,-1),n("n4",o,a,-1),n("f1",-o,-a,1),n("f2",o,-a,1),n("f3",-o,a,1),n("f4",o,a,1),n("u1",.7*o,1.1*a,-1),n("u2",.7*-o,1.1*a,-1),n("u3",0,2*a,-1),n("cf1",-o,0,1),n("cf2",o,0,1),n("cf3",0,-a,1),n("cf4",0,a,1),n("cn1",-o,0,-1),n("cn2",o,0,-1),n("cn3",0,-a,-1),n("cn4",0,a,-1),this.geometry.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(t,e){THREE.Object3D.call(this),this.matrixAutoUpdate=!1,this.light=t;var i=new THREE.SphereGeometry(e,4,2),n=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere=new THREE.Mesh(i,n),this.lightSphere.matrixWorld=this.light.matrixWorld,this.lightSphere.matrixAutoUpdate=!1,this.add(this.lightSphere),i=new THREE.Geometry,i.vertices.push(this.light.position),i.vertices.push(this.light.target.position),i.computeLineDistances(),n=new THREE.LineDashedMaterial({dashSize:4,gapSize:4,opacity:.75,transparent:!0,fog:!1}),n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(i,n),this.add(this.targetLine)},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.update=function(){this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.computeLineDistances(),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.GridHelper=function(t,e){for(var i=new THREE.Geometry,n=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),r=new THREE.Color(4473924),o=new THREE.Color(8947848),a=-t;t>=a;a+=e){i.vertices.push(new THREE.Vector3(-t,0,a)),i.vertices.push(new THREE.Vector3(t,0,a)),i.vertices.push(new THREE.Vector3(a,0,-t)),i.vertices.push(new THREE.Vector3(a,0,t));var s=0===a?r:o;i.colors.push(s,s,s,s)}THREE.Line.call(this,i,n,THREE.LinePieces)},THREE.GridHelper.prototype=Object.create(THREE.Line.prototype),THREE.HemisphereLightHelper=function(t,e,i,n){THREE.Object3D.call(this),this.light=t;var r=new THREE.SphereGeometry(e,4,2);r.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var o=0,a=8;a>o;o++)r.faces[o].materialIndex=4>o?0:1;var s=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});s.color.copy(t.color).multiplyScalar(t.intensity);var l=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});l.color.copy(t.groundColor).multiplyScalar(t.intensity),this.lightSphere=new THREE.Mesh(r,new THREE.MeshFaceMaterial([s,l])),this.lightSphere.position=t.position,this.lightSphere.lookAt(new THREE.Vector3),this.add(this.lightSphere)},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.update=function(){this.lightSphere.lookAt(new THREE.Vector3),this.lightSphere.material.materials[0].color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere.material.materials[1].color.copy(this.light.groundColor).multiplyScalar(this.light.intensity)},THREE.PointLightHelper=function(t,e){THREE.Object3D.call(this),this.matrixAutoUpdate=!1,this.light=t;var i=new THREE.SphereGeometry(e,4,2),n=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere=new THREE.Mesh(i,n),this.lightSphere.matrixWorld=this.light.matrixWorld,this.lightSphere.matrixAutoUpdate=!1,this.add(this.lightSphere)},THREE.PointLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.PointLightHelper.prototype.update=function(){this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SpotLightHelper=function(t,e){THREE.Object3D.call(this),this.matrixAutoUpdate=!1,this.light=t;var i=new THREE.SphereGeometry(e,4,2),n=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere=new THREE.Mesh(i,n),this.lightSphere.matrixWorld=this.light.matrixWorld,this.lightSphere.matrixAutoUpdate=!1,this.add(this.lightSphere),i=new THREE.CylinderGeometry(1e-4,1,1,8,1,!0),i.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0)),i.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2)),n=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0,opacity:.3,transparent:!0}),n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightCone=new THREE.Mesh(i,n),this.lightCone.position=this.light.position;var r=t.distance?t.distance:1e4,o=r*Math.tan(t.angle);this.lightCone.scale.set(o,o,r),this.lightCone.lookAt(this.light.target.position),this.add(this.lightCone)},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.update=function(){var t=this.light.distance?this.light.distance:1e4,e=t*Math.tan(this.light.angle);this.lightCone.scale.set(e,e,t),this.lightCone.lookAt(this.light.target.position),this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightCone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this),this.render=function(t){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare=function(t,e,i,n,r){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,i,n,r)
},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.add=function(t,e,i,n,r,o){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===o&&(o=1),void 0===r&&(r=new THREE.Color(16777215)),void 0===n&&(n=THREE.NormalBlending),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:t,size:e,distance:i,x:0,y:0,z:0,scale:1,rotation:1,opacity:o,color:r,blending:n})},THREE.LensFlare.prototype.updateLensFlares=function(){var t,e=this.lensFlares.length,i,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;e>t;t++)i=this.lensFlares[t],i.x=this.positionScreen.x+n*i.distance,i.y=this.positionScreen.y+r*i.distance,i.wantedRotation=i.x*Math.PI*.25,i.rotation+=.25*(i.wantedRotation-i.rotation)},THREE.MorphBlendMesh=function(t,e){THREE.Mesh.call(this,t,e),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n="__default",r=0,o=i-1,a=i/1;this.createAnimation(n,r,o,a),this.setAnimationWeight(n,1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.createAnimation=function(t,e,i,n){var r={startFrame:e,endFrame:i,length:i-e+1,fps:n,duration:(i-e)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=r,this.animationsList.push(r)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e=/([a-z]+)(\d+)/,i,n={},r=this.geometry,o=0,a=r.morphTargets.length;a>o;o++){var s=r.morphTargets[o],l=s.name.match(e);if(l&&l.length>1){var c=l[1],h=l[2];n[c]||(n[c]={start:1/0,end:-1/0});var u=n[c];o<u.start&&(u.start=o),o>u.end&&(u.end=o),i||(i=c)}}for(var c in n){var u=n[c];this.createAnimation(c,u.start,u.end,t)}this.firstAnimation=i},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var i=this.animationsMap[t];i&&(i.fps=e,i.duration=(i.end-i.start)/i.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var i=this.animationsMap[t];i&&(i.duration=e,i.fps=(i.end-i.start)/i.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var i=this.animationsMap[t];i&&(i.weight=e)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var i=this.animationsMap[t];i&&(i.time=e)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0,i=this.animationsMap[t];return i&&(e=i.time),e},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1,i=this.animationsMap[t];return i&&(e=i.duration),e},THREE.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("animation["+t+"] undefined")},THREE.MorphBlendMesh.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},THREE.MorphBlendMesh.prototype.update=function(t){for(var e=0,i=this.animationsList.length;i>e;e++){var n=this.animationsList[e];if(n.active){var r=n.duration/n.length;n.time+=n.direction*t,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var o=n.startFrame+THREE.Math.clamp(Math.floor(n.time/r),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o);var s=n.time%r/r;n.directionBackwards&&(s=1-s),this.morphTargetInfluences[n.currentFrame]=s*a,this.morphTargetInfluences[n.lastFrame]=(1-s)*a}}},THREE.LensFlarePlugin=function(){function t(t,i){var n=e.createProgram(),r=e.createShader(e.FRAGMENT_SHADER),o=e.createShader(e.VERTEX_SHADER),a="precision "+i+" float;\n";return e.shaderSource(r,a+t.fragmentShader),e.shaderSource(o,a+t.vertexShader),e.compileShader(r),e.compileShader(o),e.attachShader(n,r),e.attachShader(n,o),e.linkProgram(n),n}var e,i,n,r={};this.init=function(o){e=o.context,i=o,n=o.getPrecision(),r.vertices=new Float32Array(16),r.faces=new Uint16Array(6);var a=0;r.vertices[a++]=-1,r.vertices[a++]=-1,r.vertices[a++]=0,r.vertices[a++]=0,r.vertices[a++]=1,r.vertices[a++]=-1,r.vertices[a++]=1,r.vertices[a++]=0,r.vertices[a++]=1,r.vertices[a++]=1,r.vertices[a++]=1,r.vertices[a++]=1,r.vertices[a++]=-1,r.vertices[a++]=1,r.vertices[a++]=0,r.vertices[a++]=1,a=0,r.faces[a++]=0,r.faces[a++]=1,r.faces[a++]=2,r.faces[a++]=0,r.faces[a++]=2,r.faces[a++]=3,r.vertexBuffer=e.createBuffer(),r.elementBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,r.vertices,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.elementBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,r.faces,e.STATIC_DRAW),r.tempTexture=e.createTexture(),r.occlusionTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,r.tempTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGB,16,16,0,e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.bindTexture(e.TEXTURE_2D,r.occlusionTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,16,16,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<=0?(r.hasVertexTexture=!1,r.program=t(THREE.ShaderFlares.lensFlare,n)):(r.hasVertexTexture=!0,r.program=t(THREE.ShaderFlares.lensFlareVertexTexture,n)),r.attributes={},r.uniforms={},r.attributes.vertex=e.getAttribLocation(r.program,"position"),r.attributes.uv=e.getAttribLocation(r.program,"uv"),r.uniforms.renderType=e.getUniformLocation(r.program,"renderType"),r.uniforms.map=e.getUniformLocation(r.program,"map"),r.uniforms.occlusionMap=e.getUniformLocation(r.program,"occlusionMap"),r.uniforms.opacity=e.getUniformLocation(r.program,"opacity"),r.uniforms.color=e.getUniformLocation(r.program,"color"),r.uniforms.scale=e.getUniformLocation(r.program,"scale"),r.uniforms.rotation=e.getUniformLocation(r.program,"rotation"),r.uniforms.screenPosition=e.getUniformLocation(r.program,"screenPosition")},this.render=function(t,n,o,a){var s=t.__webglFlares,l=s.length;if(l){var c=new THREE.Vector3,h=a/o,u=.5*o,f=.5*a,d=16/a,p=new THREE.Vector2(d*h,d),m=new THREE.Vector3(1,1,0),g=new THREE.Vector2(1,1),v=r.uniforms,E=r.attributes;e.useProgram(r.program),e.enableVertexAttribArray(r.attributes.vertex),e.enableVertexAttribArray(r.attributes.uv),e.uniform1i(v.occlusionMap,0),e.uniform1i(v.map,1),e.bindBuffer(e.ARRAY_BUFFER,r.vertexBuffer),e.vertexAttribPointer(E.vertex,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(E.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.elementBuffer),e.disable(e.CULL_FACE),e.depthMask(!1);var y,x,T,b,_;for(y=0;l>y;y++)if(d=16/a,p.set(d*h,d),b=s[y],c.set(b.matrixWorld.elements[12],b.matrixWorld.elements[13],b.matrixWorld.elements[14]),c.applyMatrix4(n.matrixWorldInverse),c.applyProjection(n.projectionMatrix),m.copy(c),g.x=m.x*u+u,g.y=m.y*f+f,r.hasVertexTexture||g.x>0&&g.x<o&&g.y>0&&g.y<a)for(e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r.tempTexture),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGB,g.x-8,g.y-8,16,16,0),e.uniform1i(v.renderType,0),e.uniform2f(v.scale,p.x,p.y),e.uniform3f(v.screenPosition,m.x,m.y,m.z),e.disable(e.BLEND),e.enable(e.DEPTH_TEST),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,r.occlusionTexture),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,g.x-8,g.y-8,16,16,0),e.uniform1i(v.renderType,1),e.disable(e.DEPTH_TEST),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,r.tempTexture),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),b.positionScreen.copy(m),b.customUpdateCallback?b.customUpdateCallback(b):b.updateLensFlares(),e.uniform1i(v.renderType,2),e.enable(e.BLEND),x=0,T=b.lensFlares.length;T>x;x++)_=b.lensFlares[x],_.opacity>.001&&_.scale>.001&&(m.x=_.x,m.y=_.y,m.z=_.z,d=_.size*_.scale/a,p.x=d*h,p.y=d,e.uniform3f(v.screenPosition,m.x,m.y,m.z),e.uniform2f(v.scale,p.x,p.y),e.uniform1f(v.rotation,_.rotation),e.uniform1f(v.opacity,_.opacity),e.uniform3f(v.color,_.color.r,_.color.g,_.color.b),i.setBlending(_.blending,_.blendEquation,_.blendSrc,_.blendDst),i.setTexture(_.texture,1),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0));e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthMask(!0)}}},THREE.ShadowMapPlugin=function(){function t(t,e){var i=new THREE.DirectionalLight;i.isVirtual=!0,i.onlyShadow=!0,i.castShadow=!0,i.shadowCameraNear=t.shadowCameraNear,i.shadowCameraFar=t.shadowCameraFar,i.shadowCameraLeft=t.shadowCameraLeft,i.shadowCameraRight=t.shadowCameraRight,i.shadowCameraBottom=t.shadowCameraBottom,i.shadowCameraTop=t.shadowCameraTop,i.shadowCameraVisible=t.shadowCameraVisible,i.shadowDarkness=t.shadowDarkness,i.shadowBias=t.shadowCascadeBias[e],i.shadowMapWidth=t.shadowCascadeWidth[e],i.shadowMapHeight=t.shadowCascadeHeight[e],i.pointsWorld=[],i.pointsFrustum=[];for(var n=i.pointsWorld,r=i.pointsFrustum,o=0;8>o;o++)n[o]=new THREE.Vector3,r[o]=new THREE.Vector3;var a=t.shadowCascadeNearZ[e],s=t.shadowCascadeFarZ[e];return r[0].set(-1,-1,a),r[1].set(1,-1,a),r[2].set(-1,1,a),r[3].set(1,1,a),r[4].set(-1,-1,s),r[5].set(1,-1,s),r[6].set(-1,1,s),r[7].set(1,1,s),i}function e(t,e){var i=t.shadowCascadeArray[e];i.position.copy(t.position),i.target.position.copy(t.target.position),i.lookAt(i.target),i.shadowCameraVisible=t.shadowCameraVisible,i.shadowDarkness=t.shadowDarkness,i.shadowBias=t.shadowCascadeBias[e];var n=t.shadowCascadeNearZ[e],r=t.shadowCascadeFarZ[e],o=i.pointsFrustum;o[0].z=n,o[1].z=n,o[2].z=n,o[3].z=n,o[4].z=r,o[5].z=r,o[6].z=r,o[7].z=r}function i(t,e){var i=e.shadowCamera,n=e.pointsFrustum,r=e.pointsWorld;f.set(1/0,1/0,1/0),d.set(-1/0,-1/0,-1/0);for(var o=0;8>o;o++){var a=r[o];a.copy(n[o]),THREE.ShadowMapPlugin.__projector.unprojectVector(a,t),a.applyMatrix4(i.matrixWorldInverse),a.x<f.x&&(f.x=a.x),a.x>d.x&&(d.x=a.x),a.y<f.y&&(f.y=a.y),a.y>d.y&&(d.y=a.y),a.z<f.z&&(f.z=a.z),a.z>d.z&&(d.z=a.z)}i.left=f.x,i.right=d.x,i.top=d.y,i.bottom=f.y,i.updateProjectionMatrix()}function n(t){return t.material instanceof THREE.MeshFaceMaterial?t.material.materials[0]:t.material}var r,o,a,s,l,c,h=new THREE.Frustum,u=new THREE.Matrix4,f=new THREE.Vector3,d=new THREE.Vector3,p=new THREE.Vector3;this.init=function(t){r=t.context,o=t;var e=THREE.ShaderLib.depthRGBA,i=THREE.UniformsUtils.clone(e.uniforms);a=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:i}),s=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:i,morphTargets:!0}),l=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:i,skinning:!0}),c=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:i,morphTargets:!0,skinning:!0}),a._shadowPass=!0,s._shadowPass=!0,l._shadowPass=!0,c._shadowPass=!0},this.render=function(t,e){o.shadowMapEnabled&&o.shadowMapAutoUpdate&&this.update(t,e)},this.update=function(f,d){var m,g,v,E,y,x,T,b,_,w,R,H,M,S,C,A=[],D=0,P=null;for(r.clearColor(1,1,1,1),r.disable(r.BLEND),r.enable(r.CULL_FACE),r.frontFace(r.CCW),r.cullFace(o.shadowMapCullFace===THREE.CullFaceFront?r.FRONT:r.BACK),o.setDepthTest(!0),m=0,g=f.__lights.length;g>m;m++)if(S=f.__lights[m],S.castShadow)if(S instanceof THREE.DirectionalLight&&S.shadowCascade)for(y=0;y<S.shadowCascadeCount;y++){var k;if(S.shadowCascadeArray[y])k=S.shadowCascadeArray[y];else{k=t(S,y),k.originalCamera=d;var L=new THREE.Gyroscope;L.position=S.shadowCascadeOffset,L.add(k),L.add(k.target),d.add(L),S.shadowCascadeArray[y]=k,console.log("Created virtualLight",k)}e(S,y),A[D]=k,D++}else A[D]=S,D++;for(m=0,g=A.length;g>m;m++){if(S=A[m],!S.shadowMap){var N=THREE.LinearFilter;o.shadowMapType===THREE.PCFSoftShadowMap&&(N=THREE.NearestFilter);var F={minFilter:N,magFilter:N,format:THREE.RGBAFormat};S.shadowMap=new THREE.WebGLRenderTarget(S.shadowMapWidth,S.shadowMapHeight,F),S.shadowMapSize=new THREE.Vector2(S.shadowMapWidth,S.shadowMapHeight),S.shadowMatrix=new THREE.Matrix4}if(!S.shadowCamera){if(S instanceof THREE.SpotLight)S.shadowCamera=new THREE.PerspectiveCamera(S.shadowCameraFov,S.shadowMapWidth/S.shadowMapHeight,S.shadowCameraNear,S.shadowCameraFar);else{if(!(S instanceof THREE.DirectionalLight)){console.error("Unsupported light type for shadow");continue}S.shadowCamera=new THREE.OrthographicCamera(S.shadowCameraLeft,S.shadowCameraRight,S.shadowCameraTop,S.shadowCameraBottom,S.shadowCameraNear,S.shadowCameraFar)}f.add(S.shadowCamera),f.autoUpdate===!0&&f.updateMatrixWorld()}for(S.shadowCameraVisible&&!S.cameraHelper&&(S.cameraHelper=new THREE.CameraHelper(S.shadowCamera),S.shadowCamera.add(S.cameraHelper)),S.isVirtual&&k.originalCamera==d&&i(d,S),x=S.shadowMap,T=S.shadowMatrix,b=S.shadowCamera,b.position.getPositionFromMatrix(S.matrixWorld),p.getPositionFromMatrix(S.target.matrixWorld),b.lookAt(p),b.updateMatrixWorld(),b.matrixWorldInverse.getInverse(b.matrixWorld),S.cameraHelper&&(S.cameraHelper.visible=S.shadowCameraVisible),S.shadowCameraVisible&&S.cameraHelper.update(),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(b.projectionMatrix),T.multiply(b.matrixWorldInverse),u.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),h.setFromMatrix(u),o.setRenderTarget(x),o.clear(),C=f.__webglObjects,v=0,E=C.length;E>v;v++)H=C[v],M=H.object,H.render=!1,M.visible&&M.castShadow&&((M instanceof THREE.Mesh||M instanceof THREE.ParticleSystem)&&M.frustumCulled&&!h.intersectsObject(M)||(M._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,M.matrixWorld),H.render=!0));var I,z,O;for(v=0,E=C.length;E>v;v++)H=C[v],H.render&&(M=H.object,w=H.buffer,I=n(M),z=M.geometry.morphTargets.length>0&&I.morphTargets,O=M instanceof THREE.SkinnedMesh&&I.skinning,R=M.customDepthMaterial?M.customDepthMaterial:O?z?c:l:z?s:a,w instanceof THREE.BufferGeometry?o.renderBufferDirect(b,f.__lights,P,R,w,M):o.renderBuffer(b,f.__lights,P,R,w,M));for(C=f.__webglObjectsImmediate,v=0,E=C.length;E>v;v++)H=C[v],M=H.object,M.visible&&M.castShadow&&(M._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,M.matrixWorld),o.renderImmediateObject(b,f.__lights,P,a,M))}var U=o.getClearColor(),B=o.getClearAlpha();r.clearColor(U.r,U.g,U.b,B),r.enable(r.BLEND),o.shadowMapCullFace===THREE.CullFaceFront&&r.cullFace(r.BACK)}},THREE.ShadowMapPlugin.__projector=new THREE.Projector,THREE.SpritePlugin=function(){function t(t,e){var n=i.createProgram(),r=i.createShader(i.FRAGMENT_SHADER),o=i.createShader(i.VERTEX_SHADER),a="precision "+e+" float;\n";return i.shaderSource(r,a+t.fragmentShader),i.shaderSource(o,a+t.vertexShader),i.compileShader(r),i.compileShader(o),i.attachShader(n,r),i.attachShader(n,o),i.linkProgram(n),n}function e(t,e){return t.z!==e.z?e.z-t.z:e.id-t.id}var i,n,r,o={};this.init=function(e){i=e.context,n=e,r=e.getPrecision(),o.vertices=new Float32Array(16),o.faces=new Uint16Array(6);var a=0;o.vertices[a++]=-1,o.vertices[a++]=-1,o.vertices[a++]=0,o.vertices[a++]=0,o.vertices[a++]=1,o.vertices[a++]=-1,o.vertices[a++]=1,o.vertices[a++]=0,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=-1,o.vertices[a++]=1,o.vertices[a++]=0,o.vertices[a++]=1,a=0,o.faces[a++]=0,o.faces[a++]=1,o.faces[a++]=2,o.faces[a++]=0,o.faces[a++]=2,o.faces[a++]=3,o.vertexBuffer=i.createBuffer(),o.elementBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,o.vertexBuffer),i.bufferData(i.ARRAY_BUFFER,o.vertices,i.STATIC_DRAW),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,o.elementBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,o.faces,i.STATIC_DRAW),o.program=t(THREE.ShaderSprite.sprite,r),o.attributes={},o.uniforms={},o.attributes.position=i.getAttribLocation(o.program,"position"),o.attributes.uv=i.getAttribLocation(o.program,"uv"),o.uniforms.uvOffset=i.getUniformLocation(o.program,"uvOffset"),o.uniforms.uvScale=i.getUniformLocation(o.program,"uvScale"),o.uniforms.rotation=i.getUniformLocation(o.program,"rotation"),o.uniforms.scale=i.getUniformLocation(o.program,"scale"),o.uniforms.alignment=i.getUniformLocation(o.program,"alignment"),o.uniforms.color=i.getUniformLocation(o.program,"color"),o.uniforms.map=i.getUniformLocation(o.program,"map"),o.uniforms.opacity=i.getUniformLocation(o.program,"opacity"),o.uniforms.useScreenCoordinates=i.getUniformLocation(o.program,"useScreenCoordinates"),o.uniforms.sizeAttenuation=i.getUniformLocation(o.program,"sizeAttenuation"),o.uniforms.screenPosition=i.getUniformLocation(o.program,"screenPosition"),o.uniforms.modelViewMatrix=i.getUniformLocation(o.program,"modelViewMatrix"),o.uniforms.projectionMatrix=i.getUniformLocation(o.program,"projectionMatrix"),o.uniforms.fogType=i.getUniformLocation(o.program,"fogType"),o.uniforms.fogDensity=i.getUniformLocation(o.program,"fogDensity"),o.uniforms.fogNear=i.getUniformLocation(o.program,"fogNear"),o.uniforms.fogFar=i.getUniformLocation(o.program,"fogFar"),o.uniforms.fogColor=i.getUniformLocation(o.program,"fogColor"),o.uniforms.alphaTest=i.getUniformLocation(o.program,"alphaTest")},this.render=function(t,r,a,s){var l=t.__webglSprites,c=l.length;if(c){var h=o.attributes,u=o.uniforms,f=s/a,d=.5*a,p=.5*s;i.useProgram(o.program),i.enableVertexAttribArray(h.position),i.enableVertexAttribArray(h.uv),i.disable(i.CULL_FACE),i.enable(i.BLEND),i.bindBuffer(i.ARRAY_BUFFER,o.vertexBuffer),i.vertexAttribPointer(h.position,2,i.FLOAT,!1,16,0),i.vertexAttribPointer(h.uv,2,i.FLOAT,!1,16,8),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,o.elementBuffer),i.uniformMatrix4fv(u.projectionMatrix,!1,r.projectionMatrix.elements),i.activeTexture(i.TEXTURE0),i.uniform1i(u.map,0);var m=0,g=0,v=t.fog;v?(i.uniform3f(u.fogColor,v.color.r,v.color.g,v.color.b),v instanceof THREE.Fog?(i.uniform1f(u.fogNear,v.near),i.uniform1f(u.fogFar,v.far),i.uniform1i(u.fogType,1),m=1,g=1):v instanceof THREE.FogExp2&&(i.uniform1f(u.fogDensity,v.density),i.uniform1i(u.fogType,2),m=2,g=2)):(i.uniform1i(u.fogType,0),m=0,g=0);var E,y,x,T,b,_,w=[];for(E=0;c>E;E++)y=l[E],x=y.material,y.visible&&0!==x.opacity&&(x.useScreenCoordinates?y.z=-y.position.z:(y._modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,y.matrixWorld),y.z=-y._modelViewMatrix.elements[14]));for(l.sort(e),E=0;c>E;E++)y=l[E],x=y.material,y.visible&&0!==x.opacity&&x.map&&x.map.image&&x.map.image.width&&(i.uniform1f(u.alphaTest,x.alphaTest),x.useScreenCoordinates===!0?(i.uniform1i(u.useScreenCoordinates,1),i.uniform3f(u.screenPosition,(y.position.x*n.devicePixelRatio-d)/d,(p-y.position.y*n.devicePixelRatio)/p,Math.max(0,Math.min(1,y.position.z))),w[0]=n.devicePixelRatio,w[1]=n.devicePixelRatio):(i.uniform1i(u.useScreenCoordinates,0),i.uniform1i(u.sizeAttenuation,x.sizeAttenuation?1:0),i.uniformMatrix4fv(u.modelViewMatrix,!1,y._modelViewMatrix.elements),w[0]=1,w[1]=1),_=t.fog&&x.fog?g:0,m!==_&&(i.uniform1i(u.fogType,_),m=_),b=1/(x.scaleByViewport?s:1),w[0]*=b*f*y.scale.x,w[1]*=b*y.scale.y,i.uniform2f(u.uvScale,x.uvScale.x,x.uvScale.y),i.uniform2f(u.uvOffset,x.uvOffset.x,x.uvOffset.y),i.uniform2f(u.alignment,x.alignment.x,x.alignment.y),i.uniform1f(u.opacity,x.opacity),i.uniform3f(u.color,x.color.r,x.color.g,x.color.b),i.uniform1f(u.rotation,y.rotation),i.uniform2fv(u.scale,w),n.setBlending(x.blending,x.blendEquation,x.blendSrc,x.blendDst),n.setDepthTest(x.depthTest),n.setDepthWrite(x.depthWrite),n.setTexture(x.map,0),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0));i.enable(i.CULL_FACE)}}},THREE.DepthPassPlugin=function(){function t(t){return t.material instanceof THREE.MeshFaceMaterial?t.material.materials[0]:t.material}this.enabled=!1,this.renderTarget=null;var e,i,n,r,o,a,s=new THREE.Frustum,l=new THREE.Matrix4;this.init=function(t){e=t.context,i=t;var s=THREE.ShaderLib.depthRGBA,l=THREE.UniformsUtils.clone(s.uniforms);n=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l}),r=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,morphTargets:!0}),o=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,skinning:!0}),a=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,morphTargets:!0,skinning:!0}),n._shadowPass=!0,r._shadowPass=!0,o._shadowPass=!0,a._shadowPass=!0},this.render=function(t,e){this.enabled&&this.update(t,e)},this.update=function(c,h){var u,f,d,p,m,g,v,E,y,x,T,b,_=null;for(e.clearColor(1,1,1,1),e.disable(e.BLEND),i.setDepthTest(!0),c.autoUpdate===!0&&c.updateMatrixWorld(),h.matrixWorldInverse.getInverse(h.matrixWorld),l.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse),s.setFromMatrix(l),i.setRenderTarget(this.renderTarget),i.clear(),b=c.__webglObjects,d=0,p=b.length;p>d;d++)y=b[d],x=y.object,y.render=!1,x.visible&&((x instanceof THREE.Mesh||x instanceof THREE.ParticleSystem)&&x.frustumCulled&&!s.intersectsObject(x)||(x._modelViewMatrix.multiplyMatrices(h.matrixWorldInverse,x.matrixWorld),y.render=!0));var w,R,H;for(d=0,p=b.length;p>d;d++)if(y=b[d],y.render){if(x=y.object,v=y.buffer,x instanceof THREE.ParticleSystem&&!x.customDepthMaterial)continue;w=t(x),w&&i.setMaterialFaces(x.material),R=x.geometry.morphTargets.length>0&&w.morphTargets,H=x instanceof THREE.SkinnedMesh&&w.skinning,E=x.customDepthMaterial?x.customDepthMaterial:H?R?a:o:R?r:n,v instanceof THREE.BufferGeometry?i.renderBufferDirect(h,c.__lights,_,E,v,x):i.renderBuffer(h,c.__lights,_,E,v,x)}for(b=c.__webglObjectsImmediate,d=0,p=b.length;p>d;d++)y=b[d],x=y.object,x.visible&&(x._modelViewMatrix.multiplyMatrices(h.matrixWorldInverse,x.matrixWorld),i.renderImmediateObject(h,c.__lights,_,n,x));var M=i.getClearColor(),S=i.getClearAlpha();e.clearColor(M.r,M.g,M.b,S),e.enable(e.BLEND)}},THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +","texture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +","texture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +","texture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +","texture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +","texture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +","texture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +","texture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +","texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility = (       visibility.r / 9.0 ) *","( 1.0 - visibility.g / 9.0 ) *","(       visibility.b / 9.0 ) *","( 1.0 - visibility.a / 9.0 );","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},lensFlare:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +","texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +","texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +","texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}},THREE.ShaderSprite={sprite:{vertexShader:["uniform int useScreenCoordinates;","uniform int sizeAttenuation;","uniform vec3 screenPosition;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 alignment;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position + alignment;","vec2 rotatedPosition;","rotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;","rotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;","vec4 finalPosition;","if( useScreenCoordinates != 0 ) {","finalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );","} else {","finalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );","}","gl_Position = finalPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")}},THREE.TrackballControls=function(t,e){function i(t){u.enabled!==!1&&(window.removeEventListener("keydown",i),m=p,p===f.NONE&&(t.keyCode!==u.keys[f.ROTATE]||u.noRotate?t.keyCode!==u.keys[f.ZOOM]||u.noZoom?t.keyCode!==u.keys[f.PAN]||u.noPan||(p=f.PAN):p=f.ZOOM:p=f.ROTATE))}function n(t){u.enabled!==!1&&(p=m,window.addEventListener("keydown",i,!1))}function r(t){u.enabled!==!1&&(t.preventDefault(),t.stopPropagation(),p===f.NONE&&(p=t.button),p!==f.ROTATE||u.noRotate?p!==f.ZOOM||u.noZoom?p!==f.PAN||u.noPan||(_=w=u.getMouseOnScreen(t.clientX,t.clientY)):y=x=u.getMouseOnScreen(t.clientX,t.clientY):v=E=u.getMouseProjectionOnBall(t.clientX,t.clientY),document.addEventListener("mousemove",o,!1),document.addEventListener("mouseup",a,!1))}function o(t){u.enabled!==!1&&(t.preventDefault(),t.stopPropagation(),p!==f.ROTATE||u.noRotate?p!==f.ZOOM||u.noZoom?p!==f.PAN||u.noPan||(w=u.getMouseOnScreen(t.clientX,t.clientY)):x=u.getMouseOnScreen(t.clientX,t.clientY):E=u.getMouseProjectionOnBall(t.clientX,t.clientY))}function a(t){u.enabled!==!1&&(t.preventDefault(),t.stopPropagation(),p=f.NONE,document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a))}function s(t){if(u.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=0;t.wheelDelta?e=t.wheelDelta/40:t.detail&&(e=-t.detail/3),y.y+=.01*e}}function l(t){if(u.enabled!==!1)switch(t.touches.length){case 1:p=f.TOUCH_ROTATE,v=E=u.getMouseProjectionOnBall(t.touches[0].pageX,t.touches[0].pageY);break;case 2:p=f.TOUCH_ZOOM;var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;b=T=Math.sqrt(e*e+i*i);break;case 3:p=f.TOUCH_PAN,_=w=u.getMouseOnScreen(t.touches[0].pageX,t.touches[0].pageY);break;default:p=f.NONE}}function c(t){if(u.enabled!==!1)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:E=u.getMouseProjectionOnBall(t.touches[0].pageX,t.touches[0].pageY);break;case 2:var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;b=Math.sqrt(e*e+i*i);break;case 3:w=u.getMouseOnScreen(t.touches[0].pageX,t.touches[0].pageY);break;default:p=f.NONE}}function h(t){if(u.enabled!==!1){switch(t.touches.length){case 1:v=E=u.getMouseProjectionOnBall(t.touches[0].pageX,t.touches[0].pageY);break;case 2:T=b=0;break;case 3:_=w=u.getMouseOnScreen(t.touches[0].pageX,t.touches[0].pageY)}p=f.NONE}}var u=this,f={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5};this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.screen={width:0,height:0,offsetLeft:0,offsetTop:0},this.radius=(this.screen.width+this.screen.height)/4,this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var d=new THREE.Vector3,p=f.NONE,m=f.NONE,g=new THREE.Vector3,v=new THREE.Vector3,E=new THREE.Vector3,y=new THREE.Vector2,x=new THREE.Vector2,T=0,b=0,_=new THREE.Vector2,w=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var R={type:"change"};this.handleResize=function(){this.screen.width=window.innerWidth,this.screen.height=window.innerHeight,this.screen.offsetLeft=0,this.screen.offsetTop=0,this.radius=(this.screen.width+this.screen.height)/4},this.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)},this.getMouseOnScreen=function(t,e){return new THREE.Vector2((t-u.screen.offsetLeft)/u.radius*.5,(e-u.screen.offsetTop)/u.radius*.5)},this.getMouseProjectionOnBall=function(t,e){var i=new THREE.Vector3((t-.5*u.screen.width-u.screen.offsetLeft)/u.radius,(.5*u.screen.height+u.screen.offsetTop-e)/u.radius,0),n=i.length();n>1?i.normalize():i.z=Math.sqrt(1-n*n),g.copy(u.object.position).sub(u.target);var r=u.object.up.clone().setLength(i.y);return r.add(u.object.up.clone().cross(g).setLength(i.x)),r.add(g.setLength(i.z)),r},this.rotateCamera=function(){var t=Math.acos(v.dot(E)/v.length()/E.length());if(t){var e=(new THREE.Vector3).crossVectors(v,E).normalize(),i=new THREE.Quaternion;t*=u.rotateSpeed,i.setFromAxisAngle(e,-t),g.applyQuaternion(i),u.object.up.applyQuaternion(i),E.applyQuaternion(i),u.staticMoving?v.copy(E):(i.setFromAxisAngle(e,t*(u.dynamicDampingFactor-1)),v.applyQuaternion(i))}},this.zoomCamera=function(){if(p===f.TOUCH_ZOOM){var t=T/b;T=b,g.multiplyScalar(t)}else{var t=1+(x.y-y.y)*u.zoomSpeed;1!==t&&t>0&&(g.multiplyScalar(t),u.staticMoving?y.copy(x):y.y+=(x.y-y.y)*this.dynamicDampingFactor)}},this.panCamera=function(){var t=w.clone().sub(_);if(t.lengthSq()){t.multiplyScalar(g.length()*u.panSpeed);var e=g.clone().cross(u.object.up).setLength(t.x);e.add(u.object.up.clone().setLength(t.y)),u.object.position.add(e),u.target.add(e),u.staticMoving?_=w:_.add(t.subVectors(w,_).multiplyScalar(u.dynamicDampingFactor))
}},this.checkDistances=function(){u.noZoom&&u.noPan||(u.object.position.lengthSq()>u.maxDistance*u.maxDistance&&u.object.position.setLength(u.maxDistance),g.lengthSq()<u.minDistance*u.minDistance&&u.object.position.addVectors(u.target,g.setLength(u.minDistance)))},this.update=function(){g.subVectors(u.object.position,u.target),u.noRotate||u.rotateCamera(),u.noZoom||u.zoomCamera(),u.noPan||u.panCamera(),u.object.position.addVectors(u.target,g),u.checkDistances(),u.object.lookAt(u.target),d.distanceToSquared(u.object.position)>0&&(u.dispatchEvent(R),d.copy(u.object.position))},this.reset=function(){p=f.NONE,m=f.NONE,u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.up.copy(u.up0),g.subVectors(u.object.position,u.target),u.object.lookAt(u.target),u.dispatchEvent(R),d.copy(u.object.position)},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",r,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",l,!1),this.domElement.addEventListener("touchend",h,!1),this.domElement.addEventListener("touchmove",c,!1),window.addEventListener("keydown",i,!1),window.addEventListener("keyup",n,!1),this.handleResize()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.ColorConverter={setHSV:function(t,e,i,n){return t.setHSL(e,i*n/((e=(2-i)*n)<1?e:2-e),.5*e)},getHSV:function(t){var e=t.getHSL();return e.s*=e.l<.5?e.l:1-e.l,{h:e.h,s:2*e.s/(e.l+e.s),v:e.l+e.s}},setCMYK:function(t,e,i,n,r){var o=(1-e)*(1-r),a=(1-i)*(1-r),s=(1-n)*(1-r);return t.setRGB(o,a,s)},getCMYK:function(t){var e=t.r,i=t.g,n=t.b,r=1-Math.max(e,i,n),o=(1-e-r)/(1-r),a=(1-i-r)/(1-r),s=(1-n-r)/(1-r);return{c:o,m:a,y:s,k:r}}},THREE.SVGRenderer=function(){function t(t){S.setRGB(0,0,0),C.setRGB(0,0,0),A.setRGB(0,0,0);for(var e=0,i=t.length;i>e;e++){var n=t[e],r=n.color;n instanceof THREE.AmbientLight?(S.r+=r.r,S.g+=r.g,S.b+=r.b):n instanceof THREE.DirectionalLight?(C.r+=r.r,C.g+=r.g,C.b+=r.b):n instanceof THREE.PointLight&&(A.r+=r.r,A.g+=r.g,A.b+=r.b)}}function e(t,e,i,n){for(var r=0,o=t.length;o>r;r++){var a=t[r],s=a.color;if(a instanceof THREE.DirectionalLight){var l=P.getPositionFromMatrix(a.matrixWorld).normalize(),c=i.dot(l);if(0>=c)continue;c*=a.intensity,n.r+=s.r*c,n.g+=s.g*c,n.b+=s.b*c}else if(a instanceof THREE.PointLight){var l=P.getPositionFromMatrix(a.matrixWorld),c=i.dot(P.subVectors(l,e).normalize());if(0>=c)continue;if(c*=0==a.distance?1:1-Math.min(e.distanceTo(l)/a.distance,1),0==c)continue;c*=a.intensity,n.r+=s.r*c,n.g+=s.g*c,n.b+=s.b*c}}}function i(t,e,i){}function n(t,e,i,n){F=a(O++),F.setAttribute("x1",t.positionScreen.x),F.setAttribute("y1",t.positionScreen.y),F.setAttribute("x2",e.positionScreen.x),F.setAttribute("y2",e.positionScreen.y),n instanceof THREE.LineBasicMaterial&&(F.setAttribute("style","fill: none; stroke: "+n.color.getStyle()+"; stroke-width: "+n.linewidth+"; stroke-opacity: "+n.opacity+"; stroke-linecap: "+n.linecap+"; stroke-linejoin: "+n.linejoin),m.appendChild(F))}function r(t,i,n,r,o){if(h.info.render.vertices+=3,h.info.render.faces++,F=s(I++),F.setAttribute("d","M "+t.positionScreen.x+" "+t.positionScreen.y+" L "+i.positionScreen.x+" "+i.positionScreen.y+" L "+n.positionScreen.x+","+n.positionScreen.y+"z"),o instanceof THREE.MeshBasicMaterial)H.copy(o.color),o.vertexColors===THREE.FaceColors&&H.multiply(r.color);else if(o instanceof THREE.MeshLambertMaterial||o instanceof THREE.MeshPhongMaterial)M.copy(o.color),o.vertexColors===THREE.FaceColors&&M.multiply(r.color),H.copy(S),e(d,r.centroidModel,r.normalModel,H),H.multiply(M).add(o.emissive);else if(o instanceof THREE.MeshDepthMaterial)D=1-o.__2near/(o.__farPlusNear-r.z*o.__farMinusNear),H.setRGB(D,D,D);else if(o instanceof THREE.MeshNormalMaterial){var a=r.normalModelView;H.setRGB(a.x,a.y,a.z).multiplyScalar(.5).addScalar(.5)}o.wireframe?F.setAttribute("style","fill: none; stroke: "+H.getStyle()+"; stroke-width: "+o.wireframeLinewidth+"; stroke-opacity: "+o.opacity+"; stroke-linecap: "+o.wireframeLinecap+"; stroke-linejoin: "+o.wireframeLinejoin):F.setAttribute("style","fill: "+H.getStyle()+"; fill-opacity: "+o.opacity),m.appendChild(F)}function o(t,i,n,r,o,a){if(h.info.render.vertices+=4,h.info.render.faces++,F=s(I++),F.setAttribute("d","M "+t.positionScreen.x+" "+t.positionScreen.y+" L "+i.positionScreen.x+" "+i.positionScreen.y+" L "+n.positionScreen.x+","+n.positionScreen.y+" L "+r.positionScreen.x+","+r.positionScreen.y+"z"),a instanceof THREE.MeshBasicMaterial)H.copy(a.color),a.vertexColors===THREE.FaceColors&&H.multiply(o.color);else if(a instanceof THREE.MeshLambertMaterial||a instanceof THREE.MeshPhongMaterial)M.copy(a.color),a.vertexColors===THREE.FaceColors&&M.multiply(o.color),H.copy(S),e(d,o.centroidModel,o.normalModel,H),H.multiply(M).add(a.emissive);else if(a instanceof THREE.MeshDepthMaterial)D=1-a.__2near/(a.__farPlusNear-o.z*a.__farMinusNear),H.setRGB(D,D,D);else if(a instanceof THREE.MeshNormalMaterial){var l=o.normalModelView;H.setRGB(l.x,l.y,l.z).multiplyScalar(.5).addScalar(.5)}a.wireframe?F.setAttribute("style","fill: none; stroke: "+H.getStyle()+"; stroke-width: "+a.wireframeLinewidth+"; stroke-opacity: "+a.opacity+"; stroke-linecap: "+a.wireframeLinecap+"; stroke-linejoin: "+a.wireframeLinejoin):F.setAttribute("style","fill: "+H.getStyle()+"; fill-opacity: "+a.opacity),m.appendChild(F)}function a(t){return null==N[t]?(N[t]=document.createElementNS("http://www.w3.org/2000/svg","line"),0==U&&N[t].setAttribute("shape-rendering","crispEdges"),N[t]):N[t]}function s(t){return null==k[t]?(k[t]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==U&&k[t].setAttribute("shape-rendering","crispEdges"),k[t]):k[t]}function l(t){return null==L[t]?(L[t]=document.createElementNS("http://www.w3.org/2000/svg","circle"),0==U&&L[t].setAttribute("shape-rendering","crispEdges"),L[t]):L[t]}function c(t){for(;t.length<6;)t="0"+t;return t}console.log("THREE.SVGRenderer",THREE.REVISION);var h=this,u,f,d,p=new THREE.Projector,m=document.createElementNS("http://www.w3.org/2000/svg","svg"),g,v,E,y,x,T,b,_,w=new THREE.Box2,R=new THREE.Box2,H=new THREE.Color,M=new THREE.Color,S=new THREE.Color,C=new THREE.Color,A=new THREE.Color,D,P=new THREE.Vector3,k=[],L=[],N=[],F,I,z,O,U=1;this.domElement=m,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.setQuality=function(t){switch(t){case"high":U=1;break;case"low":U=0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setClearColor=function(t,e){},this.setSize=function(t,e){g=t,v=e,E=g/2,y=v/2,m.setAttribute("viewBox",-E+" "+-y+" "+g+" "+v),m.setAttribute("width",g),m.setAttribute("height",v),w.min.set(-E,-y),w.max.set(E,y)},this.clear=function(){for(I=0,z=0,O=0;m.childNodes.length>0;)m.removeChild(m.childNodes[0])},this.render=function(e,a){if(a instanceof THREE.Camera==!1)return void console.error("THREE.SVGRenderer.render: camera is not an instance of THREE.Camera.");this.autoClear===!0&&this.clear(),h.info.render.vertices=0,h.info.render.faces=0,u=p.projectScene(e,a,this.sortObjects,this.sortElements),f=u.elements,d=u.lights,t(d);for(var s=0,l=f.length;l>s;s++){var c=f[s],m=c.material;if(void 0!==m&&m.visible!==!1)if(R.makeEmpty(),c instanceof THREE.RenderableParticle)x=c,x.x*=E,x.y*=-y,i(x,c,m);else if(c instanceof THREE.RenderableLine)x=c.v1,T=c.v2,x.positionScreen.x*=E,x.positionScreen.y*=-y,T.positionScreen.x*=E,T.positionScreen.y*=-y,R.setFromPoints([x.positionScreen,T.positionScreen]),w.isIntersectionBox(R)===!0&&n(x,T,c,m);else if(c instanceof THREE.RenderableFace3){if(x=c.v1,T=c.v2,b=c.v3,x.positionScreen.z<-1||x.positionScreen.z>1)continue;if(T.positionScreen.z<-1||T.positionScreen.z>1)continue;if(b.positionScreen.z<-1||b.positionScreen.z>1)continue;x.positionScreen.x*=E,x.positionScreen.y*=-y,T.positionScreen.x*=E,T.positionScreen.y*=-y,b.positionScreen.x*=E,b.positionScreen.y*=-y,R.setFromPoints([x.positionScreen,T.positionScreen,b.positionScreen]),w.isIntersectionBox(R)===!0&&r(x,T,b,c,m)}else if(c instanceof THREE.RenderableFace4){if(x=c.v1,T=c.v2,b=c.v3,_=c.v4,x.positionScreen.z<-1||x.positionScreen.z>1)continue;if(T.positionScreen.z<-1||T.positionScreen.z>1)continue;if(b.positionScreen.z<-1||b.positionScreen.z>1)continue;if(_.positionScreen.z<-1||_.positionScreen.z>1)continue;x.positionScreen.x*=E,x.positionScreen.y*=-y,T.positionScreen.x*=E,T.positionScreen.y*=-y,b.positionScreen.x*=E,b.positionScreen.y*=-y,_.positionScreen.x*=E,_.positionScreen.y*=-y,R.setFromPoints([x.positionScreen,T.positionScreen,b.positionScreen,_.positionScreen]),w.isIntersectionBox(R)===!0&&o(x,T,b,_,c,m)}}}};var s,urlParams;(window.onpopstate=function(){var t,e=/\+/g,i=/([^&=]+)=?([^&]*)/g,n=function(t){return decodeURIComponent(t.replace(e," ").replace(/\//g,""))},r=window.location.search.substring(1);for(urlParams={};t=i.exec(r);)urlParams[n(t[1])]=n(t[2])})();var abundancehtml='<div id="yaxisholder"></div><div id="plot"></div>',abundanceFuns=[normStackedBar,area,donuts],phyloFuns=[sunburst,rectangularTree,radialTree],multidimFuns=[parallel,scatter,splom,threeD],visFuns=[abundanceFuns,phyloFuns,multidimFuns],allFuns=[sunburst,rectangularTree,radialTree,normStackedBar,area,donuts,threeD,scatter,splom,parallel],surveyStart='<div id="surveyMonkeyInfo" style="width:800px;font-size:10px;color:#666;"><div><iframe id="sm_e_s" src="http://www.surveymonkey.com/s/',surveyIDs=["FLMWHYQ?c=","FLZ9N9J?c=","FVVSD3C?c="],surveyEnd="",newURL="",visType,visID;
//# sourceMappingURL=./multivis-min.js.map