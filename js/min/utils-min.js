function Rainbow(){function e(e){if(e.length<2)throw new Error("Rainbow must have two or more colours.");var o=(n-i)/(e.length-1),a=new ColourGradient;a.setGradient(e[0],e[1]),a.setNumberRange(i,i+o),t=[a];for(var s=1;s<e.length-1;s++){var l=new ColourGradient;l.setGradient(e[s],e[s+1]),l.setNumberRange(i+o*s,i+o*(s+1)),t[s]=l}return r=e,this}var t=null,i=0,n=100,r=["ff0000","ffff00","00ff00","0000ff"];e(r),this.setColors=this.setColours,this.setSpectrum=function(){return e(arguments),this},this.setSpectrumByArray=function(t){return e(t),this},this.colourAt=function(e){if(isNaN(e))throw new TypeError(e+" is not a number");if(1===t.length)return t[0].colourAt(e);var r=(n-i)/t.length,o=Math.min(Math.floor((Math.max(e,i)-i)/r),t.length-1);return t[o].colourAt(e)},this.colorAt=this.colourAt,this.setNumberRange=function(t,o){if(!(o>t))throw new RangeError("maxNumber ("+o+") is not greater than minNumber ("+t+")");return i=t,n=o,e(r),this}}function ColourGradient(){function e(e,t,i){var n=e;o>n&&(n=o),n>a&&(n=a);var r=a-o,s=parseInt(t,16),l=parseInt(i,16),h=(l-s)/r,c=Math.round(h*(n-o)+s);return formatHex(c.toString(16))}function t(e){var t=/^#?[0-9a-fA-F]{6}$/i;return t.test(e)}function i(e){if(t(e))return e.substring(e.length-6,e.length);for(var i=[["red","ff0000"],["lime","00ff00"],["blue","0000ff"],["yellow","ffff00"],["orange","ff8000"],["aqua","00ffff"],["fuchsia","ff00ff"],["white","ffffff"],["black","000000"],["gray","808080"],["grey","808080"],["silver","c0c0c0"],["maroon","800000"],["olive","808000"],["green","008000"],["teal","008080"],["navy","000080"],["purple","800080"]],n=0;n<i.length;n++)if(e.toLowerCase()===i[n][0])return i[n][1];throw new Error(e+" is not a valid colour.")}var n="ff0000",r="0000ff",o=0,a=100;this.setGradient=function(e,t){n=i(e),r=i(t)},this.setNumberRange=function(e,t){if(!(t>e))throw new RangeError("maxNumber ("+t+") is not greater than minNumber ("+e+")");o=e,a=t},this.colourAt=function(t){return e(t,n.substring(0,2),r.substring(0,2))+e(t,n.substring(2,4),r.substring(2,4))+e(t,n.substring(4,6),r.substring(4,6))},formatHex=function(e){return 1===e.length?"0"+e:e}}if(function(e,t){function i(e){var t=e.length,i=ht.type(e);return ht.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function n(e){var t=wt[e]={};return ht.each(e.match(ut)||[],function(e,i){t[i]=!0}),t}function r(e,i,n,r){if(ht.acceptData(e)){var o,a,s=ht.expando,l="string"==typeof i,h=e.nodeType,c=h?ht.cache:e,u=h?e[s]:e[s]&&s;if(u&&c[u]&&(r||c[u].data)||!l||n!==t)return u||(h?e[s]=u=et.pop()||ht.guid++:u=s),c[u]||(c[u]={},h||(c[u].toJSON=ht.noop)),("object"==typeof i||"function"==typeof i)&&(r?c[u]=ht.extend(c[u],i):c[u].data=ht.extend(c[u].data,i)),o=c[u],r||(o.data||(o.data={}),o=o.data),n!==t&&(o[ht.camelCase(i)]=n),l?(a=o[i],null==a&&(a=o[ht.camelCase(i)])):a=o,a}}function o(e,t,i){if(ht.acceptData(e)){var n,r,o,a=e.nodeType,l=a?ht.cache:e,h=a?e[ht.expando]:ht.expando;if(l[h]){if(t&&(o=i?l[h]:l[h].data)){ht.isArray(t)?t=t.concat(ht.map(t,ht.camelCase)):t in o?t=[t]:(t=ht.camelCase(t),t=t in o?[t]:t.split(" "));for(n=0,r=t.length;r>n;n++)delete o[t[n]];if(!(i?s:ht.isEmptyObject)(o))return}(i||(delete l[h].data,s(l[h])))&&(a?ht.cleanData([e],!0):ht.support.deleteExpando||l!=l.window?delete l[h]:l[h]=null)}}}function a(e,i,n){if(n===t&&1===e.nodeType){var r="data-"+i.replace(Ht,"-$1").toLowerCase();if(n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Rt.test(n)?ht.parseJSON(n):n}catch(o){}ht.data(e,i,n)}else n=t}return n}function s(e){var t;for(t in e)if(("data"!==t||!ht.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(){return!0}function h(){return!1}function c(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function u(e,t,i){if(t=t||0,ht.isFunction(t))return ht.grep(e,function(e,n){var r=!!t.call(e,n,e);return r===i});if(t.nodeType)return ht.grep(e,function(e){return e===t===i});if("string"==typeof t){var n=ht.grep(e,function(e){return 1===e.nodeType});if(jt.test(t))return ht.filter(t,n,!i);t=ht.filter(t,n)}return ht.grep(e,function(e){return ht.inArray(e,t)>=0===i})}function f(e){var t=Xt.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function p(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function d(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function m(e){var t=oi.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var i,n=0;null!=(i=e[n]);n++)ht._data(i,"globalEval",!t||ht._data(t[n],"globalEval"))}function v(e,t){if(1===t.nodeType&&ht.hasData(e)){var i,n,r,o=ht._data(e),a=ht._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(i in s)for(n=0,r=s[i].length;r>n;n++)ht.event.add(t,i,s[i][n])}a.data&&(a.data=ht.extend({},a.data))}}function E(e,t){var i,n,r;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!ht.support.noCloneEvent&&t[ht.expando]){r=ht._data(t);for(n in r.events)ht.removeEvent(t,n,r.handle);t.removeAttribute(ht.expando)}"script"===i&&t.text!==e.text?(d(t).text=e.text,m(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),ht.support.html5Clone&&e.innerHTML&&!ht.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&ii.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}}function y(e,i){var n,r,o=0,a=typeof e.getElementsByTagName!==X?e.getElementsByTagName(i||"*"):typeof e.querySelectorAll!==X?e.querySelectorAll(i||"*"):t;if(!a)for(a=[],n=e.childNodes||e;null!=(r=n[o]);o++)!i||ht.nodeName(r,i)?a.push(r):ht.merge(a,y(r,i));return i===t||i&&ht.nodeName(e,i)?ht.merge([e],a):a}function T(e){ii.test(e.type)&&(e.defaultChecked=e.checked)}function x(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,r=Ri.length;r--;)if(t=Ri[r]+i,t in e)return t;return n}function b(e,t){return e=t||e,"none"===ht.css(e,"display")||!ht.contains(e.ownerDocument,e)}function _(e,t){for(var i,n,r,o=[],a=0,s=e.length;s>a;a++)n=e[a],n.style&&(o[a]=ht._data(n,"olddisplay"),i=n.style.display,t?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&b(n)&&(o[a]=ht._data(n,"olddisplay",M(n.nodeName)))):o[a]||(r=b(n),(i&&"none"!==i||!r)&&ht._data(n,"olddisplay",r?i:ht.css(n,"display"))));for(a=0;s>a;a++)n=e[a],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[a]||"":"none"));return e}function w(e,t,i){var n=Ei.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function R(e,t,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===i&&(a+=ht.css(e,i+wi[o],!0,r)),n?("content"===i&&(a-=ht.css(e,"padding"+wi[o],!0,r)),"margin"!==i&&(a-=ht.css(e,"border"+wi[o]+"Width",!0,r))):(a+=ht.css(e,"padding"+wi[o],!0,r),"padding"!==i&&(a+=ht.css(e,"border"+wi[o]+"Width",!0,r)));return a}function H(e,t,i){var n=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=ui(e),a=ht.support.boxSizing&&"border-box"===ht.css(e,"boxSizing",!1,o);if(0>=r||null==r){if(r=fi(e,t,o),(0>r||null==r)&&(r=e.style[t]),yi.test(r))return r;n=a&&(ht.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+R(e,t,i||(a?"border":"content"),n,o)+"px"}function M(e){var t=Y,i=xi[e];return i||(i=S(e,t),"none"!==i&&i||(ci=(ci||ht("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(ci[0].contentWindow||ci[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),i=S(e,t),ci.detach()),xi[e]=i),i}function S(e,t){var i=ht(t.createElement(e)).appendTo(t.body),n=ht.css(i[0],"display");return i.remove(),n}function C(e,t,i,n){var r;if(ht.isArray(t))ht.each(t,function(t,r){i||Mi.test(e)?n(e,r):C(e+"["+("object"==typeof r?t:"")+"]",r,i,n)});else if(i||"object"!==ht.type(t))n(e,t);else for(r in t)C(e+"["+r+"]",t[r],i,n)}function A(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,r=0,o=t.toLowerCase().match(ut)||[];if(ht.isFunction(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function D(e,t,i,n){function r(s){var l;return o[s]=!0,ht.each(e[s]||[],function(e,s){var h=s(t,i,n);return"string"!=typeof h||a||o[h]?a?!(l=h):void 0:(t.dataTypes.unshift(h),r(h),!1)}),l}var o={},a=e===ji;return r(t.dataTypes[0])||!o["*"]&&r("*")}function k(e,i){var n,r,o=ht.ajaxSettings.flatOptions||{};for(r in i)i[r]!==t&&((o[r]?e:n||(n={}))[r]=i[r]);return n&&ht.extend(!0,e,n),e}function P(e,i,n){var r,o,a,s,l=e.contents,h=e.dataTypes,c=e.responseFields;for(s in c)s in n&&(i[c[s]]=n[s]);for(;"*"===h[0];)h.shift(),o===t&&(o=e.mimeType||i.getResponseHeader("Content-Type"));if(o)for(s in l)if(l[s]&&l[s].test(o)){h.unshift(s);break}if(h[0]in n)a=h[0];else{for(s in n){if(!h[0]||e.converters[s+" "+h[0]]){a=s;break}r||(r=s)}a=a||r}return a?(a!==h[0]&&h.unshift(a),n[a]):void 0}function L(e,t){var i,n,r,o,a={},s=0,l=e.dataTypes.slice(),h=l[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l[1])for(r in e.converters)a[r.toLowerCase()]=e.converters[r];for(;n=l[++s];)if("*"!==n){if("*"!==h&&h!==n){if(r=a[h+" "+n]||a["* "+n],!r)for(i in a)if(o=i.split(" "),o[1]===n&&(r=a[h+" "+o[0]]||a["* "+o[0]])){r===!0?r=a[i]:a[i]!==!0&&(n=o[0],l.splice(s--,0,n));break}if(r!==!0)if(r&&e["throws"])t=r(t);else try{t=r(t)}catch(c){return{state:"parsererror",error:r?c:"No conversion from "+h+" to "+n}}}h=n}return{state:"success",data:t}}function N(){try{return new e.XMLHttpRequest}catch(t){}}function z(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function F(){return setTimeout(function(){Ji=t}),Ji=ht.now()}function I(e,t){ht.each(t,function(t,i){for(var n=(an[t]||[]).concat(an["*"]),r=0,o=n.length;o>r;r++)if(n[r].call(e,t,i))return})}function O(e,t,i){var n,r,o=0,a=on.length,s=ht.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=Ji||F(),i=Math.max(0,h.startTime+h.duration-t),n=i/h.duration||0,o=1-n,a=0,l=h.tweens.length;l>a;a++)h.tweens[a].run(o);return s.notifyWith(e,[h,o,i]),1>o&&l?i:(s.resolveWith(e,[h]),!1)},h=s.promise({elem:e,props:ht.extend({},t),opts:ht.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Ji||F(),duration:i.duration,tweens:[],createTween:function(t,i){var n=ht.Tween(e,h.opts,t,i,h.opts.specialEasing[t]||h.opts.easing);return h.tweens.push(n),n},stop:function(t){var i=0,n=t?h.tweens.length:0;if(r)return this;for(r=!0;n>i;i++)h.tweens[i].run(1);return t?s.resolveWith(e,[h,t]):s.rejectWith(e,[h,t]),this}}),c=h.props;for(U(c,h.opts.specialEasing);a>o;o++)if(n=on[o].call(h,e,c,h.opts))return n;return I(h,c),ht.isFunction(h.opts.start)&&h.opts.start.call(e,h),ht.fx.timer(ht.extend(l,{elem:e,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function U(e,t){var i,n,r,o,a;for(r in e)if(n=ht.camelCase(r),o=t[n],i=e[r],ht.isArray(i)&&(o=i[1],i=e[r]=i[0]),r!==n&&(e[n]=i,delete e[r]),a=ht.cssHooks[n],a&&"expand"in a){i=a.expand(i),delete e[n];for(r in i)r in e||(e[r]=i[r],t[r]=o)}else t[n]=o}function V(e,t,i){var n,r,o,a,s,l,h,c,u,f=this,p=e.style,d={},m=[],g=e.nodeType&&b(e);i.queue||(c=ht._queueHooks(e,"fx"),null==c.unqueued&&(c.unqueued=0,u=c.empty.fire,c.empty.fire=function(){c.unqueued||u()}),c.unqueued++,f.always(function(){f.always(function(){c.unqueued--,ht.queue(e,"fx").length||c.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===ht.css(e,"display")&&"none"===ht.css(e,"float")&&(ht.support.inlineBlockNeedsLayout&&"inline"!==M(e.nodeName)?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",ht.support.shrinkWrapBlocks||f.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(r in t)if(a=t[r],tn.exec(a)){if(delete t[r],l=l||"toggle"===a,a===(g?"hide":"show"))continue;m.push(r)}if(o=m.length){s=ht._data(e,"fxshow")||ht._data(e,"fxshow",{}),"hidden"in s&&(g=s.hidden),l&&(s.hidden=!g),g?ht(e).show():f.done(function(){ht(e).hide()}),f.done(function(){var t;ht._removeData(e,"fxshow");for(t in d)ht.style(e,t,d[t])});for(r=0;o>r;r++)n=m[r],h=f.createTween(n,g?s[n]:0),d[n]=s[n]||ht.style(e,n),n in s||(s[n]=h.start,g&&(h.end=h.start,h.start="width"===n||"height"===n?1:0))}}function B(e,t,i,n,r){return new B.prototype.init(e,t,i,n,r)}function W(e,t){var i,n={height:e},r=0;for(t=t?1:0;4>r;r+=2-t)i=wi[r],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function j(e){return ht.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var G,q,X=typeof t,Y=e.document,K=e.location,Q=e.jQuery,Z=e.$,J={},et=[],tt="1.9.1",it=et.concat,nt=et.push,rt=et.slice,ot=et.indexOf,at=J.toString,st=J.hasOwnProperty,lt=tt.trim,ht=function(e,t){return new ht.fn.init(e,t,q)},ct=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ut=/\S+/g,ft=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,pt=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,dt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,mt=/^[\],:{}\s]*$/,gt=/(?:^|:|,)(?:\s*\[)+/g,vt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Et=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,yt=/^-ms-/,Tt=/-([\da-z])/gi,xt=function(e,t){return t.toUpperCase()},bt=function(e){(Y.addEventListener||"load"===e.type||"complete"===Y.readyState)&&(_t(),ht.ready())},_t=function(){Y.addEventListener?(Y.removeEventListener("DOMContentLoaded",bt,!1),e.removeEventListener("load",bt,!1)):(Y.detachEvent("onreadystatechange",bt),e.detachEvent("onload",bt))};ht.fn=ht.prototype={jquery:tt,constructor:ht,init:function(e,i,n){var r,o;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:pt.exec(e),!r||!r[1]&&i)return!i||i.jquery?(i||n).find(e):this.constructor(i).find(e);if(r[1]){if(i=i instanceof ht?i[0]:i,ht.merge(this,ht.parseHTML(r[1],i&&i.nodeType?i.ownerDocument||i:Y,!0)),dt.test(r[1])&&ht.isPlainObject(i))for(r in i)ht.isFunction(this[r])?this[r](i[r]):this.attr(r,i[r]);return this}if(o=Y.getElementById(r[2]),o&&o.parentNode){if(o.id!==r[2])return n.find(e);this.length=1,this[0]=o}return this.context=Y,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ht.isFunction(e)?n.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),ht.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return rt.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=ht.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ht.each(this,e,t)},ready:function(e){return ht.ready.promise().done(e),this},slice:function(){return this.pushStack(rt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},map:function(e){return this.pushStack(ht.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:nt,sort:[].sort,splice:[].splice},ht.fn.init.prototype=ht.fn,ht.extend=ht.fn.extend=function(){var e,i,n,r,o,a,s=arguments[0]||{},l=1,h=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||ht.isFunction(s)||(s={}),h===l&&(s=this,--l);h>l;l++)if(null!=(o=arguments[l]))for(r in o)e=s[r],n=o[r],s!==n&&(c&&n&&(ht.isPlainObject(n)||(i=ht.isArray(n)))?(i?(i=!1,a=e&&ht.isArray(e)?e:[]):a=e&&ht.isPlainObject(e)?e:{},s[r]=ht.extend(c,a,n)):n!==t&&(s[r]=n));return s},ht.extend({noConflict:function(t){return e.$===ht&&(e.$=Z),t&&e.jQuery===ht&&(e.jQuery=Q),ht},isReady:!1,readyWait:1,holdReady:function(e){e?ht.readyWait++:ht.ready(!0)},ready:function(e){if(e===!0?!--ht.readyWait:!ht.isReady){if(!Y.body)return setTimeout(ht.ready);ht.isReady=!0,e!==!0&&--ht.readyWait>0||(G.resolveWith(Y,[ht]),ht.fn.trigger&&ht(Y).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===ht.type(e)},isArray:Array.isArray||function(e){return"array"===ht.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?J[at.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==ht.type(e)||e.nodeType||ht.isWindow(e))return!1;try{if(e.constructor&&!st.call(e,"constructor")&&!st.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}var n;for(n in e);return n===t||st.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||Y;var n=dt.exec(e),r=!i&&[];return n?[t.createElement(n[1])]:(n=ht.buildFragment([e],t,r),r&&ht(r).remove(),ht.merge([],n.childNodes))},parseJSON:function(t){return e.JSON&&e.JSON.parse?e.JSON.parse(t):null===t?t:"string"==typeof t&&(t=ht.trim(t),t&&mt.test(t.replace(vt,"@").replace(Et,"]").replace(gt,"")))?new Function("return "+t)():void ht.error("Invalid JSON: "+t)},parseXML:function(i){var n,r;if(!i||"string"!=typeof i)return null;try{e.DOMParser?(r=new DOMParser,n=r.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(o){n=t}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||ht.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(t){t&&ht.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(yt,"ms-").replace(Tt,xt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,o=0,a=e.length,s=i(e);if(n){if(s)for(;a>o&&(r=t.apply(e[o],n),r!==!1);o++);else for(o in e)if(r=t.apply(e[o],n),r===!1)break}else if(s)for(;a>o&&(r=t.call(e[o],o,e[o]),r!==!1);o++);else for(o in e)if(r=t.call(e[o],o,e[o]),r===!1)break;return e},trim:lt&&!lt.call("﻿ ")?function(e){return null==e?"":lt.call(e)}:function(e){return null==e?"":(e+"").replace(ft,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?ht.merge(n,"string"==typeof e?[e]:e):nt.call(n,e)),n},inArray:function(e,t,i){var n;if(t){if(ot)return ot.call(t,e,i);for(n=t.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var n=i.length,r=e.length,o=0;if("number"==typeof n)for(;n>o;o++)e[r++]=i[o];else for(;i[o]!==t;)e[r++]=i[o++];return e.length=r,e},grep:function(e,t,i){var n,r=[],o=0,a=e.length;for(i=!!i;a>o;o++)n=!!t(e[o],o),i!==n&&r.push(e[o]);return r},map:function(e,t,n){var r,o=0,a=e.length,s=i(e),l=[];if(s)for(;a>o;o++)r=t(e[o],o,n),null!=r&&(l[l.length]=r);else for(o in e)r=t(e[o],o,n),null!=r&&(l[l.length]=r);return it.apply([],l)},guid:1,proxy:function(e,i){var n,r,o;return"string"==typeof i&&(o=e[i],i=e,e=o),ht.isFunction(e)?(n=rt.call(arguments,2),r=function(){return e.apply(i||this,n.concat(rt.call(arguments)))},r.guid=e.guid=e.guid||ht.guid++,r):t},access:function(e,i,n,r,o,a,s){var l=0,h=e.length,c=null==n;if("object"===ht.type(n)){o=!0;for(l in n)ht.access(e,i,l,n[l],!0,a,s)}else if(r!==t&&(o=!0,ht.isFunction(r)||(s=!0),c&&(s?(i.call(e,r),i=null):(c=i,i=function(e,t,i){return c.call(ht(e),i)})),i))for(;h>l;l++)i(e[l],n,s?r:r.call(e[l],l,i(e[l],n)));return o?e:c?i.call(e):h?i(e[0],n):a},now:function(){return(new Date).getTime()}}),ht.ready.promise=function(t){if(!G)if(G=ht.Deferred(),"complete"===Y.readyState)setTimeout(ht.ready);else if(Y.addEventListener)Y.addEventListener("DOMContentLoaded",bt,!1),e.addEventListener("load",bt,!1);else{Y.attachEvent("onreadystatechange",bt),e.attachEvent("onload",bt);var i=!1;try{i=null==e.frameElement&&Y.documentElement}catch(n){}i&&i.doScroll&&!function r(){if(!ht.isReady){try{i.doScroll("left")}catch(e){return setTimeout(r,50)}_t(),ht.ready()}}()}return G.promise(t)},ht.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){J["[object "+t+"]"]=t.toLowerCase()}),q=ht(Y);var wt={};ht.Callbacks=function(e){e="string"==typeof e?wt[e]||n(e):ht.extend({},e);var i,r,o,a,s,l,h=[],c=!e.once&&[],u=function(t){for(r=e.memory&&t,o=!0,s=l||0,l=0,a=h.length,i=!0;h&&a>s;s++)if(h[s].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}i=!1,h&&(c?c.length&&u(c.shift()):r?h=[]:f.disable())},f={add:function(){if(h){var t=h.length;!function n(t){ht.each(t,function(t,i){var r=ht.type(i);"function"===r?e.unique&&f.has(i)||h.push(i):i&&i.length&&"string"!==r&&n(i)})}(arguments),i?a=h.length:r&&(l=t,u(r))}return this},remove:function(){return h&&ht.each(arguments,function(e,t){for(var n;(n=ht.inArray(t,h,n))>-1;)h.splice(n,1),i&&(a>=n&&a--,s>=n&&s--)}),this},has:function(e){return e?ht.inArray(e,h)>-1:!(!h||!h.length)},empty:function(){return h=[],this},disable:function(){return h=c=r=t,this},disabled:function(){return!h},lock:function(){return c=t,r||f.disable(),this},locked:function(){return!c},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!h||o&&!c||(i?c.push(t):u(t)),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},ht.extend({Deferred:function(e){var t=[["resolve","done",ht.Callbacks("once memory"),"resolved"],["reject","fail",ht.Callbacks("once memory"),"rejected"],["notify","progress",ht.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ht.Deferred(function(i){ht.each(t,function(t,o){var a=o[0],s=ht.isFunction(e[t])&&e[t];r[o[1]](function(){var e=s&&s.apply(this,arguments);e&&ht.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[a+"With"](this===n?i.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ht.extend(e,n):n}},r={};return n.pipe=n.then,ht.each(t,function(e,o){var a=o[2],s=o[3];n[o[1]]=a.add,s&&a.add(function(){i=s},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=a.fireWith}),n.promise(r),e&&e.call(r,r),r},when:function(e){var t=0,i=rt.call(arguments),n=i.length,r=1!==n||e&&ht.isFunction(e.promise)?n:0,o=1===r?e:ht.Deferred(),a=function(e,t,i){return function(n){t[e]=this,i[e]=arguments.length>1?rt.call(arguments):n,i===s?o.notifyWith(t,i):--r||o.resolveWith(t,i)}},s,l,h;if(n>1)for(s=new Array(n),l=new Array(n),h=new Array(n);n>t;t++)i[t]&&ht.isFunction(i[t].promise)?i[t].promise().done(a(t,h,i)).fail(o.reject).progress(a(t,l,s)):--r;return r||o.resolveWith(h,i),o.promise()}}),ht.support=function(){var t,i,n,r,o,a,s,l,h,c,u=Y.createElement("div");if(u.setAttribute("className","t"),u.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=u.getElementsByTagName("*"),n=u.getElementsByTagName("a")[0],!i||!n||!i.length)return{};o=Y.createElement("select"),s=o.appendChild(Y.createElement("option")),r=u.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==u.className,leadingWhitespace:3===u.firstChild.nodeType,tbody:!u.getElementsByTagName("tbody").length,htmlSerialize:!!u.getElementsByTagName("link").length,style:/top/.test(n.getAttribute("style")),hrefNormalized:"/a"===n.getAttribute("href"),opacity:/^0.5/.test(n.style.opacity),cssFloat:!!n.style.cssFloat,checkOn:!!r.value,optSelected:s.selected,enctype:!!Y.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==Y.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===Y.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},r.checked=!0,t.noCloneChecked=r.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!s.disabled;try{delete u.test}catch(f){t.deleteExpando=!1}r=Y.createElement("input"),r.setAttribute("value",""),t.input=""===r.getAttribute("value"),r.value="t",r.setAttribute("type","radio"),t.radioValue="t"===r.value,r.setAttribute("checked","t"),r.setAttribute("name","t"),a=Y.createDocumentFragment(),a.appendChild(r),t.appendChecked=r.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,u.attachEvent&&(u.attachEvent("onclick",function(){t.noCloneEvent=!1}),u.cloneNode(!0).click());for(c in{submit:!0,change:!0,focusin:!0})u.setAttribute(l="on"+c,"t"),t[c+"Bubbles"]=l in e||u.attributes[l].expando===!1;return u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===u.style.backgroundClip,ht(function(){var i,n,r,o="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=Y.getElementsByTagName("body")[0];a&&(i=Y.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(i).appendChild(u),u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",r=u.getElementsByTagName("td"),r[0].style.cssText="padding:0;margin:0;border:0;display:none",h=0===r[0].offsetHeight,r[0].style.display="",r[1].style.display="none",t.reliableHiddenOffsets=h&&0===r[0].offsetHeight,u.innerHTML="",u.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===u.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==a.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(u,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(u,null)||{width:"4px"}).width,n=u.appendChild(Y.createElement("div")),n.style.cssText=u.style.cssText=o,n.style.marginRight=n.style.width="0",u.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight)),typeof u.style.zoom!==X&&(u.innerHTML="",u.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===u.offsetWidth,u.style.display="block",u.innerHTML="<div></div>",u.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==u.offsetWidth,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(i),i=u=r=n=null)}),i=o=a=s=n=r=null,t}();var Rt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Ht=/([A-Z])/g;ht.extend({cache:{},expando:"jQuery"+(tt+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?ht.cache[e[ht.expando]]:e[ht.expando],!!e&&!s(e)},data:function(e,t,i){return r(e,t,i)},removeData:function(e,t){return o(e,t)},_data:function(e,t,i){return r(e,t,i,!0)},_removeData:function(e,t){return o(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&ht.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),ht.fn.extend({data:function(e,i){var n,r,o=this[0],s=0,l=null;if(e===t){if(this.length&&(l=ht.data(o),1===o.nodeType&&!ht._data(o,"parsedAttrs"))){for(n=o.attributes;s<n.length;s++)r=n[s].name,r.indexOf("data-")||(r=ht.camelCase(r.slice(5)),a(o,r,l[r]));ht._data(o,"parsedAttrs",!0)}return l}return"object"==typeof e?this.each(function(){ht.data(this,e)}):ht.access(this,function(i){return i===t?o?a(o,e,ht.data(o,e)):null:void this.each(function(){ht.data(this,e,i)})},null,i,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ht.removeData(this,e)})}}),ht.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=ht._data(e,t),i&&(!n||ht.isArray(i)?n=ht._data(e,t,ht.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=ht.queue(e,t),n=i.length,r=i.shift(),o=ht._queueHooks(e,t),a=function(){ht.dequeue(e,t)};"inprogress"===r&&(r=i.shift(),n--),o.cur=r,r&&("fx"===t&&i.unshift("inprogress"),delete o.stop,r.call(e,a,o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ht._data(e,i)||ht._data(e,i,{empty:ht.Callbacks("once memory").add(function(){ht._removeData(e,t+"queue"),ht._removeData(e,i)})})}}),ht.fn.extend({queue:function(e,i){var n=2;return"string"!=typeof e&&(i=e,e="fx",n--),arguments.length<n?ht.queue(this[0],e):i===t?this:this.each(function(){var t=ht.queue(this,e,i);ht._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&ht.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ht.dequeue(this,e)})},delay:function(e,t){return e=ht.fx?ht.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,r=1,o=ht.Deferred(),a=this,s=this.length,l=function(){--r||o.resolveWith(a,[a])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";s--;)n=ht._data(a[s],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(l));return l(),o.promise(i)}});var Mt,St,Ct=/[\t\r\n]/g,At=/\r/g,Dt=/^(?:input|select|textarea|button|object)$/i,kt=/^(?:a|area)$/i,Pt=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Lt=/^(?:checked|selected)$/i,Nt=ht.support.getSetAttribute,zt=ht.support.input;ht.fn.extend({attr:function(e,t){return ht.access(this,ht.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ht.removeAttr(this,e)})},prop:function(e,t){return ht.access(this,ht.prop,e,t,arguments.length>1)},removeProp:function(e){return e=ht.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(i){}})},addClass:function(e){var t,i,n,r,o,a=0,s=this.length,l="string"==typeof e&&e;if(ht.isFunction(e))return this.each(function(t){ht(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ut)||[];s>a;a++)if(i=this[a],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ct," "):" ")){for(o=0;r=t[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");i.className=ht.trim(n)}return this},removeClass:function(e){var t,i,n,r,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(ht.isFunction(e))return this.each(function(t){ht(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ut)||[];s>a;a++)if(i=this[a],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ct," "):"")){for(o=0;r=t[o++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");i.className=e?ht.trim(n):""}return this},toggleClass:function(e,t){var i=typeof e,n="boolean"==typeof t;return this.each(ht.isFunction(e)?function(i){ht(this).toggleClass(e.call(this,i,this.className,t),t)}:function(){if("string"===i)for(var r,o=0,a=ht(this),s=t,l=e.match(ut)||[];r=l[o++];)s=n?s:!a.hasClass(r),a[s?"addClass":"removeClass"](r);else(i===X||"boolean"===i)&&(this.className&&ht._data(this,"__className__",this.className),this.className=this.className||e===!1?"":ht._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Ct," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,n,r,o=this[0];{if(arguments.length)return r=ht.isFunction(e),this.each(function(i){var o,a=ht(this);1===this.nodeType&&(o=r?e.call(this,i,a.val()):e,null==o?o="":"number"==typeof o?o+="":ht.isArray(o)&&(o=ht.map(o,function(e){return null==e?"":e+""})),n=ht.valHooks[this.type]||ht.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,o,"value")!==t||(this.value=o))});if(o)return n=ht.valHooks[o.type]||ht.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(o,"value"))!==t?i:(i=o.value,"string"==typeof i?i.replace(At,""):null==i?"":i)}}}),ht.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,i,n=e.options,r=e.selectedIndex,o="select-one"===e.type||0>r,a=o?null:[],s=o?r+1:n.length,l=0>r?s:o?r:0;s>l;l++)if(i=n[l],!(!i.selected&&l!==r||(ht.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&ht.nodeName(i.parentNode,"optgroup"))){if(t=ht(i).val(),o)return t;
a.push(t)}return a},set:function(e,t){var i=ht.makeArray(t);return ht(e).find("option").each(function(){this.selected=ht.inArray(ht(this).val(),i)>=0}),i.length||(e.selectedIndex=-1),i}}},attr:function(e,i,n){var r,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===X?ht.prop(e,i,n):(o=1!==s||!ht.isXMLDoc(e),o&&(i=i.toLowerCase(),r=ht.attrHooks[i]||(Pt.test(i)?St:Mt)),n===t?r&&o&&"get"in r&&null!==(a=r.get(e,i))?a:(typeof e.getAttribute!==X&&(a=e.getAttribute(i)),null==a?t:a):null!==n?r&&o&&"set"in r&&(a=r.set(e,n,i))!==t?a:(e.setAttribute(i,n+""),n):void ht.removeAttr(e,i))},removeAttr:function(e,t){var i,n,r=0,o=t&&t.match(ut);if(o&&1===e.nodeType)for(;i=o[r++];)n=ht.propFix[i]||i,Pt.test(i)?!Nt&&Lt.test(i)?e[ht.camelCase("default-"+i)]=e[n]=!1:e[n]=!1:ht.attr(e,i,""),e.removeAttribute(Nt?i:n)},attrHooks:{type:{set:function(e,t){if(!ht.support.radioValue&&"radio"===t&&ht.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,i,n){var r,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!ht.isXMLDoc(e),a&&(i=ht.propFix[i]||i,o=ht.propHooks[i]),n!==t?o&&"set"in o&&(r=o.set(e,n,i))!==t?r:e[i]=n:o&&"get"in o&&null!==(r=o.get(e,i))?r:e[i]},propHooks:{tabIndex:{get:function(e){var i=e.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):Dt.test(e.nodeName)||kt.test(e.nodeName)&&e.href?0:t}}}}),St={get:function(e,i){var n=ht.prop(e,i),r="boolean"==typeof n&&e.getAttribute(i),o="boolean"==typeof n?zt&&Nt?null!=r:Lt.test(i)?e[ht.camelCase("default-"+i)]:!!r:e.getAttributeNode(i);return o&&o.value!==!1?i.toLowerCase():t},set:function(e,t,i){return t===!1?ht.removeAttr(e,i):zt&&Nt||!Lt.test(i)?e.setAttribute(!Nt&&ht.propFix[i]||i,i):e[ht.camelCase("default-"+i)]=e[i]=!0,i}},zt&&Nt||(ht.attrHooks.value={get:function(e,i){var n=e.getAttributeNode(i);return ht.nodeName(e,"input")?e.defaultValue:n&&n.specified?n.value:t},set:function(e,t,i){return ht.nodeName(e,"input")?void(e.defaultValue=t):Mt&&Mt.set(e,t,i)}}),Nt||(Mt=ht.valHooks.button={get:function(e,i){var n=e.getAttributeNode(i);return n&&("id"===i||"name"===i||"coords"===i?""!==n.value:n.specified)?n.value:t},set:function(e,i,n){var r=e.getAttributeNode(n);return r||e.setAttributeNode(r=e.ownerDocument.createAttribute(n)),r.value=i+="","value"===n||i===e.getAttribute(n)?i:t}},ht.attrHooks.contenteditable={get:Mt.get,set:function(e,t,i){Mt.set(e,""===t?!1:t,i)}},ht.each(["width","height"],function(e,t){ht.attrHooks[t]=ht.extend(ht.attrHooks[t],{set:function(e,i){return""===i?(e.setAttribute(t,"auto"),i):void 0}})})),ht.support.hrefNormalized||(ht.each(["href","src","width","height"],function(e,i){ht.attrHooks[i]=ht.extend(ht.attrHooks[i],{get:function(e){var n=e.getAttribute(i,2);return null==n?t:n}})}),ht.each(["href","src"],function(e,t){ht.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),ht.support.style||(ht.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),ht.support.optSelected||(ht.propHooks.selected=ht.extend(ht.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),ht.support.enctype||(ht.propFix.enctype="encoding"),ht.support.checkOn||ht.each(["radio","checkbox"],function(){ht.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),ht.each(["radio","checkbox"],function(){ht.valHooks[this]=ht.extend(ht.valHooks[this],{set:function(e,t){return ht.isArray(t)?e.checked=ht.inArray(ht(e).val(),t)>=0:void 0}})});var Ft=/^(?:input|select|textarea)$/i,It=/^key/,Ot=/^(?:mouse|contextmenu)|click/,Ut=/^(?:focusinfocus|focusoutblur)$/,Vt=/^([^.]*)(?:\.(.+)|)$/;ht.event={global:{},add:function(e,i,n,r,o){var a,s,l,h,c,u,f,p,d,m,g,v=ht._data(e);if(v){for(n.handler&&(h=n,n=h.handler,o=h.selector),n.guid||(n.guid=ht.guid++),(s=v.events)||(s=v.events={}),(u=v.handle)||(u=v.handle=function(e){return typeof ht===X||e&&ht.event.triggered===e.type?t:ht.event.dispatch.apply(u.elem,arguments)},u.elem=e),i=(i||"").match(ut)||[""],l=i.length;l--;)a=Vt.exec(i[l])||[],d=g=a[1],m=(a[2]||"").split(".").sort(),c=ht.event.special[d]||{},d=(o?c.delegateType:c.bindType)||d,c=ht.event.special[d]||{},f=ht.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:o,needsContext:o&&ht.expr.match.needsContext.test(o),namespace:m.join(".")},h),(p=s[d])||(p=s[d]=[],p.delegateCount=0,c.setup&&c.setup.call(e,r,m,u)!==!1||(e.addEventListener?e.addEventListener(d,u,!1):e.attachEvent&&e.attachEvent("on"+d,u))),c.add&&(c.add.call(e,f),f.handler.guid||(f.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,f):p.push(f),ht.event.global[d]=!0;e=null}},remove:function(e,t,i,n,r){var o,a,s,l,h,c,u,f,p,d,m,g=ht.hasData(e)&&ht._data(e);if(g&&(c=g.events)){for(t=(t||"").match(ut)||[""],h=t.length;h--;)if(s=Vt.exec(t[h])||[],p=m=s[1],d=(s[2]||"").split(".").sort(),p){for(u=ht.event.special[p]||{},p=(n?u.delegateType:u.bindType)||p,f=c[p]||[],s=s[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;o--;)a=f[o],!r&&m!==a.origType||i&&i.guid!==a.guid||s&&!s.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,u.remove&&u.remove.call(e,a));l&&!f.length&&(u.teardown&&u.teardown.call(e,d,g.handle)!==!1||ht.removeEvent(e,p,g.handle),delete c[p])}else for(p in c)ht.event.remove(e,p+t[h],i,n,!0);ht.isEmptyObject(c)&&(delete g.handle,ht._removeData(e,"events"))}},trigger:function(i,n,r,o){var a,s,l,h,c,u,f,p=[r||Y],d=st.call(i,"type")?i.type:i,m=st.call(i,"namespace")?i.namespace.split("."):[];if(l=u=r=r||Y,3!==r.nodeType&&8!==r.nodeType&&!Ut.test(d+ht.event.triggered)&&(d.indexOf(".")>=0&&(m=d.split("."),d=m.shift(),m.sort()),s=d.indexOf(":")<0&&"on"+d,i=i[ht.expando]?i:new ht.Event(d,"object"==typeof i&&i),i.isTrigger=!0,i.namespace=m.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=r),n=null==n?[i]:ht.makeArray(n,[i]),c=ht.event.special[d]||{},o||!c.trigger||c.trigger.apply(r,n)!==!1)){if(!o&&!c.noBubble&&!ht.isWindow(r)){for(h=c.delegateType||d,Ut.test(h+d)||(l=l.parentNode);l;l=l.parentNode)p.push(l),u=l;u===(r.ownerDocument||Y)&&p.push(u.defaultView||u.parentWindow||e)}for(f=0;(l=p[f++])&&!i.isPropagationStopped();)i.type=f>1?h:c.bindType||d,a=(ht._data(l,"events")||{})[i.type]&&ht._data(l,"handle"),a&&a.apply(l,n),a=s&&l[s],a&&ht.acceptData(l)&&a.apply&&a.apply(l,n)===!1&&i.preventDefault();if(i.type=d,!(o||i.isDefaultPrevented()||c._default&&c._default.apply(r.ownerDocument,n)!==!1||"click"===d&&ht.nodeName(r,"a")||!ht.acceptData(r)||!s||!r[d]||ht.isWindow(r))){u=r[s],u&&(r[s]=null),ht.event.triggered=d;try{r[d]()}catch(g){}ht.event.triggered=t,u&&(r[s]=u)}return i.result}},dispatch:function(e){e=ht.event.fix(e);var i,n,r,o,a,s=[],l=rt.call(arguments),h=(ht._data(this,"events")||{})[e.type]||[],c=ht.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(s=ht.event.handlers.call(this,e,h),i=0;(o=s[i++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,a=0;(r=o.handlers[a++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(r.namespace))&&(e.handleObj=r,e.data=r.data,n=((ht.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,l),n!==t&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,i){var n,r,o,a,s=[],l=i.delegateCount,h=e.target;if(l&&h.nodeType&&(!e.button||"click"!==e.type))for(;h!=this;h=h.parentNode||this)if(1===h.nodeType&&(h.disabled!==!0||"click"!==e.type)){for(o=[],a=0;l>a;a++)r=i[a],n=r.selector+" ",o[n]===t&&(o[n]=r.needsContext?ht(n,this).index(h)>=0:ht.find(n,this,null,[h]).length),o[n]&&o.push(r);o.length&&s.push({elem:h,handlers:o})}return l<i.length&&s.push({elem:this,handlers:i.slice(l)}),s},fix:function(e){if(e[ht.expando])return e;var t,i,n,r=e.type,o=e,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=Ot.test(r)?this.mouseHooks:It.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new ht.Event(o),t=n.length;t--;)i=n[t],e[i]=o[i];return e.target||(e.target=o.srcElement||Y),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,r,o,a=i.button,s=i.fromElement;return null==e.pageX&&null!=i.clientX&&(r=e.target.ownerDocument||Y,o=r.documentElement,n=r.body,e.pageX=i.clientX+(o&&o.scrollLeft||n&&n.scrollLeft||0)-(o&&o.clientLeft||n&&n.clientLeft||0),e.pageY=i.clientY+(o&&o.scrollTop||n&&n.scrollTop||0)-(o&&o.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?i.toElement:s),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return ht.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0}},focus:{trigger:function(){if(this!==Y.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===Y.activeElement&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var r=ht.extend(new ht.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?ht.event.trigger(r,null,t):ht.event.dispatch.call(t,r),r.isDefaultPrevented()&&i.preventDefault()}},ht.removeEvent=Y.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===X&&(e[n]=null),e.detachEvent(n,i))},ht.Event=function(e,t){return this instanceof ht.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?l:h):this.type=e,t&&ht.extend(this,t),this.timeStamp=e&&e.timeStamp||ht.now(),void(this[ht.expando]=!0)):new ht.Event(e,t)},ht.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},ht.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ht.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,r=e.relatedTarget,o=e.handleObj;return(!r||r!==n&&!ht.contains(n,r))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),ht.support.submitBubbles||(ht.event.special.submit={setup:function(){return ht.nodeName(this,"form")?!1:void ht.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,n=ht.nodeName(i,"input")||ht.nodeName(i,"button")?i.form:t;n&&!ht._data(n,"submitBubbles")&&(ht.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),ht._data(n,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ht.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return ht.nodeName(this,"form")?!1:void ht.event.remove(this,"._submit")}}),ht.support.changeBubbles||(ht.event.special.change={setup:function(){return Ft.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ht.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ht.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ht.event.simulate("change",this,e,!0)})),!1):void ht.event.add(this,"beforeactivate._change",function(e){var t=e.target;Ft.test(t.nodeName)&&!ht._data(t,"changeBubbles")&&(ht.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||ht.event.simulate("change",this.parentNode,e,!0)}),ht._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return ht.event.remove(this,"._change"),!Ft.test(this.nodeName)}}),ht.support.focusinBubbles||ht.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){ht.event.simulate(t,e.target,ht.event.fix(e),!0)};ht.event.special[t]={setup:function(){0===i++&&Y.addEventListener(e,n,!0)},teardown:function(){0===--i&&Y.removeEventListener(e,n,!0)}}}),ht.fn.extend({on:function(e,i,n,r,o){var a,s;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=t);for(a in e)this.on(a,i,n,e[a],o);return this}if(null==n&&null==r?(r=i,n=i=t):null==r&&("string"==typeof i?(r=n,n=t):(r=n,n=i,i=t)),r===!1)r=h;else if(!r)return this;return 1===o&&(s=r,r=function(e){return ht().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=ht.guid++)),this.each(function(){ht.event.add(this,e,r,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ht(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(o in e)this.off(o,i,e[o]);return this}return(i===!1||"function"==typeof i)&&(n=i,i=t),n===!1&&(n=h),this.each(function(){ht.event.remove(this,e,n,i)})},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},trigger:function(e,t){return this.each(function(){ht.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?ht.event.trigger(e,t,i,!0):void 0}}),function(e,t){function i(e){return mt.test(e+"")}function n(){var e,t=[];return e=function(i,n){return t.push(i+=" ")>w.cacheLength&&delete e[t.shift()],e[i]=n}}function r(e){return e[O]=!0,e}function o(e){var t=D.createElement("div");try{return e(t)}catch(i){return!1}finally{t=null}}function a(e,t,i,n){var r,o,a,s,l,h,c,p,d,m;if((t?t.ownerDocument||t:U)!==D&&A(t),t=t||D,i=i||[],!e||"string"!=typeof e)return i;if(1!==(s=t.nodeType)&&9!==s)return[];if(!P&&!n){if(r=gt.exec(e))if(a=r[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&F(t,o)&&o.id===a)return i.push(o),i}else{if(r[2])return Z.apply(i,J.call(t.getElementsByTagName(e),0)),i;if((a=r[3])&&V.getByClassName&&t.getElementsByClassName)return Z.apply(i,J.call(t.getElementsByClassName(a),0)),i}if(V.qsa&&!L.test(e)){if(c=!0,p=O,d=t,m=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(h=u(e),(c=t.getAttribute("id"))?p=c.replace(yt,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",l=h.length;l--;)h[l]=p+f(h[l]);d=dt.test(e)&&t.parentNode||t,m=h.join(",")}if(m)try{return Z.apply(i,J.call(d.querySelectorAll(m),0)),i}catch(g){}finally{c||t.removeAttribute("id")}}}return T(e.replace(st,"$1"),t,i,n)}function s(e,t){var i=t&&e,n=i&&(~t.sourceIndex||Y)-(~e.sourceIndex||Y);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function l(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function h(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function c(e){return r(function(t){return t=+t,r(function(i,n){for(var r,o=e([],i.length,t),a=o.length;a--;)i[r=o[a]]&&(i[r]=!(n[r]=i[r]))})})}function u(e,t){var i,n,r,o,s,l,h,c=G[e+" "];if(c)return t?0:c.slice(0);for(s=e,l=[],h=w.preFilter;s;){(!i||(n=lt.exec(s)))&&(n&&(s=s.slice(n[0].length)||s),l.push(r=[])),i=!1,(n=ct.exec(s))&&(i=n.shift(),r.push({value:i,type:n[0].replace(st," ")}),s=s.slice(i.length));for(o in w.filter)!(n=pt[o].exec(s))||h[o]&&!(n=h[o](n))||(i=n.shift(),r.push({value:i,type:o,matches:n}),s=s.slice(i.length));if(!i)break}return t?s.length:s?a.error(e):G(e,l).slice(0)}function f(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function p(e,t,i){var n=t.dir,r=i&&"parentNode"===n,o=W++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||r)return e(t,i,o)}:function(t,i,a){var s,l,h,c=B+" "+o;if(a){for(;t=t[n];)if((1===t.nodeType||r)&&e(t,i,a))return!0}else for(;t=t[n];)if(1===t.nodeType||r)if(h=t[O]||(t[O]={}),(l=h[n])&&l[0]===c){if((s=l[1])===!0||s===_)return s===!0}else if(l=h[n]=[c],l[1]=e(t,i,a)||_,l[1]===!0)return!0}}function d(e){return e.length>1?function(t,i,n){for(var r=e.length;r--;)if(!e[r](t,i,n))return!1;return!0}:e[0]}function m(e,t,i,n,r){for(var o,a=[],s=0,l=e.length,h=null!=t;l>s;s++)(o=e[s])&&(!i||i(o,n,r))&&(a.push(o),h&&t.push(s));return a}function g(e,t,i,n,o,a){return n&&!n[O]&&(n=g(n)),o&&!o[O]&&(o=g(o,a)),r(function(r,a,s,l){var h,c,u,f=[],p=[],d=a.length,g=r||y(t||"*",s.nodeType?[s]:s,[]),v=!e||!r&&t?g:m(g,f,e,s,l),E=i?o||(r?e:d||n)?[]:a:v;if(i&&i(v,E,s,l),n)for(h=m(E,p),n(h,[],s,l),c=h.length;c--;)(u=h[c])&&(E[p[c]]=!(v[p[c]]=u));if(r){if(o||e){if(o){for(h=[],c=E.length;c--;)(u=E[c])&&h.push(v[c]=u);o(null,E=[],h,l)}for(c=E.length;c--;)(u=E[c])&&(h=o?et.call(r,u):f[c])>-1&&(r[h]=!(a[h]=u))}}else E=m(E===a?E.splice(d,E.length):E),o?o(null,a,E,l):Z.apply(a,E)})}function v(e){for(var t,i,n,r=e.length,o=w.relative[e[0].type],a=o||w.relative[" "],s=o?1:0,l=p(function(e){return e===t},a,!0),h=p(function(e){return et.call(t,e)>-1},a,!0),c=[function(e,i,n){return!o&&(n||i!==C)||((t=i).nodeType?l(e,i,n):h(e,i,n))}];r>s;s++)if(i=w.relative[e[s].type])c=[p(d(c),i)];else{if(i=w.filter[e[s].type].apply(null,e[s].matches),i[O]){for(n=++s;r>n&&!w.relative[e[n].type];n++);return g(s>1&&d(c),s>1&&f(e.slice(0,s-1)).replace(st,"$1"),i,n>s&&v(e.slice(s,n)),r>n&&v(e=e.slice(n)),r>n&&f(e))}c.push(i)}return d(c)}function E(e,t){var i=0,n=t.length>0,o=e.length>0,s=function(r,s,l,h,c){var u,f,p,d=[],g=0,v="0",E=r&&[],y=null!=c,T=C,x=r||o&&w.find.TAG("*",c&&s.parentNode||s),b=B+=null==T?1:Math.random()||.1;for(y&&(C=s!==D&&s,_=i);null!=(u=x[v]);v++){if(o&&u){for(f=0;p=e[f++];)if(p(u,s,l)){h.push(u);break}y&&(B=b,_=++i)}n&&((u=!p&&u)&&g--,r&&E.push(u))}if(g+=v,n&&v!==g){for(f=0;p=t[f++];)p(E,d,s,l);if(r){if(g>0)for(;v--;)E[v]||d[v]||(d[v]=Q.call(h));d=m(d)}Z.apply(h,d),y&&!r&&d.length>0&&g+t.length>1&&a.uniqueSort(h)}return y&&(B=b,C=T),E};return n?r(s):s}function y(e,t,i){for(var n=0,r=t.length;r>n;n++)a(e,t[n],i);return i}function T(e,t,i,n){var r,o,a,s,l,h=u(e);if(!n&&1===h.length){if(o=h[0]=h[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&9===t.nodeType&&!P&&w.relative[o[1].type]){if(t=w.find.ID(a.matches[0].replace(xt,bt),t)[0],!t)return i;e=e.slice(o.shift().value.length)}for(r=pt.needsContext.test(e)?0:o.length;r--&&(a=o[r],!w.relative[s=a.type]);)if((l=w.find[s])&&(n=l(a.matches[0].replace(xt,bt),dt.test(o[0].type)&&t.parentNode||t))){if(o.splice(r,1),e=n.length&&f(o),!e)return Z.apply(i,J.call(n,0)),i;break}}return M(e,h)(n,t,P,i,dt.test(e)),i}function x(){}var b,_,w,R,H,M,S,C,A,D,k,P,L,N,z,F,I,O="sizzle"+-new Date,U=e.document,V={},B=0,W=0,j=n(),G=n(),q=n(),X=typeof t,Y=1<<31,K=[],Q=K.pop,Z=K.push,J=K.slice,et=K.indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},tt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",nt=it.replace("w","w#"),rt="([*^$|!~]?=)",ot="\\["+tt+"*("+it+")"+tt+"*(?:"+rt+tt+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+nt+")|)|)"+tt+"*\\]",at=":("+it+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ot.replace(3,8)+")*)|.*)\\)|)",st=new RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),lt=new RegExp("^"+tt+"*,"+tt+"*"),ct=new RegExp("^"+tt+"*([\\x20\\t\\r\\n\\f>+~])"+tt+"*"),ut=new RegExp(at),ft=new RegExp("^"+nt+"$"),pt={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),NAME:new RegExp("^\\[name=['\"]?("+it+")['\"]?\\]"),TAG:new RegExp("^("+it.replace("w","w*")+")"),ATTR:new RegExp("^"+ot),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),needsContext:new RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},dt=/[\x20\t\r\n\f]*[+~]/,mt=/^[^{]+\{\s*\[native code/,gt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,vt=/^(?:input|select|textarea|button)$/i,Et=/^h\d$/i,yt=/'|\\/g,Tt=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,xt=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,bt=function(e,t){var i="0x"+t-65536;return i!==i?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{J.call(U.documentElement.childNodes,0)[0].nodeType}catch(_t){J=function(e){for(var t,i=[];t=this[e++];)i.push(t);return i}}H=a.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},A=a.setDocument=function(e){var n=e?e.ownerDocument||e:U;return n!==D&&9===n.nodeType&&n.documentElement?(D=n,k=n.documentElement,P=H(n),V.tagNameNoComments=o(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),V.attributes=o(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),V.getByClassName=o(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),V.getByName=o(function(e){e.id=O+0,e.innerHTML="<a name='"+O+"'></a><div name='"+O+"'></div>",k.insertBefore(e,k.firstChild);var t=n.getElementsByName&&n.getElementsByName(O).length===2+n.getElementsByName(O+0).length;return V.getIdNotName=!n.getElementById(O),k.removeChild(e),t}),w.attrHandle=o(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==X&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},V.getIdNotName?(w.find.ID=function(e,t){if(typeof t.getElementById!==X&&!P){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},w.filter.ID=function(e){var t=e.replace(xt,bt);return function(e){return e.getAttribute("id")===t}}):(w.find.ID=function(e,i){if(typeof i.getElementById!==X&&!P){var n=i.getElementById(e);return n?n.id===e||typeof n.getAttributeNode!==X&&n.getAttributeNode("id").value===e?[n]:t:[]}},w.filter.ID=function(e){var t=e.replace(xt,bt);return function(e){var i=typeof e.getAttributeNode!==X&&e.getAttributeNode("id");return i&&i.value===t}}),w.find.TAG=V.tagNameNoComments?function(e,t){return typeof t.getElementsByTagName!==X?t.getElementsByTagName(e):void 0}:function(e,t){var i,n=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},w.find.NAME=V.getByName&&function(e,t){return typeof t.getElementsByName!==X?t.getElementsByName(name):void 0},w.find.CLASS=V.getByClassName&&function(e,t){return typeof t.getElementsByClassName===X||P?void 0:t.getElementsByClassName(e)},N=[],L=[":focus"],(V.qsa=i(n.querySelectorAll))&&(o(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||L.push("\\["+tt+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||L.push(":checked")}),o(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&L.push("[*^$]="+tt+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||L.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),L.push(",.*:")})),(V.matchesSelector=i(z=k.matchesSelector||k.mozMatchesSelector||k.webkitMatchesSelector||k.oMatchesSelector||k.msMatchesSelector))&&o(function(e){V.disconnectedMatch=z.call(e,"div"),z.call(e,"[s!='']:x"),N.push("!=",at)}),L=new RegExp(L.join("|")),N=new RegExp(N.join("|")),F=i(k.contains)||k.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},I=k.compareDocumentPosition?function(e,t){var i;return e===t?(S=!0,0):(i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&i||e.parentNode&&11===e.parentNode.nodeType?e===n||F(U,e)?-1:t===n||F(U,t)?1:0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var i,r=0,o=e.parentNode,a=t.parentNode,l=[e],h=[t];if(e===t)return S=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:0;if(o===a)return s(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)h.unshift(i);for(;l[r]===h[r];)r++;return r?s(l[r],h[r]):l[r]===U?-1:h[r]===U?1:0},S=!1,[0,0].sort(I),V.detectDuplicates=S,D):D},a.matches=function(e,t){return a(e,null,null,t)},a.matchesSelector=function(e,t){if((e.ownerDocument||e)!==D&&A(e),t=t.replace(Tt,"='$1']"),!(!V.matchesSelector||P||N&&N.test(t)||L.test(t)))try{var i=z.call(e,t);if(i||V.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(n){}return a(t,D,null,[e]).length>0},a.contains=function(e,t){return(e.ownerDocument||e)!==D&&A(e),F(e,t)},a.attr=function(e,t){var i;return(e.ownerDocument||e)!==D&&A(e),P||(t=t.toLowerCase()),(i=w.attrHandle[t])?i(e):P||V.attributes?e.getAttribute(t):((i=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:i&&i.specified?i.value:null},a.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a.uniqueSort=function(e){var t,i=[],n=1,r=0;if(S=!V.detectDuplicates,e.sort(I),S){for(;t=e[n];n++)t===e[n-1]&&(r=i.push(n));for(;r--;)e.splice(i[r],1)}return e},R=a.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=R(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n];n++)i+=R(t);return i},w=a.selectors={cacheLength:50,createPseudo:r,match:pt,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(xt,bt),e[3]=(e[4]||e[5]||"").replace(xt,bt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||a.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&a.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return pt.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:i&&ut.test(i)&&(t=u(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(xt,bt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=j[e+" "];return t||(t=new RegExp("(^|"+tt+")"+e+"("+tt+"|$)"))&&j(e,function(e){return t.test(e.className||typeof e.getAttribute!==X&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(n){var r=a.attr(n,e);return null==r?"!="===t:t?(r+="","="===t?r===i:"!="===t?r!==i:"^="===t?i&&0===r.indexOf(i):"*="===t?i&&r.indexOf(i)>-1:"$="===t?i&&r.slice(-i.length)===i:"~="===t?(" "+r+" ").indexOf(i)>-1:"|="===t?r===i||r.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,i,n,r){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,i,l){var h,c,u,f,p,d,m=o!==a?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),E=!l&&!s;if(g){if(o){for(;m;){for(u=t;u=u[m];)if(s?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;d=m="only"===e&&!d&&"nextSibling"}return!0}if(d=[a?g.firstChild:g.lastChild],a&&E){for(c=g[O]||(g[O]={}),h=c[e]||[],p=h[0]===B&&h[1],f=h[0]===B&&h[2],u=p&&g.childNodes[p];u=++p&&u&&u[m]||(f=p=0)||d.pop();)if(1===u.nodeType&&++f&&u===t){c[e]=[B,p,f];break}}else if(E&&(h=(t[O]||(t[O]={}))[e])&&h[0]===B)f=h[1];else for(;(u=++p&&u&&u[m]||(f=p=0)||d.pop())&&((s?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++f||(E&&((u[O]||(u[O]={}))[e]=[B,f]),u!==t)););return f-=r,f===n||f%n===0&&f/n>=0}}},PSEUDO:function(e,t){var i,n=w.pseudos[e]||w.setFilters[e.toLowerCase()]||a.error("unsupported pseudo: "+e);return n[O]?n(t):n.length>1?(i=[e,e,"",t],w.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,i){for(var r,o=n(e,t),a=o.length;a--;)r=et.call(e,o[a]),e[r]=!(i[r]=o[a])}):function(e){return n(e,0,i)}):n}},pseudos:{not:r(function(e){var t=[],i=[],n=M(e.replace(st,"$1"));return n[O]?r(function(e,t,i,r){for(var o,a=n(e,null,r,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,r,o){return t[0]=e,n(t,null,o,i),!i.pop()}}),has:r(function(e){return function(t){return a(e,t).length>0}}),contains:r(function(e){return function(t){return(t.textContent||t.innerText||R(t)).indexOf(e)>-1}}),lang:r(function(e){return ft.test(e||"")||a.error("unsupported lang: "+e),e=e.replace(xt,bt).toLowerCase(),function(t){var i;do if(i=P?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===k},focus:function(e){return e===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!w.pseudos.empty(e)},header:function(e){return Et.test(e.nodeName)},input:function(e){return vt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,i){return[0>i?i+t:i]}),even:c(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:c(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:c(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:c(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);return e})}};for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[b]=l(b);for(b in{submit:!0,reset:!0})w.pseudos[b]=h(b);M=a.compile=function(e,t){var i,n=[],r=[],o=q[e+" "];if(!o){for(t||(t=u(e)),i=t.length;i--;)o=v(t[i]),o[O]?n.push(o):r.push(o);o=q(e,E(r,n))}return o},w.pseudos.nth=w.pseudos.eq,w.filters=x.prototype=w.pseudos,w.setFilters=new x,A(),a.attr=ht.attr,ht.find=a,ht.expr=a.selectors,ht.expr[":"]=ht.expr.pseudos,ht.unique=a.uniqueSort,ht.text=a.getText,ht.isXMLDoc=a.isXML,ht.contains=a.contains
}(e);var Bt=/Until$/,Wt=/^(?:parents|prev(?:Until|All))/,jt=/^.[^:#\[\.,]*$/,Gt=ht.expr.match.needsContext,qt={children:!0,contents:!0,next:!0,prev:!0};ht.fn.extend({find:function(e){var t,i,n,r=this.length;if("string"!=typeof e)return n=this,this.pushStack(ht(e).filter(function(){for(t=0;r>t;t++)if(ht.contains(n[t],this))return!0}));for(i=[],t=0;r>t;t++)ht.find(e,this[t],i);return i=this.pushStack(r>1?ht.unique(i):i),i.selector=(this.selector?this.selector+" ":"")+e,i},has:function(e){var t,i=ht(e,this),n=i.length;return this.filter(function(){for(t=0;n>t;t++)if(ht.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(u(this,e,!1))},filter:function(e){return this.pushStack(u(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?Gt.test(e)?ht(e,this.context).index(this[0])>=0:ht.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var i,n=0,r=this.length,o=[],a=Gt.test(e)||"string"!=typeof e?ht(e,t||this.context):0;r>n;n++)for(i=this[n];i&&i.ownerDocument&&i!==t&&11!==i.nodeType;){if(a?a.index(i)>-1:ht.find.matchesSelector(i,e)){o.push(i);break}i=i.parentNode}return this.pushStack(o.length>1?ht.unique(o):o)},index:function(e){return e?"string"==typeof e?ht.inArray(this[0],ht(e)):ht.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?ht(e,t):ht.makeArray(e&&e.nodeType?[e]:e),n=ht.merge(this.get(),i);return this.pushStack(ht.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ht.fn.andSelf=ht.fn.addBack,ht.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ht.dir(e,"parentNode")},parentsUntil:function(e,t,i){return ht.dir(e,"parentNode",i)},next:function(e){return c(e,"nextSibling")},prev:function(e){return c(e,"previousSibling")},nextAll:function(e){return ht.dir(e,"nextSibling")},prevAll:function(e){return ht.dir(e,"previousSibling")},nextUntil:function(e,t,i){return ht.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return ht.dir(e,"previousSibling",i)},siblings:function(e){return ht.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ht.sibling(e.firstChild)},contents:function(e){return ht.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ht.merge([],e.childNodes)}},function(e,t){ht.fn[e]=function(i,n){var r=ht.map(this,t,i);return Bt.test(e)||(n=i),n&&"string"==typeof n&&(r=ht.filter(n,r)),r=this.length>1&&!qt[e]?ht.unique(r):r,this.length>1&&Wt.test(e)&&(r=r.reverse()),this.pushStack(r)}}),ht.extend({filter:function(e,t,i){return i&&(e=":not("+e+")"),1===t.length?ht.find.matchesSelector(t[0],e)?[t[0]]:[]:ht.find.matches(e,t)},dir:function(e,i,n){for(var r=[],o=e[i];o&&9!==o.nodeType&&(n===t||1!==o.nodeType||!ht(o).is(n));)1===o.nodeType&&r.push(o),o=o[i];return r},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var Xt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Yt=/ jQuery\d+="(?:null|\d+)"/g,Kt=new RegExp("<(?:"+Xt+")[\\s/>]","i"),Qt=/^\s+/,$t=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Zt=/<([\w:]+)/,Jt=/<tbody/i,ei=/<|&#?\w+;/,ti=/<(?:script|style|link)/i,ii=/^(?:checkbox|radio)$/i,ni=/checked\s*(?:[^=]|=\s*.checked.)/i,ri=/^$|\/(?:java|ecma)script/i,oi=/^true\/(.*)/,ai=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,si={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ht.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},li=f(Y),hi=li.appendChild(Y.createElement("div"));si.optgroup=si.option,si.tbody=si.tfoot=si.colgroup=si.caption=si.thead,si.th=si.td,ht.fn.extend({text:function(e){return ht.access(this,function(e){return e===t?ht.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Y).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(ht.isFunction(e))return this.each(function(t){ht(this).wrapAll(e.call(this,t))});if(this[0]){var t=ht(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(ht.isFunction(e)?function(t){ht(this).wrapInner(e.call(this,t))}:function(){var t=ht(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=ht.isFunction(e);return this.each(function(i){ht(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){ht.nodeName(this,"body")||ht(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=0;null!=(i=this[n]);n++)(!e||ht.filter(e,[i]).length>0)&&(t||1!==i.nodeType||ht.cleanData(y(i)),i.parentNode&&(t&&ht.contains(i.ownerDocument,i)&&g(y(i,"script")),i.parentNode.removeChild(i)));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&ht.cleanData(y(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&ht.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ht.clone(this,e,t)})},html:function(e){return ht.access(this,function(e){var i=this[0]||{},n=0,r=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(Yt,""):t;if(!("string"!=typeof e||ti.test(e)||!ht.support.htmlSerialize&&Kt.test(e)||!ht.support.leadingWhitespace&&Qt.test(e)||si[(Zt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace($t,"<$1></$2>");try{for(;r>n;n++)i=this[n]||{},1===i.nodeType&&(ht.cleanData(y(i,!1)),i.innerHTML=e);i=0}catch(o){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=ht.isFunction(e);return t||"string"==typeof e||(e=ht(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,i=this.parentNode;i&&(ht(this).remove(),i.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,i,n){e=it.apply([],e);var r,o,a,s,l,h,c=0,u=this.length,f=this,g=u-1,v=e[0],E=ht.isFunction(v);if(E||!(1>=u||"string"!=typeof v||ht.support.checkClone)&&ni.test(v))return this.each(function(r){var o=f.eq(r);E&&(e[0]=v.call(this,r,i?o.html():t)),o.domManip(e,i,n)});if(u&&(h=ht.buildFragment(e,this[0].ownerDocument,!1,this),r=h.firstChild,1===h.childNodes.length&&(h=r),r)){for(i=i&&ht.nodeName(r,"tr"),s=ht.map(y(h,"script"),d),a=s.length;u>c;c++)o=h,c!==g&&(o=ht.clone(o,!0,!0),a&&ht.merge(s,y(o,"script"))),n.call(i&&ht.nodeName(this[c],"table")?p(this[c],"tbody"):this[c],o,c);if(a)for(l=s[s.length-1].ownerDocument,ht.map(s,m),c=0;a>c;c++)o=s[c],ri.test(o.type||"")&&!ht._data(o,"globalEval")&&ht.contains(l,o)&&(o.src?ht.ajax({url:o.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):ht.globalEval((o.text||o.textContent||o.innerHTML||"").replace(ai,"")));h=r=null}return this}}),ht.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ht.fn[e]=function(e){for(var i,n=0,r=[],o=ht(e),a=o.length-1;a>=n;n++)i=n===a?this:this.clone(!0),ht(o[n])[t](i),nt.apply(r,i.get());return this.pushStack(r)}}),ht.extend({clone:function(e,t,i){var n,r,o,a,s,l=ht.contains(e.ownerDocument,e);if(ht.support.html5Clone||ht.isXMLDoc(e)||!Kt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(hi.innerHTML=e.outerHTML,hi.removeChild(o=hi.firstChild)),!(ht.support.noCloneEvent&&ht.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ht.isXMLDoc(e)))for(n=y(o),s=y(e),a=0;null!=(r=s[a]);++a)n[a]&&E(r,n[a]);if(t)if(i)for(s=s||y(e),n=n||y(o),a=0;null!=(r=s[a]);a++)v(r,n[a]);else v(e,o);return n=y(o,"script"),n.length>0&&g(n,!l&&y(e,"script")),n=s=r=null,o},buildFragment:function(e,t,i,n){for(var r,o,a,s,l,h,c,u=e.length,p=f(t),d=[],m=0;u>m;m++)if(o=e[m],o||0===o)if("object"===ht.type(o))ht.merge(d,o.nodeType?[o]:o);else if(ei.test(o)){for(s=s||p.appendChild(t.createElement("div")),l=(Zt.exec(o)||["",""])[1].toLowerCase(),c=si[l]||si._default,s.innerHTML=c[1]+o.replace($t,"<$1></$2>")+c[2],r=c[0];r--;)s=s.lastChild;if(!ht.support.leadingWhitespace&&Qt.test(o)&&d.push(t.createTextNode(Qt.exec(o)[0])),!ht.support.tbody)for(o="table"!==l||Jt.test(o)?"<table>"!==c[1]||Jt.test(o)?0:s:s.firstChild,r=o&&o.childNodes.length;r--;)ht.nodeName(h=o.childNodes[r],"tbody")&&!h.childNodes.length&&o.removeChild(h);for(ht.merge(d,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=p.lastChild}else d.push(t.createTextNode(o));for(s&&p.removeChild(s),ht.support.appendChecked||ht.grep(y(d,"input"),T),m=0;o=d[m++];)if((!n||-1===ht.inArray(o,n))&&(a=ht.contains(o.ownerDocument,o),s=y(p.appendChild(o),"script"),a&&g(s),i))for(r=0;o=s[r++];)ri.test(o.type||"")&&i.push(o);return s=null,p},cleanData:function(e,t){for(var i,n,r,o,a=0,s=ht.expando,l=ht.cache,h=ht.support.deleteExpando,c=ht.event.special;null!=(i=e[a]);a++)if((t||ht.acceptData(i))&&(r=i[s],o=r&&l[r])){if(o.events)for(n in o.events)c[n]?ht.event.remove(i,n):ht.removeEvent(i,n,o.handle);l[r]&&(delete l[r],h?delete i[s]:typeof i.removeAttribute!==X?i.removeAttribute(s):i[s]=null,et.push(r))}}});var ci,ui,fi,pi=/alpha\([^)]*\)/i,di=/opacity\s*=\s*([^)]*)/,mi=/^(top|right|bottom|left)$/,gi=/^(none|table(?!-c[ea]).+)/,vi=/^margin/,Ei=new RegExp("^("+ct+")(.*)$","i"),yi=new RegExp("^("+ct+")(?!px)[a-z%]+$","i"),Ti=new RegExp("^([+-])=("+ct+")","i"),xi={BODY:"block"},bi={position:"absolute",visibility:"hidden",display:"block"},_i={letterSpacing:0,fontWeight:400},wi=["Top","Right","Bottom","Left"],Ri=["Webkit","O","Moz","ms"];ht.fn.extend({css:function(e,i){return ht.access(this,function(e,i,n){var r,o,a={},s=0;if(ht.isArray(i)){for(o=ui(e),r=i.length;r>s;s++)a[i[s]]=ht.css(e,i[s],!1,o);return a}return n!==t?ht.style(e,i,n):ht.css(e,i)},e,i,arguments.length>1)},show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:b(this))?ht(this).show():ht(this).hide()})}}),ht.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=fi(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ht.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=ht.camelCase(i),h=e.style;if(i=ht.cssProps[l]||(ht.cssProps[l]=x(h,l)),s=ht.cssHooks[i]||ht.cssHooks[l],n===t)return s&&"get"in s&&(o=s.get(e,!1,r))!==t?o:h[i];if(a=typeof n,"string"===a&&(o=Ti.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(ht.css(e,i)),a="number"),!(null==n||"number"===a&&isNaN(n)||("number"!==a||ht.cssNumber[l]||(n+="px"),ht.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(h[i]="inherit"),s&&"set"in s&&(n=s.set(e,n,r))===t)))try{h[i]=n}catch(c){}}},css:function(e,i,n,r){var o,a,s,l=ht.camelCase(i);return i=ht.cssProps[l]||(ht.cssProps[l]=x(e.style,l)),s=ht.cssHooks[i]||ht.cssHooks[l],s&&"get"in s&&(a=s.get(e,!0,n)),a===t&&(a=fi(e,i,r)),"normal"===a&&i in _i&&(a=_i[i]),""===n||n?(o=parseFloat(a),n===!0||ht.isNumeric(o)?o||0:a):a},swap:function(e,t,i,n){var r,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];r=i.apply(e,n||[]);for(o in t)e.style[o]=a[o];return r}}),e.getComputedStyle?(ui=function(t){return e.getComputedStyle(t,null)},fi=function(e,i,n){var r,o,a,s=n||ui(e),l=s?s.getPropertyValue(i)||s[i]:t,h=e.style;return s&&(""!==l||ht.contains(e.ownerDocument,e)||(l=ht.style(e,i)),yi.test(l)&&vi.test(i)&&(r=h.width,o=h.minWidth,a=h.maxWidth,h.minWidth=h.maxWidth=h.width=l,l=s.width,h.width=r,h.minWidth=o,h.maxWidth=a)),l}):Y.documentElement.currentStyle&&(ui=function(e){return e.currentStyle},fi=function(e,i,n){var r,o,a,s=n||ui(e),l=s?s[i]:t,h=e.style;return null==l&&h&&h[i]&&(l=h[i]),yi.test(l)&&!mi.test(i)&&(r=h.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),h.left="fontSize"===i?"1em":l,l=h.pixelLeft+"px",h.left=r,a&&(o.left=a)),""===l?"auto":l}),ht.each(["height","width"],function(e,t){ht.cssHooks[t]={get:function(e,i,n){return i?0===e.offsetWidth&&gi.test(ht.css(e,"display"))?ht.swap(e,bi,function(){return H(e,t,n)}):H(e,t,n):void 0},set:function(e,i,n){var r=n&&ui(e);return w(e,i,n?R(e,t,n,ht.support.boxSizing&&"border-box"===ht.css(e,"boxSizing",!1,r),r):0)}}}),ht.support.opacity||(ht.cssHooks.opacity={get:function(e,t){return di.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,r=ht.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=n&&n.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===ht.trim(o.replace(pi,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=pi.test(o)?o.replace(pi,r):o+" "+r)}}),ht(function(){ht.support.reliableMarginRight||(ht.cssHooks.marginRight={get:function(e,t){return t?ht.swap(e,{display:"inline-block"},fi,[e,"marginRight"]):void 0}}),!ht.support.pixelPosition&&ht.fn.position&&ht.each(["top","left"],function(e,t){ht.cssHooks[t]={get:function(e,i){return i?(i=fi(e,t),yi.test(i)?ht(e).position()[t]+"px":i):void 0}}})}),ht.expr&&ht.expr.filters&&(ht.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!ht.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||ht.css(e,"display"))},ht.expr.filters.visible=function(e){return!ht.expr.filters.hidden(e)}),ht.each({margin:"",padding:"",border:"Width"},function(e,t){ht.cssHooks[e+t]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];4>n;n++)r[e+wi[n]+t]=o[n]||o[n-2]||o[0];return r}},vi.test(e)||(ht.cssHooks[e+t].set=w)});var Hi=/%20/g,Mi=/\[\]$/,Si=/\r?\n/g,Ci=/^(?:submit|button|image|reset|file)$/i,Ai=/^(?:input|select|textarea|keygen)/i;ht.fn.extend({serialize:function(){return ht.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ht.prop(this,"elements");return e?ht.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ht(this).is(":disabled")&&Ai.test(this.nodeName)&&!Ci.test(e)&&(this.checked||!ii.test(e))}).map(function(e,t){var i=ht(this).val();return null==i?null:ht.isArray(i)?ht.map(i,function(e){return{name:t.name,value:e.replace(Si,"\r\n")}}):{name:t.name,value:i.replace(Si,"\r\n")}}).get()}}),ht.param=function(e,i){var n,r=[],o=function(e,t){t=ht.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=ht.ajaxSettings&&ht.ajaxSettings.traditional),ht.isArray(e)||e.jquery&&!ht.isPlainObject(e))ht.each(e,function(){o(this.name,this.value)});else for(n in e)C(n,e[n],i,o);return r.join("&").replace(Hi,"+")},ht.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ht.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),ht.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var Di,ki,Pi=ht.now(),Li=/\?/,Ni=/#.*$/,zi=/([?&])_=[^&]*/,Fi=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ii=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Oi=/^(?:GET|HEAD)$/,Ui=/^\/\//,Vi=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Bi=ht.fn.load,Wi={},ji={},Gi="*/".concat("*");try{ki=K.href}catch(qi){ki=Y.createElement("a"),ki.href="",ki=ki.href}Di=Vi.exec(ki.toLowerCase())||[],ht.fn.load=function(e,i,n){if("string"!=typeof e&&Bi)return Bi.apply(this,arguments);var r,o,a,s=this,l=e.indexOf(" ");return l>=0&&(r=e.slice(l,e.length),e=e.slice(0,l)),ht.isFunction(i)?(n=i,i=t):i&&"object"==typeof i&&(a="POST"),s.length>0&&ht.ajax({url:e,type:a,dataType:"html",data:i}).done(function(e){o=arguments,s.html(r?ht("<div>").append(ht.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},ht.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ht.fn[t]=function(e){return this.on(t,e)}}),ht.each(["get","post"],function(e,i){ht[i]=function(e,n,r,o){return ht.isFunction(n)&&(o=o||r,r=n,n=t),ht.ajax({url:e,type:i,dataType:o,data:n,success:r})}}),ht.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ki,type:"GET",isLocal:Ii.test(Di[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Gi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":ht.parseJSON,"text xml":ht.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?k(k(e,ht.ajaxSettings),t):k(ht.ajaxSettings,e)},ajaxPrefilter:A(Wi),ajaxTransport:A(ji),ajax:function(e,i){function n(e,i,n,r){var o,u,E,y,x,_=i;2!==T&&(T=2,l&&clearTimeout(l),c=t,s=r||"",b.readyState=e>0?4:0,n&&(y=P(f,b,n)),e>=200&&300>e||304===e?(f.ifModified&&(x=b.getResponseHeader("Last-Modified"),x&&(ht.lastModified[a]=x),x=b.getResponseHeader("etag"),x&&(ht.etag[a]=x)),204===e?(o=!0,_="nocontent"):304===e?(o=!0,_="notmodified"):(o=L(f,y),_=o.state,u=o.data,E=o.error,o=!E)):(E=_,(e||!_)&&(_="error",0>e&&(e=0))),b.status=e,b.statusText=(i||_)+"",o?m.resolveWith(p,[u,_,b]):m.rejectWith(p,[b,_,E]),b.statusCode(v),v=t,h&&d.trigger(o?"ajaxSuccess":"ajaxError",[b,f,o?u:E]),g.fireWith(p,[b,_]),h&&(d.trigger("ajaxComplete",[b,f]),--ht.active||ht.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var r,o,a,s,l,h,c,u,f=ht.ajaxSetup({},i),p=f.context||f,d=f.context&&(p.nodeType||p.jquery)?ht(p):ht.event,m=ht.Deferred(),g=ht.Callbacks("once memory"),v=f.statusCode||{},E={},y={},T=0,x="canceled",b={readyState:0,getResponseHeader:function(e){var t;if(2===T){if(!u)for(u={};t=Fi.exec(s);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===T?s:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return T||(e=y[i]=y[i]||e,E[e]=t),this},overrideMimeType:function(e){return T||(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>T)for(t in e)v[t]=[v[t],e[t]];else b.always(e[b.status]);return this},abort:function(e){var t=e||x;return c&&c.abort(t),n(0,t),this}};if(m.promise(b).complete=g.add,b.success=b.done,b.error=b.fail,f.url=((e||f.url||ki)+"").replace(Ni,"").replace(Ui,Di[1]+"//"),f.type=i.method||i.type||f.method||f.type,f.dataTypes=ht.trim(f.dataType||"*").toLowerCase().match(ut)||[""],null==f.crossDomain&&(r=Vi.exec(f.url.toLowerCase()),f.crossDomain=!(!r||r[1]===Di[1]&&r[2]===Di[2]&&(r[3]||("http:"===r[1]?80:443))==(Di[3]||("http:"===Di[1]?80:443)))),f.data&&f.processData&&"string"!=typeof f.data&&(f.data=ht.param(f.data,f.traditional)),D(Wi,f,i,b),2===T)return b;h=f.global,h&&0===ht.active++&&ht.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Oi.test(f.type),a=f.url,f.hasContent||(f.data&&(a=f.url+=(Li.test(a)?"&":"?")+f.data,delete f.data),f.cache===!1&&(f.url=zi.test(a)?a.replace(zi,"$1_="+Pi++):a+(Li.test(a)?"&":"?")+"_="+Pi++)),f.ifModified&&(ht.lastModified[a]&&b.setRequestHeader("If-Modified-Since",ht.lastModified[a]),ht.etag[a]&&b.setRequestHeader("If-None-Match",ht.etag[a])),(f.data&&f.hasContent&&f.contentType!==!1||i.contentType)&&b.setRequestHeader("Content-Type",f.contentType),b.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Gi+"; q=0.01":""):f.accepts["*"]);for(o in f.headers)b.setRequestHeader(o,f.headers[o]);if(f.beforeSend&&(f.beforeSend.call(p,b,f)===!1||2===T))return b.abort();x="abort";for(o in{success:1,error:1,complete:1})b[o](f[o]);if(c=D(ji,f,i,b)){b.readyState=1,h&&d.trigger("ajaxSend",[b,f]),f.async&&f.timeout>0&&(l=setTimeout(function(){b.abort("timeout")},f.timeout));try{T=1,c.send(E,n)}catch(_){if(!(2>T))throw _;n(-1,_)}}else n(-1,"No Transport");return b},getScript:function(e,i){return ht.get(e,t,i,"script")},getJSON:function(e,t,i){return ht.get(e,t,i,"json")}}),ht.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ht.globalEval(e),e}}}),ht.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ht.ajaxTransport("script",function(e){if(e.crossDomain){var i,n=Y.head||ht("head")[0]||Y.documentElement;return{send:function(t,r){i=Y.createElement("script"),i.async=!0,e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,t){(t||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||r(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(t,!0)}}}});var Xi=[],Yi=/(=)\?(?=&|$)|\?\?/;ht.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xi.pop()||ht.expando+"_"+Pi++;return this[e]=!0,e}}),ht.ajaxPrefilter("json jsonp",function(i,n,r){var o,a,s,l=i.jsonp!==!1&&(Yi.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Yi.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(o=i.jsonpCallback=ht.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(Yi,"$1"+o):i.jsonp!==!1&&(i.url+=(Li.test(i.url)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return s||ht.error(o+" was not called"),s[0]},i.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},r.always(function(){e[o]=a,i[o]&&(i.jsonpCallback=n.jsonpCallback,Xi.push(o)),s&&ht.isFunction(a)&&a(s[0]),s=a=t}),"script"):void 0});var Ki,Qi,$i=0,Zi=e.ActiveXObject&&function(){var e;for(e in Ki)Ki[e](t,!0)};ht.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&N()||z()}:N,Qi=ht.ajaxSettings.xhr(),ht.support.cors=!!Qi&&"withCredentials"in Qi,Qi=ht.support.ajax=!!Qi,Qi&&ht.ajaxTransport(function(i){if(!i.crossDomain||ht.support.cors){var n;return{send:function(r,o){var a,s,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(s in i.xhrFields)l[s]=i.xhrFields[s];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");try{for(s in r)l.setRequestHeader(s,r[s])}catch(h){}l.send(i.hasContent&&i.data||null),n=function(e,r){var s,h,c,u;try{if(n&&(r||4===l.readyState))if(n=t,a&&(l.onreadystatechange=ht.noop,Zi&&delete Ki[a]),r)4!==l.readyState&&l.abort();else{u={},s=l.status,h=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(u.text=l.responseText);try{c=l.statusText}catch(f){c=""}s||!i.isLocal||i.crossDomain?1223===s&&(s=204):s=u.text?200:404}}catch(p){r||o(-1,p)}u&&o(s,c,u,h)},i.async?4===l.readyState?setTimeout(n):(a=++$i,Zi&&(Ki||(Ki={},ht(e).unload(Zi)),Ki[a]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(t,!0)}}}});var Ji,en,tn=/^(?:toggle|show|hide)$/,nn=new RegExp("^(?:([+-])=|)("+ct+")([a-z%]*)$","i"),rn=/queueHooks$/,on=[V],an={"*":[function(e,t){var i,n,r=this.createTween(e,t),o=nn.exec(t),a=r.cur(),s=+a||0,l=1,h=20;if(o){if(i=+o[2],n=o[3]||(ht.cssNumber[e]?"":"px"),"px"!==n&&s){s=ht.css(r.elem,e,!0)||i||1;do l=l||".5",s/=l,ht.style(r.elem,e,s+n);while(l!==(l=r.cur()/a)&&1!==l&&--h)}r.unit=n,r.start=s,r.end=o[1]?s+(o[1]+1)*i:i}return r}]};ht.Animation=ht.extend(O,{tweener:function(e,t){ht.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,r=e.length;r>n;n++)i=e[n],an[i]=an[i]||[],an[i].unshift(t)},prefilter:function(e,t){t?on.unshift(e):on.push(e)}}),ht.Tween=B,B.prototype={constructor:B,init:function(e,t,i,n,r,o){this.elem=e,this.prop=i,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(ht.cssNumber[i]?"":"px")},cur:function(){var e=B.propHooks[this.prop];return e&&e.get?e.get(this):B.propHooks._default.get(this)},run:function(e){var t,i=B.propHooks[this.prop];return this.pos=t=this.options.duration?ht.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):B.propHooks._default.set(this),this}},B.prototype.init.prototype=B.prototype,B.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ht.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ht.fx.step[e.prop]?ht.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ht.cssProps[e.prop]]||ht.cssHooks[e.prop])?ht.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},B.propHooks.scrollTop=B.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ht.each(["toggle","show","hide"],function(e,t){var i=ht.fn[t];ht.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(W(t,!0),e,n,r)}}),ht.fn.extend({fadeTo:function(e,t,i,n){return this.filter(b).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var r=ht.isEmptyObject(e),o=ht.speed(t,i,n),a=function(){var t=O(this,ht.extend({},e),o);a.finish=function(){t.stop(!0)},(r||ht._data(this,"finish"))&&t.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,i,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=ht.timers,a=ht._data(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&rn.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));(t||!n)&&ht.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=ht._data(this),n=i[e+"queue"],r=i[e+"queueHooks"],o=ht.timers,a=n?n.length:0;for(i.finish=!0,ht.queue(this,e,[]),r&&r.cur&&r.cur.finish&&r.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),ht.each({slideDown:W("show"),slideUp:W("hide"),slideToggle:W("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ht.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),ht.speed=function(e,t,i){var n=e&&"object"==typeof e?ht.extend({},e):{complete:i||!i&&t||ht.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ht.isFunction(t)&&t};return n.duration=ht.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in ht.fx.speeds?ht.fx.speeds[n.duration]:ht.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){ht.isFunction(n.old)&&n.old.call(this),n.queue&&ht.dequeue(this,n.queue)},n},ht.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ht.timers=[],ht.fx=B.prototype.init,ht.fx.tick=function(){var e,i=ht.timers,n=0;for(Ji=ht.now();n<i.length;n++)e=i[n],e()||i[n]!==e||i.splice(n--,1);i.length||ht.fx.stop(),Ji=t},ht.fx.timer=function(e){e()&&ht.timers.push(e)&&ht.fx.start()},ht.fx.interval=13,ht.fx.start=function(){en||(en=setInterval(ht.fx.tick,ht.fx.interval))},ht.fx.stop=function(){clearInterval(en),en=null},ht.fx.speeds={slow:600,fast:200,_default:400},ht.fx.step={},ht.expr&&ht.expr.filters&&(ht.expr.filters.animated=function(e){return ht.grep(ht.timers,function(t){return e===t.elem}).length}),ht.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){ht.offset.setOffset(this,e,t)});var i,n,r={top:0,left:0},o=this[0],a=o&&o.ownerDocument;if(a)return i=a.documentElement,ht.contains(i,o)?(typeof o.getBoundingClientRect!==X&&(r=o.getBoundingClientRect()),n=j(a),{top:r.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:r.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):r},ht.offset={setOffset:function(e,t,i){var n=ht.css(e,"position");"static"===n&&(e.style.position="relative");var r=ht(e),o=r.offset(),a=ht.css(e,"top"),s=ht.css(e,"left"),l=("absolute"===n||"fixed"===n)&&ht.inArray("auto",[a,s])>-1,h={},c={},u,f;l?(c=r.position(),u=c.top,f=c.left):(u=parseFloat(a)||0,f=parseFloat(s)||0),ht.isFunction(t)&&(t=t.call(e,i,o)),null!=t.top&&(h.top=t.top-o.top+u),null!=t.left&&(h.left=t.left-o.left+f),"using"in t?t.using.call(e,h):r.css(h)}},ht.fn.extend({position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===ht.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ht.nodeName(e[0],"html")||(i=e.offset()),i.top+=ht.css(e[0],"borderTopWidth",!0),i.left+=ht.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-ht.css(n,"marginTop",!0),left:t.left-i.left-ht.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Y.documentElement;e&&!ht.nodeName(e,"html")&&"static"===ht.css(e,"position");)e=e.offsetParent;return e||Y.documentElement})}}),ht.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n=/Y/.test(i);ht.fn[e]=function(r){return ht.access(this,function(e,r,o){var a=j(e);return o===t?a?i in a?a[i]:a.document.documentElement[r]:e[r]:void(a?a.scrollTo(n?ht(a).scrollLeft():o,n?o:ht(a).scrollTop()):e[r]=o)},e,r,arguments.length,null)}}),ht.each({Height:"height",Width:"width"},function(e,i){ht.each({padding:"inner"+e,content:i,"":"outer"+e},function(n,r){ht.fn[r]=function(r,o){var a=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||o===!0?"margin":"border");return ht.access(this,function(i,n,r){var o;return ht.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+e],o["scroll"+e],i.body["offset"+e],o["offset"+e],o["client"+e])):r===t?ht.css(i,n,s):ht.style(i,n,r,s)},i,a?r:t,a,null)}})}),e.jQuery=e.$=ht,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return ht})}(window),function($,e){function t(e,t){var n,r,o,a=e.nodeName.toLowerCase();return"area"===a?(n=e.parentNode,r=n.name,e.href&&r&&"map"===n.nodeName.toLowerCase()?(o=$("img[usemap=#"+r+"]")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||t:t)&&i(e)}function i(e){return $.expr.filters.visible(e)&&!$(e).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length}var n=0,r=/^ui-id-\d+$/;$.ui=$.ui||{},$.extend($.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),$.fn.extend({focus:function(e){return function(t,i){return"number"==typeof t?this.each(function(){var e=this;setTimeout(function(){$(e).focus(),i&&i.call(e)
},t)}):e.apply(this,arguments)}}($.fn.focus),scrollParent:function(){var e;return e=$.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test($.css(this,"position"))&&/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?$(document):e},zIndex:function(t){if(t!==e)return this.css("zIndex",t);if(this.length)for(var i=$(this[0]),n,r;i.length&&i[0]!==document;){if(n=i.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(r=parseInt(i.css("zIndex"),10),!isNaN(r)&&0!==r))return r;i=i.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&$(this).removeAttr("id")})}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(e){return function(t){return!!$.data(t,e)}}):function(e,t,i){return!!$.data(e,i[3])},focusable:function(e){return t(e,!isNaN($.attr(e,"tabindex")))},tabbable:function(e){var i=$.attr(e,"tabindex"),n=isNaN(i);return(n||i>=0)&&t(e,!n)}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],function(t,i){function n(e,t,i,n){return $.each(r,function(){t-=parseFloat($.css(e,"padding"+this))||0,i&&(t-=parseFloat($.css(e,"border"+this+"Width"))||0),n&&(t-=parseFloat($.css(e,"margin"+this))||0)}),t}var r="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};$.fn["inner"+i]=function(t){return t===e?a["inner"+i].call(this):this.each(function(){$(this).css(o,n(this,t)+"px")})},$.fn["outer"+i]=function(e,t){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){$(this).css(o,n(this,e,!0,t)+"px")})}}),$.fn.addBack||($.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),$("<a>").data("a-b","a").removeData("a-b").data("a-b")&&($.fn.removeData=function(e){return function(t){return arguments.length?e.call(this,$.camelCase(t)):e.call(this)}}($.fn.removeData)),$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),$.support.selectstart="onselectstart"in document.createElement("div"),$.fn.extend({disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),$.extend($.ui,{plugin:{add:function(e,t,i){var n,r=$.ui[e].prototype;for(n in i)r.plugins[n]=r.plugins[n]||[],r.plugins[n].push([t,i[n]])},call:function(e,t,i){var n,r=e.plugins[t];if(r&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(n=0;n<r.length;n++)e.options[r[n][0]]&&r[n][1].apply(e.element,i)}},hasScroll:function(e,t){if("hidden"===$(e).css("overflow"))return!1;var i=t&&"left"===t?"scrollLeft":"scrollTop",n=!1;return e[i]>0?!0:(e[i]=1,n=e[i]>0,e[i]=0,n)}})}(jQuery),function($,e){var t=0,i=Array.prototype.slice,n=$.cleanData;$.cleanData=function(e){for(var t=0,i;null!=(i=e[t]);t++)try{$(i).triggerHandler("remove")}catch(r){}n(e)},$.widget=function(e,t,i){var n,r,o,a,s={},l=e.split(".")[0];e=e.split(".")[1],n=l+"-"+e,i||(i=t,t=$.Widget),$.expr[":"][n.toLowerCase()]=function(e){return!!$.data(e,n)},$[l]=$[l]||{},r=$[l][e],o=$[l][e]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},$.extend(o,r,{version:i.version,_proto:$.extend({},i),_childConstructors:[]}),a=new t,a.options=$.widget.extend({},a.options),$.each(i,function(e,i){return $.isFunction(i)?void(s[e]=function(){var n=function(){return t.prototype[e].apply(this,arguments)},r=function(i){return t.prototype[e].apply(this,i)};return function(){var e=this._super,t=this._superApply,o;return this._super=n,this._superApply=r,o=i.apply(this,arguments),this._super=e,this._superApply=t,o}}()):void(s[e]=i)}),o.prototype=$.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix:e},s,{constructor:o,namespace:l,widgetName:e,widgetFullName:n}),r?($.each(r._childConstructors,function(e,t){var i=t.prototype;$.widget(i.namespace+"."+i.widgetName,o,t._proto)}),delete r._childConstructors):t._childConstructors.push(o),$.widget.bridge(e,o)},$.widget.extend=function(t){for(var n=i.call(arguments,1),r=0,o=n.length,a,s;o>r;r++)for(a in n[r])s=n[r][a],n[r].hasOwnProperty(a)&&s!==e&&(t[a]=$.isPlainObject(s)?$.isPlainObject(t[a])?$.widget.extend({},t[a],s):$.widget.extend({},s):s);return t},$.widget.bridge=function(t,n){var r=n.prototype.widgetFullName||t;$.fn[t]=function(o){var a="string"==typeof o,s=i.call(arguments,1),l=this;return o=!a&&s.length?$.widget.extend.apply(null,[o].concat(s)):o,this.each(a?function(){var i,n=$.data(this,r);return n?$.isFunction(n[o])&&"_"!==o.charAt(0)?(i=n[o].apply(n,s),i!==n&&i!==e?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):$.error("no such method '"+o+"' for "+t+" widget instance"):$.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}:function(){var e=$.data(this,r);e?e.option(o||{})._init():$.data(this,r,new n(o,this))}),l}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,i){i=$(i||this.defaultElement||this)[0],this.element=$(i),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=$.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=$(),this.hoverable=$(),this.focusable=$(),i!==this&&($.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=$(i.style?i.ownerDocument:i.document||i),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(t,i){var n=t,r,o,a;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof t)if(n={},r=t.split("."),t=r.shift(),r.length){for(o=n[t]=$.widget.extend({},this.options[t]),a=0;a<r.length-1;a++)o[r[a]]=o[r[a]]||{},o=o[r[a]];if(t=r.pop(),i===e)return o[t]===e?null:o[t];o[t]=i}else{if(i===e)return this.options[t]===e?null:this.options[t];n[t]=i}return this._setOptions(n),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,t,i){var n,r=this;"boolean"!=typeof e&&(i=t,t=e,e=!1),i?(t=n=$(t),this.bindings=this.bindings.add(t)):(i=t,t=this.element,n=this.widget()),$.each(i,function(i,o){function a(){return e||r.options.disabled!==!0&&!$(this).hasClass("ui-state-disabled")?("string"==typeof o?r[o]:o).apply(r,arguments):void 0}"string"!=typeof o&&(a.guid=o.guid=o.guid||a.guid||$.guid++);var s=i.match(/^(\w+)\s*(.*)$/),l=s[1]+r.eventNamespace,h=s[2];h?n.delegate(h,l,a):t.bind(l,a)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){$(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){$(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){$(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){$(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,i){var n,r,o=this.options[e];if(i=i||{},t=$.Event(t),t.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],r=t.originalEvent)for(n in r)n in t||(t[n]=r[n]);return this.element.trigger(t,i),!($.isFunction(o)&&o.apply(this.element[0],[t].concat(i))===!1||t.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(e,t){$.Widget.prototype["_"+e]=function(i,n,r){"string"==typeof n&&(n={effect:n});var o,a=n?n===!0||"number"==typeof n?t:n.effect||t:e;n=n||{},"number"==typeof n&&(n={duration:n}),o=!$.isEmptyObject(n),n.complete=r,n.delay&&i.delay(n.delay),o&&$.effects&&$.effects.effect[a]?i[e](n):a!==e&&i[a]?i[a](n.duration,n.easing,r):i.queue(function(t){$(this)[e](),r&&r.call(i[0]),t()})}})}(jQuery),function($,e){var t=!1;$(document).mouseup(function(){t=!1}),$.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(t){return!0===$.data(t.target,e.widgetName+".preventClickEvent")?($.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!t){this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,n=1===e.which,r="string"==typeof this.options.cancel&&e.target.nodeName?$(e.target).closest(this.options.cancel).length:!1;return n&&!r&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===$.data(e.target,this.widgetName+".preventClickEvent")&&$.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(e){return $.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button?this._mouseUp(e):this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return $(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&$.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function($,e){$.widget("ui.draggable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(e){var t=this.options;return this.helper||t.disabled||$(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?($(t.iframeFix===!0?"iframe":t.iframeFix).each(function(){$("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css($(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var t=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,$.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,t.cursorAt&&this._adjustOffsetFromHelper(t.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!t.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,t){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!t){var i=this._uiHash();if(this._trigger("drag",e,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),$.ui.ddmanager&&$.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var t=this,i=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(i=$.ui.ddmanager.drop(this,e)),this.dropped&&(i=this.dropped,this.dropped=!1),"original"!==this.options.helper||$.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){t._trigger("stop",e)!==!1&&t._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1):!1},_mouseUp:function(e){return $("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,e),$.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!$(e.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(e){var t=this.options,i=$.isFunction(t.helper)?$(t.helper.apply(this.element[0],[e])):"clone"===t.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===t.appendTo?this.element[0].parentNode:t.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),$.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options;return n.containment?"window"===n.containment?void(this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),t=$(n.containment),i=t[0],void(i&&(e="hidden"!==t.css("overflow"),this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(e?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=t))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:n.scrollTop(),left:n.scrollLeft()}),{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*i}},_generatePosition:function(e){var t,i,n,r,o=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=e.pageX,l=e.pageY;return this.offset.scroll||(this.offset.scroll={top:a.scrollTop(),left:a.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(i=this.relative_container.offset(),t=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):t=this.containment,e.pageX-this.offset.click.left<t[0]&&(s=t[0]+this.offset.click.left),e.pageY-this.offset.click.top<t[1]&&(l=t[1]+this.offset.click.top),e.pageX-this.offset.click.left>t[2]&&(s=t[2]+this.offset.click.left),e.pageY-this.offset.click.top>t[3]&&(l=t[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=t?n-this.offset.click.top>=t[1]||n-this.offset.click.top>t[3]?n:n-this.offset.click.top>=t[1]?n-o.grid[1]:n+o.grid[1]:n,r=o.grid[0]?this.originalPageX+Math.round((s-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,s=t?r-this.offset.click.left>=t[0]||r-this.offset.click.left>t[2]?r:r-this.offset.click.left>=t[0]?r-o.grid[0]:r+o.grid[0]:r)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,t,i){return i=i||this._uiHash(),$.ui.plugin.call(this,e,[t,i]),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),$.Widget.prototype._trigger.call(this,e,t,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(e,t){var i=$(this).data("ui-draggable"),n=i.options,r=$.extend({},t,{item:i.element});i.sortables=[],$(n.connectToSortable).each(function(){var t=$.data(this,"ui-sortable");t&&!t.options.disabled&&(i.sortables.push({instance:t,shouldRevert:t.options.revert}),t.refreshPositions(),t._trigger("activate",e,r))})},stop:function(e,t){var i=$(this).data("ui-draggable"),n=$.extend({},t,{item:i.element});$.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,n))})},drag:function(e,t){var i=$(this).data("ui-draggable"),n=this;$.each(i.sortables,function(){var r=!1,o=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(r=!0,$.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&$.contains(o.instance.element[0],this.instance.element[0])&&(r=!1),r})),r?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=$(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return t.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",e),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",e),i.dropped=!1)})}}),$.ui.plugin.add("draggable","cursor",{start:function(){var e=$("body"),t=$(this).data("ui-draggable").options;e.css("cursor")&&(t._cursor=e.css("cursor")),e.css("cursor",t.cursor)},stop:function(){var e=$(this).data("ui-draggable").options;e._cursor&&$("body").css("cursor",e._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(e,t){var i=$(t.helper),n=$(this).data("ui-draggable").options;i.css("opacity")&&(n._opacity=i.css("opacity")),i.css("opacity",n.opacity)},stop:function(e,t){var i=$(this).data("ui-draggable").options;i._opacity&&$(t.helper).css("opacity",i._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(){var e=$(this).data("ui-draggable");e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName&&(e.overflowOffset=e.scrollParent.offset())},drag:function(e){var t=$(this).data("ui-draggable"),i=t.options,n=!1;t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(t.overflowOffset.top+t.scrollParent[0].offsetHeight-e.pageY<i.scrollSensitivity?t.scrollParent[0].scrollTop=n=t.scrollParent[0].scrollTop+i.scrollSpeed:e.pageY-t.overflowOffset.top<i.scrollSensitivity&&(t.scrollParent[0].scrollTop=n=t.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(t.overflowOffset.left+t.scrollParent[0].offsetWidth-e.pageX<i.scrollSensitivity?t.scrollParent[0].scrollLeft=n=t.scrollParent[0].scrollLeft+i.scrollSpeed:e.pageX-t.overflowOffset.left<i.scrollSensitivity&&(t.scrollParent[0].scrollLeft=n=t.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(e.pageY-$(document).scrollTop()<i.scrollSensitivity?n=$(document).scrollTop($(document).scrollTop()-i.scrollSpeed):$(window).height()-(e.pageY-$(document).scrollTop())<i.scrollSensitivity&&(n=$(document).scrollTop($(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(e.pageX-$(document).scrollLeft()<i.scrollSensitivity?n=$(document).scrollLeft($(document).scrollLeft()-i.scrollSpeed):$(window).width()-(e.pageX-$(document).scrollLeft())<i.scrollSensitivity&&(n=$(document).scrollLeft($(document).scrollLeft()+i.scrollSpeed)))),n!==!1&&$.ui.ddmanager&&!i.dropBehaviour&&$.ui.ddmanager.prepareOffsets(t,e)}}),$.ui.plugin.add("draggable","snap",{start:function(){var e=$(this).data("ui-draggable"),t=e.options;e.snapElements=[],$(t.snap.constructor!==String?t.snap.items||":data(ui-draggable)":t.snap).each(function(){var t=$(this),i=t.offset();this!==e.element[0]&&e.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(e,t){var i,n,r,o,a,s,l,h,c,u,f=$(this).data("ui-draggable"),p=f.options,d=p.snapTolerance,m=t.offset.left,g=m+f.helperProportions.width,v=t.offset.top,E=v+f.helperProportions.height;for(c=f.snapElements.length-1;c>=0;c--)a=f.snapElements[c].left,s=a+f.snapElements[c].width,l=f.snapElements[c].top,h=l+f.snapElements[c].height,a-d>g||m>s+d||l-d>E||v>h+d||!$.contains(f.snapElements[c].item.ownerDocument,f.snapElements[c].item)?(f.snapElements[c].snapping&&f.options.snap.release&&f.options.snap.release.call(f.element,e,$.extend(f._uiHash(),{snapItem:f.snapElements[c].item})),f.snapElements[c].snapping=!1):("inner"!==p.snapMode&&(i=Math.abs(l-E)<=d,n=Math.abs(h-v)<=d,r=Math.abs(a-g)<=d,o=Math.abs(s-m)<=d,i&&(t.position.top=f._convertPositionTo("relative",{top:l-f.helperProportions.height,left:0}).top-f.margins.top),n&&(t.position.top=f._convertPositionTo("relative",{top:h,left:0}).top-f.margins.top),r&&(t.position.left=f._convertPositionTo("relative",{top:0,left:a-f.helperProportions.width}).left-f.margins.left),o&&(t.position.left=f._convertPositionTo("relative",{top:0,left:s}).left-f.margins.left)),u=i||n||r||o,"outer"!==p.snapMode&&(i=Math.abs(l-v)<=d,n=Math.abs(h-E)<=d,r=Math.abs(a-m)<=d,o=Math.abs(s-g)<=d,i&&(t.position.top=f._convertPositionTo("relative",{top:l,left:0}).top-f.margins.top),n&&(t.position.top=f._convertPositionTo("relative",{top:h-f.helperProportions.height,left:0}).top-f.margins.top),r&&(t.position.left=f._convertPositionTo("relative",{top:0,left:a}).left-f.margins.left),o&&(t.position.left=f._convertPositionTo("relative",{top:0,left:s-f.helperProportions.width}).left-f.margins.left)),!f.snapElements[c].snapping&&(i||n||r||o||u)&&f.options.snap.snap&&f.options.snap.snap.call(f.element,e,$.extend(f._uiHash(),{snapItem:f.snapElements[c].item})),f.snapElements[c].snapping=i||n||r||o||u)}}),$.ui.plugin.add("draggable","stack",{start:function(){var e,t=this.data("ui-draggable").options,i=$.makeArray($(t.stack)).sort(function(e,t){return(parseInt($(e).css("zIndex"),10)||0)-(parseInt($(t).css("zIndex"),10)||0)});i.length&&(e=parseInt($(i[0]).css("zIndex"),10)||0,$(i).each(function(t){$(this).css("zIndex",e+t)}),this.css("zIndex",e+i.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(e,t){var i=$(t.helper),n=$(this).data("ui-draggable").options;i.css("zIndex")&&(n._zIndex=i.css("zIndex")),i.css("zIndex",n.zIndex)},stop:function(e,t){var i=$(this).data("ui-draggable").options;i._zIndex&&$(t.helper).css("zIndex",i._zIndex)}})}(jQuery),function($,e){function t(e,t,i){return e>t&&t+i>e}$.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e=this.options,t=e.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(t)?t:function(e){return e.is(t)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},$.ui.ddmanager.droppables[e.scope]=$.ui.ddmanager.droppables[e.scope]||[],$.ui.ddmanager.droppables[e.scope].push(this),e.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var e=0,t=$.ui.ddmanager.droppables[this.options.scope];e<t.length;e++)t[e]===this&&t.splice(e,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,t){"accept"===e&&(this.accept=$.isFunction(t)?t:function(e){return e.is(t)}),$.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var t=$.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=$.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),t&&this._trigger("deactivate",e,this.ui(t))
},_over:function(e){var t=$.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=$.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(t)))},_drop:function(e,t){var i=t||$.ui.ddmanager.current,n=!1;return i&&(i.currentItem||i.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=$.data(this,"ui-droppable");return e.options.greedy&&!e.options.disabled&&e.options.scope===i.options.scope&&e.accept.call(e.element[0],i.currentItem||i.element)&&$.ui.intersect(i,$.extend(e,{offset:e.element.offset()}),e.options.tolerance)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(i)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),$.ui.intersect=function(e,i,n){if(!i.offset)return!1;var r,o,a=(e.positionAbs||e.position.absolute).left,s=a+e.helperProportions.width,l=(e.positionAbs||e.position.absolute).top,h=l+e.helperProportions.height,c=i.offset.left,u=c+i.proportions.width,f=i.offset.top,p=f+i.proportions.height;switch(n){case"fit":return a>=c&&u>=s&&l>=f&&p>=h;case"intersect":return c<a+e.helperProportions.width/2&&s-e.helperProportions.width/2<u&&f<l+e.helperProportions.height/2&&h-e.helperProportions.height/2<p;case"pointer":return r=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,o=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,t(o,f,i.proportions.height)&&t(r,c,i.proportions.width);case"touch":return(l>=f&&p>=l||h>=f&&p>=h||f>l&&h>p)&&(a>=c&&u>=a||s>=c&&u>=s||c>a&&s>u);default:return!1}},$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,t){var i,n,r=$.ui.ddmanager.droppables[e.options.scope]||[],o=t?t.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(i=0;i<r.length;i++)if(!(r[i].options.disabled||e&&!r[i].accept.call(r[i].element[0],e.currentItem||e.element))){for(n=0;n<a.length;n++)if(a[n]===r[i].element[0]){r[i].proportions.height=0;continue e}r[i].visible="none"!==r[i].element.css("display"),r[i].visible&&("mousedown"===o&&r[i]._activate.call(r[i],t),r[i].offset=r[i].element.offset(),r[i].proportions={width:r[i].element[0].offsetWidth,height:r[i].element[0].offsetHeight})}},drop:function(e,t){var i=!1;return $.each(($.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&$.ui.intersect(e,this,this.options.tolerance)&&(i=this._drop.call(this,t)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t)))}),i},dragStart:function(e,t){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||$.ui.ddmanager.prepareOffsets(e,t)})},drag:function(e,t){e.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(e,t),$.each($.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var i,n,r,o=$.ui.intersect(e,this,this.options.tolerance),a=!o&&this.isover?"isout":o&&!this.isover?"isover":null;a&&(this.options.greedy&&(n=this.options.scope,r=this.element.parents(":data(ui-droppable)").filter(function(){return $.data(this,"ui-droppable").options.scope===n}),r.length&&(i=$.data(r[0],"ui-droppable"),i.greedyChild="isover"===a)),i&&"isover"===a&&(i.isover=!1,i.isout=!0,i._out.call(i,t)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,t),i&&"isout"===a&&(i.isout=!1,i.isover=!0,i._over.call(i,t)))}})},dragStop:function(e,t){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||$.ui.ddmanager.prepareOffsets(e,t)}}}(jQuery),function($,e){function t(e){return parseInt(e,10)||0}function i(e){return!isNaN(parseInt(e,10))}$.widget("ui.resizable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var e,t,i,n,r,o=this,a=this.options;if(this.element.addClass("ui-resizable"),$.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||($(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},t=0;t<e.length;t++)i=$.trim(e[t]),r="ui-resizable-"+i,n=$("<div class='ui-resizable-handle "+r+"'></div>"),n.css({zIndex:a.zIndex}),"se"===i&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[i]=".ui-resizable-"+i,this.element.append(n);this._renderAxis=function(e){var t,i,n,r;e=e||this.element;for(t in this.handles)this.handles[t].constructor===String&&(this.handles[t]=$(this.handles[t],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(i=$(this.handles[t],this.element),r=/sw|ne|nw|se|n|s/.test(t)?i.outerHeight():i.outerWidth(),n=["padding",/ne|nw|n/.test(t)?"Top":/se|sw|s/.test(t)?"Bottom":/^e$/.test(t)?"Right":"Left"].join(""),e.css(n,r),this._proportionallyResize()),$(this.handles[t]).length},this._renderAxis(this.element),this._handles=$(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),a.autoHide&&(this._handles.hide(),$(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||($(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){a.disabled||o.resizing||($(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,t=function(e){$(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(t(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(e){var t,i,n=!1;for(t in this.handles)i=$(this.handles[t])[0],(i===e.target||$.contains(i,e.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(e){var i,n,r,o=this.options,a=this.element.position(),s=this.element;return this.resizing=!0,/absolute/.test(s.css("position"))?s.css({position:"absolute",top:s.css("top"),left:s.css("left")}):s.is(".ui-draggable")&&s.css({position:"absolute",top:a.top,left:a.left}),this._renderProxy(),i=t(this.helper.css("left")),n=t(this.helper.css("top")),o.containment&&(i+=$(o.containment).scrollLeft()||0,n+=$(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:n},this.size=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalPosition={left:i,top:n},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=$(".ui-resizable-"+this.axis).css("cursor"),$("body").css("cursor","auto"===r?this.axis+"-resize":r),s.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var t,i=this.helper,n={},r=this.originalMousePosition,o=this.axis,a=this.position.top,s=this.position.left,l=this.size.width,h=this.size.height,c=e.pageX-r.left||0,u=e.pageY-r.top||0,f=this._change[o];return f?(t=f.apply(this,[e,c,u]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(t=this._updateRatio(t,e)),t=this._respectSize(t,e),this._updateCache(t),this._propagate("resize",e),this.position.top!==a&&(n.top=this.position.top+"px"),this.position.left!==s&&(n.left=this.position.left+"px"),this.size.width!==l&&(n.width=this.size.width+"px"),this.size.height!==h&&(n.height=this.size.height+"px"),i.css(n),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),$.isEmptyObject(n)||this._trigger("resize",e,this.ui()),!1):!1},_mouseStop:function(e){this.resizing=!1;var t,i,n,r,o,a,s,l=this.options,h=this;return this._helper&&(t=this._proportionallyResizeElements,i=t.length&&/textarea/i.test(t[0].nodeName),n=i&&$.ui.hasScroll(t[0],"left")?0:h.sizeDiff.height,r=i?0:h.sizeDiff.width,o={width:h.helper.width()-r,height:h.helper.height()-n},a=parseInt(h.element.css("left"),10)+(h.position.left-h.originalPosition.left)||null,s=parseInt(h.element.css("top"),10)+(h.position.top-h.originalPosition.top)||null,l.animate||this.element.css($.extend(o,{top:s,left:a})),h.helper.height(h.size.height),h.helper.width(h.size.width),this._helper&&!l.animate&&this._proportionallyResize()),$("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,r,o,a,s=this.options;a={minWidth:i(s.minWidth)?s.minWidth:0,maxWidth:i(s.maxWidth)?s.maxWidth:1/0,minHeight:i(s.minHeight)?s.minHeight:0,maxHeight:i(s.maxHeight)?s.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,r=a.minWidth/this.aspectRatio,n=a.maxHeight*this.aspectRatio,o=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),r>a.minHeight&&(a.minHeight=r),n<a.maxWidth&&(a.maxWidth=n),o<a.maxHeight&&(a.maxHeight=o)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),i(e.left)&&(this.position.left=e.left),i(e.top)&&(this.position.top=e.top),i(e.height)&&(this.size.height=e.height),i(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,r=this.axis;return i(e.height)?e.width=e.height*this.aspectRatio:i(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===r&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===r&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,r=i(e.width)&&t.maxWidth&&t.maxWidth<e.width,o=i(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=i(e.width)&&t.minWidth&&t.minWidth>e.width,s=i(e.height)&&t.minHeight&&t.minHeight>e.height,l=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,c=/sw|nw|w/.test(n),u=/nw|ne|n/.test(n);return a&&(e.width=t.minWidth),s&&(e.height=t.minHeight),r&&(e.width=t.maxWidth),o&&(e.height=t.maxHeight),a&&c&&(e.left=l-t.minWidth),r&&c&&(e.left=l-t.maxWidth),s&&u&&(e.top=h-t.minHeight),o&&u&&(e.top=h-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,i,n,r,o=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){if(r=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],i=[r.css("borderTopWidth"),r.css("borderRightWidth"),r.css("borderBottomWidth"),r.css("borderLeftWidth")],n=[r.css("paddingTop"),r.css("paddingRight"),r.css("paddingBottom"),r.css("paddingLeft")],t=0;t<i.length;t++)this.borderDif[t]=(parseInt(i[t],10)||0)+(parseInt(n[t],10)||0);r.css({height:o.height()-this.borderDif[0]-this.borderDif[2]||0,width:o.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var e=this.element,t=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||$("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++t.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,n=this.originalPosition;return{left:n.left+t,width:i.width-t}},n:function(e,t,i){var n=this.originalSize,r=this.originalPosition;return{top:r.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(e,t,i){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,t,i]))},sw:function(e,t,i){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,t,i]))},ne:function(e,t,i){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,t,i]))},nw:function(e,t,i){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,t,i]))}},_propagate:function(e,t){$.ui.plugin.call(this,e,[t,this.ui()]),"resize"!==e&&this._trigger(e,t,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),$.ui.plugin.add("resizable","animate",{stop:function(e){var t=$(this).data("ui-resizable"),i=t.options,n=t._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),o=r&&$.ui.hasScroll(n[0],"left")?0:t.sizeDiff.height,a=r?0:t.sizeDiff.width,s={width:t.size.width-a,height:t.size.height-o},l=parseInt(t.element.css("left"),10)+(t.position.left-t.originalPosition.left)||null,h=parseInt(t.element.css("top"),10)+(t.position.top-t.originalPosition.top)||null;t.element.animate($.extend(s,h&&l?{top:h,left:l}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseInt(t.element.css("width"),10),height:parseInt(t.element.css("height"),10),top:parseInt(t.element.css("top"),10),left:parseInt(t.element.css("left"),10)};n&&n.length&&$(n[0]).css({width:i.width,height:i.height}),t._updateCache(i),t._propagate("resize",e)}})}}),$.ui.plugin.add("resizable","containment",{start:function(){var e,i,n,r,o,a,s,l=$(this).data("ui-resizable"),h=l.options,c=l.element,u=h.containment,f=u instanceof $?u.get(0):/parent/.test(u)?c.parent().get(0):u;f&&(l.containerElement=$(f),/document/.test(u)||u===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}):(e=$(f),i=[],$(["Top","Right","Left","Bottom"]).each(function(n,r){i[n]=t(e.css("padding"+r))}),l.containerOffset=e.offset(),l.containerPosition=e.position(),l.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},n=l.containerOffset,r=l.containerSize.height,o=l.containerSize.width,a=$.ui.hasScroll(f,"left")?f.scrollWidth:o,s=$.ui.hasScroll(f)?f.scrollHeight:r,l.parentData={element:f,left:n.left,top:n.top,width:a,height:s}))},resize:function(e){var t,i,n,r,o=$(this).data("ui-resizable"),a=o.options,s=o.containerOffset,l=o.position,h=o._aspectRatio||e.shiftKey,c={top:0,left:0},u=o.containerElement;u[0]!==document&&/static/.test(u.css("position"))&&(c=s),l.left<(o._helper?s.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-s.left:o.position.left-c.left),h&&(o.size.height=o.size.width/o.aspectRatio),o.position.left=a.helper?s.left:0),l.top<(o._helper?s.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-s.top:o.position.top),h&&(o.size.width=o.size.height*o.aspectRatio),o.position.top=o._helper?s.top:0),o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top,t=Math.abs((o._helper?o.offset.left-c.left:o.offset.left-c.left)+o.sizeDiff.width),i=Math.abs((o._helper?o.offset.top-c.top:o.offset.top-s.top)+o.sizeDiff.height),n=o.containerElement.get(0)===o.element.parent().get(0),r=/relative|absolute/.test(o.containerElement.css("position")),n&&r&&(t-=o.parentData.left),t+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-t,h&&(o.size.height=o.size.width/o.aspectRatio)),i+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-i,h&&(o.size.width=o.size.height*o.aspectRatio))},stop:function(){var e=$(this).data("ui-resizable"),t=e.options,i=e.containerOffset,n=e.containerPosition,r=e.containerElement,o=$(e.helper),a=o.offset(),s=o.outerWidth()-e.sizeDiff.width,l=o.outerHeight()-e.sizeDiff.height;e._helper&&!t.animate&&/relative/.test(r.css("position"))&&$(this).css({left:a.left-n.left-i.left,width:s,height:l}),e._helper&&!t.animate&&/static/.test(r.css("position"))&&$(this).css({left:a.left-n.left-i.left,width:s,height:l})}}),$.ui.plugin.add("resizable","alsoResize",{start:function(){var e=$(this).data("ui-resizable"),t=e.options,i=function(e){$(e).each(function(){var e=$(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"!=typeof t.alsoResize||t.alsoResize.parentNode?i(t.alsoResize):t.alsoResize.length?(t.alsoResize=t.alsoResize[0],i(t.alsoResize)):$.each(t.alsoResize,function(e){i(e)})},resize:function(e,t){var i=$(this).data("ui-resizable"),n=i.options,r=i.originalSize,o=i.originalPosition,a={height:i.size.height-r.height||0,width:i.size.width-r.width||0,top:i.position.top-o.top||0,left:i.position.left-o.left||0},s=function(e,i){$(e).each(function(){var e=$(this),n=$(this).data("ui-resizable-alsoresize"),r={},o=i&&i.length?i:e.parents(t.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(o,function(e,t){var i=(n[t]||0)+(a[t]||0);i&&i>=0&&(r[t]=i||null)}),e.css(r)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?s(n.alsoResize):$.each(n.alsoResize,function(e,t){s(e,t)})},stop:function(){$(this).removeData("resizable-alsoresize")}}),$.ui.plugin.add("resizable","ghost",{start:function(){var e=$(this).data("ui-resizable"),t=e.options,i=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof t.ghost?t.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=$(this).data("ui-resizable");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=$(this).data("ui-resizable");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),$.ui.plugin.add("resizable","grid",{resize:function(){var e=$(this).data("ui-resizable"),t=e.options,i=e.size,n=e.originalSize,r=e.originalPosition,o=e.axis,a="number"==typeof t.grid?[t.grid,t.grid]:t.grid,s=a[0]||1,l=a[1]||1,h=Math.round((i.width-n.width)/s)*s,c=Math.round((i.height-n.height)/l)*l,u=n.width+h,f=n.height+c,p=t.maxWidth&&t.maxWidth<u,d=t.maxHeight&&t.maxHeight<f,m=t.minWidth&&t.minWidth>u,g=t.minHeight&&t.minHeight>f;t.grid=a,m&&(u+=s),g&&(f+=l),p&&(u-=s),d&&(f-=l),/^(se|s|e)$/.test(o)?(e.size.width=u,e.size.height=f):/^(ne)$/.test(o)?(e.size.width=u,e.size.height=f,e.position.top=r.top-c):/^(sw)$/.test(o)?(e.size.width=u,e.size.height=f,e.position.left=r.left-h):(e.size.width=u,e.size.height=f,e.position.top=r.top-c,e.position.left=r.left-h)}})}(jQuery),function($,e){$.widget("ui.selectable",$.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,t=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e=$(t.options.filter,t.element[0]),e.addClass("ui-selectee"),e.each(function(){var e=$(this),t=e.offset();$.data(this,"selectable-item",{element:this,$element:e,left:t.left,top:t.top,right:t.left+e.outerWidth(),bottom:t.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=$("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var t=this,i=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=$(i.filter,this.element[0]),this._trigger("start",e),$(i.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),i.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var i=$.data(this,"selectable-item");i.startselected=!0,e.metaKey||e.ctrlKey||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,t._trigger("unselecting",e,{unselecting:i.element}))}),$(e.target).parents().addBack().each(function(){var i,n=$.data(this,"selectable-item");return n?(i=!e.metaKey&&!e.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(i?"ui-unselecting":"ui-selected").addClass(i?"ui-selecting":"ui-unselecting"),n.unselecting=!i,n.selecting=i,n.selected=i,i?t._trigger("selecting",e,{selecting:n.element}):t._trigger("unselecting",e,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var t,i=this,n=this.options,r=this.opos[0],o=this.opos[1],a=e.pageX,s=e.pageY;return r>a&&(t=a,a=r,r=t),o>s&&(t=s,s=o,o=t),this.helper.css({left:r,top:o,width:a-r,height:s-o}),this.selectees.each(function(){var t=$.data(this,"selectable-item"),l=!1;t&&t.element!==i.element[0]&&("touch"===n.tolerance?l=!(t.left>a||t.right<r||t.top>s||t.bottom<o):"fit"===n.tolerance&&(l=t.left>r&&t.right<a&&t.top>o&&t.bottom<s),l?(t.selected&&(t.$element.removeClass("ui-selected"),t.selected=!1),t.unselecting&&(t.$element.removeClass("ui-unselecting"),t.unselecting=!1),t.selecting||(t.$element.addClass("ui-selecting"),t.selecting=!0,i._trigger("selecting",e,{selecting:t.element}))):(t.selecting&&((e.metaKey||e.ctrlKey)&&t.startselected?(t.$element.removeClass("ui-selecting"),t.selecting=!1,t.$element.addClass("ui-selected"),t.selected=!0):(t.$element.removeClass("ui-selecting"),t.selecting=!1,t.startselected&&(t.$element.addClass("ui-unselecting"),t.unselecting=!0),i._trigger("unselecting",e,{unselecting:t.element}))),t.selected&&(e.metaKey||e.ctrlKey||t.startselected||(t.$element.removeClass("ui-selected"),t.selected=!1,t.$element.addClass("ui-unselecting"),t.unselecting=!0,i._trigger("unselecting",e,{unselecting:t.element})))))}),!1}},_mouseStop:function(e){var t=this;return this.dragged=!1,$(".ui-unselecting",this.element[0]).each(function(){var i=$.data(this,"selectable-item");i.$element.removeClass("ui-unselecting"),i.unselecting=!1,i.startselected=!1,t._trigger("unselected",e,{unselected:i.element})}),$(".ui-selecting",this.element[0]).each(function(){var i=$.data(this,"selectable-item");i.$element.removeClass("ui-selecting").addClass("ui-selected"),i.selecting=!1,i.selected=!0,i.startselected=!0,t._trigger("selected",e,{selected:i.element})}),this._trigger("stop",e),this.helper.remove(),!1}})}(jQuery),function($,e){function t(e,t,i){return e>t&&t+i>e}function i(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}$.widget("ui.sortable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||i(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,t){"disabled"===e?(this.options[e]=t,this.widget().toggleClass("ui-sortable-disabled",!!t)):$.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,t){var i=null,n=!1,r=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),$(e.target).parents().each(function(){return $.data(this,r.widgetName+"-item")===r?(i=$(this),!1):void 0}),$.data(e.target,r.widgetName+"-item")===r&&(i=$(e.target)),i&&(!this.options.handle||t||($(this.options.handle,i).find("*").addBack().each(function(){this===e.target&&(n=!0)}),n))?(this.currentItem=i,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(e,t,i){var n,r,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},$.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",o.cursor),this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(r)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return $.ui.ddmanager&&($.ui.ddmanager.current=this),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var t,i,n,r,o=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+o.scrollSpeed:e.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(e.pageY-$(document).scrollTop()<o.scrollSensitivity?a=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(e.pageY-$(document).scrollTop())<o.scrollSensitivity&&(a=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)),e.pageX-$(document).scrollLeft()<o.scrollSensitivity?a=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(e.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(a=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed))),a!==!1&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t=this.items.length-1;t>=0;t--)if(i=this.items[t],n=i.item[0],r=this._intersectsWithPointer(i),r&&i.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===r?"next":"prev"]()[0]!==n&&!$.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!$.contains(this.element[0],n):!0)){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(e,i),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),$.ui.ddmanager&&$.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,t){if(e){if($.ui.ddmanager&&!this.options.dropBehaviour&&$.ui.ddmanager.drop(this,e),this.options.revert){var i=this,n=this.placeholder.offset(),r=this.options.axis,o={};r&&"x"!==r||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),r&&"y"!==r||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,$(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){i._clear(e)
})}else this._clear(e,t);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),$.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?$(this.domPosition.prev).after(this.currentItem):$(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},$(t).each(function(){var t=($(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);t&&i.push((e.key||t[1]+"[]")+"="+(e.key&&e.expression?t[1]:t[2]))}),!i.length&&e.key&&i.push(e.key+"="),i.join("&")},toArray:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},t.each(function(){i.push($(e.item||this).attr(e.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,r=n+this.helperProportions.height,o=e.left,a=o+e.width,s=e.top,l=s+e.height,h=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||n+h>s&&l>n+h,f="y"===this.options.axis||t+c>o&&a>t+c,p=u&&f;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:o<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<a&&s<n+this.helperProportions.height/2&&r-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var i="x"===this.options.axis||t(this.positionAbs.top+this.offset.click.top,e.top,e.height),n="y"===this.options.axis||t(this.positionAbs.left+this.offset.click.left,e.left,e.width),r=i&&n,o=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return r?this.floating?a&&"right"===a||"down"===o?2:1:o&&("down"===o?2:1):!1},_intersectsWithSides:function(e){var i=t(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),n=t(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),r=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&n||"left"===o&&!n:r&&("down"===r&&i||"up"===r&&!i)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(e){var t,i,n,r,o=[],a=[],s=this._connectWith();if(s&&e)for(t=s.length-1;t>=0;t--)for(n=$(s[t]),i=n.length-1;i>=0;i--)r=$.data(n[i],this.widgetFullName),r&&r!==this&&!r.options.disabled&&a.push([$.isFunction(r.options.items)?r.options.items.call(r.element):$(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(a.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),t=a.length-1;t>=0;t--)a[t][0].each(function(){o.push(this)});return $(o)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(t){for(var i=0;i<e.length;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var t,i,n,r,o,a,s,l,h=this.items,c=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):$(this.options.items,this.element),this]],u=this._connectWith();if(u&&this.ready)for(t=u.length-1;t>=0;t--)for(n=$(u[t]),i=n.length-1;i>=0;i--)r=$.data(n[i],this.widgetFullName),r&&r!==this&&!r.options.disabled&&(c.push([$.isFunction(r.options.items)?r.options.items.call(r.element[0],e,{item:this.currentItem}):$(r.options.items,r.element),r]),this.containers.push(r));for(t=c.length-1;t>=0;t--)for(o=c[t][1],a=c[t][0],i=0,l=a.length;l>i;i++)s=$(a[i]),s.data(this.widgetName+"-item",o),h.push({item:s,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var t,i,n,r;for(t=this.items.length-1;t>=0;t--)i=this.items[t],i.instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?$(this.options.toleranceElement,i.item):i.item,e||(i.width=n.outerWidth(),i.height=n.outerHeight()),r=n.offset(),i.left=r.left,i.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(t=this.containers.length-1;t>=0;t--)r=this.containers[t].element.offset(),this.containers[t].containerCache.left=r.left,this.containers[t].containerCache.top=r.top,this.containers[t].containerCache.width=this.containers[t].element.outerWidth(),this.containers[t].containerCache.height=this.containers[t].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var t,i=e.options;i.placeholder&&i.placeholder.constructor!==String||(t=i.placeholder,i.placeholder={element:function(){var i=e.currentItem[0].nodeName.toLowerCase(),n=$("<"+i+">",e.document[0]).addClass(t||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===i?e.currentItem.children().each(function(){$("<td>&#160;</td>",e.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(n)}):"img"===i&&n.attr("src",e.currentItem.attr("src")),t||n.css("visibility","hidden"),n},update:function(n,r){(!t||i.forcePlaceholderSize)&&(r.height()||r.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=$(i.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),i.placeholder.update(e,e.placeholder)},_contactContainers:function(e){var n,r,o,a,s,l,h,c,u,f,p=null,d=null;for(n=this.containers.length-1;n>=0;n--)if(!$.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(p&&$.contains(this.containers[n].element[0],p.element[0]))continue;p=this.containers[n],d=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",e,this._uiHash(this)),this.containers[n].containerCache.over=0);if(p)if(1===this.containers.length)this.containers[d].containerCache.over||(this.containers[d]._trigger("over",e,this._uiHash(this)),this.containers[d].containerCache.over=1);else{for(o=1e4,a=null,f=p.floating||i(this.currentItem),s=f?"left":"top",l=f?"width":"height",h=this.positionAbs[s]+this.offset.click[s],r=this.items.length-1;r>=0;r--)$.contains(this.containers[d].element[0],this.items[r].item[0])&&this.items[r].item[0]!==this.currentItem[0]&&(!f||t(this.positionAbs.top+this.offset.click.top,this.items[r].top,this.items[r].height))&&(c=this.items[r].item.offset()[s],u=!1,Math.abs(c-h)>Math.abs(c+this.items[r][l]-h)&&(u=!0,c+=this.items[r][l]),Math.abs(c-h)<o&&(o=Math.abs(c-h),a=this.items[r],this.direction=u?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[d])return;a?this._rearrange(e,a,null,!0):this._rearrange(e,null,this.containers[d].element,!0),this._trigger("change",e,this._uiHash()),this.containers[d]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[d],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",e,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(e){var t=this.options,i=$.isFunction(t.helper)?$(t.helper.apply(this.element[0],[e,this.currentItem])):"clone"===t.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||$("parent"!==t.appendTo?t.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!i[0].style.width||t.forceHelperSize)&&i.width(this.currentItem.width()),(!i[0].style.height||t.forceHelperSize)&&i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),$.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,($("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=$(n.containment)[0],t=$(n.containment).offset(),i="hidden"!==$(e).css("overflow"),this.containment=[t.left+(parseInt($(e).css("borderLeftWidth"),10)||0)+(parseInt($(e).css("paddingLeft"),10)||0)-this.margins.left,t.top+(parseInt($(e).css("borderTopWidth"),10)||0)+(parseInt($(e).css("paddingTop"),10)||0)-this.margins.top,t.left+(i?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt($(e).css("borderLeftWidth"),10)||0)-(parseInt($(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,t.top+(i?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt($(e).css("borderTopWidth"),10)||0)-(parseInt($(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(n[0].tagName);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:n.scrollTop())*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:n.scrollLeft())*i}},_generatePosition:function(e){var t,i,n=this.options,r=e.pageX,o=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(t=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?t-this.offset.click.top>=this.containment[1]&&t-this.offset.click.top<=this.containment[3]?t:t-this.offset.click.top>=this.containment[1]?t-n.grid[1]:t+n.grid[1]:t,i=this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0],r=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-n.grid[0]:i+n.grid[0]:i)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:a.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:a.scrollLeft())}},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!n)})},_clear:function(e,t){this.reverting=!1;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)t||n.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(n.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),i=0;i<n.length;i++)n[i].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(i=0;i<n.length;i++)n[i].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){$.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var t=e||this;return{helper:t.helper,placeholder:t.placeholder||$([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,item:t.currentItem,sender:e?e.element:null}}})}(jQuery),function($,e){var t="ui-effects-";$.effects={effect:{}},function(e,t){function i(e,t,i){var n=c[t.type]||{};return null==e?i||!t.def?null:t.def:(e=n.floor?~~e:parseFloat(e),isNaN(e)?t.def:n.mod?(e+n.mod)%n.mod:0>e?0:n.max<e?n.max:e)}function n(t){var i=l(),n=i._rgba=[];return t=t.toLowerCase(),d(s,function(e,r){var o,a=r.re.exec(t),s=a&&r.parse(a),l=r.space||"rgba";return s?(o=i[l](s),i[h[l].cache]=o[h[l].cache],n=i._rgba=o._rgba,!1):void 0}),n.length?("0,0,0,0"===n.join()&&e.extend(n,p.transparent),i):p[t]}function r(e,t,i){return i=(i+1)%1,1>6*i?e+(t-e)*i*6:1>2*i?t:2>3*i?e+(t-e)*(2/3-i)*6:e}var o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,s=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],l=e.Color=function(t,i,n,r){return new e.Color.fn.parse(t,i,n,r)},h={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},c={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=l.support={},f=e("<p>")[0],p,d=e.each;f.style.cssText="background-color:rgba(1,1,1,.5)",u.rgba=f.style.backgroundColor.indexOf("rgba")>-1,d(h,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),l.fn=e.extend(l.prototype,{parse:function(r,o,a,s){if(r===t)return this._rgba=[null,null,null,null],this;(r.jquery||r.nodeType)&&(r=e(r).css(o),o=t);var c=this,u=e.type(r),f=this._rgba=[];return o!==t&&(r=[r,o,a,s],u="array"),"string"===u?this.parse(n(r)||p._default):"array"===u?(d(h.rgba.props,function(e,t){f[t.idx]=i(r[t.idx],t)}),this):"object"===u?(r instanceof l?d(h,function(e,t){r[t.cache]&&(c[t.cache]=r[t.cache].slice())}):d(h,function(t,n){var o=n.cache;d(n.props,function(e,t){if(!c[o]&&n.to){if("alpha"===e||null==r[e])return;c[o]=n.to(c._rgba)}c[o][t.idx]=i(r[e],t,!0)}),c[o]&&e.inArray(null,c[o].slice(0,3))<0&&(c[o][3]=1,n.from&&(c._rgba=n.from(c[o])))}),this):void 0},is:function(e){var t=l(e),i=!0,n=this;return d(h,function(e,r){var o,a=t[r.cache];return a&&(o=n[r.cache]||r.to&&r.to(n._rgba)||[],d(r.props,function(e,t){return null!=a[t.idx]?i=a[t.idx]===o[t.idx]:void 0})),i}),i},_space:function(){var e=[],t=this;return d(h,function(i,n){t[n.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var n=l(e),r=n._space(),o=h[r],a=0===this.alpha()?l("transparent"):this,s=a[o.cache]||o.to(a._rgba),u=s.slice();return n=n[o.cache],d(o.props,function(e,r){var o=r.idx,a=s[o],l=n[o],h=c[r.type]||{};null!==l&&(null===a?u[o]=l:(h.mod&&(l-a>h.mod/2?a+=h.mod:a-l>h.mod/2&&(a-=h.mod)),u[o]=i((l-a)*t+a,r)))}),this[r](u)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),r=l(t)._rgba;return l(e.map(i,function(e,t){return(1-n)*r[t]+n*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),n=i.pop();return t&&i.push(~~(255*n)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,h.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/255,i=e[1]/255,n=e[2]/255,r=e[3],o=Math.max(t,i,n),a=Math.min(t,i,n),s=o-a,l=o+a,h=.5*l,c,u;return c=a===o?0:t===o?60*(i-n)/s+360:i===o?60*(n-t)/s+120:60*(t-i)/s+240,u=0===s?0:.5>=h?s/l:s/(2-l),[Math.round(c)%360,u,h,null==r?1:r]},h.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],n=e[2],o=e[3],a=.5>=n?n*(1+i):n+i-n*i,s=2*n-a;return[Math.round(255*r(s,a,t+1/3)),Math.round(255*r(s,a,t)),Math.round(255*r(s,a,t-1/3)),o]},d(h,function(n,r){var o=r.props,s=r.cache,h=r.to,c=r.from;l.fn[n]=function(n){if(h&&!this[s]&&(this[s]=h(this._rgba)),n===t)return this[s].slice();var r,a=e.type(n),u="array"===a||"object"===a?n:arguments,f=this[s].slice();return d(o,function(e,t){var n=u["object"===a?e:t.idx];null==n&&(n=f[t.idx]),f[t.idx]=i(n,t)}),c?(r=l(c(f)),r[s]=f,r):l(f)},d(o,function(t,i){l.fn[t]||(l.fn[t]=function(r){var o=e.type(r),s="alpha"===t?this._hsla?"hsla":"rgba":n,l=this[s](),h=l[i.idx],c;return"undefined"===o?h:("function"===o&&(r=r.call(this,h),o=e.type(r)),null==r&&i.empty?this:("string"===o&&(c=a.exec(r),c&&(r=h+parseFloat(c[2])*("+"===c[1]?1:-1))),l[i.idx]=r,this[s](l)))})})}),l.hook=function(t){var i=t.split(" ");d(i,function(t,i){e.cssHooks[i]={set:function(t,r){var o,a,s="";if("transparent"!==r&&("string"!==e.type(r)||(o=n(r)))){if(r=l(o||r),!u.rgba&&1!==r._rgba[3]){for(a="backgroundColor"===i?t.parentNode:t;(""===s||"transparent"===s)&&a&&a.style;)try{s=e.css(a,"backgroundColor"),a=a.parentNode}catch(h){}r=r.blend(s&&"transparent"!==s?s:"_default")}r=r.toRgbaString()}try{t.style[i]=r}catch(h){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=l(t.elem,i),t.end=l(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},l.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return d(["Top","Right","Bottom","Left"],function(i,n){t["border"+n+"Color"]=e}),t}},p=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function t(e){var t,i,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,r={};if(n&&n.length&&n[0]&&n[n[0]])for(i=n.length;i--;)t=n[i],"string"==typeof n[t]&&(r[$.camelCase(t)]=n[t]);else for(t in n)"string"==typeof n[t]&&(r[t]=n[t]);return r}function i(e,t){var i={},n,o;for(n in t)o=t[n],e[n]!==o&&(r[n]||($.fx.step[n]||!isNaN(parseFloat(o)))&&(i[n]=o));return i}var n=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,t){$.fx.step[t]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,t,e.end),e.setAttr=!0)}}),$.fn.addBack||($.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),$.effects.animateClass=function(e,r,o,a){var s=$.speed(r,o,a);return this.queue(function(){var r=$(this),o=r.attr("class")||"",a,l=s.children?r.find("*").addBack():r;l=l.map(function(){var e=$(this);return{el:e,start:t(this)}}),a=function(){$.each(n,function(t,i){e[i]&&r[i+"Class"](e[i])})},a(),l=l.map(function(){return this.end=t(this.el[0]),this.diff=i(this.start,this.end),this}),r.attr("class",o),l=l.map(function(){var e=this,t=$.Deferred(),i=$.extend({},s,{queue:!1,complete:function(){t.resolve(e)}});return this.el.animate(this.diff,i),t.promise()}),$.when.apply($,l.get()).done(function(){a(),$.each(arguments,function(){var e=this.el;$.each(this.diff,function(t){e.css(t,"")})}),s.complete.call(r[0])})})},$.fn.extend({addClass:function(e){return function(t,i,n,r){return i?$.effects.animateClass.call(this,{add:t},i,n,r):e.apply(this,arguments)}}($.fn.addClass),removeClass:function(e){return function(t,i,n,r){return arguments.length>1?$.effects.animateClass.call(this,{remove:t},i,n,r):e.apply(this,arguments)}}($.fn.removeClass),toggleClass:function(t){return function(i,n,r,o,a){return"boolean"==typeof n||n===e?r?$.effects.animateClass.call(this,n?{add:i}:{remove:i},r,o,a):t.apply(this,arguments):$.effects.animateClass.call(this,{toggle:i},n,r,o)}}($.fn.toggleClass),switchClass:function(e,t,i,n,r){return $.effects.animateClass.call(this,{add:t,remove:e},i,n,r)}})}(),function(){function i(e,t,i,n){return $.isPlainObject(e)&&(t=e,e=e.effect),e={effect:e},null==t&&(t={}),$.isFunction(t)&&(n=t,i=null,t={}),("number"==typeof t||$.fx.speeds[t])&&(n=i,i=t,t={}),$.isFunction(i)&&(n=i,i=null),t&&$.extend(e,t),i=i||t.duration,e.duration=$.fx.off?0:"number"==typeof i?i:i in $.fx.speeds?$.fx.speeds[i]:$.fx.speeds._default,e.complete=n||t.complete,e}function n(e){return!e||"number"==typeof e||$.fx.speeds[e]?!0:"string"!=typeof e||$.effects.effect[e]?$.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}$.extend($.effects,{version:"1.10.3",save:function(e,i){for(var n=0;n<i.length;n++)null!==i[n]&&e.data(t+i[n],e[0].style[i[n]])},restore:function(i,n){var r,o;for(o=0;o<n.length;o++)null!==n[o]&&(r=i.data(t+n[o]),r===e&&(r=""),i.css(n[o],r))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,n;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=e[1]/t.width}return{x:n,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var t={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},i=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:e.width(),height:e.height()},r=document.activeElement;try{r.id}catch(o){r=document.body}return e.wrap(i),(e[0]===r||$.contains(e[0],r))&&$(r).focus(),i=e.parent(),"static"===e.css("position")?(i.css({position:"relative"}),e.css({position:"relative"})):($.extend(t,{position:e.css("position"),zIndex:e.css("z-index")}),$.each(["top","left","bottom","right"],function(i,n){t[n]=e.css(n),isNaN(parseInt(t[n],10))&&(t[n]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(n),i.css(t).show()},removeWrapper:function(e){var t=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===t||$.contains(e[0],t))&&$(t).focus()),e},setTransition:function(e,t,i,n){return n=n||{},$.each(t,function(t,r){var o=e.cssUnit(r);o[0]>0&&(n[r]=o[0]*i+o[1])}),n}}),$.fn.extend({effect:function(){function e(e){function i(){$.isFunction(r)&&r.call(n[0]),$.isFunction(e)&&e()}var n=$(this),r=t.complete,a=t.mode;(n.is(":hidden")?"hide"===a:"show"===a)?(n[a](),i()):o.call(n[0],t,i)}var t=i.apply(this,arguments),n=t.mode,r=t.queue,o=$.effects.effect[t.effect];return $.fx.off||!o?n?this[n](t.duration,t.complete):this.each(function(){t.complete&&t.complete.call(this)}):r===!1?this.each(e):this.queue(r||"fx",e)},show:function(e){return function(t){if(n(t))return e.apply(this,arguments);var r=i.apply(this,arguments);return r.mode="show",this.effect.call(this,r)}}($.fn.show),hide:function(e){return function(t){if(n(t))return e.apply(this,arguments);var r=i.apply(this,arguments);return r.mode="hide",this.effect.call(this,r)}}($.fn.hide),toggle:function(e){return function(t){if(n(t)||"boolean"==typeof t)return e.apply(this,arguments);var r=i.apply(this,arguments);return r.mode="toggle",this.effect.call(this,r)}}($.fn.toggle),cssUnit:function(e){var t=this.css(e),i=[];return $.each(["em","px","%","pt"],function(e,n){t.indexOf(n)>0&&(i=[parseFloat(t),n])}),i}})}(),function(){var e={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),$.extend(e,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;e<((t=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),$.each(e,function(e,t){$.easing["easeIn"+e]=t,$.easing["easeOut"+e]=function(e){return 1-t(1-e)},$.easing["easeInOut"+e]=function(e){return.5>e?t(2*e)/2:1-t(-2*e+2)/2}})}()}(jQuery),function($,e){var t=0,i={},n={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide",n.height=n.paddingTop=n.paddingBottom=n.borderTopWidth=n.borderBottomWidth="show",$.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var e=this.options;this.prevShow=this.prevHide=$(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||e.active!==!1&&null!=e.active||(e.active=0),this._processPanels(),e.active<0&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():$(),content:this.active.length?this.active.next():$()}},_createIcons:function(){var e=this.options.icons;e&&($("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")
}),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),void("disabled"===e&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var t=$.ui.keyCode,i=this.headers.length,n=this.headers.index(e.target),r=!1;switch(e.keyCode){case t.RIGHT:case t.DOWN:r=this.headers[(n+1)%i];break;case t.LEFT:case t.UP:r=this.headers[(n-1+i)%i];break;case t.SPACE:case t.ENTER:this._eventHandler(e);break;case t.HOME:r=this.headers[0];break;case t.END:r=this.headers[i-1]}r&&($(e.target).attr("tabIndex",-1),$(r).attr("tabIndex",0),r.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===$.ui.keyCode.UP&&e.ctrlKey&&$(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),e.active===!1&&e.collapsible===!0||!this.headers.length?(e.active=!1,this.active=$()):e.active===!1?this._activate(0):this.active.length&&!$.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=$()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var e,i=this.options,n=i.heightStyle,r=this.element.parent(),o=this.accordionId="ui-accordion-"+(this.element.attr("id")||++t);this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(e){var t=$(this),i=t.attr("id"),n=t.next(),r=n.attr("id");i||(i=o+"-header-"+e,t.attr("id",i)),r||(r=o+"-panel-"+e,n.attr("id",r)),t.attr("aria-controls",r),n.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===n?(e=r.height(),this.element.siblings(":visible").each(function(){var t=$(this),i=t.css("position");"absolute"!==i&&"fixed"!==i&&(e-=t.outerHeight(!0))}),this.headers.each(function(){e-=$(this).outerHeight(!0)}),this.headers.next().each(function(){$(this).height(Math.max(0,e-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===n&&(e=0,this.headers.next().each(function(){e=Math.max(e,$(this).css("height","").height())}).height(e))},_activate:function(e){var t=this._findActive(e)[0];t!==this.active[0]&&(t=t||this.active[0],this._eventHandler({target:t,currentTarget:t,preventDefault:$.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):$()},_setupEvents:function(e){var t={keydown:"_keydown"};e&&$.each(e.split(" "),function(e,i){t[i]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,t),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var t=this.options,i=this.active,n=$(e.currentTarget),r=n[0]===i[0],o=r&&t.collapsible,a=o?$():n.next(),s=i.next(),l={oldHeader:i,oldPanel:s,newHeader:o?$():n,newPanel:a};e.preventDefault(),r&&!t.collapsible||this._trigger("beforeActivate",e,l)===!1||(t.active=o?!1:this.headers.index(n),this.active=r?$():n,this._toggle(l),i.removeClass("ui-accordion-header-active ui-state-active"),t.icons&&i.children(".ui-accordion-header-icon").removeClass(t.icons.activeHeader).addClass(t.icons.header),r||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),t.icons&&n.children(".ui-accordion-header-icon").removeClass(t.icons.header).addClass(t.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var t=e.newPanel,i=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=t,this.prevHide=i,this.options.animate?this._animate(t,i,e):(i.hide(),t.show(),this._toggleComplete(e)),i.attr({"aria-expanded":"false","aria-hidden":"true"}),i.prev().attr("aria-selected","false"),t.length&&i.length?i.prev().attr("tabIndex",-1):t.length&&this.headers.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),t.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(e,t,r){var o,a,s,l=this,h=0,c=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},f=c&&u.down||u,p=function(){l._toggleComplete(r)};return"number"==typeof f&&(s=f),"string"==typeof f&&(a=f),a=a||f.easing||u.easing,s=s||f.duration||u.duration,t.length?e.length?(o=e.show().outerHeight(),t.animate(i,{duration:s,easing:a,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(n,{duration:s,easing:a,complete:p,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?h+=i.now:"content"!==l.options.heightStyle&&(i.now=Math.round(o-t.outerHeight()-h),h=0)}})):t.animate(i,s,a,p):e.animate(n,s,a,p)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}(jQuery),function($,e){var t=0;$.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var e,t,i,n=this.element[0].nodeName.toLowerCase(),r="textarea"===n,o="input"===n;this.isMultiLine=r?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[r||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return e=!0,i=!0,void(t=!0);e=!1,i=!1,t=!1;var r=$.ui.keyCode;switch(n.keyCode){case r.PAGE_UP:e=!0,this._move("previousPage",n);break;case r.PAGE_DOWN:e=!0,this._move("nextPage",n);break;case r.UP:e=!0,this._keyEvent("previous",n);break;case r.DOWN:e=!0,this._keyEvent("next",n);break;case r.ENTER:case r.NUMPAD_ENTER:this.menu.active&&(e=!0,n.preventDefault(),this.menu.select(n));break;case r.TAB:this.menu.active&&this.menu.select(n);break;case r.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(n),n.preventDefault());break;default:t=!0,this._searchTimeout(n)}},keypress:function(i){if(e)return e=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&i.preventDefault());if(!t){var n=$.ui.keyCode;switch(i.keyCode){case n.PAGE_UP:this._move("previousPage",i);break;case n.PAGE_DOWN:this._move("nextPage",i);break;case n.UP:this._keyEvent("previous",i);break;case n.DOWN:this._keyEvent("next",i)}}},input:function(e){return i?(i=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=$("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var t=this.menu.element[0];$(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(i){i.target===e.element[0]||i.target===t||$.contains(t,i.target)||e.close()})})},menufocus:function(e,t){if(this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){$(e.target).trigger(e.originalEvent)});var i=t.item.data("ui-autocomplete-item");!1!==this._trigger("focus",e,{item:i})?e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(i.value):this.liveRegion.text(i.value)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=$("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?$(e):this.document.find(e).eq(0)),e||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,t,i=this;$.isArray(this.options.source)?(e=this.options.source,this.source=function(t,i){i($.ui.autocomplete.filter(e,t.term))}):"string"==typeof this.options.source?(t=this.options.source,this.source=function(e,n){i.xhr&&i.xhr.abort(),i.xhr=$.ajax({url:t,data:e,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,i=++t;return function(n){i===t&&e.__response(n),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:$.map(e,function(e){return"string"==typeof e?{label:e,value:e}:$.extend({label:e.label||e.value,value:e.value||e.label},e)})},_suggest:function(e){var t=this.menu.element.empty();this._renderMenu(t,e),this.isNewMenu=!0,this.menu.refresh(),t.show(),this._resizeMenu(),t.position($.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,t){var i=this;$.each(t,function(t,n){i._renderItemData(e,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(e,t){return $("<li>").append($("<a>").text(t.label)).appendTo(e)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),$.extend($.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,t){var i=new RegExp($.ui.autocomplete.escapeRegex(t),"i");return $.grep(e,function(e){return i.test(e.label||e.value||e)})}}),$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),function($,e){var t,i,n,r,o="ui-button ui-widget ui-state-default ui-corner-all",a="ui-state-hover ui-state-active ",s="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",l=function(){var e=$(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)},h=function(e){var t=e.name,i=e.form,n=$([]);return t&&(t=t.replace(/'/g,"\\'"),n=i?$(i).find("[name='"+t+"']"):$("[name='"+t+"']",e.ownerDocument).filter(function(){return!this.form})),n};$.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,l),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var e=this,a=this.options,s="checkbox"===this.type||"radio"===this.type,c=s?"":"ui-state-active",u="ui-state-focus";null===a.label&&(a.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){a.disabled||this===t&&$(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){a.disabled||$(this).removeClass(c)}).bind("click"+this.eventNamespace,function(e){a.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){e.buttonElement.addClass(u)}).bind("blur"+this.eventNamespace,function(){e.buttonElement.removeClass(u)}),s&&(this.element.bind("change"+this.eventNamespace,function(){r||e.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){a.disabled||(r=!1,i=e.pageX,n=e.pageY)}).bind("mouseup"+this.eventNamespace,function(e){a.disabled||(i!==e.pageX||n!==e.pageY)&&(r=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return a.disabled||r?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(a.disabled||r)return!1;$(this).addClass("ui-state-active"),e.buttonElement.attr("aria-pressed","true");var t=e.element[0];h(t).not(t).map(function(){return $(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return a.disabled?!1:($(this).addClass("ui-state-active"),t=this,void e.document.one("mouseup",function(){t=null}))}).bind("mouseup"+this.eventNamespace,function(){return a.disabled?!1:void $(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(e){return a.disabled?!1:void((e.keyCode===$.ui.keyCode.SPACE||e.keyCode===$.ui.keyCode.ENTER)&&$(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){$(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===$.ui.keyCode.SPACE&&$(this).click()})),this._setOption("disabled",a.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+a+" "+s).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?void(t?this.element.prop("disabled",!0):this.element.prop("disabled",!1)):void this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?h(this.element[0]).each(function(){$(this).is(":checked")?$(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):$(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var e=this.buttonElement.removeClass(s),t=$("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),i=this.options.icons,n=i.primary&&i.secondary,r=[];i.primary||i.secondary?(this.options.text&&r.push("ui-button-text-icon"+(n?"s":i.primary?"-primary":"-secondary")),i.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+i.primary+"'></span>"),i.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+i.secondary+"'></span>"),this.options.text||(r.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",$.trim(t)))):r.push("ui-button-text-only"),e.addClass(r.join(" "))}}),$.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var e="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function($,e){function t(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=i($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function i(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){$(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",function(){$.datepicker._isDisabledDatepicker(o.inline?e.parent()[0]:o.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).addClass("ui-datepicker-next-hover"))})}function n(e,t){$.extend(e,t);for(var i in t)null==t[i]&&(e[i]=t[i]);return e}$.extend($.ui,{datepicker:{version:"1.10.3"}});var r="datepicker",o;$.extend(t.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return n(this._defaults,e||{}),this},_attachDatepicker:function(e,t){var i,n,r;i=e.nodeName.toLowerCase(),n="div"===i||"span"===i,e.id||(this.uuid+=1,e.id="dp"+this.uuid),r=this._newInst($(e),n),r.settings=$.extend({},t||{}),"input"===i?this._connectDatepicker(e,r):n&&this._inlineDatepicker(e,r)},_newInst:function(e,t){var n=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?i($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,t){var i=$(e);t.append=$([]),t.trigger=$([]),i.hasClass(this.markerClassName)||(this._attachments(i,t),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(t),$.data(e,r,t),t.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,t){var i,n,r,o=this._get(t,"appendText"),a=this._get(t,"isRTL");t.append&&t.append.remove(),o&&(t.append=$("<span class='"+this._appendClass+"'>"+o+"</span>"),e[a?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove(),i=this._get(t,"showOn"),("focus"===i||"both"===i)&&e.focus(this._showDatepicker),("button"===i||"both"===i)&&(n=this._get(t,"buttonText"),r=this._get(t,"buttonImage"),t.trigger=$(this._get(t,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:r,alt:n,title:n}):$("<button type='button'></button>").addClass(this._triggerClass).html(r?$("<img/>").attr({src:r,alt:n,title:n}):n)),e[a?"before":"after"](t.trigger),t.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput===e[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!==e[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(e[0])):$.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,n,r,o=new Date(2009,11,20),a=this._get(e,"dateFormat");a.match(/[DM]/)&&(t=function(e){for(i=0,n=0,r=0;r<e.length;r++)e[r].length>i&&(i=e[r].length,n=r);return n},o.setMonth(t(this._get(e,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(t(this._get(e,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),e.input.attr("size",this._formatDate(e,o).length)}},_inlineDatepicker:function(e,t){var i=$(e);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(t.dpDiv),$.data(e,r,t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block"))},_dialogDatepicker:function(e,t,i,o,a){var s,l,h,c,u,f=this._dialogInst;return f||(this.uuid+=1,s="dp"+this.uuid,this._dialogInput=$("<input type='text' id='"+s+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),f=this._dialogInst=this._newInst(this._dialogInput,!1),f.settings={},$.data(this._dialogInput[0],r,f)),n(f.settings,o||{}),t=t&&t.constructor===Date?this._formatDate(f,t):t,this._dialogInput.val(t),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+c,h/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),f.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],r,f),this},_destroyDatepicker:function(e){var t,i=$(e),n=$.data(e,r);i.hasClass(this.markerClassName)&&(t=e.nodeName.toLowerCase(),$.removeData(e,r),"input"===t?(n.append.remove(),n.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===t||"span"===t)&&i.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var t,i,n=$(e),o=$.data(e,r);n.hasClass(this.markerClassName)&&(t=e.nodeName.toLowerCase(),"input"===t?(e.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===t||"span"===t)&&(i=n.children("."+this._inlineClass),i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=$.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var t,i,n=$(e),o=$.data(e,r);n.hasClass(this.markerClassName)&&(t=e.nodeName.toLowerCase(),"input"===t?(e.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===t||"span"===t)&&(i=n.children("."+this._inlineClass),i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=$.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(e){try{return $.data(e,r)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,r){var o,a,s,l,h=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?$.extend({},$.datepicker._defaults):h?"all"===i?$.extend({},h.settings):this._get(h,i):null:(o=i||{},"string"==typeof i&&(o={},o[i]=r),void(h&&(this._curInst===h&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),s=this._getMinMaxDate(h,"min"),l=this._getMinMaxDate(h,"max"),n(h.settings,o),null!==s&&o.dateFormat!==e&&o.minDate===e&&(h.settings.minDate=this._formatDate(h,s)),null!==l&&o.dateFormat!==e&&o.maxDate===e&&(h.settings.maxDate=this._formatDate(h,l)),"disabled"in o&&(o.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments($(t),h),this._autoSize(h),this._setDate(h,a),this._updateAlternate(h),this._updateDatepicker(h))))},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(e){var t,i,n,r=$.datepicker._getInst(e.target),o=!0,a=r.dpDiv.is(".ui-datepicker-rtl");if(r._keyEvent=!0,$.datepicker._datepickerShowing)switch(e.keyCode){case 9:$.datepicker._hideDatepicker(),o=!1;break;case 13:return n=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",r.dpDiv),n[0]&&$.datepicker._selectDay(e.target,r.selectedMonth,r.selectedYear,n[0]),t=$.datepicker._get(r,"onSelect"),t?(i=$.datepicker._formatDate(r),t.apply(r.input?r.input[0]:null,[i,r])):$.datepicker._hideDatepicker(),!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(r,"stepBigMonths"):-$.datepicker._get(r,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(r,"stepBigMonths"):+$.datepicker._get(r,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&$.datepicker._clearDate(e.target),o=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&$.datepicker._gotoToday(e.target),o=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,a?1:-1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(r,"stepBigMonths"):-$.datepicker._get(r,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,-7,"D"),o=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,a?-1:1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(r,"stepBigMonths"):+$.datepicker._get(r,"stepMonths"),"M");
break;case 40:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,7,"D"),o=e.ctrlKey||e.metaKey;break;default:o=!1}else 36===e.keyCode&&e.ctrlKey?$.datepicker._showDatepicker(this):o=!1;o&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t,i,n=$.datepicker._getInst(e.target);return $.datepicker._get(n,"constrainInput")?(t=$.datepicker._possibleChars($.datepicker._get(n,"dateFormat")),i=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">i||!t||t.indexOf(i)>-1):void 0},_doKeyUp:function(e){var t,i=$.datepicker._getInst(e.target);if(i.input.val()!==i.lastVal)try{t=$.datepicker.parseDate($.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,$.datepicker._getFormatConfig(i)),t&&($.datepicker._setDateFromField(i),$.datepicker._updateAlternate(i),$.datepicker._updateDatepicker(i))}catch(n){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=$("input",e.parentNode)[0]),!$.datepicker._isDisabledDatepicker(e)&&$.datepicker._lastInput!==e){var t,i,r,o,a,s,l;t=$.datepicker._getInst(e),$.datepicker._curInst&&$.datepicker._curInst!==t&&($.datepicker._curInst.dpDiv.stop(!0,!0),t&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0])),i=$.datepicker._get(t,"beforeShow"),r=i?i.apply(e,[e,t]):{},r!==!1&&(n(t.settings,r),t.lastVal=null,$.datepicker._lastInput=e,$.datepicker._setDateFromField(t),$.datepicker._inDialog&&(e.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(e),$.datepicker._pos[1]+=e.offsetHeight),o=!1,$(e).parents().each(function(){return o|="fixed"===$(this).css("position"),!o}),a={left:$.datepicker._pos[0],top:$.datepicker._pos[1]},$.datepicker._pos=null,t.dpDiv.empty(),t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(t),a=$.datepicker._checkOffset(t,a,o),t.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":o?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),t.inline||(s=$.datepicker._get(t,"showAnim"),l=$.datepicker._get(t,"duration"),t.dpDiv.zIndex($(e).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects.effect[s]?t.dpDiv.show(s,$.datepicker._get(t,"showOptions"),l):t.dpDiv[s||"show"](s?l:null),$.datepicker._shouldFocusInput(t)&&t.input.focus(),$.datepicker._curInst=t))}},_updateDatepicker:function(e){this.maxRows=4,o=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var t,i=this._getNumberOfMonths(e),n=i[1],r=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",r*n+"em"),e.dpDiv[(1!==i[0]||1!==i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(t=e.yearshtml,setTimeout(function(){t===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),t=e.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(e,t,i){var n=e.dpDiv.outerWidth(),r=e.dpDiv.outerHeight(),o=e.input?e.input.outerWidth():0,a=e.input?e.input.outerHeight():0,s=document.documentElement.clientWidth+(i?0:$(document).scrollLeft()),l=document.documentElement.clientHeight+(i?0:$(document).scrollTop());return t.left-=this._get(e,"isRTL")?n-o:0,t.left-=i&&t.left===e.input.offset().left?$(document).scrollLeft():0,t.top-=i&&t.top===e.input.offset().top+a?$(document).scrollTop():0,t.left-=Math.min(t.left,t.left+n>s&&s>n?Math.abs(t.left+n-s):0),t.top-=Math.min(t.top,t.top+r>l&&l>r?Math.abs(r+a):0),t},_findPos:function(e){for(var t,i=this._getInst(e),n=this._get(i,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||$.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return t=$(e).offset(),[t.left,t.top]},_hideDatepicker:function(e){var t,i,n,o,a=this._curInst;!a||e&&a!==$.data(e,r)||this._datepickerShowing&&(t=this._get(a,"showAnim"),i=this._get(a,"duration"),n=function(){$.datepicker._tidyDialog(a)},$.effects&&($.effects.effect[t]||$.effects[t])?a.dpDiv.hide(t,$.datepicker._get(a,"showOptions"),i,n):a.dpDiv["slideDown"===t?"slideUp":"fadeIn"===t?"fadeOut":"hide"](t?i:null,n),t||n(),this._datepickerShowing=!1,o=this._get(a,"onClose"),o&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if($.datepicker._curInst){var t=$(e.target),i=$.datepicker._getInst(t[0]);(t[0].id!==$.datepicker._mainDivId&&0===t.parents("#"+$.datepicker._mainDivId).length&&!t.hasClass($.datepicker.markerClassName)&&!t.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||t.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==i)&&$.datepicker._hideDatepicker()}},_adjustDate:function(e,t,i){var n=$(e),r=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(r,t+("M"===i?this._get(r,"showCurrentAtPos"):0),i),this._updateDatepicker(r))},_gotoToday:function(e){var t,i=$(e),n=this._getInst(i[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(t=new Date,n.selectedDay=t.getDate(),n.drawMonth=n.selectedMonth=t.getMonth(),n.drawYear=n.selectedYear=t.getFullYear()),this._notifyChange(n),this._adjustDate(i)},_selectMonthYear:function(e,t,i){var n=$(e),r=this._getInst(n[0]);r["selected"+("M"===i?"Month":"Year")]=r["draw"+("M"===i?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(r),this._adjustDate(n)},_selectDay:function(e,t,i,n){var r,o=$(e);$(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(r=this._getInst(o[0]),r.selectedDay=r.currentDay=$("a",n).html(),r.selectedMonth=r.currentMonth=t,r.selectedYear=r.currentYear=i,this._selectDate(e,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear)))},_clearDate:function(e){var t=$(e);this._selectDate(t,"")},_selectDate:function(e,t){var i,n=$(e),r=this._getInst(n[0]);t=null!=t?t:this._formatDate(r),r.input&&r.input.val(t),this._updateAlternate(r),i=this._get(r,"onSelect"),i?i.apply(r.input?r.input[0]:null,[t,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],"object"!=typeof r.input[0]&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t,i,n,r=this._get(e,"altField");r&&(t=this._get(e,"altFormat")||this._get(e,"dateFormat"),i=this._getDate(e),n=this.formatDate(t,i,this._getFormatConfig(e)),$(r).each(function(){$(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(e,t,i){if(null==e||null==t)throw"Invalid arguments";if(t="object"==typeof t?t.toString():t+"",""===t)return null;var n,r,o,a=0,s=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,l="string"!=typeof s?s:(new Date).getFullYear()%100+parseInt(s,10),h=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,c=(i?i.dayNames:null)||this._defaults.dayNames,u=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,f=(i?i.monthNames:null)||this._defaults.monthNames,p=-1,d=-1,m=-1,g=-1,v=!1,E,y=function(t){var i=n+1<e.length&&e.charAt(n+1)===t;return i&&n++,i},T=function(e){var i=y(e),n="@"===e?14:"!"===e?20:"y"===e&&i?4:"o"===e?3:2,r=new RegExp("^\\d{1,"+n+"}"),o=t.substring(a).match(r);if(!o)throw"Missing number at position "+a;return a+=o[0].length,parseInt(o[0],10)},x=function(e,i,n){var r=-1,o=$.map(y(e)?n:i,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if($.each(o,function(e,i){var n=i[1];return t.substr(a,n.length).toLowerCase()===n.toLowerCase()?(r=i[0],a+=n.length,!1):void 0}),-1!==r)return r+1;throw"Unknown name at position "+a},b=function(){if(t.charAt(a)!==e.charAt(n))throw"Unexpected literal at position "+a;a++};for(n=0;n<e.length;n++)if(v)"'"!==e.charAt(n)||y("'")?b():v=!1;else switch(e.charAt(n)){case"d":m=T("d");break;case"D":x("D",h,c);break;case"o":g=T("o");break;case"m":d=T("m");break;case"M":d=x("M",u,f);break;case"y":p=T("y");break;case"@":E=new Date(T("@")),p=E.getFullYear(),d=E.getMonth()+1,m=E.getDate();break;case"!":E=new Date((T("!")-this._ticksTo1970)/1e4),p=E.getFullYear(),d=E.getMonth()+1,m=E.getDate();break;case"'":y("'")?b():v=!0;break;default:b()}if(a<t.length&&(o=t.substr(a),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===p?p=(new Date).getFullYear():100>p&&(p+=(new Date).getFullYear()-(new Date).getFullYear()%100+(l>=p?0:-100)),g>-1)for(d=1,m=g;;){if(r=this._getDaysInMonth(p,d-1),r>=m)break;d++,m-=r}if(E=this._daylightSavingAdjust(new Date(p,d-1,m)),E.getFullYear()!==p||E.getMonth()+1!==d||E.getDate()!==m)throw"Invalid date";return E},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,i){if(!t)return"";var n,r=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,s=(i?i.monthNames:null)||this._defaults.monthNames,l=function(t){var i=n+1<e.length&&e.charAt(n+1)===t;return i&&n++,i},h=function(e,t,i){var n=""+t;if(l(e))for(;n.length<i;)n="0"+n;return n},c=function(e,t,i,n){return l(e)?n[t]:i[t]},u="",f=!1;if(t)for(n=0;n<e.length;n++)if(f)"'"!==e.charAt(n)||l("'")?u+=e.charAt(n):f=!1;else switch(e.charAt(n)){case"d":u+=h("d",t.getDate(),2);break;case"D":u+=c("D",t.getDay(),r,o);break;case"o":u+=h("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=h("m",t.getMonth()+1,2);break;case"M":u+=c("M",t.getMonth(),a,s);break;case"y":u+=l("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":u+=t.getTime();break;case"!":u+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":f=!0;break;default:u+=e.charAt(n)}return u},_possibleChars:function(e){var t,i="",n=!1,r=function(i){var n=t+1<e.length&&e.charAt(t+1)===i;return n&&t++,n};for(t=0;t<e.length;t++)if(n)"'"!==e.charAt(t)||r("'")?i+=e.charAt(t):n=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":r("'")?i+="'":n=!0;break;default:i+=e.charAt(t)}return i},_get:function(t,i){return t.settings[i]!==e?t.settings[i]:this._defaults[i]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),n=e.lastVal=e.input?e.input.val():null,r=this._getDefaultDate(e),o=r,a=this._getFormatConfig(e);try{o=this.parseDate(i,n,a)||r}catch(s){n=t?"":n}e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),e.currentDay=n?o.getDate():0,e.currentMonth=n?o.getMonth():0,e.currentYear=n?o.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(e,t,i){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},r=function(t){try{return $.datepicker.parseDate($.datepicker._get(e,"dateFormat"),t,$.datepicker._getFormatConfig(e))}catch(i){}for(var n=(t.toLowerCase().match(/^c/)?$.datepicker._getDate(e):null)||new Date,r=n.getFullYear(),o=n.getMonth(),a=n.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=s.exec(t);l;){switch(l[2]||"d"){case"d":case"D":a+=parseInt(l[1],10);break;case"w":case"W":a+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),a=Math.min(a,$.datepicker._getDaysInMonth(r,o));break;case"y":case"Y":r+=parseInt(l[1],10),a=Math.min(a,$.datepicker._getDaysInMonth(r,o))}l=s.exec(t)}return new Date(r,o,a)},o=null==t||""===t?i:"string"==typeof t?r(t):"number"==typeof t?isNaN(t)?i:n(t):new Date(t.getTime());return o=o&&"Invalid Date"===o.toString()?i:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var n=!t,r=e.selectedMonth,o=e.selectedYear,a=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=a.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=a.getMonth(),e.drawYear=e.selectedYear=e.currentYear=a.getFullYear(),r===e.selectedMonth&&o===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(n?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),i="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){$.datepicker._adjustDate(i,-t,"M")},next:function(){$.datepicker._adjustDate(i,+t,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(i)},selectDay:function(){return $.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return $.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return $.datepicker._selectMonthYear(i,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,n,r,o,a,s,l,h,c,u,f,p,d,m,g,v,E,y,T,x,b,_,w,R,H,M,S,C,A,D,k,P,L,N,z,F,I,O,U=new Date,V=this._daylightSavingAdjust(new Date(U.getFullYear(),U.getMonth(),U.getDate())),B=this._get(e,"isRTL"),W=this._get(e,"showButtonPanel"),j=this._get(e,"hideIfNoPrevNext"),G=this._get(e,"navigationAsDateFormat"),q=this._getNumberOfMonths(e),X=this._get(e,"showCurrentAtPos"),Y=this._get(e,"stepMonths"),K=1!==q[0]||1!==q[1],Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(e,"min"),J=this._getMinMaxDate(e,"max"),et=e.drawMonth-X,tt=e.drawYear;if(0>et&&(et+=12,tt--),J)for(t=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-q[0]*q[1]+1,J.getDate())),t=Z&&Z>t?Z:t;this._daylightSavingAdjust(new Date(tt,et,1))>t;)et--,0>et&&(et=11,tt--);for(e.drawMonth=et,e.drawYear=tt,i=this._get(e,"prevText"),i=G?this.formatDate(i,this._daylightSavingAdjust(new Date(tt,et-Y,1)),this._getFormatConfig(e)):i,n=this._canAdjustMonth(e,-1,tt,et)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>":j?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>",r=this._get(e,"nextText"),r=G?this.formatDate(r,this._daylightSavingAdjust(new Date(tt,et+Y,1)),this._getFormatConfig(e)):r,o=this._canAdjustMonth(e,1,tt,et)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+r+"</span></a>":j?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+r+"</span></a>",a=this._get(e,"currentText"),s=this._get(e,"gotoCurrent")&&e.currentDay?Q:V,a=G?this.formatDate(a,s,this._getFormatConfig(e)):a,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",h=W?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(B?l:"")+(this._isInRange(e,s)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(B?"":l)+"</div>":"",c=parseInt(this._get(e,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(e,"showWeek"),f=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),E=this._get(e,"selectOtherMonths"),y=this._getDefaultDate(e),T="",b=0;b<q[0];b++){for(_="",this.maxRows=4,w=0;w<q[1];w++){if(R=this._daylightSavingAdjust(new Date(tt,et,e.selectedDay)),H=" ui-corner-all",M="",K){if(M+="<div class='ui-datepicker-group",q[1]>1)switch(w){case 0:M+=" ui-datepicker-group-first",H=" ui-corner-"+(B?"right":"left");break;case q[1]-1:M+=" ui-datepicker-group-last",H=" ui-corner-"+(B?"left":"right");break;default:M+=" ui-datepicker-group-middle",H=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+H+"'>"+(/all|left/.test(H)&&0===b?B?o:n:"")+(/all|right/.test(H)&&0===b?B?n:o:"")+this._generateMonthYearHeader(e,et,tt,Z,J,b>0||w>0,d,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",S=u?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;7>x;x++)C=(x+c)%7,S+="<th"+((x+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+f[C]+"'>"+p[C]+"</span></th>";for(M+=S+"</tr></thead><tbody>",A=this._getDaysInMonth(tt,et),tt===e.selectedYear&&et===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),D=(this._getFirstDayOfMonth(tt,et)-c+7)%7,k=Math.ceil((D+A)/7),P=K&&this.maxRows>k?this.maxRows:k,this.maxRows=P,L=this._daylightSavingAdjust(new Date(tt,et,1-D)),N=0;P>N;N++){for(M+="<tr>",z=u?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(L)+"</td>":"",x=0;7>x;x++)F=g?g.apply(e.input?e.input[0]:null,[L]):[!0,""],I=L.getMonth()!==et,O=I&&!E||!F[0]||Z&&Z>L||J&&L>J,z+="<td class='"+((x+c+6)%7>=5?" ui-datepicker-week-end":"")+(I?" ui-datepicker-other-month":"")+(L.getTime()===R.getTime()&&et===e.selectedMonth&&e._keyEvent||y.getTime()===L.getTime()&&y.getTime()===R.getTime()?" "+this._dayOverClass:"")+(O?" "+this._unselectableClass+" ui-state-disabled":"")+(I&&!v?"":" "+F[1]+(L.getTime()===Q.getTime()?" "+this._currentClass:"")+(L.getTime()===V.getTime()?" ui-datepicker-today":""))+"'"+(I&&!v||!F[2]?"":" title='"+F[2].replace(/'/g,"&#39;")+"'")+(O?"":" data-handler='selectDay' data-event='click' data-month='"+L.getMonth()+"' data-year='"+L.getFullYear()+"'")+">"+(I&&!v?"&#xa0;":O?"<span class='ui-state-default'>"+L.getDate()+"</span>":"<a class='ui-state-default"+(L.getTime()===V.getTime()?" ui-state-highlight":"")+(L.getTime()===Q.getTime()?" ui-state-active":"")+(I?" ui-priority-secondary":"")+"' href='#'>"+L.getDate()+"</a>")+"</td>",L.setDate(L.getDate()+1),L=this._daylightSavingAdjust(L);M+=z+"</tr>"}et++,et>11&&(et=0,tt++),M+="</tbody></table>"+(K?"</div>"+(q[0]>0&&w===q[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),_+=M}T+=_}return T+=h,e._keyEvent=!1,T},_generateMonthYearHeader:function(e,t,i,n,r,o,a,s){var l,h,c,u,f,p,d,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),E=this._get(e,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",T="";if(o||!g)T+="<span class='ui-datepicker-month'>"+a[t]+"</span>";else{for(l=n&&n.getFullYear()===i,h=r&&r.getFullYear()===i,T+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!l||c>=n.getMonth())&&(!h||c<=r.getMonth())&&(T+="<option value='"+c+"'"+(c===t?" selected='selected'":"")+">"+s[c]+"</option>");T+="</select>"}if(E||(y+=T+(!o&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",o||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(e,"yearRange").split(":"),f=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?f+parseInt(e,10):parseInt(e,10);return isNaN(t)?f:t},d=p(u[0]),m=Math.max(d,p(u[1]||"")),d=n?Math.max(d,n.getFullYear()):d,m=r?Math.min(m,r.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=d;d++)e.yearshtml+="<option value='"+d+"'"+(d===i?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",y+=e.yearshtml,e.yearshtml=null}return y+=this._get(e,"yearSuffix"),E&&(y+=(!o&&g&&v?"":"&#xa0;")+T),y+="</div>"},_adjustInstDate:function(e,t,i){var n=e.drawYear+("Y"===i?t:0),r=e.drawMonth+("M"===i?t:0),o=Math.min(e.selectedDay,this._getDaysInMonth(n,r))+("D"===i?t:0),a=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,r,o)));e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),r=i&&i>t?i:t;return n&&r>n?n:r},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,n){var r=this._getNumberOfMonths(e),o=this._daylightSavingAdjust(new Date(i,n+(0>t?t:r[0]*r[1]),1));return 0>t&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(e,o)},_isInRange:function(e,t){var i,n,r=this._getMinMaxDate(e,"min"),o=this._getMinMaxDate(e,"max"),a=null,s=null,l=this._get(e,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),a=parseInt(i[0],10),s=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=n),i[1].match(/[+\-].*/)&&(s+=n)),(!r||t.getTime()>=r.getTime())&&(!o||t.getTime()<=o.getTime())&&(!a||t.getFullYear()>=a)&&(!s||t.getFullYear()<=s)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,n){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var r=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(n,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),r,this._getFormatConfig(e))}}),$.fn.datepicker=function(e){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick),$.datepicker.initialized=!0),0===$("#"+$.datepicker._mainDivId).length&&$("body").append($.datepicker.dpDiv);var t=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t)):this.each(function(){"string"==typeof e?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this].concat(t)):$.datepicker._attachDatepicker(this,e)}):$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t))},$.datepicker=new t,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.10.3"}(jQuery),function($,e){var t={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};$.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var t=$(this).css(e).offset().top;0>t&&$(this).css("top",e.top-t)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&$.fn.draggable&&this._makeDraggable(),this.options.resizable&&$.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?$(e):this.document.find(e||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:$.noop,enable:$.noop,close:function(e){var t=this;this._isOpen&&this._trigger("beforeClose",e)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||$(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){t._trigger("close",e)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return i&&!t&&this._trigger("focus",e),i},open:function(){var e=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=$(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var e=this.element.find("[autofocus]");e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(e){function t(){var e=this.document[0].activeElement,t=this.uiDialog[0]===e||$.contains(this.uiDialog[0],e);t||this._focusTabbable()}e.preventDefault(),t.call(this),this._delay(t)},_createWrapper:function(){this.uiDialog=$("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===$.ui.keyCode.ESCAPE)return e.preventDefault(),void this.close(e);if(e.keyCode===$.ui.keyCode.TAB){var t=this.uiDialog.find(":tabbable"),i=t.filter(":first"),n=t.filter(":last");e.target!==n[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==i[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(n.focus(1),e.preventDefault()):(i.focus(1),e.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=$("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){$(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=$("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),e=$("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=$("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var e=this,t=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),$.isEmptyObject(t)||$.isArray(t)&&!t.length?void this.uiDialog.removeClass("ui-dialog-buttons"):($.each(t,function(t,i){var n,r;i=$.isFunction(i)?{click:i,text:t}:i,i=$.extend({type:"button"},i),n=i.click,i.click=function(){n.apply(e.element[0],arguments)},r={icons:i.icons,text:i.showText},delete i.icons,delete i.showText,$("<button></button>",i).button(r).appendTo(e.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function e(e){return{position:e.position,offset:e.offset}}var t=this,i=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(i,n){$(this).addClass("ui-dialog-dragging"),t._blockFrames(),t._trigger("dragStart",i,e(n))},drag:function(i,n){t._trigger("drag",i,e(n))},stop:function(n,r){i.position=[r.position.left-t.document.scrollLeft(),r.position.top-t.document.scrollTop()],$(this).removeClass("ui-dialog-dragging"),t._unblockFrames(),t._trigger("dragStop",n,e(r))}})},_makeResizable:function(){function e(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var t=this,i=this.options,n=i.resizable,r=this.uiDialog.css("position"),o="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:i.maxWidth,maxHeight:i.maxHeight,minWidth:i.minWidth,minHeight:this._minHeight(),handles:o,start:function(i,n){$(this).addClass("ui-dialog-resizing"),t._blockFrames(),t._trigger("resizeStart",i,e(n))},resize:function(i,n){t._trigger("resize",i,e(n))},stop:function(n,r){i.height=$(this).height(),i.width=$(this).width(),$(this).removeClass("ui-dialog-resizing"),t._unblockFrames(),t._trigger("resizeStop",n,e(r))}}).css("position",r)},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(e){var n=this,r=!1,o={};
$.each(e,function(e,a){n._setOption(e,a),e in t&&(r=!0),e in i&&(o[e]=a)}),r&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(e,t){var i,n,r=this.uiDialog;"dialogClass"===e&&r.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=r.is(":data(ui-draggable)"),i&&!t&&r.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(n=r.is(":data(ui-resizable)"),n&&!t&&r.resizable("destroy"),n&&"string"==typeof t&&r.resizable("option","handles",t),n||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),t=Math.max(0,n.minHeight-e),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-e):"none","auto"===n.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=$(this);return $("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return $(e.target).closest(".ui-dialog").length?!0:!!$(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=this,t=this.widgetFullName;$.ui.dialog.overlayInstances||this._delay(function(){$.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(i){e._allowInteraction(i)||(i.preventDefault(),$(".ui-dialog:visible:last .ui-dialog-content").data(t)._focusTabbable())})}),this.overlay=$("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),$.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&($.ui.dialog.overlayInstances--,$.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),$.ui.dialog.overlayInstances=0,$.uiBackCompat!==!1&&$.widget("ui.dialog",$.ui.dialog,{_position:function(){var e=this.options.position,t=[],i=[0,0],n;e?(("string"==typeof e||"object"==typeof e&&"0"in e)&&(t=e.split?e.split(" "):[e[0],e[1]],1===t.length&&(t[1]=t[0]),$.each(["left","top"],function(e,n){+t[e]===t[e]&&(i[e]=t[e],t[e]=n)}),e={my:t[0]+(i[0]<0?i[0]:"+"+i[0])+" "+t[1]+(i[1]<0?i[1]:"+"+i[1]),at:t.join(" ")}),e=$.extend({},$.ui.dialog.prototype.options.position,e)):e=$.ui.dialog.prototype.options.position,n=this.uiDialog.is(":visible"),n||this.uiDialog.show(),this.uiDialog.position(e),n||this.uiDialog.hide()}})}(jQuery),function($,e){var t=/up|down|vertical/,i=/up|left|vertical|horizontal/;$.effects.effect.blind=function(e,n){var r=$(this),o=["position","top","bottom","left","right","height","width"],a=$.effects.setMode(r,e.mode||"hide"),s=e.direction||"up",l=t.test(s),h=l?"height":"width",c=l?"top":"left",u=i.test(s),f={},p="show"===a,d,m,g;r.parent().is(".ui-effects-wrapper")?$.effects.save(r.parent(),o):$.effects.save(r,o),r.show(),d=$.effects.createWrapper(r).css({overflow:"hidden"}),m=d[h](),g=parseFloat(d.css(c))||0,f[h]=p?m:0,u||(r.css(l?"bottom":"right",0).css(l?"top":"left","auto").css({position:"absolute"}),f[c]=p?g:m+g),p&&(d.css(h,0),u||d.css(c,g+m)),d.animate(f,{duration:e.duration,easing:e.easing,queue:!1,complete:function(){"hide"===a&&r.hide(),$.effects.restore(r,o),$.effects.removeWrapper(r),n()}})}}(jQuery),function($,e){$.effects.effect.bounce=function(e,t){var i=$(this),n=["position","top","bottom","left","right","height","width"],r=$.effects.setMode(i,e.mode||"effect"),o="hide"===r,a="show"===r,s=e.direction||"up",l=e.distance,h=e.times||5,c=2*h+(a||o?1:0),u=e.duration/c,f=e.easing,p="up"===s||"down"===s?"top":"left",d="up"===s||"left"===s,m,g,v,E=i.queue(),y=E.length;for((a||o)&&n.push("opacity"),$.effects.save(i,n),i.show(),$.effects.createWrapper(i),l||(l=i["top"===p?"outerHeight":"outerWidth"]()/3),a&&(v={opacity:1},v[p]=0,i.css("opacity",0).css(p,d?2*-l:2*l).animate(v,u,f)),o&&(l/=Math.pow(2,h-1)),v={},v[p]=0,m=0;h>m;m++)g={},g[p]=(d?"-=":"+=")+l,i.animate(g,u,f).animate(v,u,f),l=o?2*l:l/2;o&&(g={opacity:0},g[p]=(d?"-=":"+=")+l,i.animate(g,u,f)),i.queue(function(){o&&i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),t()}),y>1&&E.splice.apply(E,[1,0].concat(E.splice(y,c+1))),i.dequeue()}}(jQuery),function($,e){$.effects.effect.clip=function(e,t){var i=$(this),n=["position","top","bottom","left","right","height","width"],r=$.effects.setMode(i,e.mode||"hide"),o="show"===r,a=e.direction||"vertical",s="vertical"===a,l=s?"height":"width",h=s?"top":"left",c={},u,f,p;$.effects.save(i,n),i.show(),u=$.effects.createWrapper(i).css({overflow:"hidden"}),f="IMG"===i[0].tagName?u:i,p=f[l](),o&&(f.css(l,0),f.css(h,p/2)),c[l]=o?p:0,c[h]=o?0:p/2,f.animate(c,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){o||i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),t()}})}}(jQuery),function($,e){$.effects.effect.drop=function(e,t){var i=$(this),n=["position","top","bottom","left","right","opacity","height","width"],r=$.effects.setMode(i,e.mode||"hide"),o="show"===r,a=e.direction||"left",s="up"===a||"down"===a?"top":"left",l="up"===a||"left"===a?"pos":"neg",h={opacity:o?1:0},c;$.effects.save(i,n),i.show(),$.effects.createWrapper(i),c=e.distance||i["top"===s?"outerHeight":"outerWidth"](!0)/2,o&&i.css("opacity",0).css(s,"pos"===l?-c:c),h[s]=(o?"pos"===l?"+=":"-=":"pos"===l?"-=":"+=")+c,i.animate(h,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===r&&i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),t()}})}}(jQuery),function($,e){$.effects.effect.explode=function(e,t){function i(){f.push(this),f.length===r*o&&n()}function n(){a.css({visibility:"visible"}),$(f).remove(),l||a.hide(),t()}var r=e.pieces?Math.round(Math.sqrt(e.pieces)):3,o=r,a=$(this),s=$.effects.setMode(a,e.mode||"hide"),l="show"===s,h=a.show().css("visibility","hidden").offset(),c=Math.ceil(a.outerWidth()/o),u=Math.ceil(a.outerHeight()/r),f=[],p,d,m,g,v,E;for(p=0;r>p;p++)for(g=h.top+p*u,E=p-(r-1)/2,d=0;o>d;d++)m=h.left+d*c,v=d-(o-1)/2,a.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-d*c,top:-p*u}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:c,height:u,left:m+(l?v*c:0),top:g+(l?E*u:0),opacity:l?0:1}).animate({left:m+(l?0:v*c),top:g+(l?0:E*u),opacity:l?1:0},e.duration||500,e.easing,i)}}(jQuery),function($,e){$.effects.effect.fade=function(e,t){var i=$(this),n=$.effects.setMode(i,e.mode||"toggle");i.animate({opacity:n},{queue:!1,duration:e.duration,easing:e.easing,complete:t})}}(jQuery),function($,e){$.effects.effect.fold=function(e,t){var i=$(this),n=["position","top","bottom","left","right","height","width"],r=$.effects.setMode(i,e.mode||"hide"),o="show"===r,a="hide"===r,s=e.size||15,l=/([0-9]+)%/.exec(s),h=!!e.horizFirst,c=o!==h,u=c?["width","height"]:["height","width"],f=e.duration/2,p,d,m={},g={};$.effects.save(i,n),i.show(),p=$.effects.createWrapper(i).css({overflow:"hidden"}),d=c?[p.width(),p.height()]:[p.height(),p.width()],l&&(s=parseInt(l[1],10)/100*d[a?0:1]),o&&p.css(h?{height:0,width:s}:{height:s,width:0}),m[u[0]]=o?d[0]:s,g[u[1]]=o?d[1]:0,p.animate(m,f,e.easing).animate(g,f,e.easing,function(){a&&i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),t()})}}(jQuery),function($,e){$.effects.effect.highlight=function(e,t){var i=$(this),n=["backgroundImage","backgroundColor","opacity"],r=$.effects.setMode(i,e.mode||"show"),o={backgroundColor:i.css("backgroundColor")};"hide"===r&&(o.opacity=0),$.effects.save(i,n),i.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(o,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===r&&i.hide(),$.effects.restore(i,n),t()}})}}(jQuery),function($,e){$.effects.effect.pulsate=function(e,t){var i=$(this),n=$.effects.setMode(i,e.mode||"show"),r="show"===n,o="hide"===n,a=r||"hide"===n,s=2*(e.times||5)+(a?1:0),l=e.duration/s,h=0,c=i.queue(),u=c.length,f;for((r||!i.is(":visible"))&&(i.css("opacity",0).show(),h=1),f=1;s>f;f++)i.animate({opacity:h},l,e.easing),h=1-h;i.animate({opacity:h},l,e.easing),i.queue(function(){o&&i.hide(),t()}),u>1&&c.splice.apply(c,[1,0].concat(c.splice(u,s+1))),i.dequeue()}}(jQuery),function($,e){$.effects.effect.puff=function(e,t){var i=$(this),n=$.effects.setMode(i,e.mode||"hide"),r="hide"===n,o=parseInt(e.percent,10)||150,a=o/100,s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};$.extend(e,{effect:"scale",queue:!1,fade:!0,mode:n,complete:t,percent:r?o:100,from:r?s:{height:s.height*a,width:s.width*a,outerHeight:s.outerHeight*a,outerWidth:s.outerWidth*a}}),i.effect(e)},$.effects.effect.scale=function(e,t){var i=$(this),n=$.extend(!0,{},e),r=$.effects.setMode(i,e.mode||"effect"),o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===r?0:100),a=e.direction||"both",s=e.origin,l={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()},h={y:"horizontal"!==a?o/100:1,x:"vertical"!==a?o/100:1};n.effect="size",n.queue=!1,n.complete=t,"effect"!==r&&(n.origin=s||["middle","center"],n.restore=!0),n.from=e.from||("show"===r?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*h.y,width:l.width*h.x,outerHeight:l.outerHeight*h.y,outerWidth:l.outerWidth*h.x},n.fade&&("show"===r&&(n.from.opacity=0,n.to.opacity=1),"hide"===r&&(n.from.opacity=1,n.to.opacity=0)),i.effect(n)},$.effects.effect.size=function(e,t){var i,n,r,o=$(this),a=["position","top","bottom","left","right","width","height","overflow","opacity"],s=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],h=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],u=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],f=$.effects.setMode(o,e.mode||"effect"),p=e.restore||"effect"!==f,d=e.scale||"both",m=e.origin||["middle","center"],g=o.css("position"),v=p?a:s,E={height:0,width:0,outerHeight:0,outerWidth:0};"show"===f&&o.show(),i={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===e.mode&&"show"===f?(o.from=e.to||E,o.to=e.from||i):(o.from=e.from||("show"===f?E:i),o.to=e.to||("hide"===f?E:i)),r={from:{y:o.from.height/i.height,x:o.from.width/i.width},to:{y:o.to.height/i.height,x:o.to.width/i.width}},("box"===d||"both"===d)&&(r.from.y!==r.to.y&&(v=v.concat(c),o.from=$.effects.setTransition(o,c,r.from.y,o.from),o.to=$.effects.setTransition(o,c,r.to.y,o.to)),r.from.x!==r.to.x&&(v=v.concat(u),o.from=$.effects.setTransition(o,u,r.from.x,o.from),o.to=$.effects.setTransition(o,u,r.to.x,o.to))),("content"===d||"both"===d)&&r.from.y!==r.to.y&&(v=v.concat(h).concat(l),o.from=$.effects.setTransition(o,h,r.from.y,o.from),o.to=$.effects.setTransition(o,h,r.to.y,o.to)),$.effects.save(o,v),o.show(),$.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(n=$.effects.getBaseline(m,i),o.from.top=(i.outerHeight-o.outerHeight())*n.y,o.from.left=(i.outerWidth-o.outerWidth())*n.x,o.to.top=(i.outerHeight-o.to.outerHeight)*n.y,o.to.left=(i.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===d||"both"===d)&&(c=c.concat(["marginTop","marginBottom"]).concat(h),u=u.concat(["marginLeft","marginRight"]),l=a.concat(c).concat(u),o.find("*[width]").each(function(){var t=$(this),i={height:t.height(),width:t.width(),outerHeight:t.outerHeight(),outerWidth:t.outerWidth()};p&&$.effects.save(t,l),t.from={height:i.height*r.from.y,width:i.width*r.from.x,outerHeight:i.outerHeight*r.from.y,outerWidth:i.outerWidth*r.from.x},t.to={height:i.height*r.to.y,width:i.width*r.to.x,outerHeight:i.height*r.to.y,outerWidth:i.width*r.to.x},r.from.y!==r.to.y&&(t.from=$.effects.setTransition(t,c,r.from.y,t.from),t.to=$.effects.setTransition(t,c,r.to.y,t.to)),r.from.x!==r.to.x&&(t.from=$.effects.setTransition(t,u,r.from.x,t.from),t.to=$.effects.setTransition(t,u,r.to.x,t.to)),t.css(t.from),t.animate(t.to,e.duration,e.easing,function(){p&&$.effects.restore(t,l)})})),o.animate(o.to,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===f&&o.hide(),$.effects.restore(o,v),p||("static"===g?o.css({position:"relative",top:o.to.top,left:o.to.left}):$.each(["top","left"],function(e,t){o.css(t,function(t,i){var n=parseInt(i,10),r=e?o.to.left:o.to.top;return"auto"===i?r+"px":n+r+"px"})})),$.effects.removeWrapper(o),t()}})}}(jQuery),function($,e){$.effects.effect.shake=function(e,t){var i=$(this),n=["position","top","bottom","left","right","height","width"],r=$.effects.setMode(i,e.mode||"effect"),o=e.direction||"left",a=e.distance||20,s=e.times||3,l=2*s+1,h=Math.round(e.duration/l),c="up"===o||"down"===o?"top":"left",u="up"===o||"left"===o,f={},p={},d={},m,g=i.queue(),v=g.length;for($.effects.save(i,n),i.show(),$.effects.createWrapper(i),f[c]=(u?"-=":"+=")+a,p[c]=(u?"+=":"-=")+2*a,d[c]=(u?"-=":"+=")+2*a,i.animate(f,h,e.easing),m=1;s>m;m++)i.animate(p,h,e.easing).animate(d,h,e.easing);i.animate(p,h,e.easing).animate(f,h/2,e.easing).queue(function(){"hide"===r&&i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),t()}),v>1&&g.splice.apply(g,[1,0].concat(g.splice(v,l+1))),i.dequeue()}}(jQuery),function($,e){$.effects.effect.slide=function(e,t){var i=$(this),n=["position","top","bottom","left","right","width","height"],r=$.effects.setMode(i,e.mode||"show"),o="show"===r,a=e.direction||"left",s="up"===a||"down"===a?"top":"left",l="up"===a||"left"===a,h,c={};$.effects.save(i,n),i.show(),h=e.distance||i["top"===s?"outerHeight":"outerWidth"](!0),$.effects.createWrapper(i).css({overflow:"hidden"}),o&&i.css(s,l?isNaN(h)?"-"+h:-h:h),c[s]=(o?l?"+=":"-=":l?"-=":"+=")+h,i.animate(c,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===r&&i.hide(),$.effects.restore(i,n),$.effects.removeWrapper(i),t()}})}}(jQuery),function($,e){$.effects.effect.transfer=function(e,t){var i=$(this),n=$(e.to),r="fixed"===n.css("position"),o=$("body"),a=r?o.scrollTop():0,s=r?o.scrollLeft():0,l=n.offset(),h={top:l.top-a,left:l.left-s,height:n.innerHeight(),width:n.innerWidth()},c=i.offset(),u=$("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:c.top-a,left:c.left-s,height:i.innerHeight(),width:i.innerWidth(),position:r?"fixed":"absolute"}).animate(h,e.duration,e.easing,function(){u.remove(),t()})}}(jQuery),function($,e){$.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,$.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(e){var t=$(e.target).closest(".ui-menu-item");!this.mouseHandled&&t.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(e),t.has(".ui-menu").length?this.expand(e):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var t=$(e.currentTarget);t.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(e,t)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,i)},blur:function(e){this._delay(function(){$.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){$(e.target).closest(".ui-menu").length||this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=$(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){function t(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var i,n,r,o,a,s=!0;switch(e.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(e);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case $.ui.keyCode.HOME:this._move("first","first",e);break;case $.ui.keyCode.END:this._move("last","last",e);break;case $.ui.keyCode.UP:this.previous(e);break;case $.ui.keyCode.DOWN:this.next(e);break;case $.ui.keyCode.LEFT:this.collapse(e);break;case $.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(e);break;case $.ui.keyCode.ESCAPE:this.collapse(e);break;default:s=!1,n=this.previousFilter||"",r=String.fromCharCode(e.keyCode),o=!1,clearTimeout(this.filterTimer),r===n?o=!0:r=n+r,a=new RegExp("^"+t(r),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test($(this).children("a").text())}),i=o&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(r=String.fromCharCode(e.keyCode),a=new RegExp("^"+t(r),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test($(this).children("a").text())})),i.length?(this.focus(e,i),i.length>1?(this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}s&&e.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var e,t=this.options.icons.submenu,i=this.element.find(this.options.menus);i.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=$(this),i=e.prev("a"),n=$("<span>").addClass("ui-menu-icon ui-icon "+t).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(n),e.attr("aria-labelledby",i.attr("id"))}),e=i.add(this.element),e.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),e.children(":not(.ui-menu-item)").each(function(){var e=$(this);/[^\-\u2014\u2013\s]/.test(e.text())||e.addClass("ui-widget-content ui-menu-divider")}),e.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!$.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var i,n;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),n=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(e){var t,i,n,r,o,a;this._hasScroll()&&(t=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-t-i,r=this.activeMenu.scrollTop(),o=this.activeMenu.height(),a=e.height(),0>n?this.activeMenu.scrollTop(r+n):n+a>o&&this.activeMenu.scrollTop(r+n-o+a))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(e){var t=$.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(t)},collapseAll:function(e,t){clearTimeout(this.timer),this.timer=this._delay(function(){var i=t?this.element:$(e&&e.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(e),this.activeMenu=i},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var n;this.active&&(n="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(i,n)},nextPage:function(e){var t,i,n;return this.active?void(this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return t=$(this),t.offset().top-i-n<0}),this.focus(e,t)):this.focus(e,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var t,i,n;return this.active?void(this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return t=$(this),t.offset().top-i+n>0}),this.focus(e,t)):this.focus(e,this.activeMenu.children(".ui-menu-item").first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||$(e.target).closest(".ui-menu-item");var t={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,t)}})}(jQuery),function($,e){function t(e,t,i){return[parseFloat(e[0])*(f.test(e[0])?t/100:1),parseFloat(e[1])*(f.test(e[1])?i/100:1)]}function i(e,t){return parseInt($.css(e,t),10)||0}function n(e){var t=e[0];return 9===t.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:$.isWindow(t)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:t.preventDefault?{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}$.ui=$.ui||{};var r,o=Math.max,a=Math.abs,s=Math.round,l=/left|center|right/,h=/top|center|bottom/,c=/[\+\-]\d+(\.[\d]+)?%?/,u=/^\w+/,f=/%$/,p=$.fn.position;$.position={scrollbarWidth:function(){if(r!==e)return r;var t,i,n=$("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=n.children()[0];return $("body").append(n),t=o.offsetWidth,n.css("overflow","scroll"),i=o.offsetWidth,t===i&&(i=n[0].clientWidth),n.remove(),r=t-i},getScrollInfo:function(e){var t=e.isWindow?"":e.element.css("overflow-x"),i=e.isWindow?"":e.element.css("overflow-y"),n="scroll"===t||"auto"===t&&e.width<e.element[0].scrollWidth,r="scroll"===i||"auto"===i&&e.height<e.element[0].scrollHeight;return{width:r?$.position.scrollbarWidth():0,height:n?$.position.scrollbarWidth():0}},getWithinInfo:function(e){var t=$(e||window),i=$.isWindow(t[0]);return{element:t,isWindow:i,offset:t.offset()||{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:i?t.width():t.outerWidth(),height:i?t.height():t.outerHeight()}}},$.fn.position=function(e){if(!e||!e.of)return p.apply(this,arguments);e=$.extend({},e);var r,f,d,m,g,v,E=$(e.of),y=$.position.getWithinInfo(e.within),T=$.position.getScrollInfo(y),x=(e.collision||"flip").split(" "),b={};return v=n(E),E[0].preventDefault&&(e.at="left top"),f=v.width,d=v.height,m=v.offset,g=$.extend({},m),$.each(["my","at"],function(){var t=(e[this]||"").split(" "),i,n;1===t.length&&(t=l.test(t[0])?t.concat(["center"]):h.test(t[0])?["center"].concat(t):["center","center"]),t[0]=l.test(t[0])?t[0]:"center",t[1]=h.test(t[1])?t[1]:"center",i=c.exec(t[0]),n=c.exec(t[1]),b[this]=[i?i[0]:0,n?n[0]:0],e[this]=[u.exec(t[0])[0],u.exec(t[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===e.at[0]?g.left+=f:"center"===e.at[0]&&(g.left+=f/2),"bottom"===e.at[1]?g.top+=d:"center"===e.at[1]&&(g.top+=d/2),r=t(b.at,f,d),g.left+=r[0],g.top+=r[1],this.each(function(){var n,l,h=$(this),c=h.outerWidth(),u=h.outerHeight(),p=i(this,"marginLeft"),v=i(this,"marginTop"),_=c+p+i(this,"marginRight")+T.width,w=u+v+i(this,"marginBottom")+T.height,R=$.extend({},g),H=t(b.my,h.outerWidth(),h.outerHeight());"right"===e.my[0]?R.left-=c:"center"===e.my[0]&&(R.left-=c/2),"bottom"===e.my[1]?R.top-=u:"center"===e.my[1]&&(R.top-=u/2),R.left+=H[0],R.top+=H[1],$.support.offsetFractions||(R.left=s(R.left),R.top=s(R.top)),n={marginLeft:p,marginTop:v},$.each(["left","top"],function(t,i){$.ui.position[x[t]]&&$.ui.position[x[t]][i](R,{targetWidth:f,targetHeight:d,elemWidth:c,elemHeight:u,collisionPosition:n,collisionWidth:_,collisionHeight:w,offset:[r[0]+H[0],r[1]+H[1]],my:e.my,at:e.at,within:y,elem:h})}),e.using&&(l=function(t){var i=m.left-R.left,n=i+f-c,r=m.top-R.top,s=r+d-u,l={target:{element:E,left:m.left,top:m.top,width:f,height:d},element:{element:h,left:R.left,top:R.top,width:c,height:u},horizontal:0>n?"left":i>0?"right":"center",vertical:0>s?"top":r>0?"bottom":"middle"};c>f&&a(i+n)<f&&(l.horizontal="center"),u>d&&a(r+s)<d&&(l.vertical="middle"),l.important=o(a(i),a(n))>o(a(r),a(s))?"horizontal":"vertical",e.using.call(this,t,l)}),h.offset($.extend(R,{using:l}))})},$.ui.position={fit:{left:function(e,t){var i=t.within,n=i.isWindow?i.scrollLeft:i.offset.left,r=i.width,a=e.left-t.collisionPosition.marginLeft,s=n-a,l=a+t.collisionWidth-r-n,h;t.collisionWidth>r?s>0&&0>=l?(h=e.left+s+t.collisionWidth-r-n,e.left+=s-h):e.left=l>0&&0>=s?n:s>l?n+r-t.collisionWidth:n:s>0?e.left+=s:l>0?e.left-=l:e.left=o(e.left-a,e.left)},top:function(e,t){var i=t.within,n=i.isWindow?i.scrollTop:i.offset.top,r=t.within.height,a=e.top-t.collisionPosition.marginTop,s=n-a,l=a+t.collisionHeight-r-n,h;t.collisionHeight>r?s>0&&0>=l?(h=e.top+s+t.collisionHeight-r-n,e.top+=s-h):e.top=l>0&&0>=s?n:s>l?n+r-t.collisionHeight:n:s>0?e.top+=s:l>0?e.top-=l:e.top=o(e.top-a,e.top)}},flip:{left:function(e,t){var i=t.within,n=i.offset.left+i.scrollLeft,r=i.width,o=i.isWindow?i.scrollLeft:i.offset.left,s=e.left-t.collisionPosition.marginLeft,l=s-o,h=s+t.collisionWidth-r-o,c="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,u="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0],p,d;0>l?(p=e.left+c+u+f+t.collisionWidth-r-n,(0>p||p<a(l))&&(e.left+=c+u+f)):h>0&&(d=e.left-t.collisionPosition.marginLeft+c+u+f-o,(d>0||a(d)<h)&&(e.left+=c+u+f))},top:function(e,t){var i=t.within,n=i.offset.top+i.scrollTop,r=i.height,o=i.isWindow?i.scrollTop:i.offset.top,s=e.top-t.collisionPosition.marginTop,l=s-o,h=s+t.collisionHeight-r-o,c="top"===t.my[1],u=c?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,p=-2*t.offset[1],d,m;0>l?(m=e.top+u+f+p+t.collisionHeight-r-n,e.top+u+f+p>l&&(0>m||m<a(l))&&(e.top+=u+f+p)):h>0&&(d=e.top-t.collisionPosition.marginTop+u+f+p-o,e.top+u+f+p>h&&(d>0||a(d)<h)&&(e.top+=u+f+p))}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments),$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments),$.ui.position.fit.top.apply(this,arguments)}}},function(){var e,t,i,n,r,o=document.getElementsByTagName("body")[0],a=document.createElement("div");e=document.createElement(o?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&$.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(r in i)e.style[r]=i[r];e.appendChild(a),t=o||document.documentElement,t.insertBefore(e,t.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",n=$(a).offset().left,$.support.offsetFractions=n>10&&11>n,e.innerHTML="",t.removeChild(e)}()}(jQuery),function($,e){$.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=$("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return t===e?this.options.value:(this.options.value=this._constrainedValue(t),void this._refreshValue())},_constrainedValue:function(t){return t===e&&(t=this.options.value),this.indeterminate=t===!1,"number"!=typeof t&&(t=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,t=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(t.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=$("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")
}})}(jQuery),function($,e){var t=5;$.widget("ui.slider",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,t,i=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),r="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];for(t=i.values&&i.values.length||1,n.length>t&&(n.slice(t).remove(),n=n.slice(0,t)),e=n.length;t>e;e++)o.push(r);this.handles=n.add($(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){$(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,t="";e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:$.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=$("<div></div>").appendTo(this.element),t="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(t+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):this.range=$([])},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var t,i,n,r,o,a,s,l,h=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var t=Math.abs(i-h.values(e));(n>t||n===t&&(e===h._lastChangedValue||h.values(e)===c.min))&&(n=t,r=$(this),o=e)}),a=this._start(e,o),a===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,r.addClass("ui-state-active").focus(),s=r.offset(),l=!$(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-s.left-r.width()/2,top:e.pageY-s.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,o,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,n,r,o;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/t,n>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),r=this._valueMax()-this._valueMin(),o=this._valueMin()+n*r,this._trimAlignValue(o)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var n,r,o;this.options.values&&this.options.values.length?(n=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>n||1===t&&n>i)&&(i=n),i!==this.values(t)&&(r=this.values(),r[t]=i,o=this._trigger("slide",e,{handle:this.handles[t],value:i,values:r}),n=this.values(t?0:1),o!==!1&&this.values(t,i,!0))):i!==this.value()&&(o=this._trigger("slide",e,{handle:this.handles[t],value:i}),o!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,t){var i,n,r;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(t),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!$.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(i=this.options.values,n=arguments[0],r=0;r<i.length;r+=1)i[r]=this._trimAlignValue(n[r]),this._change(null,r);this._refreshValue()},_setOption:function(e,t){var i,n=0;switch("range"===e&&this.options.range===!0&&("min"===t?(this.options.value=this._values(0),this.options.values=null):"max"===t&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),$.isArray(this.options.values)&&(n=this.options.values.length),$.Widget.prototype._setOption.apply(this,arguments),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;n>i;i+=1)this._change(null,i);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,n;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,n=e-i;return 2*Math.abs(i)>=t&&(n+=i>0?t:-t),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,t,i,n,r,o=this.options.range,a=this.options,s=this,l=this._animateOff?!1:a.animate,h={};this.options.values&&this.options.values.length?this.handles.each(function(i){t=(s.values(i)-s._valueMin())/(s._valueMax()-s._valueMin())*100,h["horizontal"===s.orientation?"left":"bottom"]=t+"%",$(this).stop(1,1)[l?"animate":"css"](h,a.animate),s.options.range===!0&&("horizontal"===s.orientation?(0===i&&s.range.stop(1,1)[l?"animate":"css"]({left:t+"%"},a.animate),1===i&&s.range[l?"animate":"css"]({width:t-e+"%"},{queue:!1,duration:a.animate})):(0===i&&s.range.stop(1,1)[l?"animate":"css"]({bottom:t+"%"},a.animate),1===i&&s.range[l?"animate":"css"]({height:t-e+"%"},{queue:!1,duration:a.animate}))),e=t}):(i=this.value(),n=this._valueMin(),r=this._valueMax(),t=r!==n?(i-n)/(r-n)*100:0,h["horizontal"===this.orientation?"left":"bottom"]=t+"%",this.handle.stop(1,1)[l?"animate":"css"](h,a.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:t+"%"},a.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-t+"%"},{queue:!1,duration:a.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:t+"%"},a.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-t+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(e){var i,n,r,o,a=$(e.target).data("ui-slider-handle-index");switch(e.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,$(e.target).addClass("ui-state-active"),i=this._start(e,a),i===!1))return}switch(o=this.options.step,n=r=this.options.values&&this.options.values.length?this.values(a):this.value(),e.keyCode){case $.ui.keyCode.HOME:r=this._valueMin();break;case $.ui.keyCode.END:r=this._valueMax();break;case $.ui.keyCode.PAGE_UP:r=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/t);break;case $.ui.keyCode.PAGE_DOWN:r=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/t);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(n===this._valueMax())return;r=this._trimAlignValue(n+o);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(n===this._valueMin())return;r=this._trimAlignValue(n-o)}this._slide(e,a,r)},click:function(e){e.preventDefault()},keyup:function(e){var t=$(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,t),this._change(e,t),$(e.target).removeClass("ui-state-active"))}}})}(jQuery),function($){function e(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}$.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},t=this.element;return $.each(["min","max","step"],function(i,n){var r=t.attr(n);void 0!==r&&r.length&&(e[n]=r)}),e},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(e){function t(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i}))}var i;i=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),t.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,t.call(this)}),this._start(e)!==!1&&this._repeat(null,$(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return $(e.currentTarget).hasClass("ui-state-active")?this._start(e)===!1?!1:void this._repeat(null,$(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(e){var t=this.options,i=$.ui.keyCode;switch(e.keyCode){case i.UP:return this._repeat(null,1,e),!0;case i.DOWN:return this._repeat(null,-1,e),!0;case i.PAGE_UP:return this._repeat(null,t.page,e),!0;case i.PAGE_DOWN:return this._repeat(null,-t.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var t=this.options.incremental;return t?$.isFunction(t)?t(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,n=this.options;return t=null!==n.min?n.min:0,i=e-t,i=Math.round(i/n.step)*n.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==n.max&&e>n.max?n.max:null!==n.min&&e<n.min?n.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,void this.element.val(this._format(i))}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:e(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:e(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:e(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:e(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:e(function(e){this._stepDown((e||1)*this.options.page)}),value:function(t){return arguments.length?void e(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function($,e){function t(){return++n}function i(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(r,""))===decodeURIComponent(location.href.replace(r,""))}var n=0,r=/#.*$/;$.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var e=this,t=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",t.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(e){$(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){$(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),t.active=this._initialActive(),$.isArray(t.disabled)&&(t.disabled=$.unique(t.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(t.active):$(),this._refresh(),this.active.length&&this.load(t.active)},_initialActive:function(){var e=this.options.active,t=this.options.collapsible,i=location.hash.substring(1);return null===e&&(i&&this.tabs.each(function(t,n){return $(n).attr("aria-controls")===i?(e=t,!1):void 0}),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=this.tabs.length?0:!1)),e!==!1&&(e=this.tabs.index(this.tabs.eq(e)),-1===e&&(e=t?!1:0)),!t&&e===!1&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):$()}},_tabKeydown:function(e){var t=$(this.document[0].activeElement).closest("li"),i=this.tabs.index(t),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:i++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:n=!1,i--;break;case $.ui.keyCode.END:i=this.anchors.length-1;break;case $.ui.keyCode.HOME:i=0;break;case $.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(i);case $.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(i===this.options.active?!1:i);default:return}e.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,n),e.ctrlKey||(t.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===$.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===$.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===$.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,t){function i(){return e>n&&(e=0),0>e&&(e=n),e}for(var n=this.tabs.length-1;-1!==$.inArray(i(),this.options.disabled);)e=t?e+1:e-1;return e},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+t()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,t=this.tablist.children(":has(a[href])");e.disabled=$.map(t.filter(".ui-state-disabled"),function(e){return t.index(e)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!$.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=$()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=$()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=$(),this.anchors.each(function(t,n){var r,o,a,s=$(n).uniqueId().attr("id"),l=$(n).closest("li"),h=l.attr("aria-controls");i(n)?(r=n.hash,o=e.element.find(e._sanitizeSelector(r))):(a=e._tabId(l),r="#"+a,o=e.element.find(r),o.length||(o=e._createPanel(a),o.insertAfter(e.panels[t-1]||e.tablist)),o.attr("aria-live","polite")),o.length&&(e.panels=e.panels.add(o)),h&&l.data("ui-tabs-aria-controls",h),l.attr({"aria-controls":r.substring(1),"aria-labelledby":s}),o.attr("aria-labelledby",s)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(e){return $("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){$.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var t=0,i;i=this.tabs[t];t++)e===!0||-1!==$.inArray(t,e)?$(i).addClass("ui-state-disabled").attr("aria-disabled","true"):$(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var t={click:function(e){e.preventDefault()}};e&&$.each(e.split(" "),function(e,i){t[i]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,t),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var t,i=this.element.parent();"fill"===e?(t=i.height(),t-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=$(this),i=e.css("position");"absolute"!==i&&"fixed"!==i&&(t-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){t-=$(this).outerHeight(!0)}),this.panels.each(function(){$(this).height(Math.max(0,t-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===e&&(t=0,this.panels.each(function(){t=Math.max(t,$(this).height("").height())}).height(t))},_eventHandler:function(e){var t=this.options,i=this.active,n=$(e.currentTarget),r=n.closest("li"),o=r[0]===i[0],a=o&&t.collapsible,s=a?$():this._getPanelForTab(r),l=i.length?this._getPanelForTab(i):$(),h={oldTab:i,oldPanel:l,newTab:a?$():r,newPanel:s};e.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||o&&!t.collapsible||this._trigger("beforeActivate",e,h)===!1||(t.active=a?!1:this.tabs.index(r),this.active=o?$():r,this.xhr&&this.xhr.abort(),l.length||s.length||$.error("jQuery UI Tabs: Mismatching fragment identifier."),s.length&&this.load(this.tabs.index(r),e),this._toggle(e,h))},_toggle:function(e,t){function i(){r.running=!1,r._trigger("activate",e,t)}function n(){t.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&r.options.show?r._show(o,r.options.show,i):(o.show(),i())}var r=this,o=t.newPanel,a=t.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),n()),a.attr({"aria-expanded":"false","aria-hidden":"true"}),t.oldTab.attr("aria-selected","false"),o.length&&a.length?t.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr({"aria-expanded":"true","aria-hidden":"false"}),t.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var t,i=this._findActive(e);i[0]!==this.active[0]&&(i.length||(i=this.active),t=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:t,currentTarget:t,preventDefault:$.noop}))},_findActive:function(e){return e===!1?$():this.tabs.eq(e)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){$.data(this,"ui-tabs-destroy")?$(this).remove():$(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=$(this),t=e.data("ui-tabs-aria-controls");t?e.attr("aria-controls",t).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var i=this.options.disabled;i!==!1&&(t===e?i=!1:(t=this._getIndex(t),i=$.isArray(i)?$.map(i,function(e){return e!==t?e:null}):$.map(this.tabs,function(e,i){return i!==t?i:null})),this._setupDisabled(i))},disable:function(t){var i=this.options.disabled;if(i!==!0){if(t===e)i=!0;else{if(t=this._getIndex(t),-1!==$.inArray(t,i))return;i=$.isArray(i)?$.merge([t],i).sort():[t]}this._setupDisabled(i)}},load:function(e,t){e=this._getIndex(e);var n=this,r=this.tabs.eq(e),o=r.find(".ui-tabs-anchor"),a=this._getPanelForTab(r),s={tab:r,panel:a};i(o[0])||(this.xhr=$.ajax(this._ajaxSettings(o,t,s)),this.xhr&&"canceled"!==this.xhr.statusText&&(r.addClass("ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){a.html(e),n._trigger("load",t,s)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&n.panels.stop(!1,!0),r.removeClass("ui-tabs-loading"),a.removeAttr("aria-busy"),e===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(e,t,i){var n=this;return{url:e.attr("href"),beforeSend:function(e,r){return n._trigger("beforeLoad",t,$.extend({jqXHR:e,ajaxSettings:r},i))}}},_getPanelForTab:function(e){var t=$(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+t))}})}(jQuery),function($){function e(e,t){var i=(e.attr("aria-describedby")||"").split(/\s+/);i.push(t),e.data("ui-tooltip-id",t).attr("aria-describedby",$.trim(i.join(" ")))}function t(e){var t=e.data("ui-tooltip-id"),i=(e.attr("aria-describedby")||"").split(/\s+/),n=$.inArray(t,i);-1!==n&&i.splice(n,1),e.removeData("ui-tooltip-id"),i=$.trim(i.join(" ")),i?e.attr("aria-describedby",i):e.removeAttr("aria-describedby")}var i=0;$.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var e=$(this).attr("title")||"";return $("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(e,t){var i=this;return"disabled"===e?(this[t?"_disable":"_enable"](),void(this.options[e]=t)):(this._super(e,t),void("content"===e&&$.each(this.tooltips,function(e,t){i._updateContent(t)})))},_disable:function(){var e=this;$.each(this.tooltips,function(t,i){var n=$.Event("blur");n.target=n.currentTarget=i[0],e.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=$(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=$(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var t=this,i=$(e?e.target:this.element).closest(this.options.items);i.length&&!i.data("ui-tooltip-id")&&(i.attr("title")&&i.data("ui-tooltip-title",i.attr("title")),i.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&i.parents().each(function(){var e=$(this),i;e.data("ui-tooltip-open")&&(i=$.Event("blur"),i.target=i.currentTarget=this,t.close(i,!0)),e.attr("title")&&(e.uniqueId(),t.parents[this.id]={element:this,title:e.attr("title")},e.attr("title",""))}),this._updateContent(i,e))},_updateContent:function(e,t){var i,n=this.options.content,r=this,o=t?t.type:null;return"string"==typeof n?this._open(t,e,n):(i=n.call(e[0],function(i){e.data("ui-tooltip-open")&&r._delay(function(){t&&(t.type=o),this._open(t,e,i)})}),void(i&&this._open(t,e,i)))},_open:function(t,i,n){function r(e){l.of=e,o.is(":hidden")||o.position(l)}var o,a,s,l=$.extend({},this.options.position);if(n){if(o=this._find(i),o.length)return void o.find(".ui-tooltip-content").html(n);i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),o=this._tooltip(i),e(i,o.attr("id")),o.find(".ui-tooltip-content").html(n),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:r}),r(t)):o.position($.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(s=this.delayedShow=setInterval(function(){o.is(":visible")&&(r(l.of),clearInterval(s))},$.fx.interval)),this._trigger("open",t,{tooltip:o}),a={keyup:function(e){if(e.keyCode===$.ui.keyCode.ESCAPE){var t=$.Event(e);t.currentTarget=i[0],this.close(t,!0)}},remove:function(){this._removeTooltip(o)}},t&&"mouseover"!==t.type||(a.mouseleave="close"),t&&"focusin"!==t.type||(a.focusout="close"),this._on(!0,i,a)}},close:function(e){var i=this,n=$(e?e.currentTarget:this.element),r=this._find(n);this.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&n.attr("title",n.data("ui-tooltip-title")),t(n),r.stop(!0),this._hide(r,this.options.hide,function(){i._removeTooltip($(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&$.each(this.parents,function(e,t){$(t.element).attr("title",t.title),delete i.parents[e]
}),this.closing=!0,this._trigger("close",e,{tooltip:r}),this.closing=!1)},_tooltip:function(e){var t="ui-tooltip-"+i++,n=$("<div>").attr({id:t,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return $("<div>").addClass("ui-tooltip-content").appendTo(n),n.appendTo(this.document[0].body),this.tooltips[t]=e,n},_find:function(e){var t=e.data("ui-tooltip-id");return t?$("#"+t):$()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var e=this;$.each(this.tooltips,function(t,i){var n=$.Event("blur");n.target=n.currentTarget=i[0],e.close(n,!0),$("#"+t).remove(),i.data("ui-tooltip-title")&&(i.attr("title",i.data("ui-tooltip-title")),i.removeData("ui-tooltip-title"))})}})}(jQuery),/**
 * @license jQuery paging plugin v1.8 06/21/2010
 * http://www.xarg.org/project/jquery-color-plugin-xcolor/
 *
 * Copyright (c) 2010, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
function($,e){function t(i){function n(t,i){var n;if(e!==t&&(t=parseFloat(t)),e===i)i=255,n=255;else if(1===i){if(e===t||1===t)return 1;i=100,n=1}else n=i;return isNaN(t)||0>=t?0:t>i?n:1>t||1===i?1===n?t:t*n|0:t*n/i}function a(e,t,i){function r(e,t,i){return i=++i%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+(t-e)*(4-6*i):e}if(e=n(e,360)/360,t=n(t,1),i=n(i,1),0===t)return i=Math.round(255*i),[i,i,i];var o=.5>i?i+i*t:i+t-i*t,a=i+i-o;return[Math.round(255*r(a,o,e+1/3)),Math.round(255*r(a,o,e)),Math.round(255*r(a,o,e-1/3))]}function s(e,t,i){e=n(e,360)/60,t=n(t,1),i=n(i,1);var r=0|e,o=e-r,a=Math.round(255*i*(1-t)),s=Math.round(255*i*(1-t*o)),l=Math.round(255*i*(1-t*(1-o)));switch(i=Math.round(255*i),r){case 1:return[s,i,a];case 2:return[a,i,l];case 3:return[a,s,i];case 4:return[l,a,i];case 5:return[i,a,s]}return[i,l,a]}this.setColor=function(t){if(this.success=!0,"number"==typeof t)return this.a=(t>>24&255)/255,this.r=t>>16&255,this.g=t>>8&255,void(this.b=255&t);for(;"object"==typeof t;){if(0 in t&&1 in t&&2 in t)return this.a=n(t[3],1),this.r=n(t[0]),this.g=n(t[1]),void(this.b=n(t[2]));if("r"in t&&"g"in t&&"b"in t)return this.a=n(t.a,1),this.r=n(t.r),this.g=n(t.g),void(this.b=n(t.b));if("h"in t&&"s"in t){var i;if("l"in t)i=a(t.h,t.s,t.l);else if("v"in t)i=s(t.h,t.s,t.v);else{if(!("b"in t))break;i=s(t.h,t.s,t.b)}return this.a=n(t.a,1),this.r=i[0],this.g=i[1],void(this.b=i[2])}break}if("string"==typeof t){t=t.toLowerCase().replace(/[^a-z0-9,.()#%]/g,"");var o,l;if("transparent"===t)return void(this.a=this.r=this.g=this.b=0);if("rand"===t)return l=16777215*Math.random()|0,this.a=1,this.r=l>>16&255,this.g=l>>8&255,void(this.b=255&l);if(e!==r[t]&&(t="#"+r[t]),o=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/.exec(t))return this.a=1,this.r=parseInt(o[1],16),this.g=parseInt(o[2],16),void(this.b=parseInt(o[3],16));if(o=/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/.exec(t))return this.a=1,this.r=parseInt(o[1]+o[1],16),this.g=parseInt(o[2]+o[2],16),void(this.b=parseInt(o[3]+o[3],16));if(o=/^rgba?\((\d{1,3}),(\d{1,3}),(\d{1,3})(,([0-9.]+))?\)$/.exec(t))return this.a=n(o[5],1),this.r=n(o[1]),this.g=n(o[2]),void(this.b=n(o[3]));if(o=/^rgba?\(([0-9.]+\%),([0-9.]+\%),([0-9.]+\%)(,([0-9.]+)\%?)?\)$/.exec(t))return this.a=n(o[5],1),this.r=Math.round(2.55*n(o[1],100)),this.g=Math.round(2.55*n(o[2],100)),void(this.b=Math.round(2.55*n(o[3],100)));if(o=/^hs([bvl])a?\((\d{1,3}),(\d{1,3}),(\d{1,3})(,([0-9.]+))?\)$/.exec(t)){var h;return h="l"===o[1]?a:s,l=h(parseInt(o[2],10),parseInt(o[3],10),parseInt(o[4],10)),this.a=n(o[6],1),this.r=l[0],this.g=l[1],void(this.b=l[2])}if(o=/^(\d{1,3}),(\d{1,3}),(\d{1,3})(,([0-9.]+))?$/.exec(t))return this.a=n(o[5],1),this.r=n(o[1]),this.g=n(o[2]),void(this.b=n(o[3]))}this.success=!1},this.getColor=function(t){if(e!==t)switch(t.toLowerCase()){case"rgb":return this.getRGB();case"hsv":case"hsb":return this.getHSV();case"hsl":return this.getHSL();case"int":return this.getInt();case"array":return this.getArray();case"fraction":return this.getFraction();case"css":case"style":return this.getCSS();case"name":return this.getName()}return this.getHex()},this.getRGB=function(){return this.success?{r:this.r,g:this.g,b:this.b,a:this.a}:null},this.getCSS=function(){return this.success?0===this.a?"transparent":1===this.a?"rgb("+this.r+","+this.g+","+this.b+")":o(this.r,this.g,this.b,this.a):null},this.getArray=function(){return this.success?[this.r,this.g,this.b,100*this.a|0]:null},this.getName=function(){if(this.success){var e=null,i,n=r,o=this.getHSL();for(var a in n){var s=new t(n[a]).getHSL(),l=Math.sqrt(.5*(o.h-s.h)*(o.h-s.h)+.5*(o.s-s.s)*(o.s-s.s)+(o.l-s.l)*(o.l-s.l));(null===e||e>l)&&(e=l,i=a)}return i}return null},this.getFraction=function(){return this.success?{r:this.r/255,g:this.g/255,b:this.b/255,a:this.a}:null},this.getHSL=function(){if(this.success){var e=this.r/255,t=this.g/255,i=this.b/255,n=Math.min(e,t,i),r=Math.max(e,t,i),o=r-n,a,s,l=(r+n)/2;return 0===o?(a=0,s=0):(a=e===r?(t-i)/o:t===r?2+(i-e)/o:4+(e-t)/o,s=o/(.5>l?r+n:2-r-n)),{h:Math.round(60*((6+a)%6)),s:Math.round(100*s),l:Math.round(100*l),a:this.a}}return null},this.getHSV=function(){if(this.success){var e=this.r/255,t=this.g/255,i=this.b/255,n=Math.min(e,t,i),r=Math.max(e,t,i),o=r-n,a,s,l=r;return s=0===r?0:o/r,a=0===o?0:e===r?(t-i)/o:t===r?2+(i-e)/o:4+(e-t)/o,{h:Math.round(60*((6+a)%6)),s:Math.round(100*s),v:Math.round(100*l),a:this.a}}return null},this.getHex=function(){if(this.success){var e="0123456789abcdef",t=this.r>>4,i=this.g>>4,n=this.b>>4,r=15&this.r,o=15&this.g,a=15&this.b;return"#"+e.charAt(t)+e.charAt(r)+e.charAt(i)+e.charAt(o)+e.charAt(n)+e.charAt(a)}return null},this.getInt=function(t){return this.success?e!==t?(100*this.a|0)<<24^this.r<<16^this.g<<8^this.b:16777215&(this.r<<16^this.g<<8^this.b):null},this.toString=function(){return this.getHex()},this.setColor(i)}function i(e,i){var n="";do if(n=$.css(e,i),""!==n&&"transparent"!==n&&"rgba(0, 0, 0, 0)"!==n||$.nodeName(e,"body"))break;while(e=e.parentNode);return""===n&&(n=$.support.rgba?"transparent":"backgroundColor"===i?"white":"black"),new t(n)}function n(){this.test=function(e){var i=new t(e);return i.success?i:null},this.red=function(e){var i=new t(e);return i.success?(i.g=255,i.b=255,i):null},this.blue=function(e){var i=new t(e);return i.success?(i.r=255,i.g=255,i):null},this.green=function(e){var i=new t(e);return i.success?(i.r=255,i.b=255,i):null},this.sepia=function(e){var i=new t(e);if(i.success){var n=i.r,r=i.g,o=i.b;return i.r=Math.round(.393*n+.769*r+.189*o),i.g=Math.round(.349*n+.686*r+.168*o),i.b=Math.round(.272*n+.534*r+.131*o),i}return null},this.random=function(){return new t([255*Math.random()|0,255*Math.random()|0,255*Math.random()|0])},this.inverse=function(e){var i=new t(e);return i.success?(i.r^=255,i.g^=255,i.b^=255,i):null},this.opacity=function(e,i,n){var r=new t(e),o=new t(i);return r.success&o.success?(n>1&&(n/=100),n=Math.max(n-1+o.a,0),r.r=Math.round((o.r-r.r)*n+r.r),r.g=Math.round((o.g-r.g)*n+r.g),r.b=Math.round((o.b-r.b)*n+r.b),r):null},this.greyfilter=function(e,i){var n,r=new t(e);if(r.success){switch(i){case 1:n=.35+13*(r.r+r.g+r.b)/60;break;case 2:n=(13*(r.r+r.g+r.b)+5355)/60;break;default:n=.3*r.r+.59*r.g+.11*r.b}return r.r=r.g=r.b=Math.min(0|n,255),r}return null},this.webround=function(e){var i=new t(e);return i.success?((i.r+=51-i.r%51)>255&&(i.r=255),(i.g+=51-i.g%51)>255&&(i.g=255),(i.b+=51-i.b%51)>255&&(i.b=255),i):null},this.distance=function(e,i){var n=new t(e),r=new t(i);return n.success&r.success?Math.sqrt(3*(r.r-n.r)*(r.r-n.r)+4*(r.g-n.g)*(r.g-n.g)+2*(r.b-n.b)*(r.b-n.b)):null},this.readable=function(e,i,n){var r=new t(i),o=new t(e);if(n=n||10,r.success&o.success){var a=.299*o.r+.587*o.g+.114*o.b-.299*r.r-.587*r.g-.114*r.b;return!(a<1.5+141.162*Math.pow(.975,n)&&a>-.5-154.709*Math.pow(.99,n))}return null},this.combine=function(e,i){var n=new t(e),r=new t(i);return n.success&r.success?(n.r^=r.r,n.g^=r.g,n.b^=r.b,n):null},this.breed=function(e,i){var n=new t(e),r=new t(i),o=0,a=6;if(n.success&r.success){for(;a--;)Math.random()<.5&&(o|=15<<(a<<2));return n.r=n.r&(o>>16&255)|r.r&(o>>16&255^255),n.g=n.g&(o>>8&255)|r.g&(o>>8&255^255),n.b=n.b&(o>>0&255)|r.b&(o>>0&255^255),n}return null},this.additive=function(e,i){var n=new t(e),r=new t(i);return n.success&r.success?((n.r+=r.r)>255&&(n.r=255),(n.g+=r.g)>255&&(n.g=255),(n.b+=r.b)>255&&(n.b=255),n):null},this.subtractive=function(e,i){var n=new t(e),r=new t(i);return n.success&r.success?((n.r+=r.r-255)<0&&(n.r=0),(n.g+=r.g-255)<0&&(n.g=0),(n.b+=r.b-255)<0&&(n.b=0),n):null},this.subtract=function(e,i){var n=new t(e),r=new t(i);return n.success&r.success?((n.r-=r.r)<0&&(n.r=0),(n.g-=r.g)<0&&(n.g=0),(n.b-=r.b)<0&&(n.b=0),n):null},this.multiply=function(e,i){var n=new t(e),r=new t(i);return n.success&r.success?(n.r=n.r/255*r.r|0,n.g=n.g/255*r.g|0,n.b=n.b/255*r.b|0,n):null},this.average=function(e,i){var n=new t(e),r=new t(i);return n.success&r.success?(n.r=n.r+r.r>>1,n.g=n.g+r.g>>1,n.b=n.b+r.b>>1,n):null},this.triad=function(e){var i=new t(e);return i.success?[i,new t([i.b,i.r,i.g]),new t([i.g,i.b,i.r])]:null},this.tetrad=function(e){var i=new t(e);return i.success?[i,new t([i.b,i.r,i.b]),new t([i.b,i.g,i.r]),new t([i.r,i.b,i.r])]:null},this.gradientlevel=function(i,n,r,o){if(e===o&&(o=1),r>o)return null;var a=new t(i),s=new t(n);return a.success&s.success?(a.r=a.r+(s.r-a.r)/o*r|0,a.g=a.g+(s.g-a.g)/o*r|0,a.b=a.b+(s.b-a.b)/o*r|0,a):null},this.gradientarray=function(e,i,n){if(i>n||!e.length)return null;if(1==e.length)return new t(e[0]);var r=i*(e.length-1)/(n+1)|0,o=n/(e.length-1);return $.xcolor.gradientlevel(e[r],e[r+1],i-r*o,o)},this.nearestname=function(e){return e=new t(e),e.success?e.getName():null},this.darken=function(i,n,r){if(e===n)n=1;else if(0>n)return this.lighten(i,-n,r);e===r&&(r=32);var o=new t(i);return o.success?((o.r-=r*n)<0&&(o.r=0),(o.g-=r*n)<0&&(o.g=0),(o.b-=r*n)<0&&(o.b=0),o):null},this.lighten=function(i,n,r){if(e===n)n=1;else if(0>n)return this.darken(i,-n,r);e===r&&(r=32);var o=new t(i);return o.success?((o.r+=r*n)>255&&(o.r=255),(o.g+=r*n)>255&&(o.g=255),(o.b+=r*n)>255&&(o.b=255),o):null},this.analogous=function(i,n,r){e===n&&(n=8),e===r&&(r=30);var o=new t(i);if(o.success){var a=o.getHSV(),s=360/r,l=[o];for(a.h=(a.h-(s*n>>1)+720)%360;--n;)a.h+=s,a.h%=360,l.push(new t(a));return l}return null},this.complementary=function(e){var i=new t(e);if(i.success){var n=i.getHSL();return n.h=(n.h+180)%360,new t(n)}return null},this.splitcomplement=function(e){var i=new t(e);if(i.success){var n=i.getHSV(),r=[i];return n.h+=72,n.h%=360,r.push(new t(n)),n.h+=144,n.h%=360,r.push(new t(n)),r}return null},this.monochromatic=function(i,n){e===n&&(n=6);var r=new t(i);if(r.success){for(var o=r.getHSV(),a=[r];--n;)o.v+=20,o.v%=100,a.push(new t(o));return a}return null}}var r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},o;$.each(["color","backgroundColor","borderColor","borderTopColor","borderBottomColor","borderLeftColor","borderRightColor","outlineColor"],function(n,r){$.cssHooks[r]={set:function(e,i){e.style[r]=new t(i).getCSS()}},$.fx.step[r]=function(n){if(e===n.xinit){if("string"==typeof n.end&&-1!==n.end.indexOf(";")){var a,s=n.end.split(";");if(s.length>2){for(a in s)s[a]=-1===s[a].indexOf("native")?new t(s[a]):i(n.elem,r);n.start=null,n.end=s}else n.start=new t(s[0]),n.end=new t(s[1])}else n.start=i(n.elem,r),n.end=new t(n.end);n.xinit=1}var l=n.start,h=n.end,c=n.pos;if(null===l){var u=c*(h.length-1),f=1>c?0|u:h.length-2;l=h[f],h=h[f+1],c=u-f}n.elem.style[r]=o(l.r+c*(h.r-l.r)|0,l.g+c*(h.g-l.g)|0,l.b+c*(h.b-l.b)|0,l.a+c*(h.a-l.a))}}),$(function(){var e=document.createElement("div"),t=e.style;o=function(e,t,i,n){return"rgba("+e+","+t+","+i+","+n+")"},t.cssText="background-color:rgba(1,1,1,.5)",($.support.rgba=t.backgroundColor.indexOf("rgba")>-1)||(o=function(e,t,i){return"rgb("+e+","+t+","+i+")"})}),$.xcolor=new n,$.fn.readable=function(){var e=this[0],t="",i="";do if(""!==t||"transparent"!==(t=$.css(e,"color"))&&"rgba(0, 0, 0, 0)"!==t||(t=""),""!==i||"transparent"!==(i=$.css(e,"backgroundColor"))&&"rgba(0, 0, 0, 0)"!==i||(i=""),""!==t&&""!==i||$.nodeName(e,"body"))break;while(e=e.parentNode);return""===t&&(t="black"),""===i&&(i="white"),$.xcolor.readable(i,t)},$.fn.colorize=function(e,i,n){var r={gradient:function(e,t,i,n){return e/t},flip:function(e,t,i,n){return" "===n?i:!i},pillow:function(e,t,i,n){return e*=2,t>=e?e/t:2-e/t}};if("function"==typeof n);else{if(void 0===r[n])return;n=r[n]}e=new t(e),i=new t(i),this.each(function(){var t=this.childNodes,r=0,a=0;if(e.success&i.success){for(var s=t.length;s--;r+=t[s].textContent.length);!function l(t){var s=0,h;if(3===t.nodeType){var c=e,u=i,f=r,p,d,m=0,g,v=n;for(h=t.nodeValue.length,d=document.createElement("span"),s=0;h>s;++s)p=document.createElement("span"),g=t.nodeValue.charAt(s),m=v(a,f,m,g),p.style.color=o(c.r+m*(u.r-c.r)|0,c.g+m*(u.g-c.g)|0,c.b+m*(u.b-c.b)|0,c.a+m*(u.a-c.a)),p.appendChild(document.createTextNode(g)),d.appendChild(p),++a;t.parentNode.replaceChild(d,t)}else for(h=t.childNodes.length;h>s;++s)l(t.childNodes[s])}(this)}})}}(jQuery),!function(){function e(e,t){return t>e?-1:e>t?1:e>=t?0:0/0}function t(e){return null===e?0/0:+e}function i(e){return!isNaN(e)}function n(e){return{left:function(t,i,n,r){for(arguments.length<3&&(n=0),arguments.length<4&&(r=t.length);r>n;){var o=n+r>>>1;e(t[o],i)<0?n=o+1:r=o}return n},right:function(t,i,n,r){for(arguments.length<3&&(n=0),arguments.length<4&&(r=t.length);r>n;){var o=n+r>>>1;e(t[o],i)>0?r=o:n=o+1}return n}}}function r(e){return e.length}function o(e){for(var t=1;e*t%1;)t*=10;return t}function a(e,t){for(var i in t)Object.defineProperty(e.prototype,i,{value:t[i],enumerable:!1})}function s(){this._=Object.create(null)}function l(e){return(e+="")===vs||e[0]===Es?Es+e:e}function h(e){return(e+="")[0]===Es?e.slice(1):e}function c(e){return l(e)in this._}function u(e){return(e=l(e))in this._&&delete this._[e]}function f(){var e=[];for(var t in this._)e.push(h(t));return e}function p(){var e=0;for(var t in this._)++e;return e}function d(){for(var e in this._)return!1;return!0}function m(){this._=Object.create(null)}function g(e,t,i){return function(){var n=i.apply(t,arguments);return n===t?e:n}}function v(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var i=0,n=ys.length;n>i;++i){var r=ys[i]+t;if(r in e)return r}}function E(){}function y(){}function T(e){function t(){for(var t,n=i,r=-1,o=n.length;++r<o;)(t=n[r].on)&&t.apply(this,arguments);return e}var i=[],n=new s;return t.on=function(t,r){var o,a=n.get(t);return arguments.length<2?a&&a.on:(a&&(a.on=null,i=i.slice(0,o=i.indexOf(a)).concat(i.slice(o+1)),n.remove(t)),r&&i.push(n.set(t,{on:r})),e)},t}function x(){is.event.preventDefault()}function b(){for(var e,t=is.event;e=t.sourceEvent;)t=e;return t}function _(e){for(var t=new y,i=0,n=arguments.length;++i<n;)t[arguments[i]]=T(t);return t.of=function(i,n){return function(r){try{var o=r.sourceEvent=is.event;r.target=e,is.event=r,t[r.type].apply(i,n)}finally{is.event=o}}},t}function w(e){return xs(e,Hs),e}function R(e){return"function"==typeof e?e:function(){return bs(e,this)}}function H(e){return"function"==typeof e?e:function(){return _s(e,this)}}function M(e,t){function i(){this.removeAttribute(e)}function n(){this.removeAttributeNS(e.space,e.local)}function r(){this.setAttribute(e,t)}function o(){this.setAttributeNS(e.space,e.local,t)}function a(){var i=t.apply(this,arguments);null==i?this.removeAttribute(e):this.setAttribute(e,i)}function s(){var i=t.apply(this,arguments);null==i?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,i)}return e=is.ns.qualify(e),null==t?e.local?n:i:"function"==typeof t?e.local?s:a:e.local?o:r}function S(e){return e.trim().replace(/\s+/g," ")}function C(e){return new RegExp("(?:^|\\s+)"+is.requote(e)+"(?:\\s+|$)","g")}function A(e){return(e+"").trim().split(/^|\s+/)}function D(e,t){function i(){for(var i=-1;++i<r;)e[i](this,t)}function n(){for(var i=-1,n=t.apply(this,arguments);++i<r;)e[i](this,n)}e=A(e).map(k);var r=e.length;return"function"==typeof t?n:i}function k(e){var t=C(e);return function(i,n){if(r=i.classList)return n?r.add(e):r.remove(e);var r=i.getAttribute("class")||"";n?(t.lastIndex=0,t.test(r)||i.setAttribute("class",S(r+" "+e))):i.setAttribute("class",S(r.replace(t," ")))}}function P(e,t,i){function n(){this.style.removeProperty(e)}function r(){this.style.setProperty(e,t,i)}function o(){var n=t.apply(this,arguments);null==n?this.style.removeProperty(e):this.style.setProperty(e,n,i)}return null==t?n:"function"==typeof t?o:r}function L(e,t){function i(){delete this[e]}function n(){this[e]=t}function r(){var i=t.apply(this,arguments);null==i?delete this[e]:this[e]=i}return null==t?i:"function"==typeof t?r:n}function N(e){return"function"==typeof e?e:(e=is.ns.qualify(e)).local?function(){return this.ownerDocument.createElementNS(e.space,e.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,e)}}function z(){var e=this.parentNode;e&&e.removeChild(this)}function F(e){return{__data__:e}}function I(e){return function(){return Rs(this,e)}}function O(t){return arguments.length||(t=e),function(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}}function U(e,t){for(var i=0,n=e.length;n>i;i++)for(var r,o=e[i],a=0,s=o.length;s>a;a++)(r=o[a])&&t(r,a,i);return e}function V(e){return xs(e,Ss),e}function B(e){var t,i;return function(n,r,o){var a,s=e[o].update,l=s.length;for(o!=i&&(i=o,t=0),r>=t&&(t=r+1);!(a=s[t])&&++t<l;);return a}}function W(e,t,i){function n(){var t=this[a];t&&(this.removeEventListener(e,t,t.$),delete this[a])}function r(){var r=l(t,rs(arguments));n.call(this),this.addEventListener(e,this[a]=r,r.$=i),r._=t}function o(){var t,i=new RegExp("^__on([^.]+)"+is.requote(e)+"$");for(var n in this)if(t=n.match(i)){var r=this[n];this.removeEventListener(t[1],r,r.$),delete this[n]}}var a="__on"+e,s=e.indexOf("."),l=j;s>0&&(e=e.slice(0,s));var h=As.get(e);return h&&(e=h,l=G),s?t?r:n:t?E:o}function j(e,t){return function(i){var n=is.event;is.event=i,t[0]=this.__data__;try{e.apply(this,t)}finally{is.event=n}}}function G(e,t){var i=j(e,t);return function(e){var t=this,n=e.relatedTarget;n&&(n===t||8&n.compareDocumentPosition(t))||i.call(t,e)}}function q(){var e=".dragsuppress-"+ ++ks,t="click"+e,i=is.select(ss).on("touchmove"+e,x).on("dragstart"+e,x).on("selectstart"+e,x);if(Ds){var n=as.style,r=n[Ds];n[Ds]="none"}return function(o){if(i.on(e,null),Ds&&(n[Ds]=r),o){var a=function(){i.on(t,null)};i.on(t,function(){x(),a()},!0),setTimeout(a,0)}}}function $(e,t){t.changedTouches&&(t=t.changedTouches[0]);var i=e.ownerSVGElement||e;if(i.createSVGPoint){var n=i.createSVGPoint();if(0>Ps&&(ss.scrollX||ss.scrollY)){i=is.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var r=i[0][0].getScreenCTM();Ps=!(r.f||r.e),i.remove()}return Ps?(n.x=t.pageX,n.y=t.pageY):(n.x=t.clientX,n.y=t.clientY),n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}function X(){return is.event.changedTouches[0].identifier}function Y(){return is.event.target}function K(){return ss}function Q(e){return e>0?1:0>e?-1:0}function Z(e,t,i){return(t[0]-e[0])*(i[1]-e[1])-(t[1]-e[1])*(i[0]-e[0])}function J(e){return e>1?0:-1>e?zs:Math.acos(e)}function et(e){return e>1?Os:-1>e?-Os:Math.asin(e)}function tt(e){return((e=Math.exp(e))-1/e)/2}function it(e){return((e=Math.exp(e))+1/e)/2}function nt(e){return((e=Math.exp(2*e))-1)/(e+1)}function rt(e){return(e=Math.sin(e/2))*e}function ot(){}function at(e,t,i){return this instanceof at?(this.h=+e,this.s=+t,void(this.l=+i)):arguments.length<2?e instanceof at?new at(e.h,e.s,e.l):Tt(""+e,xt,at):new at(e,t,i)}function st(e,t,i){function n(e){return e>360?e-=360:0>e&&(e+=360),60>e?o+(a-o)*e/60:180>e?a:240>e?o+(a-o)*(240-e)/60:o}function r(e){return Math.round(255*n(e))}var o,a;return e=isNaN(e)?0:(e%=360)<0?e+360:e,t=isNaN(t)?0:0>t?0:t>1?1:t,i=0>i?0:i>1?1:i,a=.5>=i?i*(1+t):i+t-i*t,o=2*i-a,new gt(r(e+120),r(e),r(e-120))}function lt(e,t,i){return this instanceof lt?(this.h=+e,this.c=+t,void(this.l=+i)):arguments.length<2?e instanceof lt?new lt(e.h,e.c,e.l):e instanceof ct?ft(e.l,e.a,e.b):ft((e=bt((e=is.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new lt(e,t,i)}function ht(e,t,i){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new ct(i,Math.cos(e*=Us)*t,Math.sin(e)*t)}function ct(e,t,i){return this instanceof ct?(this.l=+e,this.a=+t,void(this.b=+i)):arguments.length<2?e instanceof ct?new ct(e.l,e.a,e.b):e instanceof lt?ht(e.h,e.c,e.l):bt((e=gt(e)).r,e.g,e.b):new ct(e,t,i)}function ut(e,t,i){var n=(e+16)/116,r=n+t/500,o=n-i/200;return r=pt(r)*$s,n=pt(n)*Zs,o=pt(o)*Js,new gt(mt(3.2404542*r-1.5371385*n-.4985314*o),mt(-.969266*r+1.8760108*n+.041556*o),mt(.0556434*r-.2040259*n+1.0572252*o))}function ft(e,t,i){return e>0?new lt(Math.atan2(i,t)*Vs,Math.sqrt(t*t+i*i),e):new lt(0/0,0/0,e)}function pt(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function dt(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function mt(e){return Math.round(255*(.00304>=e?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function gt(e,t,i){return this instanceof gt?(this.r=~~e,this.g=~~t,void(this.b=~~i)):arguments.length<2?e instanceof gt?new gt(e.r,e.g,e.b):Tt(""+e,gt,st):new gt(e,t,i)}function vt(e){return new gt(e>>16,255&e>>8,255&e)}function Et(e){return vt(e)+""}function yt(e){return 16>e?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function Tt(e,t,i){var n,r,o,a=0,s=0,l=0;if(n=/([a-z]+)\((.*)\)/i.exec(e))switch(r=n[2].split(","),n[1]){case"hsl":return i(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return t(wt(r[0]),wt(r[1]),wt(r[2]))}return(o=il.get(e))?t(o.r,o.g,o.b):(null==e||"#"!==e.charAt(0)||isNaN(o=parseInt(e.slice(1),16))||(4===e.length?(a=(3840&o)>>4,a=a>>4|a,s=240&o,s=s>>4|s,l=15&o,l=l<<4|l):7===e.length&&(a=(16711680&o)>>16,s=(65280&o)>>8,l=255&o)),t(a,s,l))}function xt(e,t,i){var n,r,o=Math.min(e/=255,t/=255,i/=255),a=Math.max(e,t,i),s=a-o,l=(a+o)/2;return s?(r=.5>l?s/(a+o):s/(2-a-o),n=e==a?(t-i)/s+(i>t?6:0):t==a?(i-e)/s+2:(e-t)/s+4,n*=60):(n=0/0,r=l>0&&1>l?0:n),new at(n,r,l)}function bt(e,t,i){e=_t(e),t=_t(t),i=_t(i);var n=dt((.4124564*e+.3575761*t+.1804375*i)/$s),r=dt((.2126729*e+.7151522*t+.072175*i)/Zs),o=dt((.0193339*e+.119192*t+.9503041*i)/Js);return ct(116*r-16,500*(n-r),200*(r-o))}function _t(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function wt(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*t):t}function Rt(e){return"function"==typeof e?e:function(){return e}}function Ht(e){return e}function Mt(e){return function(t,i,n){return 2===arguments.length&&"function"==typeof i&&(n=i,i=null),St(t,i,e,n)}}function St(e,t,i,n){function r(){var e,t=l.status;if(!t&&At(l)||t>=200&&300>t||304===t){try{e=i.call(o,l)}catch(n){return void a.error.call(o,n)}a.load.call(o,e)}else a.error.call(o,l)}var o={},a=is.dispatch("beforesend","progress","load","error"),s={},l=new XMLHttpRequest,h=null;return!ss.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(e)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=r:l.onreadystatechange=function(){l.readyState>3&&r()},l.onprogress=function(e){var t=is.event;is.event=e;try{a.progress.call(o,l)}finally{is.event=t}},o.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?s[e]:(null==t?delete s[e]:s[e]=t+"",o)},o.mimeType=function(e){return arguments.length?(t=null==e?null:e+"",o):t},o.responseType=function(e){return arguments.length?(h=e,o):h},o.response=function(e){return i=e,o},["get","post"].forEach(function(e){o[e]=function(){return o.send.apply(o,[e].concat(rs(arguments)))}}),o.send=function(i,n,r){if(2===arguments.length&&"function"==typeof n&&(r=n,n=null),l.open(i,e,!0),null==t||"accept"in s||(s.accept=t+",*/*"),l.setRequestHeader)for(var c in s)l.setRequestHeader(c,s[c]);return null!=t&&l.overrideMimeType&&l.overrideMimeType(t),null!=h&&(l.responseType=h),null!=r&&o.on("error",r).on("load",function(e){r(null,e)}),a.beforesend.call(o,l),l.send(null==n?null:n),o},o.abort=function(){return l.abort(),o},is.rebind(o,a,"on"),null==n?o:o.get(Ct(n))}function Ct(e){return 1===e.length?function(t,i){e(null==t?i:null)}:e}function At(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}function Dt(){var e=kt(),t=Pt()-e;t>24?(isFinite(t)&&(clearTimeout(al),al=setTimeout(Dt,t)),ol=0):(ol=1,ll(Dt))}function kt(){var e=Date.now();for(sl=nl;sl;)e>=sl.t&&(sl.f=sl.c(e-sl.t)),sl=sl.n;return e}function Pt(){for(var e,t=nl,i=1/0;t;)t.f?t=e?e.n=t.n:nl=t.n:(t.t<i&&(i=t.t),t=(e=t).n);return rl=e,i}function Lt(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function Nt(e,t){var i=Math.pow(10,3*gs(8-t));return{scale:t>8?function(e){return e/i}:function(e){return e*i},symbol:e}}function zt(e){var t=e.decimal,i=e.thousands,n=e.grouping,r=e.currency,o=n&&i?function(e,t){for(var r=e.length,o=[],a=0,s=n[0],l=0;r>0&&s>0&&(l+s+1>t&&(s=Math.max(1,t-l)),o.push(e.substring(r-=s,r+s)),!((l+=s+1)>t));)s=n[a=(a+1)%n.length];return o.reverse().join(i)}:Ht;return function(e){var i=cl.exec(e),n=i[1]||" ",a=i[2]||">",s=i[3]||"-",l=i[4]||"",h=i[5],c=+i[6],u=i[7],f=i[8],p=i[9],d=1,m="",g="",v=!1,E=!0;switch(f&&(f=+f.substring(1)),(h||"0"===n&&"="===a)&&(h=n="0",a="="),p){case"n":u=!0,p="g";break;case"%":d=100,g="%",p="f";break;case"p":d=100,g="%",p="r";break;case"b":case"o":case"x":case"X":"#"===l&&(m="0"+p.toLowerCase());case"c":E=!1;case"d":v=!0,f=0;break;case"s":d=-1,p="r"}"$"===l&&(m=r[0],g=r[1]),"r"!=p||f||(p="g"),null!=f&&("g"==p?f=Math.max(1,Math.min(21,f)):("e"==p||"f"==p)&&(f=Math.max(0,Math.min(20,f)))),p=ul.get(p)||Ft;var y=h&&u;return function(e){var i=g;if(v&&e%1)return"";var r=0>e||0===e&&0>1/e?(e=-e,"-"):"-"===s?"":s;if(0>d){var l=is.formatPrefix(e,f);e=l.scale(e),i=l.symbol+g}else e*=d;e=p(e,f);var T,x,b=e.lastIndexOf(".");if(0>b){var _=E?e.lastIndexOf("e"):-1;0>_?(T=e,x=""):(T=e.substring(0,_),x=e.substring(_))}else T=e.substring(0,b),x=t+e.substring(b+1);!h&&u&&(T=o(T,1/0));var w=m.length+T.length+x.length+(y?0:r.length),R=c>w?new Array(w=c-w+1).join(n):"";return y&&(T=o(R+T,R.length?c-x.length:1/0)),r+=m,e=T+x,("<"===a?r+e+R:">"===a?R+r+e:"^"===a?R.substring(0,w>>=1)+r+e+R.substring(w):r+(y?e:R+e))+i}}}function Ft(e){return e+""}function It(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ot(e,t,i){function n(t){var i=e(t),n=o(i,1);return n-t>t-i?i:n}function r(i){return t(i=e(new pl(i-1)),1),i}function o(e,i){return t(e=new pl(+e),i),e}function a(e,n,o){var a=r(e),s=[];if(o>1)for(;n>a;)i(a)%o||s.push(new Date(+a)),t(a,1);else for(;n>a;)s.push(new Date(+a)),t(a,1);return s}function s(e,t,i){try{pl=It;var n=new It;return n._=e,a(n,t,i)}finally{pl=Date}}e.floor=e,e.round=n,e.ceil=r,e.offset=o,e.range=a;var l=e.utc=Ut(e);return l.floor=l,l.round=Ut(n),l.ceil=Ut(r),l.offset=Ut(o),l.range=s,e}function Ut(e){return function(t,i){try{pl=It;var n=new It;return n._=t,e(n,i)._}finally{pl=Date}}}function Vt(e){function t(e){function t(t){for(var i,r,o,a=[],s=-1,l=0;++s<n;)37===e.charCodeAt(s)&&(a.push(e.slice(l,s)),null!=(r=ml[i=e.charAt(++s)])&&(i=e.charAt(++s)),(o=S[i])&&(i=o(t,null==r?"e"===i?" ":"0":r)),a.push(i),l=s+1);return a.push(e.slice(l,s)),a.join("")}var n=e.length;return t.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=i(n,e,t,0);if(r!=t.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var o=null!=n.Z&&pl!==It,a=new(o?It:pl);return"j"in n?a.setFullYear(n.y,0,n.j):"w"in n&&("W"in n||"U"in n)?(a.setFullYear(n.y,0,1),a.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(a.getDay()+5)%7:n.w+7*n.U-(a.getDay()+6)%7)):a.setFullYear(n.y,n.m,n.d),a.setHours(n.H+(0|n.Z/100),n.M+n.Z%100,n.S,n.L),o?a._:a},t.toString=function(){return e},t}function i(e,t,i,n){for(var r,o,a,s=0,l=t.length,h=i.length;l>s;){if(n>=h)return-1;if(r=t.charCodeAt(s++),37===r){if(a=t.charAt(s++),o=C[a in ml?t.charAt(s++):a],!o||(n=o(e,i,n))<0)return-1}else if(r!=i.charCodeAt(n++))return-1}return n}function n(e,t,i){b.lastIndex=0;var n=b.exec(t.slice(i));return n?(e.w=_.get(n[0].toLowerCase()),i+n[0].length):-1}function r(e,t,i){T.lastIndex=0;var n=T.exec(t.slice(i));return n?(e.w=x.get(n[0].toLowerCase()),i+n[0].length):-1}function o(e,t,i){H.lastIndex=0;var n=H.exec(t.slice(i));return n?(e.m=M.get(n[0].toLowerCase()),i+n[0].length):-1}function a(e,t,i){w.lastIndex=0;var n=w.exec(t.slice(i));return n?(e.m=R.get(n[0].toLowerCase()),i+n[0].length):-1}function s(e,t,n){return i(e,S.c.toString(),t,n)}function l(e,t,n){return i(e,S.x.toString(),t,n)}function h(e,t,n){return i(e,S.X.toString(),t,n)}function c(e,t,i){var n=y.get(t.slice(i,i+=2).toLowerCase());return null==n?-1:(e.p=n,i)}var u=e.dateTime,f=e.date,p=e.time,d=e.periods,m=e.days,g=e.shortDays,v=e.months,E=e.shortMonths;t.utc=function(e){function i(e){try{pl=It;var t=new pl;return t._=e,n(t)}finally{pl=Date}}var n=t(e);return i.parse=function(e){try{pl=It;var t=n.parse(e);return t&&t._}finally{pl=Date}},i.toString=n.toString,i},t.multi=t.utc.multi=si;var y=is.map(),T=Wt(m),x=jt(m),b=Wt(g),_=jt(g),w=Wt(v),R=jt(v),H=Wt(E),M=jt(E);d.forEach(function(e,t){y.set(e.toLowerCase(),t)});var S={a:function(e){return g[e.getDay()]},A:function(e){return m[e.getDay()]},b:function(e){return E[e.getMonth()]},B:function(e){return v[e.getMonth()]},c:t(u),d:function(e,t){return Bt(e.getDate(),t,2)},e:function(e,t){return Bt(e.getDate(),t,2)},H:function(e,t){return Bt(e.getHours(),t,2)},I:function(e,t){return Bt(e.getHours()%12||12,t,2)},j:function(e,t){return Bt(1+fl.dayOfYear(e),t,3)},L:function(e,t){return Bt(e.getMilliseconds(),t,3)},m:function(e,t){return Bt(e.getMonth()+1,t,2)},M:function(e,t){return Bt(e.getMinutes(),t,2)},p:function(e){return d[+(e.getHours()>=12)]},S:function(e,t){return Bt(e.getSeconds(),t,2)},U:function(e,t){return Bt(fl.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return Bt(fl.mondayOfYear(e),t,2)},x:t(f),X:t(p),y:function(e,t){return Bt(e.getFullYear()%100,t,2)},Y:function(e,t){return Bt(e.getFullYear()%1e4,t,4)},Z:oi,"%":function(){return"%"}},C={a:n,A:r,b:o,B:a,c:s,d:Jt,e:Jt,H:ti,I:ti,j:ei,L:ri,m:Zt,M:ii,p:c,S:ni,U:qt,w:Gt,W:Xt,x:l,X:h,y:Kt,Y:Yt,Z:Qt,"%":ai};return t}function Bt(e,t,i){var n=0>e?"-":"",r=(n?-e:e)+"",o=r.length;return n+(i>o?new Array(i-o+1).join(t)+r:r)
}function Wt(e){return new RegExp("^(?:"+e.map(is.requote).join("|")+")","i")}function jt(e){for(var t=new s,i=-1,n=e.length;++i<n;)t.set(e[i].toLowerCase(),i);return t}function Gt(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i,i+1));return n?(e.w=+n[0],i+n[0].length):-1}function qt(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i));return n?(e.U=+n[0],i+n[0].length):-1}function Xt(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i));return n?(e.W=+n[0],i+n[0].length):-1}function Yt(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i,i+4));return n?(e.y=+n[0],i+n[0].length):-1}function Kt(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i,i+2));return n?(e.y=$t(+n[0]),i+n[0].length):-1}function Qt(e,t,i){return/^[+-]\d{4}$/.test(t=t.slice(i,i+5))?(e.Z=-t,i+5):-1}function $t(e){return e+(e>68?1900:2e3)}function Zt(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i,i+2));return n?(e.m=n[0]-1,i+n[0].length):-1}function Jt(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i,i+2));return n?(e.d=+n[0],i+n[0].length):-1}function ei(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i,i+3));return n?(e.j=+n[0],i+n[0].length):-1}function ti(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i,i+2));return n?(e.H=+n[0],i+n[0].length):-1}function ii(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i,i+2));return n?(e.M=+n[0],i+n[0].length):-1}function ni(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i,i+2));return n?(e.S=+n[0],i+n[0].length):-1}function ri(e,t,i){gl.lastIndex=0;var n=gl.exec(t.slice(i,i+3));return n?(e.L=+n[0],i+n[0].length):-1}function oi(e){var t=e.getTimezoneOffset(),i=t>0?"-":"+",n=0|gs(t)/60,r=gs(t)%60;return i+Bt(n,"0",2)+Bt(r,"0",2)}function ai(e,t,i){vl.lastIndex=0;var n=vl.exec(t.slice(i,i+1));return n?i+n[0].length:-1}function si(e){for(var t=e.length,i=-1;++i<t;)e[i][0]=this(e[i][0]);return function(t){for(var i=0,n=e[i];!n[1](t);)n=e[++i];return n[0](t)}}function li(){}function hi(e,t,i){var n=i.s=e+t,r=n-e,o=n-r;i.t=e-o+(t-r)}function ci(e,t){e&&xl.hasOwnProperty(e.type)&&xl[e.type](e,t)}function ui(e,t,i){var n,r=-1,o=e.length-i;for(t.lineStart();++r<o;)n=e[r],t.point(n[0],n[1],n[2]);t.lineEnd()}function fi(e,t){var i=-1,n=e.length;for(t.polygonStart();++i<n;)ui(e[i],t,1);t.polygonEnd()}function pi(){function e(e,t){e*=Us,t=t*Us/2+zs/4;var i=e-n,a=i>=0?1:-1,s=a*i,l=Math.cos(t),h=Math.sin(t),c=o*h,u=r*l+c*Math.cos(s),f=c*a*Math.sin(s);_l.add(Math.atan2(f,u)),n=e,r=l,o=h}var t,i,n,r,o;wl.point=function(a,s){wl.point=e,n=(t=a)*Us,r=Math.cos(s=(i=s)*Us/2+zs/4),o=Math.sin(s)},wl.lineEnd=function(){e(t,i)}}function di(e){var t=e[0],i=e[1],n=Math.cos(i);return[n*Math.cos(t),n*Math.sin(t),Math.sin(i)]}function mi(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function gi(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function vi(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Ei(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function yi(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Ti(e){return[Math.atan2(e[1],e[0]),et(e[2])]}function xi(e,t){return gs(e[0]-t[0])<Ls&&gs(e[1]-t[1])<Ls}function bi(e,t){e*=Us;var i=Math.cos(t*=Us);_i(i*Math.cos(e),i*Math.sin(e),Math.sin(t))}function _i(e,t,i){++Rl,Ml+=(e-Ml)/Rl,Sl+=(t-Sl)/Rl,Cl+=(i-Cl)/Rl}function wi(){function e(e,r){e*=Us;var o=Math.cos(r*=Us),a=o*Math.cos(e),s=o*Math.sin(e),l=Math.sin(r),h=Math.atan2(Math.sqrt((h=i*l-n*s)*h+(h=n*a-t*l)*h+(h=t*s-i*a)*h),t*a+i*s+n*l);Hl+=h,Al+=h*(t+(t=a)),Dl+=h*(i+(i=s)),kl+=h*(n+(n=l)),_i(t,i,n)}var t,i,n;zl.point=function(r,o){r*=Us;var a=Math.cos(o*=Us);t=a*Math.cos(r),i=a*Math.sin(r),n=Math.sin(o),zl.point=e,_i(t,i,n)}}function Ri(){zl.point=bi}function Hi(){function e(e,t){e*=Us;var i=Math.cos(t*=Us),a=i*Math.cos(e),s=i*Math.sin(e),l=Math.sin(t),h=r*l-o*s,c=o*a-n*l,u=n*s-r*a,f=Math.sqrt(h*h+c*c+u*u),p=n*a+r*s+o*l,d=f&&-J(p)/f,m=Math.atan2(f,p);Pl+=d*h,Ll+=d*c,Nl+=d*u,Hl+=m,Al+=m*(n+(n=a)),Dl+=m*(r+(r=s)),kl+=m*(o+(o=l)),_i(n,r,o)}var t,i,n,r,o;zl.point=function(a,s){t=a,i=s,zl.point=e,a*=Us;var l=Math.cos(s*=Us);n=l*Math.cos(a),r=l*Math.sin(a),o=Math.sin(s),_i(n,r,o)},zl.lineEnd=function(){e(t,i),zl.lineEnd=Ri,zl.point=bi}}function Mi(e,t){function i(i,n){return i=e(i,n),t(i[0],i[1])}return e.invert&&t.invert&&(i.invert=function(i,n){return i=t.invert(i,n),i&&e.invert(i[0],i[1])}),i}function Si(){return!0}function Ci(e,t,i,n,r){var o=[],a=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,i=e[0],n=e[t];if(xi(i,n)){r.lineStart();for(var s=0;t>s;++s)r.point((i=e[s])[0],i[1]);return void r.lineEnd()}var l=new Di(i,e,null,!0),h=new Di(i,null,l,!1);l.o=h,o.push(l),a.push(h),l=new Di(n,e,null,!1),h=new Di(n,null,l,!0),l.o=h,o.push(l),a.push(h)}}),a.sort(t),Ai(o),Ai(a),o.length){for(var s=0,l=i,h=a.length;h>s;++s)a[s].e=l=!l;for(var c,u,f=o[0];;){for(var p=f,d=!0;p.v;)if((p=p.n)===f)return;c=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(d)for(var s=0,h=c.length;h>s;++s)r.point((u=c[s])[0],u[1]);else n(p.x,p.n.x,1,r);p=p.n}else{if(d){c=p.p.z;for(var s=c.length-1;s>=0;--s)r.point((u=c[s])[0],u[1])}else n(p.x,p.p.x,-1,r);p=p.p}p=p.o,c=p.z,d=!d}while(!p.v);r.lineEnd()}}}function Ai(e){if(t=e.length){for(var t,i,n=0,r=e[0];++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function Di(e,t,i,n){this.x=e,this.z=t,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function ki(e,t,i,n){return function(r,o){function a(t,i){var n=r(t,i);e(t=n[0],i=n[1])&&o.point(t,i)}function s(e,t){var i=r(e,t);g.point(i[0],i[1])}function l(){E.point=s,g.lineStart()}function h(){E.point=a,g.lineEnd()}function c(e,t){m.push([e,t]);var i=r(e,t);T.point(i[0],i[1])}function u(){T.lineStart(),m=[]}function f(){c(m[0][0],m[0][1]),T.lineEnd();var e,t=T.clean(),i=y.buffer(),n=i.length;if(m.pop(),d.push(m),m=null,n)if(1&t){e=i[0];var r,n=e.length-1,a=-1;if(n>0){for(x||(o.polygonStart(),x=!0),o.lineStart();++a<n;)o.point((r=e[a])[0],r[1]);o.lineEnd()}}else n>1&&2&t&&i.push(i.pop().concat(i.shift())),p.push(i.filter(Pi))}var p,d,m,g=t(o),v=r.invert(n[0],n[1]),E={point:a,lineStart:l,lineEnd:h,polygonStart:function(){E.point=c,E.lineStart=u,E.lineEnd=f,p=[],d=[]},polygonEnd:function(){E.point=a,E.lineStart=l,E.lineEnd=h,p=is.merge(p);var e=Oi(v,d);p.length?(x||(o.polygonStart(),x=!0),Ci(p,Ni,e,i,o)):e&&(x||(o.polygonStart(),x=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),x&&(o.polygonEnd(),x=!1),p=d=null},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd()}},y=Li(),T=t(y),x=!1;return E}}function Pi(e){return e.length>1}function Li(){var e,t=[];return{lineStart:function(){t.push(e=[])},point:function(t,i){e.push([t,i])},lineEnd:E,buffer:function(){var i=t;return t=[],e=null,i},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function Ni(e,t){return((e=e.x)[0]<0?e[1]-Os-Ls:Os-e[1])-((t=t.x)[0]<0?t[1]-Os-Ls:Os-t[1])}function zi(e){var t,i=0/0,n=0/0,r=0/0;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?zs:-zs,l=gs(o-i);gs(l-zs)<Ls?(e.point(i,n=(n+a)/2>0?Os:-Os),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),t=0):r!==s&&l>=zs&&(gs(i-r)<Ls&&(i-=r*Ls),gs(o-s)<Ls&&(o-=s*Ls),n=Fi(i,n,o,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),t=0),e.point(i=o,n=a),r=s},lineEnd:function(){e.lineEnd(),i=n=0/0},clean:function(){return 2-t}}}function Fi(e,t,i,n){var r,o,a=Math.sin(e-i);return gs(a)>Ls?Math.atan((Math.sin(t)*(o=Math.cos(n))*Math.sin(i)-Math.sin(n)*(r=Math.cos(t))*Math.sin(e))/(r*o*a)):(t+n)/2}function Ii(e,t,i,n){var r;if(null==e)r=i*Os,n.point(-zs,r),n.point(0,r),n.point(zs,r),n.point(zs,0),n.point(zs,-r),n.point(0,-r),n.point(-zs,-r),n.point(-zs,0),n.point(-zs,r);else if(gs(e[0]-t[0])>Ls){var o=e[0]<t[0]?zs:-zs;r=i*o/2,n.point(-o,r),n.point(0,r),n.point(o,r)}else n.point(t[0],t[1])}function Oi(e,t){var i=e[0],n=e[1],r=[Math.sin(i),-Math.cos(i),0],o=0,a=0;_l.reset();for(var s=0,l=t.length;l>s;++s){var h=t[s],c=h.length;if(c)for(var u=h[0],f=u[0],p=u[1]/2+zs/4,d=Math.sin(p),m=Math.cos(p),g=1;;){g===c&&(g=0),e=h[g];var v=e[0],E=e[1]/2+zs/4,y=Math.sin(E),T=Math.cos(E),x=v-f,b=x>=0?1:-1,_=b*x,w=_>zs,R=d*y;if(_l.add(Math.atan2(R*b*Math.sin(_),m*T+R*Math.cos(_))),o+=w?x+b*Fs:x,w^f>=i^v>=i){var H=gi(di(u),di(e));yi(H);var M=gi(r,H);yi(M);var S=(w^x>=0?-1:1)*et(M[2]);(n>S||n===S&&(H[0]||H[1]))&&(a+=w^x>=0?1:-1)}if(!g++)break;f=v,d=y,m=T,u=e}}return(-Ls>o||Ls>o&&0>_l)^1&a}function Ui(e){function t(e,t){return Math.cos(e)*Math.cos(t)>o}function i(e){var i,o,l,h,c;return{lineStart:function(){h=l=!1,c=1},point:function(u,f){var p,d=[u,f],m=t(u,f),g=a?m?0:r(u,f):m?r(u+(0>u?zs:-zs),f):0;if(!i&&(h=l=m)&&e.lineStart(),m!==l&&(p=n(i,d),(xi(i,p)||xi(d,p))&&(d[0]+=Ls,d[1]+=Ls,m=t(d[0],d[1]))),m!==l)c=0,m?(e.lineStart(),p=n(d,i),e.point(p[0],p[1])):(p=n(i,d),e.point(p[0],p[1]),e.lineEnd()),i=p;else if(s&&i&&a^m){var v;g&o||!(v=n(d,i,!0))||(c=0,a?(e.lineStart(),e.point(v[0][0],v[0][1]),e.point(v[1][0],v[1][1]),e.lineEnd()):(e.point(v[1][0],v[1][1]),e.lineEnd(),e.lineStart(),e.point(v[0][0],v[0][1])))}!m||i&&xi(i,d)||e.point(d[0],d[1]),i=d,l=m,o=g},lineEnd:function(){l&&e.lineEnd(),i=null},clean:function(){return c|(h&&l)<<1}}}function n(e,t,i){var n=di(e),r=di(t),a=[1,0,0],s=gi(n,r),l=mi(s,s),h=s[0],c=l-h*h;if(!c)return!i&&e;var u=o*l/c,f=-o*h/c,p=gi(a,s),d=Ei(a,u),m=Ei(s,f);vi(d,m);var g=p,v=mi(d,g),E=mi(g,g),y=v*v-E*(mi(d,d)-1);if(!(0>y)){var T=Math.sqrt(y),x=Ei(g,(-v-T)/E);if(vi(x,d),x=Ti(x),!i)return x;var b,_=e[0],w=t[0],R=e[1],H=t[1];_>w&&(b=_,_=w,w=b);var M=w-_,S=gs(M-zs)<Ls,C=S||Ls>M;if(!S&&R>H&&(b=R,R=H,H=b),C?S?R+H>0^x[1]<(gs(x[0]-_)<Ls?R:H):R<=x[1]&&x[1]<=H:M>zs^(_<=x[0]&&x[0]<=w)){var A=Ei(g,(-v+T)/E);return vi(A,d),[x,Ti(A)]}}}function r(t,i){var n=a?e:zs-e,r=0;return-n>t?r|=1:t>n&&(r|=2),-n>i?r|=4:i>n&&(r|=8),r}var o=Math.cos(e),a=o>0,s=gs(o)>Ls,l=dn(e,6*Us);return ki(t,i,l,a?[0,-e]:[-zs,e-zs])}function Vi(e,t,i,n){return function(r){var o,a=r.a,s=r.b,l=a.x,h=a.y,c=s.x,u=s.y,f=0,p=1,d=c-l,m=u-h;if(o=e-l,d||!(o>0)){if(o/=d,0>d){if(f>o)return;p>o&&(p=o)}else if(d>0){if(o>p)return;o>f&&(f=o)}if(o=i-l,d||!(0>o)){if(o/=d,0>d){if(o>p)return;o>f&&(f=o)}else if(d>0){if(f>o)return;p>o&&(p=o)}if(o=t-h,m||!(o>0)){if(o/=m,0>m){if(f>o)return;p>o&&(p=o)}else if(m>0){if(o>p)return;o>f&&(f=o)}if(o=n-h,m||!(0>o)){if(o/=m,0>m){if(o>p)return;o>f&&(f=o)}else if(m>0){if(f>o)return;p>o&&(p=o)}return f>0&&(r.a={x:l+f*d,y:h+f*m}),1>p&&(r.b={x:l+p*d,y:h+p*m}),r}}}}}}function Bi(e,t,i,n){function r(n,r){return gs(n[0]-e)<Ls?r>0?0:3:gs(n[0]-i)<Ls?r>0?2:1:gs(n[1]-t)<Ls?r>0?1:0:r>0?3:2}function o(e,t){return a(e.x,t.x)}function a(e,t){var i=r(e,1),n=r(t,1);return i!==n?i-n:0===i?t[1]-e[1]:1===i?e[0]-t[0]:2===i?e[1]-t[1]:t[0]-e[0]}return function(s){function l(e){for(var t=0,i=g.length,n=e[1],r=0;i>r;++r)for(var o,a=1,s=g[r],l=s.length,h=s[0];l>a;++a)o=s[a],h[1]<=n?o[1]>n&&Z(h,o,e)>0&&++t:o[1]<=n&&Z(h,o,e)<0&&--t,h=o;return 0!==t}function h(o,s,l,h){var c=0,u=0;if(null==o||(c=r(o,l))!==(u=r(s,l))||a(o,s)<0^l>0){do h.point(0===c||3===c?e:i,c>1?n:t);while((c=(c+l+4)%4)!==u)}else h.point(s[0],s[1])}function c(r,o){return r>=e&&i>=r&&o>=t&&n>=o}function u(e,t){c(e,t)&&s.point(e,t)}function f(){C.point=d,g&&g.push(v=[]),w=!0,_=!1,x=b=0/0}function p(){m&&(d(E,y),T&&_&&M.rejoin(),m.push(M.buffer())),C.point=u,_&&s.lineEnd()}function d(e,t){e=Math.max(-Il,Math.min(Il,e)),t=Math.max(-Il,Math.min(Il,t));var i=c(e,t);if(g&&v.push([e,t]),w)E=e,y=t,T=i,w=!1,i&&(s.lineStart(),s.point(e,t));else if(i&&_)s.point(e,t);else{var n={a:{x:x,y:b},b:{x:e,y:t}};S(n)?(_||(s.lineStart(),s.point(n.a.x,n.a.y)),s.point(n.b.x,n.b.y),i||s.lineEnd(),R=!1):i&&(s.lineStart(),s.point(e,t),R=!1)}x=e,b=t,_=i}var m,g,v,E,y,T,x,b,_,w,R,H=s,M=Li(),S=Vi(e,t,i,n),C={point:u,lineStart:f,lineEnd:p,polygonStart:function(){s=M,m=[],g=[],R=!0},polygonEnd:function(){s=H,m=is.merge(m);var t=l([e,n]),i=R&&t,r=m.length;(i||r)&&(s.polygonStart(),i&&(s.lineStart(),h(null,null,1,s),s.lineEnd()),r&&Ci(m,o,t,h,s),s.polygonEnd()),m=g=v=null}};return C}}function Wi(e){var t=0,i=zs/3,n=an(e),r=n(t,i);return r.parallels=function(e){return arguments.length?n(t=e[0]*zs/180,i=e[1]*zs/180):[180*(t/zs),180*(i/zs)]},r}function ji(e,t){function i(e,t){var i=Math.sqrt(o-2*r*Math.sin(t))/r;return[i*Math.sin(e*=r),a-i*Math.cos(e)]}var n=Math.sin(e),r=(n+Math.sin(t))/2,o=1+n*(2*r-n),a=Math.sqrt(o)/r;return i.invert=function(e,t){var i=a-t;return[Math.atan2(e,i)/r,et((o-(e*e+i*i)*r*r)/(2*r))]},i}function Gi(){function e(e,t){Ul+=r*e-n*t,n=e,r=t}var t,i,n,r;Gl.point=function(o,a){Gl.point=e,t=n=o,i=r=a},Gl.lineEnd=function(){e(t,i)}}function qi(e,t){Vl>e&&(Vl=e),e>Wl&&(Wl=e),Bl>t&&(Bl=t),t>jl&&(jl=t)}function Xi(){function e(e,t){a.push("M",e,",",t,o)}function t(e,t){a.push("M",e,",",t),s.point=i}function i(e,t){a.push("L",e,",",t)}function n(){s.point=e}function r(){a.push("Z")}var o=Yi(4.5),a=[],s={point:e,lineStart:function(){s.point=t},lineEnd:n,polygonStart:function(){s.lineEnd=r},polygonEnd:function(){s.lineEnd=n,s.point=e},pointRadius:function(e){return o=Yi(e),s},result:function(){if(a.length){var e=a.join("");return a=[],e}}};return s}function Yi(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Ki(e,t){Ml+=e,Sl+=t,++Cl}function Qi(){function e(e,n){var r=e-t,o=n-i,a=Math.sqrt(r*r+o*o);Al+=a*(t+e)/2,Dl+=a*(i+n)/2,kl+=a,Ki(t=e,i=n)}var t,i;Xl.point=function(n,r){Xl.point=e,Ki(t=n,i=r)}}function $i(){Xl.point=Ki}function Zi(){function e(e,t){var i=e-n,o=t-r,a=Math.sqrt(i*i+o*o);Al+=a*(n+e)/2,Dl+=a*(r+t)/2,kl+=a,a=r*e-n*t,Pl+=a*(n+e),Ll+=a*(r+t),Nl+=3*a,Ki(n=e,r=t)}var t,i,n,r;Xl.point=function(o,a){Xl.point=e,Ki(t=n=o,i=r=a)},Xl.lineEnd=function(){e(t,i)}}function Ji(e){function t(t,i){e.moveTo(t+a,i),e.arc(t,i,a,0,Fs)}function i(t,i){e.moveTo(t,i),s.point=n}function n(t,i){e.lineTo(t,i)}function r(){s.point=t}function o(){e.closePath()}var a=4.5,s={point:t,lineStart:function(){s.point=i},lineEnd:r,polygonStart:function(){s.lineEnd=o},polygonEnd:function(){s.lineEnd=r,s.point=t},pointRadius:function(e){return a=e,s},result:E};return s}function en(e){function t(e){return(s?n:i)(e)}function i(t){return rn(t,function(i,n){i=e(i,n),t.point(i[0],i[1])})}function n(t){function i(i,n){i=e(i,n),t.point(i[0],i[1])}function n(){y=0/0,w.point=o,t.lineStart()}function o(i,n){var o=di([i,n]),a=e(i,n);r(y,T,E,x,b,_,y=a[0],T=a[1],E=i,x=o[0],b=o[1],_=o[2],s,t),t.point(y,T)}function a(){w.point=i,t.lineEnd()}function l(){n(),w.point=h,w.lineEnd=c}function h(e,t){o(u=e,f=t),p=y,d=T,m=x,g=b,v=_,w.point=o}function c(){r(y,T,E,x,b,_,p,d,u,m,g,v,s,t),w.lineEnd=a,a()}var u,f,p,d,m,g,v,E,y,T,x,b,_,w={point:i,lineStart:n,lineEnd:a,polygonStart:function(){t.polygonStart(),w.lineStart=l},polygonEnd:function(){t.polygonEnd(),w.lineStart=n}};return w}function r(t,i,n,s,l,h,c,u,f,p,d,m,g,v){var E=c-t,y=u-i,T=E*E+y*y;if(T>4*o&&g--){var x=s+p,b=l+d,_=h+m,w=Math.sqrt(x*x+b*b+_*_),R=Math.asin(_/=w),H=gs(gs(_)-1)<Ls||gs(n-f)<Ls?(n+f)/2:Math.atan2(b,x),M=e(H,R),S=M[0],C=M[1],A=S-t,D=C-i,k=y*A-E*D;(k*k/T>o||gs((E*A+y*D)/T-.5)>.3||a>s*p+l*d+h*m)&&(r(t,i,n,s,l,h,S,C,H,x/=w,b/=w,_,g,v),v.point(S,C),r(S,C,H,x,b,_,c,u,f,p,d,m,g,v))}}var o=.5,a=Math.cos(30*Us),s=16;return t.precision=function(e){return arguments.length?(s=(o=e*e)>0&&16,t):Math.sqrt(o)},t}function tn(e){var t=en(function(t,i){return e([t*Vs,i*Vs])});return function(e){return sn(t(e))}}function nn(e){this.stream=e}function rn(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function on(e){return an(function(){return e})()}function an(e){function t(e){return e=s(e[0]*Us,e[1]*Us),[e[0]*f+l,h-e[1]*f]}function i(e){return e=s.invert((e[0]-l)/f,(h-e[1])/f),e&&[e[0]*Vs,e[1]*Vs]}function n(){s=Mi(a=cn(v,E,y),o);var e=o(m,g);return l=p-e[0]*f,h=d+e[1]*f,r()}function r(){return c&&(c.valid=!1,c=null),t}var o,a,s,l,h,c,u=en(function(e,t){return e=o(e,t),[e[0]*f+l,h-e[1]*f]}),f=150,p=480,d=250,m=0,g=0,v=0,E=0,y=0,T=Fl,x=Ht,b=null,_=null;return t.stream=function(e){return c&&(c.valid=!1),c=sn(T(a,u(x(e)))),c.valid=!0,c},t.clipAngle=function(e){return arguments.length?(T=null==e?(b=e,Fl):Ui((b=+e)*Us),r()):b},t.clipExtent=function(e){return arguments.length?(_=e,x=e?Bi(e[0][0],e[0][1],e[1][0],e[1][1]):Ht,r()):_},t.scale=function(e){return arguments.length?(f=+e,n()):f},t.translate=function(e){return arguments.length?(p=+e[0],d=+e[1],n()):[p,d]},t.center=function(e){return arguments.length?(m=e[0]%360*Us,g=e[1]%360*Us,n()):[m*Vs,g*Vs]},t.rotate=function(e){return arguments.length?(v=e[0]%360*Us,E=e[1]%360*Us,y=e.length>2?e[2]%360*Us:0,n()):[v*Vs,E*Vs,y*Vs]},is.rebind(t,u,"precision"),function(){return o=e.apply(this,arguments),t.invert=o.invert&&i,n()}}function sn(e){return rn(e,function(t,i){e.point(t*Us,i*Us)})}function ln(e,t){return[e,t]}function hn(e,t){return[e>zs?e-Fs:-zs>e?e+Fs:e,t]}function cn(e,t,i){return e?t||i?Mi(fn(e),pn(t,i)):fn(e):t||i?pn(t,i):hn}function un(e){return function(t,i){return t+=e,[t>zs?t-Fs:-zs>t?t+Fs:t,i]}}function fn(e){var t=un(e);return t.invert=un(-e),t}function pn(e,t){function i(e,t){var i=Math.cos(t),s=Math.cos(e)*i,l=Math.sin(e)*i,h=Math.sin(t),c=h*n+s*r;return[Math.atan2(l*o-c*a,s*n-h*r),et(c*o+l*a)]}var n=Math.cos(e),r=Math.sin(e),o=Math.cos(t),a=Math.sin(t);return i.invert=function(e,t){var i=Math.cos(t),s=Math.cos(e)*i,l=Math.sin(e)*i,h=Math.sin(t),c=h*o-l*a;return[Math.atan2(l*o+h*a,s*n+c*r),et(c*n-s*r)]},i}function dn(e,t){var i=Math.cos(e),n=Math.sin(e);return function(r,o,a,s){var l=a*t;null!=r?(r=mn(i,r),o=mn(i,o),(a>0?o>r:r>o)&&(r+=a*Fs)):(r=e+a*Fs,o=e-.5*l);for(var h,c=r;a>0?c>o:o>c;c-=l)s.point((h=Ti([i,-n*Math.cos(c),-n*Math.sin(c)]))[0],h[1])}}function mn(e,t){var i=di(t);i[0]-=e,yi(i);var n=J(-i[1]);return((-i[2]<0?-n:n)+2*Math.PI-Ls)%(2*Math.PI)}function gn(e,t,i){var n=is.range(e,t-Ls,i).concat(t);return function(e){return n.map(function(t){return[e,t]})}}function vn(e,t,i){var n=is.range(e,t-Ls,i).concat(t);return function(e){return n.map(function(t){return[t,e]})}}function En(e){return e.source}function yn(e){return e.target}function Tn(e,t,i,n){var r=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n),l=r*Math.cos(e),h=r*Math.sin(e),c=a*Math.cos(i),u=a*Math.sin(i),f=2*Math.asin(Math.sqrt(rt(n-t)+r*a*rt(i-e))),p=1/Math.sin(f),d=f?function(e){var t=Math.sin(e*=f)*p,i=Math.sin(f-e)*p,n=i*l+t*c,r=i*h+t*u,a=i*o+t*s;return[Math.atan2(r,n)*Vs,Math.atan2(a,Math.sqrt(n*n+r*r))*Vs]}:function(){return[e*Vs,t*Vs]};return d.distance=f,d}function xn(){function e(e,r){var o=Math.sin(r*=Us),a=Math.cos(r),s=gs((e*=Us)-t),l=Math.cos(s);Yl+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=n*o-i*a*l)*s),i*o+n*a*l),t=e,i=o,n=a}var t,i,n;Kl.point=function(r,o){t=r*Us,i=Math.sin(o*=Us),n=Math.cos(o),Kl.point=e},Kl.lineEnd=function(){Kl.point=Kl.lineEnd=E}}function bn(e,t){function i(t,i){var n=Math.cos(t),r=Math.cos(i),o=e(n*r);return[o*r*Math.sin(t),o*Math.sin(i)]}return i.invert=function(e,i){var n=Math.sqrt(e*e+i*i),r=t(n),o=Math.sin(r),a=Math.cos(r);return[Math.atan2(e*o,n*a),Math.asin(n&&i*o/n)]},i}function _n(e,t){function i(e,t){a>0?-Os+Ls>t&&(t=-Os+Ls):t>Os-Ls&&(t=Os-Ls);var i=a/Math.pow(r(t),o);return[i*Math.sin(o*e),a-i*Math.cos(o*e)]}var n=Math.cos(e),r=function(e){return Math.tan(zs/4+e/2)},o=e===t?Math.sin(e):Math.log(n/Math.cos(t))/Math.log(r(t)/r(e)),a=n*Math.pow(r(e),o)/o;return o?(i.invert=function(e,t){var i=a-t,n=Q(o)*Math.sqrt(e*e+i*i);return[Math.atan2(e,i)/o,2*Math.atan(Math.pow(a/n,1/o))-Os]},i):Rn}function wn(e,t){function i(e,t){var i=o-t;return[i*Math.sin(r*e),o-i*Math.cos(r*e)]}var n=Math.cos(e),r=e===t?Math.sin(e):(n-Math.cos(t))/(t-e),o=n/r+e;return gs(r)<Ls?ln:(i.invert=function(e,t){var i=o-t;return[Math.atan2(e,i)/r,o-Q(r)*Math.sqrt(e*e+i*i)]},i)}function Rn(e,t){return[e,Math.log(Math.tan(zs/4+t/2))]}function Hn(e){var t,i=on(e),n=i.scale,r=i.translate,o=i.clipExtent;return i.scale=function(){var e=n.apply(i,arguments);return e===i?t?i.clipExtent(null):i:e},i.translate=function(){var e=r.apply(i,arguments);return e===i?t?i.clipExtent(null):i:e},i.clipExtent=function(e){var a=o.apply(i,arguments);if(a===i){if(t=null==e){var s=zs*n(),l=r();o([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else t&&(a=null);return a},i.clipExtent(null)}function Mn(e,t){return[Math.log(Math.tan(zs/4+t/2)),-e]}function Sn(e){return e[0]}function Cn(e){return e[1]}function An(e){for(var t=e.length,i=[0,1],n=2,r=2;t>r;r++){for(;n>1&&Z(e[i[n-2]],e[i[n-1]],e[r])<=0;)--n;i[n++]=r}return i.slice(0,n)}function Dn(e,t){return e[0]-t[0]||e[1]-t[1]}function kn(e,t,i){return(i[0]-t[0])*(e[1]-t[1])<(i[1]-t[1])*(e[0]-t[0])}function Pn(e,t,i,n){var r=e[0],o=i[0],a=t[0]-r,s=n[0]-o,l=e[1],h=i[1],c=t[1]-l,u=n[1]-h,f=(s*(l-h)-u*(r-o))/(u*a-s*c);return[r+f*a,l+f*c]}function Ln(e){var t=e[0],i=e[e.length-1];return!(t[0]-i[0]||t[1]-i[1])}function Nn(){ir(this),this.edge=this.site=this.circle=null}function zn(e){var t=sh.pop()||new Nn;return t.site=e,t}function Fn(e){Xn(e),rh.remove(e),sh.push(e),ir(e)}function In(e){var t=e.circle,i=t.x,n=t.cy,r={x:i,y:n},o=e.P,a=e.N,s=[e];Fn(e);for(var l=o;l.circle&&gs(i-l.circle.x)<Ls&&gs(n-l.circle.cy)<Ls;)o=l.P,s.unshift(l),Fn(l),l=o;s.unshift(l),Xn(l);for(var h=a;h.circle&&gs(i-h.circle.x)<Ls&&gs(n-h.circle.cy)<Ls;)a=h.N,s.push(h),Fn(h),h=a;s.push(h),Xn(h);var c,u=s.length;for(c=1;u>c;++c)h=s[c],l=s[c-1],Jn(h.edge,l.site,h.site,r);l=s[0],h=s[u-1],h.edge=$n(l.site,h.site,null,r),qn(l),qn(h)}function On(e){for(var t,i,n,r,o=e.x,a=e.y,s=rh._;s;)if(n=Un(s,a)-o,n>Ls)s=s.L;else{if(r=o-Vn(s,a),!(r>Ls)){n>-Ls?(t=s.P,i=s):r>-Ls?(t=s,i=s.N):t=i=s;break}if(!s.R){t=s;break}s=s.R}var l=zn(e);if(rh.insert(t,l),t||i){if(t===i)return Xn(t),i=zn(t.site),rh.insert(l,i),l.edge=i.edge=$n(t.site,l.site),qn(t),void qn(i);if(!i)return void(l.edge=$n(t.site,l.site));Xn(t),Xn(i);var h=t.site,c=h.x,u=h.y,f=e.x-c,p=e.y-u,d=i.site,m=d.x-c,g=d.y-u,v=2*(f*g-p*m),E=f*f+p*p,y=m*m+g*g,T={x:(g*E-p*y)/v+c,y:(f*y-m*E)/v+u};Jn(i.edge,h,d,T),l.edge=$n(h,e,null,T),i.edge=$n(e,d,null,T),qn(t),qn(i)}}function Un(e,t){var i=e.site,n=i.x,r=i.y,o=r-t;if(!o)return n;var a=e.P;if(!a)return-1/0;i=a.site;var s=i.x,l=i.y,h=l-t;if(!h)return s;var c=s-n,u=1/o-1/h,f=c/h;return u?(-f+Math.sqrt(f*f-2*u*(c*c/(-2*h)-l+h/2+r-o/2)))/u+n:(n+s)/2}function Vn(e,t){var i=e.N;if(i)return Un(i,t);var n=e.site;return n.y===t?n.x:1/0}function Bn(e){this.site=e,this.edges=[]}function Wn(e){for(var t,i,n,r,o,a,s,l,h,c,u=e[0][0],f=e[1][0],p=e[0][1],d=e[1][1],m=nh,g=m.length;g--;)if(o=m[g],o&&o.prepare())for(s=o.edges,l=s.length,a=0;l>a;)c=s[a].end(),n=c.x,r=c.y,h=s[++a%l].start(),t=h.x,i=h.y,(gs(n-t)>Ls||gs(r-i)>Ls)&&(s.splice(a,0,new er(Zn(o.site,c,gs(n-u)<Ls&&d-r>Ls?{x:u,y:gs(t-u)<Ls?i:d}:gs(r-d)<Ls&&f-n>Ls?{x:gs(i-d)<Ls?t:f,y:d}:gs(n-f)<Ls&&r-p>Ls?{x:f,y:gs(t-f)<Ls?i:p}:gs(r-p)<Ls&&n-u>Ls?{x:gs(i-p)<Ls?t:u,y:p}:null),o.site,null)),++l)}function jn(e,t){return t.angle-e.angle}function Gn(){ir(this),this.x=this.y=this.arc=this.site=this.cy=null}function qn(e){var t=e.P,i=e.N;if(t&&i){var n=t.site,r=e.site,o=i.site;if(n!==o){var a=r.x,s=r.y,l=n.x-a,h=n.y-s,c=o.x-a,u=o.y-s,f=2*(l*u-h*c);if(!(f>=-Ns)){var p=l*l+h*h,d=c*c+u*u,m=(u*p-h*d)/f,g=(l*d-c*p)/f,u=g+s,v=lh.pop()||new Gn;v.arc=e,v.site=r,v.x=m+a,v.y=u+Math.sqrt(m*m+g*g),v.cy=u,e.circle=v;for(var E=null,y=ah._;y;)if(v.y<y.y||v.y===y.y&&v.x<=y.x){if(!y.L){E=y.P;break}y=y.L}else{if(!y.R){E=y;break}y=y.R}ah.insert(E,v),E||(oh=v)}}}}function Xn(e){var t=e.circle;t&&(t.P||(oh=t.N),ah.remove(t),lh.push(t),ir(t),e.circle=null)}function Yn(e){for(var t,i=ih,n=Vi(e[0][0],e[0][1],e[1][0],e[1][1]),r=i.length;r--;)t=i[r],(!Kn(t,e)||!n(t)||gs(t.a.x-t.b.x)<Ls&&gs(t.a.y-t.b.y)<Ls)&&(t.a=t.b=null,i.splice(r,1))}function Kn(e,t){var i=e.b;if(i)return!0;var n,r,o=e.a,a=t[0][0],s=t[1][0],l=t[0][1],h=t[1][1],c=e.l,u=e.r,f=c.x,p=c.y,d=u.x,m=u.y,g=(f+d)/2,v=(p+m)/2;if(m===p){if(a>g||g>=s)return;if(f>d){if(o){if(o.y>=h)return}else o={x:g,y:l};i={x:g,y:h}}else{if(o){if(o.y<l)return}else o={x:g,y:h};i={x:g,y:l}}}else if(n=(f-d)/(m-p),r=v-n*g,-1>n||n>1)if(f>d){if(o){if(o.y>=h)return}else o={x:(l-r)/n,y:l};i={x:(h-r)/n,y:h}}else{if(o){if(o.y<l)return}else o={x:(h-r)/n,y:h};i={x:(l-r)/n,y:l}}else if(m>p){if(o){if(o.x>=s)return}else o={x:a,y:n*a+r};i={x:s,y:n*s+r}}else{if(o){if(o.x<a)return}else o={x:s,y:n*s+r};i={x:a,y:n*a+r}}return e.a=o,e.b=i,!0}function Qn(e,t){this.l=e,this.r=t,this.a=this.b=null}function $n(e,t,i,n){var r=new Qn(e,t);return ih.push(r),i&&Jn(r,e,t,i),n&&Jn(r,t,e,n),nh[e.i].edges.push(new er(r,e,t)),nh[t.i].edges.push(new er(r,t,e)),r}function Zn(e,t,i){var n=new Qn(e,null);return n.a=t,n.b=i,ih.push(n),n}function Jn(e,t,i,n){e.a||e.b?e.l===i?e.b=n:e.a=n:(e.a=n,e.l=t,e.r=i)}function er(e,t,i){var n=e.a,r=e.b;this.edge=e,this.site=t,this.angle=i?Math.atan2(i.y-t.y,i.x-t.x):e.l===t?Math.atan2(r.x-n.x,n.y-r.y):Math.atan2(n.x-r.x,r.y-n.y)}function tr(){this._=null}function ir(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function nr(e,t){var i=t,n=t.R,r=i.U;r?r.L===i?r.L=n:r.R=n:e._=n,n.U=r,i.U=n,i.R=n.L,i.R&&(i.R.U=i),n.L=i}function rr(e,t){var i=t,n=t.L,r=i.U;r?r.L===i?r.L=n:r.R=n:e._=n,n.U=r,i.U=n,i.L=n.R,i.L&&(i.L.U=i),n.R=i}function or(e){for(;e.L;)e=e.L;return e}function ar(e,t){var i,n,r,o=e.sort(sr).pop();for(ih=[],nh=new Array(e.length),rh=new tr,ah=new tr;;)if(r=oh,o&&(!r||o.y<r.y||o.y===r.y&&o.x<r.x))(o.x!==i||o.y!==n)&&(nh[o.i]=new Bn(o),On(o),i=o.x,n=o.y),o=e.pop();else{if(!r)break;In(r.arc)}t&&(Yn(t),Wn(t));var a={cells:nh,edges:ih};return rh=ah=ih=nh=null,a}function sr(e,t){return t.y-e.y||t.x-e.x}function lr(e,t,i){return(e.x-i.x)*(t.y-e.y)-(e.x-t.x)*(i.y-e.y)}function hr(e){return e.x}function cr(e){return e.y}function ur(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function fr(e,t,i,n,r,o){if(!e(t,i,n,r,o)){var a=.5*(i+r),s=.5*(n+o),l=t.nodes;l[0]&&fr(e,l[0],i,n,a,s),l[1]&&fr(e,l[1],a,n,r,s),l[2]&&fr(e,l[2],i,s,a,o),l[3]&&fr(e,l[3],a,s,r,o)}}function pr(e,t,i,n,r,o,a){var s,l=1/0;return function h(e,c,u,f,p){if(!(c>o||u>a||n>f||r>p)){if(d=e.point){var d,m=t-d[0],g=i-d[1],v=m*m+g*g;if(l>v){var E=Math.sqrt(l=v);n=t-E,r=i-E,o=t+E,a=i+E,s=d}}for(var y=e.nodes,T=.5*(c+f),x=.5*(u+p),b=t>=T,_=i>=x,w=_<<1|b,R=w+4;R>w;++w)if(e=y[3&w])switch(3&w){case 0:h(e,c,u,T,x);break;case 1:h(e,T,u,f,x);break;case 2:h(e,c,x,T,p);break;case 3:h(e,T,x,f,p)}}}(e,n,r,o,a),s}function dr(e,t){e=is.rgb(e),t=is.rgb(t);var i=e.r,n=e.g,r=e.b,o=t.r-i,a=t.g-n,s=t.b-r;return function(e){return"#"+yt(Math.round(i+o*e))+yt(Math.round(n+a*e))+yt(Math.round(r+s*e))}}function mr(e,t){var i,n={},r={};for(i in e)i in t?n[i]=Er(e[i],t[i]):r[i]=e[i];for(i in t)i in e||(r[i]=t[i]);return function(e){for(i in n)r[i]=n[i](e);return r}}function gr(e,t){return e=+e,t=+t,function(i){return e*(1-i)+t*i}}function vr(e,t){var i,n,r,o=ch.lastIndex=uh.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(i=ch.exec(e))&&(n=uh.exec(t));)(r=n.index)>o&&(r=t.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(i=i[0])===(n=n[0])?s[a]?s[a]+=n:s[++a]=n:(s[++a]=null,l.push({i:a,x:gr(i,n)})),o=uh.lastIndex;return o<t.length&&(r=t.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?(t=l[0].x,function(e){return t(e)+""}):function(){return t}:(t=l.length,function(e){for(var i,n=0;t>n;++n)s[(i=l[n]).i]=i.x(e);return s.join("")})}function Er(e,t){for(var i,n=is.interpolators.length;--n>=0&&!(i=is.interpolators[n](e,t)););return i}function yr(e,t){var i,n=[],r=[],o=e.length,a=t.length,s=Math.min(e.length,t.length);for(i=0;s>i;++i)n.push(Er(e[i],t[i]));for(;o>i;++i)r[i]=e[i];for(;a>i;++i)r[i]=t[i];return function(e){for(i=0;s>i;++i)r[i]=n[i](e);return r}}function Tr(e){return function(t){return 0>=t?0:t>=1?1:e(t)}}function xr(e){return function(t){return 1-e(1-t)}}function br(e){return function(t){return.5*(.5>t?e(2*t):2-e(2-2*t))}}function _r(e){return e*e}function wr(e){return e*e*e}function Rr(e){if(0>=e)return 0;if(e>=1)return 1;var t=e*e,i=t*e;return 4*(.5>e?i:3*(e-t)+i-.75)}function Hr(e){return function(t){return Math.pow(t,e)}}function Mr(e){return 1-Math.cos(e*Os)}function Sr(e){return Math.pow(2,10*(e-1))}function Cr(e){return 1-Math.sqrt(1-e*e)}function Ar(e,t){var i;return arguments.length<2&&(t=.45),arguments.length?i=t/Fs*Math.asin(1/e):(e=1,i=t/4),function(n){return 1+e*Math.pow(2,-10*n)*Math.sin((n-i)*Fs/t)}}function Dr(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function kr(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function Pr(e,t){e=is.hcl(e),t=is.hcl(t);var i=e.h,n=e.c,r=e.l,o=t.h-i,a=t.c-n,s=t.l-r;return isNaN(a)&&(a=0,n=isNaN(n)?t.c:n),isNaN(o)?(o=0,i=isNaN(i)?t.h:i):o>180?o-=360:-180>o&&(o+=360),function(e){return ht(i+o*e,n+a*e,r+s*e)+""}}function Lr(e,t){e=is.hsl(e),t=is.hsl(t);var i=e.h,n=e.s,r=e.l,o=t.h-i,a=t.s-n,s=t.l-r;return isNaN(a)&&(a=0,n=isNaN(n)?t.s:n),isNaN(o)?(o=0,i=isNaN(i)?t.h:i):o>180?o-=360:-180>o&&(o+=360),function(e){return st(i+o*e,n+a*e,r+s*e)+""}}function Nr(e,t){e=is.lab(e),t=is.lab(t);var i=e.l,n=e.a,r=e.b,o=t.l-i,a=t.a-n,s=t.b-r;return function(e){return ut(i+o*e,n+a*e,r+s*e)+""}}function zr(e,t){return t-=e,function(i){return Math.round(e+t*i)}}function Fr(e){var t=[e.a,e.b],i=[e.c,e.d],n=Or(t),r=Ir(t,i),o=Or(Ur(i,t,-r))||0;t[0]*i[1]<i[0]*t[1]&&(t[0]*=-1,t[1]*=-1,n*=-1,r*=-1),this.rotate=(n?Math.atan2(t[1],t[0]):Math.atan2(-i[0],i[1]))*Vs,this.translate=[e.e,e.f],this.scale=[n,o],this.skew=o?Math.atan2(r,o)*Vs:0}function Ir(e,t){return e[0]*t[0]+e[1]*t[1]}function Or(e){var t=Math.sqrt(Ir(e,e));return t&&(e[0]/=t,e[1]/=t),t}function Ur(e,t,i){return e[0]+=i*t[0],e[1]+=i*t[1],e}function Vr(e,t){var i,n=[],r=[],o=is.transform(e),a=is.transform(t),s=o.translate,l=a.translate,h=o.rotate,c=a.rotate,u=o.skew,f=a.skew,p=o.scale,d=a.scale;return s[0]!=l[0]||s[1]!=l[1]?(n.push("translate(",null,",",null,")"),r.push({i:1,x:gr(s[0],l[0])},{i:3,x:gr(s[1],l[1])})):n.push(l[0]||l[1]?"translate("+l+")":""),h!=c?(h-c>180?c+=360:c-h>180&&(h+=360),r.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:gr(h,c)})):c&&n.push(n.pop()+"rotate("+c+")"),u!=f?r.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:gr(u,f)}):f&&n.push(n.pop()+"skewX("+f+")"),p[0]!=d[0]||p[1]!=d[1]?(i=n.push(n.pop()+"scale(",null,",",null,")"),r.push({i:i-4,x:gr(p[0],d[0])},{i:i-2,x:gr(p[1],d[1])})):(1!=d[0]||1!=d[1])&&n.push(n.pop()+"scale("+d+")"),i=r.length,function(e){for(var t,o=-1;++o<i;)n[(t=r[o]).i]=t.x(e);return n.join("")}}function Br(e,t){return t=(t-=e=+e)||1/t,function(i){return(i-e)/t}}function Wr(e,t){return t=(t-=e=+e)||1/t,function(i){return Math.max(0,Math.min(1,(i-e)/t))}}function jr(e){for(var t=e.source,i=e.target,n=qr(t,i),r=[t];t!==n;)t=t.parent,r.push(t);for(var o=r.length;i!==n;)r.splice(o,0,i),i=i.parent;return r}function Gr(e){for(var t=[],i=e.parent;null!=i;)t.push(e),e=i,i=i.parent;return t.push(e),t}function qr(e,t){if(e===t)return e;for(var i=Gr(e),n=Gr(t),r=i.pop(),o=n.pop(),a=null;r===o;)a=r,r=i.pop(),o=n.pop();return a}function Xr(e){e.fixed|=2}function Yr(e){e.fixed&=-7}function Kr(e){e.fixed|=4,e.px=e.x,e.py=e.y}function Qr(e){e.fixed&=-5}function $r(e,t,i){var n=0,r=0;if(e.charge=0,!e.leaf)for(var o,a=e.nodes,s=a.length,l=-1;++l<s;)o=a[l],null!=o&&($r(o,t,i),e.charge+=o.charge,n+=o.charge*o.cx,r+=o.charge*o.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var h=t*i[e.point.index];e.charge+=e.pointCharge=h,n+=h*e.point.x,r+=h*e.point.y}e.cx=n/e.charge,e.cy=r/e.charge}function Zr(e,t){return is.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=ro,e}function Jr(e,t){for(var i=[e];null!=(e=i.pop());)if(t(e),(r=e.children)&&(n=r.length))for(var n,r;--n>=0;)i.push(r[n])}function eo(e,t){for(var i=[e],n=[];null!=(e=i.pop());)if(n.push(e),(o=e.children)&&(r=o.length))for(var r,o,a=-1;++a<r;)i.push(o[a]);for(;null!=(e=n.pop());)t(e)}function to(e){return e.children}function io(e){return e.value}function no(e,t){return t.value-e.value}function ro(e){return is.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function oo(e){return e.x}function ao(e){return e.y}function so(e,t,i){e.y0=t,e.y=i}function lo(e){return is.range(e.length)}function ho(e){for(var t=-1,i=e[0].length,n=[];++t<i;)n[t]=0;return n
}function co(e){for(var t,i=1,n=0,r=e[0][1],o=e.length;o>i;++i)(t=e[i][1])>r&&(n=i,r=t);return n}function uo(e){return e.reduce(fo,0)}function fo(e,t){return e+t[1]}function po(e,t){return mo(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function mo(e,t){for(var i=-1,n=+e[0],r=(e[1]-n)/t,o=[];++i<=t;)o[i]=r*i+n;return o}function go(e){return[is.min(e),is.max(e)]}function vo(e,t){return e.value-t.value}function Eo(e,t){var i=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=i,i._pack_prev=t}function yo(e,t){e._pack_next=t,t._pack_prev=e}function To(e,t){var i=t.x-e.x,n=t.y-e.y,r=e.r+t.r;return.999*r*r>i*i+n*n}function xo(e){function t(e){c=Math.min(e.x-e.r,c),u=Math.max(e.x+e.r,u),f=Math.min(e.y-e.r,f),p=Math.max(e.y+e.r,p)}if((i=e.children)&&(h=i.length)){var i,n,r,o,a,s,l,h,c=1/0,u=-1/0,f=1/0,p=-1/0;if(i.forEach(bo),n=i[0],n.x=-n.r,n.y=0,t(n),h>1&&(r=i[1],r.x=r.r,r.y=0,t(r),h>2))for(o=i[2],Ro(n,r,o),t(o),Eo(n,o),n._pack_prev=o,Eo(o,r),r=n._pack_next,a=3;h>a;a++){Ro(n,r,o=i[a]);var d=0,m=1,g=1;for(s=r._pack_next;s!==r;s=s._pack_next,m++)if(To(s,o)){d=1;break}if(1==d)for(l=n._pack_prev;l!==s._pack_prev&&!To(l,o);l=l._pack_prev,g++);d?(g>m||m==g&&r.r<n.r?yo(n,r=s):yo(n=l,r),a--):(Eo(n,o),r=o,t(o))}var v=(c+u)/2,E=(f+p)/2,y=0;for(a=0;h>a;a++)o=i[a],o.x-=v,o.y-=E,y=Math.max(y,o.r+Math.sqrt(o.x*o.x+o.y*o.y));e.r=y,i.forEach(_o)}}function bo(e){e._pack_next=e._pack_prev=e}function _o(e){delete e._pack_next,delete e._pack_prev}function wo(e,t,i,n){var r=e.children;if(e.x=t+=n*e.x,e.y=i+=n*e.y,e.r*=n,r)for(var o=-1,a=r.length;++o<a;)wo(r[o],t,i,n)}function Ro(e,t,i){var n=e.r+i.r,r=t.x-e.x,o=t.y-e.y;if(n&&(r||o)){var a=t.r+i.r,s=r*r+o*o;a*=a,n*=n;var l=.5+(n-a)/(2*s),h=Math.sqrt(Math.max(0,2*a*(n+s)-(n-=s)*n-a*a))/(2*s);i.x=e.x+l*r+h*o,i.y=e.y+l*o-h*r}else i.x=e.x+n,i.y=e.y}function Ho(e,t){return e.parent==t.parent?1:2}function Mo(e){var t=e.children;return t.length?t[0]:e.t}function So(e){var t,i=e.children;return(t=i.length)?i[t-1]:e.t}function Co(e,t,i){var n=i/(t.i-e.i);t.c-=n,t.s+=i,e.c+=n,t.z+=i,t.m+=i}function Ao(e){for(var t,i=0,n=0,r=e.children,o=r.length;--o>=0;)t=r[o],t.z+=i,t.m+=i,i+=t.s+(n+=t.c)}function Do(e,t,i){return e.a.parent===t.parent?e.a:i}function ko(e){return 1+is.max(e,function(e){return e.y})}function Po(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Lo(e){var t=e.children;return t&&t.length?Lo(t[0]):e}function No(e){var t,i=e.children;return i&&(t=i.length)?No(i[t-1]):e}function zo(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Fo(e,t){var i=e.x+t[3],n=e.y+t[0],r=e.dx-t[1]-t[3],o=e.dy-t[0]-t[2];return 0>r&&(i+=r/2,r=0),0>o&&(n+=o/2,o=0),{x:i,y:n,dx:r,dy:o}}function Io(e){var t=e[0],i=e[e.length-1];return i>t?[t,i]:[i,t]}function Oo(e){return e.rangeExtent?e.rangeExtent():Io(e.range())}function Uo(e,t,i,n){var r=i(e[0],e[1]),o=n(t[0],t[1]);return function(e){return o(r(e))}}function Vo(e,t){var i,n=0,r=e.length-1,o=e[n],a=e[r];return o>a&&(i=n,n=r,r=i,i=o,o=a,a=i),e[n]=t.floor(o),e[r]=t.ceil(a),e}function Bo(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:bh}function Wo(e,t,i,n){var r=[],o=[],a=0,s=Math.min(e.length,t.length)-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<=s;)r.push(i(e[a-1],e[a])),o.push(n(t[a-1],t[a]));return function(t){var i=is.bisect(e,t,1,s)-1;return o[i](r[i](t))}}function jo(e,t,i,n){function r(){var r=Math.min(e.length,t.length)>2?Wo:Uo,l=n?Wr:Br;return a=r(e,t,l,i),s=r(t,e,l,Er),o}function o(e){return a(e)}var a,s;return o.invert=function(e){return s(e)},o.domain=function(t){return arguments.length?(e=t.map(Number),r()):e},o.range=function(e){return arguments.length?(t=e,r()):t},o.rangeRound=function(e){return o.range(e).interpolate(zr)},o.clamp=function(e){return arguments.length?(n=e,r()):n},o.interpolate=function(e){return arguments.length?(i=e,r()):i},o.ticks=function(t){return Yo(e,t)},o.tickFormat=function(t,i){return Ko(e,t,i)},o.nice=function(t){return qo(e,t),r()},o.copy=function(){return jo(e,t,i,n)},r()}function Go(e,t){return is.rebind(e,t,"range","rangeRound","interpolate","clamp")}function qo(e,t){return Vo(e,Bo(Xo(e,t)[2]))}function Xo(e,t){null==t&&(t=10);var i=Io(e),n=i[1]-i[0],r=Math.pow(10,Math.floor(Math.log(n/t)/Math.LN10)),o=t/n*r;return.15>=o?r*=10:.35>=o?r*=5:.75>=o&&(r*=2),i[0]=Math.ceil(i[0]/r)*r,i[1]=Math.floor(i[1]/r)*r+.5*r,i[2]=r,i}function Yo(e,t){return is.range.apply(is,Xo(e,t))}function Ko(e,t,i){var n=Xo(e,t);if(i){var r=cl.exec(i);if(r.shift(),"s"===r[8]){var o=is.formatPrefix(Math.max(gs(n[0]),gs(n[1])));return r[7]||(r[7]="."+Qo(o.scale(n[2]))),r[8]="f",i=is.format(r.join("")),function(e){return i(o.scale(e))+o.symbol}}r[7]||(r[7]="."+$o(r[8],n)),i=r.join("")}else i=",."+Qo(n[2])+"f";return is.format(i)}function Qo(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function $o(e,t){var i=Qo(t[2]);return e in _h?Math.abs(i-Qo(Math.max(gs(t[0]),gs(t[1]))))+ +("e"!==e):i-2*("%"===e)}function Zo(e,t,i,n){function r(e){return(i?Math.log(0>e?0:e):-Math.log(e>0?0:-e))/Math.log(t)}function o(e){return i?Math.pow(t,e):-Math.pow(t,-e)}function a(t){return e(r(t))}return a.invert=function(t){return o(e.invert(t))},a.domain=function(t){return arguments.length?(i=t[0]>=0,e.domain((n=t.map(Number)).map(r)),a):n},a.base=function(i){return arguments.length?(t=+i,e.domain(n.map(r)),a):t},a.nice=function(){var t=Vo(n.map(r),i?Math:Rh);return e.domain(t),n=t.map(o),a},a.ticks=function(){var e=Io(n),a=[],s=e[0],l=e[1],h=Math.floor(r(s)),c=Math.ceil(r(l)),u=t%1?2:t;if(isFinite(c-h)){if(i){for(;c>h;h++)for(var f=1;u>f;f++)a.push(o(h)*f);a.push(o(h))}else for(a.push(o(h));h++<c;)for(var f=u-1;f>0;f--)a.push(o(h)*f);for(h=0;a[h]<s;h++);for(c=a.length;a[c-1]>l;c--);a=a.slice(h,c)}return a},a.tickFormat=function(e,t){if(!arguments.length)return wh;arguments.length<2?t=wh:"function"!=typeof t&&(t=is.format(t));var n,s=Math.max(.1,e/a.ticks().length),l=i?(n=1e-12,Math.ceil):(n=-1e-12,Math.floor);return function(e){return e/o(l(r(e)+n))<=s?t(e):""}},a.copy=function(){return Zo(e.copy(),t,i,n)},Go(a,e)}function Jo(e,t,i){function n(t){return e(r(t))}var r=ea(t),o=ea(1/t);return n.invert=function(t){return o(e.invert(t))},n.domain=function(t){return arguments.length?(e.domain((i=t.map(Number)).map(r)),n):i},n.ticks=function(e){return Yo(i,e)},n.tickFormat=function(e,t){return Ko(i,e,t)},n.nice=function(e){return n.domain(qo(i,e))},n.exponent=function(a){return arguments.length?(r=ea(t=a),o=ea(1/t),e.domain(i.map(r)),n):t},n.copy=function(){return Jo(e.copy(),t,i)},Go(n,e)}function ea(e){return function(t){return 0>t?-Math.pow(-t,e):Math.pow(t,e)}}function ta(e,t){function i(i){return o[((r.get(i)||("range"===t.t?r.set(i,e.push(i)):0/0))-1)%o.length]}function n(t,i){return is.range(e.length).map(function(e){return t+i*e})}var r,o,a;return i.domain=function(n){if(!arguments.length)return e;e=[],r=new s;for(var o,a=-1,l=n.length;++a<l;)r.has(o=n[a])||r.set(o,e.push(o));return i[t.t].apply(i,t.a)},i.range=function(e){return arguments.length?(o=e,a=0,t={t:"range",a:arguments},i):o},i.rangePoints=function(r,s){arguments.length<2&&(s=0);var l=r[0],h=r[1],c=e.length<2?(l=(l+h)/2,0):(h-l)/(e.length-1+s);return o=n(l+c*s/2,c),a=0,t={t:"rangePoints",a:arguments},i},i.rangeRoundPoints=function(r,s){arguments.length<2&&(s=0);var l=r[0],h=r[1],c=e.length<2?(l=h=Math.round((l+h)/2),0):0|(h-l)/(e.length-1+s);return o=n(l+Math.round(c*s/2+(h-l-(e.length-1+s)*c)/2),c),a=0,t={t:"rangeRoundPoints",a:arguments},i},i.rangeBands=function(r,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var h=r[1]<r[0],c=r[h-0],u=r[1-h],f=(u-c)/(e.length-s+2*l);return o=n(c+f*l,f),h&&o.reverse(),a=f*(1-s),t={t:"rangeBands",a:arguments},i},i.rangeRoundBands=function(r,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var h=r[1]<r[0],c=r[h-0],u=r[1-h],f=Math.floor((u-c)/(e.length-s+2*l));return o=n(c+Math.round((u-c-(e.length-s)*f)/2),f),h&&o.reverse(),a=Math.round(f*(1-s)),t={t:"rangeRoundBands",a:arguments},i},i.rangeBand=function(){return a},i.rangeExtent=function(){return Io(t.a[0])},i.copy=function(){return ta(e,t)},i.domain(e)}function ia(n,r){function o(){var e=0,t=r.length;for(s=[];++e<t;)s[e-1]=is.quantile(n,e/t);return a}function a(e){return isNaN(e=+e)?void 0:r[is.bisect(s,e)]}var s;return a.domain=function(r){return arguments.length?(n=r.map(t).filter(i).sort(e),o()):n},a.range=function(e){return arguments.length?(r=e,o()):r},a.quantiles=function(){return s},a.invertExtent=function(e){return e=r.indexOf(e),0>e?[0/0,0/0]:[e>0?s[e-1]:n[0],e<s.length?s[e]:n[n.length-1]]},a.copy=function(){return ia(n,r)},o()}function na(e,t,i){function n(t){return i[Math.max(0,Math.min(a,Math.floor(o*(t-e))))]}function r(){return o=i.length/(t-e),a=i.length-1,n}var o,a;return n.domain=function(i){return arguments.length?(e=+i[0],t=+i[i.length-1],r()):[e,t]},n.range=function(e){return arguments.length?(i=e,r()):i},n.invertExtent=function(t){return t=i.indexOf(t),t=0>t?0/0:t/o+e,[t,t+1/o]},n.copy=function(){return na(e,t,i)},r()}function ra(e,t){function i(i){return i>=i?t[is.bisect(e,i)]:void 0}return i.domain=function(t){return arguments.length?(e=t,i):e},i.range=function(e){return arguments.length?(t=e,i):t},i.invertExtent=function(i){return i=t.indexOf(i),[e[i-1],e[i]]},i.copy=function(){return ra(e,t)},i}function oa(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(i){return arguments.length?(e=i.map(t),t):e},t.ticks=function(t){return Yo(e,t)},t.tickFormat=function(t,i){return Ko(e,t,i)},t.copy=function(){return oa(e)},t}function aa(){return 0}function sa(e){return e.innerRadius}function la(e){return e.outerRadius}function ha(e){return e.startAngle}function ca(e){return e.endAngle}function ua(e){return e&&e.padAngle}function fa(e,t,i,n){return(e-i)*t-(t-n)*e>0?0:1}function pa(e,t,i,n,r){var o=e[0]-t[0],a=e[1]-t[1],s=(r?n:-n)/Math.sqrt(o*o+a*a),l=s*a,h=-s*o,c=e[0]+l,u=e[1]+h,f=t[0]+l,p=t[1]+h,d=(c+f)/2,m=(u+p)/2,g=f-c,v=p-u,E=g*g+v*v,y=i-n,T=c*p-f*u,x=(0>v?-1:1)*Math.sqrt(y*y*E-T*T),b=(T*v-g*x)/E,_=(-T*g-v*x)/E,w=(T*v+g*x)/E,R=(-T*g+v*x)/E,H=b-d,M=_-m,S=w-d,C=R-m;return H*H+M*M>S*S+C*C&&(b=w,_=R),[[b-l,_-h],[b*i/y,_*i/y]]}function da(e){function t(t){function a(){h.push("M",o(e(c),s))}for(var l,h=[],c=[],u=-1,f=t.length,p=Rt(i),d=Rt(n);++u<f;)r.call(this,l=t[u],u)?c.push([+p.call(this,l,u),+d.call(this,l,u)]):c.length&&(a(),c=[]);return c.length&&a(),h.length?h.join(""):null}var i=Sn,n=Cn,r=Si,o=ma,a=o.key,s=.7;return t.x=function(e){return arguments.length?(i=e,t):i},t.y=function(e){return arguments.length?(n=e,t):n},t.defined=function(e){return arguments.length?(r=e,t):r},t.interpolate=function(e){return arguments.length?(a="function"==typeof e?o=e:(o=Dh.get(e)||ma).key,t):a},t.tension=function(e){return arguments.length?(s=e,t):s},t}function ma(e){return e.join("L")}function ga(e){return ma(e)+"Z"}function va(e){for(var t=0,i=e.length,n=e[0],r=[n[0],",",n[1]];++t<i;)r.push("H",(n[0]+(n=e[t])[0])/2,"V",n[1]);return i>1&&r.push("H",n[0]),r.join("")}function Ea(e){for(var t=0,i=e.length,n=e[0],r=[n[0],",",n[1]];++t<i;)r.push("V",(n=e[t])[1],"H",n[0]);return r.join("")}function ya(e){for(var t=0,i=e.length,n=e[0],r=[n[0],",",n[1]];++t<i;)r.push("H",(n=e[t])[0],"V",n[1]);return r.join("")}function Ta(e,t){return e.length<4?ma(e):e[1]+_a(e.slice(1,-1),wa(e,t))}function xa(e,t){return e.length<3?ma(e):e[0]+_a((e.push(e[0]),e),wa([e[e.length-2]].concat(e,[e[1]]),t))}function ba(e,t){return e.length<3?ma(e):e[0]+_a(e,wa(e,t))}function _a(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return ma(e);var i=e.length!=t.length,n="",r=e[0],o=e[1],a=t[0],s=a,l=1;if(i&&(n+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],r=e[1],l=2),t.length>1){s=t[1],o=e[l],l++,n+="C"+(r[0]+a[0])+","+(r[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var h=2;h<t.length;h++,l++)o=e[l],s=t[h],n+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(i){var c=e[l];n+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+c[0]+","+c[1]}return n}function wa(e,t){for(var i,n=[],r=(1-t)/2,o=e[0],a=e[1],s=1,l=e.length;++s<l;)i=o,o=a,a=e[s],n.push([r*(a[0]-i[0]),r*(a[1]-i[1])]);return n}function Ra(e){if(e.length<3)return ma(e);var t=1,i=e.length,n=e[0],r=n[0],o=n[1],a=[r,r,r,(n=e[1])[0]],s=[o,o,o,n[1]],l=[r,",",o,"L",Ca(Lh,a),",",Ca(Lh,s)];for(e.push(e[i-1]);++t<=i;)n=e[t],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),Aa(l,a,s);return e.pop(),l.push("L",n),l.join("")}function Ha(e){if(e.length<4)return ma(e);for(var t,i=[],n=-1,r=e.length,o=[0],a=[0];++n<3;)t=e[n],o.push(t[0]),a.push(t[1]);for(i.push(Ca(Lh,o)+","+Ca(Lh,a)),--n;++n<r;)t=e[n],o.shift(),o.push(t[0]),a.shift(),a.push(t[1]),Aa(i,o,a);return i.join("")}function Ma(e){for(var t,i,n=-1,r=e.length,o=r+4,a=[],s=[];++n<4;)i=e[n%r],a.push(i[0]),s.push(i[1]);for(t=[Ca(Lh,a),",",Ca(Lh,s)],--n;++n<o;)i=e[n%r],a.shift(),a.push(i[0]),s.shift(),s.push(i[1]),Aa(t,a,s);return t.join("")}function Sa(e,t){var i=e.length-1;if(i)for(var n,r,o=e[0][0],a=e[0][1],s=e[i][0]-o,l=e[i][1]-a,h=-1;++h<=i;)n=e[h],r=h/i,n[0]=t*n[0]+(1-t)*(o+r*s),n[1]=t*n[1]+(1-t)*(a+r*l);return Ra(e)}function Ca(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Aa(e,t,i){e.push("C",Ca(kh,t),",",Ca(kh,i),",",Ca(Ph,t),",",Ca(Ph,i),",",Ca(Lh,t),",",Ca(Lh,i))}function Da(e,t){return(t[1]-e[1])/(t[0]-e[0])}function ka(e){for(var t=0,i=e.length-1,n=[],r=e[0],o=e[1],a=n[0]=Da(r,o);++t<i;)n[t]=(a+(a=Da(r=o,o=e[t+1])))/2;return n[t]=a,n}function Pa(e){for(var t,i,n,r,o=[],a=ka(e),s=-1,l=e.length-1;++s<l;)t=Da(e[s],e[s+1]),gs(t)<Ls?a[s]=a[s+1]=0:(i=a[s]/t,n=a[s+1]/t,r=i*i+n*n,r>9&&(r=3*t/Math.sqrt(r),a[s]=r*i,a[s+1]=r*n));for(s=-1;++s<=l;)r=(e[Math.min(l,s+1)][0]-e[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([r||0,a[s]*r||0]);return o}function La(e){return e.length<3?ma(e):e[0]+_a(e,Pa(e))}function Na(e){for(var t,i,n,r=-1,o=e.length;++r<o;)t=e[r],i=t[0],n=t[1]-Os,t[0]=i*Math.cos(n),t[1]=i*Math.sin(n);return e}function za(e){function t(t){function l(){m.push("M",s(e(v),u),c,h(e(g.reverse()),u),"Z")}for(var f,p,d,m=[],g=[],v=[],E=-1,y=t.length,T=Rt(i),x=Rt(r),b=i===n?function(){return p}:Rt(n),_=r===o?function(){return d}:Rt(o);++E<y;)a.call(this,f=t[E],E)?(g.push([p=+T.call(this,f,E),d=+x.call(this,f,E)]),v.push([+b.call(this,f,E),+_.call(this,f,E)])):g.length&&(l(),g=[],v=[]);return g.length&&l(),m.length?m.join(""):null}var i=Sn,n=Sn,r=0,o=Cn,a=Si,s=ma,l=s.key,h=s,c="L",u=.7;return t.x=function(e){return arguments.length?(i=n=e,t):n},t.x0=function(e){return arguments.length?(i=e,t):i},t.x1=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=o=e,t):o},t.y0=function(e){return arguments.length?(r=e,t):r},t.y1=function(e){return arguments.length?(o=e,t):o},t.defined=function(e){return arguments.length?(a=e,t):a},t.interpolate=function(e){return arguments.length?(l="function"==typeof e?s=e:(s=Dh.get(e)||ma).key,h=s.reverse||s,c=s.closed?"M":"L",t):l},t.tension=function(e){return arguments.length?(u=e,t):u},t}function Fa(e){return e.radius}function Ia(e){return[e.x,e.y]}function Oa(e){return function(){var t=e.apply(this,arguments),i=t[0],n=t[1]-Os;return[i*Math.cos(n),i*Math.sin(n)]}}function Ua(){return 64}function Va(){return"circle"}function Ba(e){var t=Math.sqrt(e/zs);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Wa(e){return function(){var t,i;(t=this[e])&&(i=t[t.active])&&(--t.count?delete t[t.active]:delete this[e],t.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function ja(e,t,i){return xs(e,Vh),e.namespace=t,e.id=i,e}function Ga(e,t,i,n){var r=e.id,o=e.namespace;return U(e,"function"==typeof i?function(e,a,s){e[o][r].tween.set(t,n(i.call(e,e.__data__,a,s)))}:(i=n(i),function(e){e[o][r].tween.set(t,i)}))}function qa(e){return null==e&&(e=""),function(){this.textContent=e}}function Xa(e){return null==e?"__transition__":"__transition_"+e+"__"}function Ya(e,t,i,n,r){var o=e[i]||(e[i]={active:0,count:0}),a=o[n];if(!a){var l=r.time;a=o[n]={tween:new s,time:l,delay:r.delay,duration:r.duration,ease:r.ease,index:t},r=null,++o.count,is.timer(function(r){function s(i){if(o.active>n)return c();var r=o[o.active];r&&(--o.count,delete o[o.active],r.event&&r.event.interrupt.call(e,e.__data__,r.index)),o.active=n,a.event&&a.event.start.call(e,e.__data__,t),a.tween.forEach(function(i,n){(n=n.call(e,e.__data__,t))&&m.push(n)}),f=a.ease,u=a.duration,is.timer(function(){return d.c=h(i||1)?Si:h,1},0,l)}function h(i){if(o.active!==n)return 1;for(var r=i/u,s=f(r),l=m.length;l>0;)m[--l].call(e,s);return r>=1?(a.event&&a.event.end.call(e,e.__data__,t),c()):void 0}function c(){return--o.count?delete o[n]:delete e[i],1}var u,f,p=a.delay,d=sl,m=[];return d.t=p+l,r>=p?s(r-p):void(d.c=s)},0,l)}}function Ka(e,t,i){e.attr("transform",function(e){var n=t(e);return"translate("+(isFinite(n)?n:i(e))+",0)"})}function Qa(e,t,i){e.attr("transform",function(e){var n=t(e);return"translate(0,"+(isFinite(n)?n:i(e))+")"})}function $a(e){return e.toISOString()}function Za(e,t,i){function n(t){return e(t)}function r(e,i){var n=e[1]-e[0],r=n/i,o=is.bisect(Qh,r);return o==Qh.length?[t.year,Xo(e.map(function(e){return e/31536e6}),i)[2]]:o?t[r/Qh[o-1]<Qh[o]/r?o-1:o]:[Jh,Xo(e,i)[2]]}return n.invert=function(t){return Ja(e.invert(t))},n.domain=function(t){return arguments.length?(e.domain(t),n):e.domain().map(Ja)},n.nice=function(e,t){function i(i){return!isNaN(i)&&!e.range(i,Ja(+i+1),t).length}var o=n.domain(),a=Io(o),s=null==e?r(a,10):"number"==typeof e&&r(a,e);return s&&(e=s[0],t=s[1]),n.domain(Vo(o,t>1?{floor:function(t){for(;i(t=e.floor(t));)t=Ja(t-1);return t},ceil:function(t){for(;i(t=e.ceil(t));)t=Ja(+t+1);return t}}:e))},n.ticks=function(e,t){var i=Io(n.domain()),o=null==e?r(i,10):"number"==typeof e?r(i,e):!e.range&&[{range:e},t];return o&&(e=o[0],t=o[1]),e.range(i[0],Ja(+i[1]+1),1>t?1:t)},n.tickFormat=function(){return i},n.copy=function(){return Za(e.copy(),t,i)},Go(n,e)}function Ja(e){return new Date(e)}function es(e){return JSON.parse(e.responseText)}function ts(e){var t=os.createRange();return t.selectNode(os.body),t.createContextualFragment(e.responseText)}var is={version:"3.5.3"};Date.now||(Date.now=function(){return+new Date});var ns=[].slice,rs=function(e){return ns.call(e)},os=document,as=os.documentElement,ss=window;try{rs(as.childNodes)[0].nodeType}catch(ls){rs=function(e){for(var t=e.length,i=new Array(t);t--;)i[t]=e[t];return i}}try{os.createElement("div").style.setProperty("opacity",0,"")}catch(hs){var cs=ss.Element.prototype,us=cs.setAttribute,fs=cs.setAttributeNS,ps=ss.CSSStyleDeclaration.prototype,ds=ps.setProperty;cs.setAttribute=function(e,t){us.call(this,e,t+"")},cs.setAttributeNS=function(e,t,i){fs.call(this,e,t,i+"")},ps.setProperty=function(e,t,i){ds.call(this,e,t+"",i)}}is.ascending=e,is.descending=function(e,t){return e>t?-1:t>e?1:t>=e?0:0/0},is.min=function(e,t){var i,n,r=-1,o=e.length;if(1===arguments.length){for(;++r<o;)if(null!=(n=e[r])&&n>=n){i=n;break}for(;++r<o;)null!=(n=e[r])&&i>n&&(i=n)}else{for(;++r<o;)if(null!=(n=t.call(e,e[r],r))&&n>=n){i=n;break}for(;++r<o;)null!=(n=t.call(e,e[r],r))&&i>n&&(i=n)}return i},is.max=function(e,t){var i,n,r=-1,o=e.length;if(1===arguments.length){for(;++r<o;)if(null!=(n=e[r])&&n>=n){i=n;break}for(;++r<o;)null!=(n=e[r])&&n>i&&(i=n)}else{for(;++r<o;)if(null!=(n=t.call(e,e[r],r))&&n>=n){i=n;break}for(;++r<o;)null!=(n=t.call(e,e[r],r))&&n>i&&(i=n)}return i},is.extent=function(e,t){var i,n,r,o=-1,a=e.length;if(1===arguments.length){for(;++o<a;)if(null!=(n=e[o])&&n>=n){i=r=n;break}for(;++o<a;)null!=(n=e[o])&&(i>n&&(i=n),n>r&&(r=n))}else{for(;++o<a;)if(null!=(n=t.call(e,e[o],o))&&n>=n){i=r=n;break}for(;++o<a;)null!=(n=t.call(e,e[o],o))&&(i>n&&(i=n),n>r&&(r=n))}return[i,r]},is.sum=function(e,t){var n,r=0,o=e.length,a=-1;if(1===arguments.length)for(;++a<o;)i(n=+e[a])&&(r+=n);else for(;++a<o;)i(n=+t.call(e,e[a],a))&&(r+=n);return r},is.mean=function(e,n){var r,o=0,a=e.length,s=-1,l=a;if(1===arguments.length)for(;++s<a;)i(r=t(e[s]))?o+=r:--l;else for(;++s<a;)i(r=t(n.call(e,e[s],s)))?o+=r:--l;return l?o/l:void 0},is.quantile=function(e,t){var i=(e.length-1)*t+1,n=Math.floor(i),r=+e[n-1],o=i-n;return o?r+o*(e[n]-r):r},is.median=function(n,r){var o,a=[],s=n.length,l=-1;if(1===arguments.length)for(;++l<s;)i(o=t(n[l]))&&a.push(o);else for(;++l<s;)i(o=t(r.call(n,n[l],l)))&&a.push(o);return a.length?is.quantile(a.sort(e),.5):void 0},is.variance=function(e,n){var r,o,a=e.length,s=0,l=0,h=-1,c=0;if(1===arguments.length)for(;++h<a;)i(r=t(e[h]))&&(o=r-s,s+=o/++c,l+=o*(r-s));else for(;++h<a;)i(r=t(n.call(e,e[h],h)))&&(o=r-s,s+=o/++c,l+=o*(r-s));return c>1?l/(c-1):void 0},is.deviation=function(){var e=is.variance.apply(this,arguments);return e?Math.sqrt(e):e};var ms=n(e);is.bisectLeft=ms.left,is.bisect=is.bisectRight=ms.right,is.bisector=function(t){return n(1===t.length?function(i,n){return e(t(i),n)}:t)},is.shuffle=function(e,t,i){(o=arguments.length)<3&&(i=e.length,2>o&&(t=0));for(var n,r,o=i-t;o;)r=0|Math.random()*o--,n=e[o+t],e[o+t]=e[r+t],e[r+t]=n;return e},is.permute=function(e,t){for(var i=t.length,n=new Array(i);i--;)n[i]=e[t[i]];return n},is.pairs=function(e){for(var t,i=0,n=e.length-1,r=e[0],o=new Array(0>n?0:n);n>i;)o[i]=[t=r,r=e[++i]];return o},is.zip=function(){if(!(n=arguments.length))return[];for(var e=-1,t=is.min(arguments,r),i=new Array(t);++e<t;)for(var n,o=-1,a=i[e]=new Array(n);++o<n;)a[o]=arguments[o][e];return i},is.transpose=function(e){return is.zip.apply(is,e)},is.keys=function(e){var t=[];for(var i in e)t.push(i);return t},is.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},is.entries=function(e){var t=[];for(var i in e)t.push({key:i,value:e[i]});return t},is.merge=function(e){for(var t,i,n,r=e.length,o=-1,a=0;++o<r;)a+=e[o].length;for(i=new Array(a);--r>=0;)for(n=e[r],t=n.length;--t>=0;)i[--a]=n[t];return i};var gs=Math.abs;is.range=function(e,t,i){if(arguments.length<3&&(i=1,arguments.length<2&&(t=e,e=0)),1/0===(t-e)/i)throw new Error("infinite range");var n,r=[],a=o(gs(i)),s=-1;if(e*=a,t*=a,i*=a,0>i)for(;(n=e+i*++s)>t;)r.push(n/a);else for(;(n=e+i*++s)<t;)r.push(n/a);return r},is.map=function(e,t){var i=new s;if(e instanceof s)e.forEach(function(e,t){i.set(e,t)});else if(Array.isArray(e)){var n,r=-1,o=e.length;if(1===arguments.length)for(;++r<o;)i.set(r,e[r]);else for(;++r<o;)i.set(t.call(e,n=e[r],r),n)}else for(var a in e)i.set(a,e[a]);return i};var vs="__proto__",Es="\x00";a(s,{has:c,get:function(e){return this._[l(e)]},set:function(e,t){return this._[l(e)]=t},remove:u,keys:f,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:h(t),value:this._[t]});return e},size:p,empty:d,forEach:function(e){for(var t in this._)e.call(this,h(t),this._[t])}}),is.nest=function(){function e(t,a,l){if(l>=o.length)return n?n.call(r,a):i?a.sort(i):a;for(var h,c,u,f,p=-1,d=a.length,m=o[l++],g=new s;++p<d;)(f=g.get(h=m(c=a[p])))?f.push(c):g.set(h,[c]);return t?(c=t(),u=function(i,n){c.set(i,e(t,n,l))}):(c={},u=function(i,n){c[i]=e(t,n,l)}),g.forEach(u),c}function t(e,i){if(i>=o.length)return e;var n=[],r=a[i++];return e.forEach(function(e,r){n.push({key:e,values:t(r,i)})}),r?n.sort(function(e,t){return r(e.key,t.key)}):n}var i,n,r={},o=[],a=[];return r.map=function(t,i){return e(i,t,0)},r.entries=function(i){return t(e(is.map,i,0),0)},r.key=function(e){return o.push(e),r},r.sortKeys=function(e){return a[o.length-1]=e,r},r.sortValues=function(e){return i=e,r},r.rollup=function(e){return n=e,r},r},is.set=function(e){var t=new m;if(e)for(var i=0,n=e.length;n>i;++i)t.add(e[i]);return t},a(m,{has:c,add:function(e){return this._[l(e+="")]=!0,e},remove:u,values:f,size:p,empty:d,forEach:function(e){for(var t in this._)e.call(this,h(t))}}),is.behavior={},is.rebind=function(e,t){for(var i,n=1,r=arguments.length;++n<r;)e[i=arguments[n]]=g(e,t,t[i]);return e};var ys=["webkit","ms","moz","Moz","o","O"];is.dispatch=function(){for(var e=new y,t=-1,i=arguments.length;++t<i;)e[arguments[t]]=T(e);return e},y.prototype.on=function(e,t){var i=e.indexOf("."),n="";if(i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),e)return arguments.length<2?this[e].on(n):this[e].on(n,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(n,null);return this}},is.event=null,is.requote=function(e){return e.replace(Ts,"\\$&")};var Ts=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,xs={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)e[i]=t[i]},bs=function(e,t){return t.querySelector(e)},_s=function(e,t){return t.querySelectorAll(e)},ws=as.matches||as[v(as,"matchesSelector")],Rs=function(e,t){return ws.call(e,t)};"function"==typeof Sizzle&&(bs=function(e,t){return Sizzle(e,t)[0]||null},_s=Sizzle,Rs=Sizzle.matchesSelector),is.selection=function(){return Cs};var Hs=is.selection.prototype=[];Hs.select=function(e){var t,i,n,r,o=[];e=R(e);for(var a=-1,s=this.length;++a<s;){o.push(t=[]),t.parentNode=(n=this[a]).parentNode;for(var l=-1,h=n.length;++l<h;)(r=n[l])?(t.push(i=e.call(r,r.__data__,l,a)),i&&"__data__"in r&&(i.__data__=r.__data__)):t.push(null)}return w(o)},Hs.selectAll=function(e){var t,i,n=[];e=H(e);for(var r=-1,o=this.length;++r<o;)for(var a=this[r],s=-1,l=a.length;++s<l;)(i=a[s])&&(n.push(t=rs(e.call(i,i.__data__,s,r))),t.parentNode=i);return w(n)};var Ms={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};is.ns={prefix:Ms,qualify:function(e){var t=e.indexOf(":"),i=e;return t>=0&&(i=e.slice(0,t),e=e.slice(t+1)),Ms.hasOwnProperty(i)?{space:Ms[i],local:e}:e}},Hs.attr=function(e,t){if(arguments.length<2){if("string"==typeof e){var i=this.node();return e=is.ns.qualify(e),e.local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}for(t in e)this.each(M(t,e[t]));return this}return this.each(M(e,t))},Hs.classed=function(e,t){if(arguments.length<2){if("string"==typeof e){var i=this.node(),n=(e=A(e)).length,r=-1;if(t=i.classList){for(;++r<n;)if(!t.contains(e[r]))return!1}else for(t=i.getAttribute("class");++r<n;)if(!C(e[r]).test(t))return!1;return!0}for(t in e)this.each(D(t,e[t]));return this}return this.each(D(e,t))},Hs.style=function(e,t,i){var n=arguments.length;if(3>n){if("string"!=typeof e){2>n&&(t="");for(i in e)this.each(P(i,e[i],t));return this}if(2>n)return ss.getComputedStyle(this.node(),null).getPropertyValue(e);i=""}return this.each(P(e,t,i))},Hs.property=function(e,t){if(arguments.length<2){if("string"==typeof e)return this.node()[e];for(t in e)this.each(L(t,e[t]));return this}return this.each(L(e,t))},Hs.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},Hs.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},Hs.append=function(e){return e=N(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},Hs.insert=function(e,t){return e=N(e),t=R(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},Hs.remove=function(){return this.each(z)},Hs.data=function(e,t){function i(e,i){var n,r,o,a=e.length,u=i.length,f=Math.min(a,u),p=new Array(u),d=new Array(u),m=new Array(a);if(t){var g,v=new s,E=new Array(a);for(n=-1;++n<a;)v.has(g=t.call(r=e[n],r.__data__,n))?m[n]=r:v.set(g,r),E[n]=g;for(n=-1;++n<u;)(r=v.get(g=t.call(i,o=i[n],n)))?r!==!0&&(p[n]=r,r.__data__=o):d[n]=F(o),v.set(g,!0);for(n=-1;++n<a;)v.get(E[n])!==!0&&(m[n]=e[n])}else{for(n=-1;++n<f;)r=e[n],o=i[n],r?(r.__data__=o,p[n]=r):d[n]=F(o);for(;u>n;++n)d[n]=F(i[n]);for(;a>n;++n)m[n]=e[n]}d.update=p,d.parentNode=p.parentNode=m.parentNode=e.parentNode,l.push(d),h.push(p),c.push(m)}var n,r,o=-1,a=this.length;if(!arguments.length){for(e=new Array(a=(n=this[0]).length);++o<a;)(r=n[o])&&(e[o]=r.__data__);return e}var l=V([]),h=w([]),c=w([]);if("function"==typeof e)for(;++o<a;)i(n=this[o],e.call(n,n.parentNode.__data__,o));else for(;++o<a;)i(n=this[o],e);return h.enter=function(){return l},h.exit=function(){return c},h},Hs.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},Hs.filter=function(e){var t,i,n,r=[];"function"!=typeof e&&(e=I(e));for(var o=0,a=this.length;a>o;o++){r.push(t=[]),t.parentNode=(i=this[o]).parentNode;for(var s=0,l=i.length;l>s;s++)(n=i[s])&&e.call(n,n.__data__,s,o)&&t.push(n)}return w(r)},Hs.order=function(){for(var e=-1,t=this.length;++e<t;)for(var i,n=this[e],r=n.length-1,o=n[r];--r>=0;)(i=n[r])&&(o&&o!==i.nextSibling&&o.parentNode.insertBefore(i,o),o=i);return this},Hs.sort=function(e){e=O.apply(this,arguments);for(var t=-1,i=this.length;++t<i;)this[t].sort(e);return this.order()},Hs.each=function(e){return U(this,function(t,i,n){e.call(t,t.__data__,i,n)})},Hs.call=function(e){var t=rs(arguments);return e.apply(t[0]=this,t),this},Hs.empty=function(){return!this.node()},Hs.node=function(){for(var e=0,t=this.length;t>e;e++)for(var i=this[e],n=0,r=i.length;r>n;n++){var o=i[n];if(o)return o}return null},Hs.size=function(){var e=0;return U(this,function(){++e}),e};var Ss=[];is.selection.enter=V,is.selection.enter.prototype=Ss,Ss.append=Hs.append,Ss.empty=Hs.empty,Ss.node=Hs.node,Ss.call=Hs.call,Ss.size=Hs.size,Ss.select=function(e){for(var t,i,n,r,o,a=[],s=-1,l=this.length;++s<l;){n=(r=this[s]).update,a.push(t=[]),t.parentNode=r.parentNode;for(var h=-1,c=r.length;++h<c;)(o=r[h])?(t.push(n[h]=i=e.call(r.parentNode,o.__data__,h,s)),i.__data__=o.__data__):t.push(null)}return w(a)},Ss.insert=function(e,t){return arguments.length<2&&(t=B(this)),Hs.insert.call(this,e,t)},is.select=function(e){var t=["string"==typeof e?bs(e,os):e];return t.parentNode=as,w([t])},is.selectAll=function(e){var t=rs("string"==typeof e?_s(e,os):e);return t.parentNode=as,w([t])};var Cs=is.select(as);Hs.on=function(e,t,i){var n=arguments.length;if(3>n){if("string"!=typeof e){2>n&&(t=!1);for(i in e)this.each(W(i,e[i],t));return this}if(2>n)return(n=this.node()["__on"+e])&&n._;i=!1}return this.each(W(e,t,i))};var As=is.map({mouseenter:"mouseover",mouseleave:"mouseout"});As.forEach(function(e){"on"+e in os&&As.remove(e)});var Ds="onselectstart"in os?null:v(as.style,"userSelect"),ks=0;is.mouse=function(e){return $(e,b())};var Ps=/WebKit/.test(ss.navigator.userAgent)?-1:0;is.touch=function(e,t,i){if(arguments.length<3&&(i=t,t=b().changedTouches),t)for(var n,r=0,o=t.length;o>r;++r)if((n=t[r]).identifier===i)return $(e,n)},is.behavior.drag=function(){function e(){this.on("mousedown.drag",r).on("touchstart.drag",o)}function t(e,t,r,o,a){return function(){function s(){var e,i,n=t(f,m);n&&(e=n[0]-y[0],i=n[1]-y[1],d|=e|i,y=n,p({type:"drag",x:n[0]+h[0],y:n[1]+h[1],dx:e,dy:i}))}function l(){t(f,m)&&(v.on(o+g,null).on(a+g,null),E(d&&is.event.target===u),p({type:"dragend"}))}var h,c=this,u=is.event.target,f=c.parentNode,p=i.of(c,arguments),d=0,m=e(),g=".drag"+(null==m?"":"-"+m),v=is.select(r()).on(o+g,s).on(a+g,l),E=q(),y=t(f,m);n?(h=n.apply(c,arguments),h=[h.x-y[0],h.y-y[1]]):h=[0,0],p({type:"dragstart"})}}var i=_(e,"drag","dragstart","dragend"),n=null,r=t(E,is.mouse,K,"mousemove","mouseup"),o=t(X,is.touch,Y,"touchmove","touchend");return e.origin=function(t){return arguments.length?(n=t,e):n},is.rebind(e,i,"on")},is.touches=function(e,t){return arguments.length<2&&(t=b().touches),t?rs(t).map(function(t){var i=$(e,t);return i.identifier=t.identifier,i}):[]};var Ls=1e-6,Ns=Ls*Ls,zs=Math.PI,Fs=2*zs,Is=Fs-Ls,Os=zs/2,Us=zs/180,Vs=180/zs,Bs=Math.SQRT2,Ws=2,js=4;is.interpolateZoom=function(e,t){function i(e){var t=e*E;if(v){var i=it(m),a=o/(Ws*f)*(i*nt(Bs*t+m)-tt(m));return[n+a*h,r+a*c,o*i/it(Bs*t+m)]}return[n+e*h,r+e*c,o*Math.exp(Bs*t)]}var n=e[0],r=e[1],o=e[2],a=t[0],s=t[1],l=t[2],h=a-n,c=s-r,u=h*h+c*c,f=Math.sqrt(u),p=(l*l-o*o+js*u)/(2*o*Ws*f),d=(l*l-o*o-js*u)/(2*l*Ws*f),m=Math.log(Math.sqrt(p*p+1)-p),g=Math.log(Math.sqrt(d*d+1)-d),v=g-m,E=(v||Math.log(l/o))/Bs;
return i.duration=1e3*E,i},is.behavior.zoom=function(){function e(e){e.on(A,c).on(Xs+".zoom",f).on("dblclick.zoom",p).on(P,u)}function t(e){return[(e[0]-R.x)/R.k,(e[1]-R.y)/R.k]}function i(e){return[e[0]*R.k+R.x,e[1]*R.k+R.y]}function n(e){R.k=Math.max(M[0],Math.min(M[1],e))}function r(e,t){t=i(t),R.x+=e[0]-t[0],R.y+=e[1]-t[1]}function o(t,i,o,a){t.__chart__={x:R.x,y:R.y,k:R.k},n(Math.pow(2,a)),r(m=i,o),t=is.select(t),S>0&&(t=t.transition().duration(S)),t.call(e.event)}function a(){T&&T.domain(y.range().map(function(e){return(e-R.x)/R.k}).map(y.invert)),w&&w.domain(b.range().map(function(e){return(e-R.y)/R.k}).map(b.invert))}function s(e){C++||e({type:"zoomstart"})}function l(e){a(),e({type:"zoom",scale:R.k,translate:[R.x,R.y]})}function h(e){--C||e({type:"zoomend"}),m=null}function c(){function e(){c=1,r(is.mouse(n),f),l(a)}function i(){u.on(D,null).on(k,null),p(c&&is.event.target===o),h(a)}var n=this,o=is.event.target,a=L.of(n,arguments),c=0,u=is.select(ss).on(D,e).on(k,i),f=t(is.mouse(n)),p=q();Uh.call(n),s(a)}function u(){function e(){var e=is.touches(d);return p=R.k,e.forEach(function(e){e.identifier in g&&(g[e.identifier]=t(e))}),e}function i(){var t=is.event.target;is.select(t).on(T,a).on(b,f),_.push(t);for(var i=is.event.changedTouches,n=0,r=i.length;r>n;++n)g[i[n].identifier]=null;var s=e(),l=Date.now();if(1===s.length){if(500>l-E){var h=s[0];o(d,h,g[h.identifier],Math.floor(Math.log(R.k)/Math.LN2)+1),x()}E=l}else if(s.length>1){var h=s[0],c=s[1],u=h[0]-c[0],p=h[1]-c[1];v=u*u+p*p}}function a(){var e,t,i,o,a=is.touches(d);Uh.call(d);for(var s=0,h=a.length;h>s;++s,o=null)if(i=a[s],o=g[i.identifier]){if(t)break;e=i,t=o}if(o){var c=(c=i[0]-e[0])*c+(c=i[1]-e[1])*c,u=v&&Math.sqrt(c/v);e=[(e[0]+i[0])/2,(e[1]+i[1])/2],t=[(t[0]+o[0])/2,(t[1]+o[1])/2],n(u*p)}E=null,r(e,t),l(m)}function f(){if(is.event.touches.length){for(var t=is.event.changedTouches,i=0,n=t.length;n>i;++i)delete g[t[i].identifier];for(var r in g)return void e()}is.selectAll(_).on(y,null),w.on(A,c).on(P,u),H(),h(m)}var p,d=this,m=L.of(d,arguments),g={},v=0,y=".zoom-"+is.event.changedTouches[0].identifier,T="touchmove"+y,b="touchend"+y,_=[],w=is.select(d),H=q();i(),s(m),w.on(A,null).on(P,i)}function f(){var e=L.of(this,arguments);v?clearTimeout(v):(d=t(m=g||is.mouse(this)),Uh.call(this),s(e)),v=setTimeout(function(){v=null,h(e)},50),x(),n(Math.pow(2,.002*Gs())*R.k),r(m,d),l(e)}function p(){var e=is.mouse(this),i=Math.log(R.k)/Math.LN2;o(this,e,t(e),is.event.shiftKey?Math.ceil(i)-1:Math.floor(i)+1)}var d,m,g,v,E,y,T,b,w,R={x:0,y:0,k:1},H=[960,500],M=qs,S=250,C=0,A="mousedown.zoom",D="mousemove.zoom",k="mouseup.zoom",P="touchstart.zoom",L=_(e,"zoomstart","zoom","zoomend");return e.event=function(e){e.each(function(){var e=L.of(this,arguments),t=R;Ih?is.select(this).transition().each("start.zoom",function(){R=this.__chart__||{x:0,y:0,k:1},s(e)}).tween("zoom:zoom",function(){var i=H[0],n=H[1],r=m?m[0]:i/2,o=m?m[1]:n/2,a=is.interpolateZoom([(r-R.x)/R.k,(o-R.y)/R.k,i/R.k],[(r-t.x)/t.k,(o-t.y)/t.k,i/t.k]);return function(t){var n=a(t),s=i/n[2];this.__chart__=R={x:r-n[0]*s,y:o-n[1]*s,k:s},l(e)}}).each("interrupt.zoom",function(){h(e)}).each("end.zoom",function(){h(e)}):(this.__chart__=R,s(e),l(e),h(e))})},e.translate=function(t){return arguments.length?(R={x:+t[0],y:+t[1],k:R.k},a(),e):[R.x,R.y]},e.scale=function(t){return arguments.length?(R={x:R.x,y:R.y,k:+t},a(),e):R.k},e.scaleExtent=function(t){return arguments.length?(M=null==t?qs:[+t[0],+t[1]],e):M},e.center=function(t){return arguments.length?(g=t&&[+t[0],+t[1]],e):g},e.size=function(t){return arguments.length?(H=t&&[+t[0],+t[1]],e):H},e.duration=function(t){return arguments.length?(S=+t,e):S},e.x=function(t){return arguments.length?(T=t,y=t.copy(),R={x:0,y:0,k:1},e):T},e.y=function(t){return arguments.length?(w=t,b=t.copy(),R={x:0,y:0,k:1},e):w},is.rebind(e,L,"on")};var Gs,qs=[0,1/0],Xs="onwheel"in os?(Gs=function(){return-is.event.deltaY*(is.event.deltaMode?120:1)},"wheel"):"onmousewheel"in os?(Gs=function(){return is.event.wheelDelta},"mousewheel"):(Gs=function(){return-is.event.detail},"MozMousePixelScroll");is.color=ot,ot.prototype.toString=function(){return this.rgb()+""},is.hsl=at;var Ys=at.prototype=new ot;Ys.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),new at(this.h,this.s,this.l/e)},Ys.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new at(this.h,this.s,e*this.l)},Ys.rgb=function(){return st(this.h,this.s,this.l)},is.hcl=lt;var Ks=lt.prototype=new ot;Ks.brighter=function(e){return new lt(this.h,this.c,Math.min(100,this.l+Qs*(arguments.length?e:1)))},Ks.darker=function(e){return new lt(this.h,this.c,Math.max(0,this.l-Qs*(arguments.length?e:1)))},Ks.rgb=function(){return ht(this.h,this.c,this.l).rgb()},is.lab=ct;var Qs=18,$s=.95047,Zs=1,Js=1.08883,el=ct.prototype=new ot;el.brighter=function(e){return new ct(Math.min(100,this.l+Qs*(arguments.length?e:1)),this.a,this.b)},el.darker=function(e){return new ct(Math.max(0,this.l-Qs*(arguments.length?e:1)),this.a,this.b)},el.rgb=function(){return ut(this.l,this.a,this.b)},is.rgb=gt;var tl=gt.prototype=new ot;tl.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,i=this.g,n=this.b,r=30;return t||i||n?(t&&r>t&&(t=r),i&&r>i&&(i=r),n&&r>n&&(n=r),new gt(Math.min(255,t/e),Math.min(255,i/e),Math.min(255,n/e))):new gt(r,r,r)},tl.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),new gt(e*this.r,e*this.g,e*this.b)},tl.hsl=function(){return xt(this.r,this.g,this.b)},tl.toString=function(){return"#"+yt(this.r)+yt(this.g)+yt(this.b)};var il=is.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});il.forEach(function(e,t){il.set(e,vt(t))}),is.functor=Rt,is.xhr=Mt(Ht),is.dsv=function(e,t){function i(e,i,o){arguments.length<3&&(o=i,i=null);var a=St(e,t,null==i?n:r(i),o);return a.row=function(e){return arguments.length?a.response(null==(i=e)?n:r(e)):i},a}function n(e){return i.parse(e.responseText)}function r(e){return function(t){return i.parse(t.responseText,e)}}function o(t){return t.map(a).join(e)}function a(e){return s.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var s=new RegExp('["'+e+"\n]"),l=e.charCodeAt(0);return i.parse=function(e,t){var n;return i.parseRows(e,function(e,i){if(n)return n(e,i-1);var r=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");n=t?function(e,i){return t(r(e),i)}:r})},i.parseRows=function(e,t){function i(){if(c>=h)return a;if(r)return r=!1,o;var t=c;if(34===e.charCodeAt(t)){for(var i=t;i++<h;)if(34===e.charCodeAt(i)){if(34!==e.charCodeAt(i+1))break;++i}c=i+2;var n=e.charCodeAt(i+1);return 13===n?(r=!0,10===e.charCodeAt(i+2)&&++c):10===n&&(r=!0),e.slice(t+1,i).replace(/""/g,'"')}for(;h>c;){var n=e.charCodeAt(c++),s=1;if(10===n)r=!0;else if(13===n)r=!0,10===e.charCodeAt(c)&&(++c,++s);else if(n!==l)continue;return e.slice(t,c-s)}return e.slice(t)}for(var n,r,o={},a={},s=[],h=e.length,c=0,u=0;(n=i())!==a;){for(var f=[];n!==o&&n!==a;)f.push(n),n=i();t&&null==(f=t(f,u++))||s.push(f)}return s},i.format=function(t){if(Array.isArray(t[0]))return i.formatRows(t);var n=new m,r=[];return t.forEach(function(e){for(var t in e)n.has(t)||r.push(n.add(t))}),[r.map(a).join(e)].concat(t.map(function(t){return r.map(function(e){return a(t[e])}).join(e)})).join("\n")},i.formatRows=function(e){return e.map(o).join("\n")},i},is.csv=is.dsv(",","text/csv"),is.tsv=is.dsv("	","text/tab-separated-values");var nl,rl,ol,al,sl,ll=ss[v(ss,"requestAnimationFrame")]||function(e){setTimeout(e,17)};is.timer=function(e,t,i){var n=arguments.length;2>n&&(t=0),3>n&&(i=Date.now());var r=i+t,o={c:e,t:r,f:!1,n:null};rl?rl.n=o:nl=o,rl=o,ol||(al=clearTimeout(al),ol=1,ll(Dt))},is.timer.flush=function(){kt(),Pt()},is.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var hl=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(Nt);is.formatPrefix=function(e,t){var i=0;return e&&(0>e&&(e*=-1),t&&(e=is.round(e,Lt(e,t))),i=1+Math.floor(1e-12+Math.log(e)/Math.LN10),i=Math.max(-24,Math.min(24,3*Math.floor((i-1)/3)))),hl[8+i/3]};var cl=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ul=is.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=is.round(e,Lt(e,t))).toFixed(Math.max(0,Math.min(20,Lt(e*(1+1e-15),t))))}}),fl=is.time={},pl=Date;It.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){dl.setUTCDate.apply(this._,arguments)},setDay:function(){dl.setUTCDay.apply(this._,arguments)},setFullYear:function(){dl.setUTCFullYear.apply(this._,arguments)},setHours:function(){dl.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){dl.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){dl.setUTCMinutes.apply(this._,arguments)},setMonth:function(){dl.setUTCMonth.apply(this._,arguments)},setSeconds:function(){dl.setUTCSeconds.apply(this._,arguments)},setTime:function(){dl.setTime.apply(this._,arguments)}};var dl=Date.prototype;fl.year=Ot(function(e){return e=fl.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),fl.years=fl.year.range,fl.years.utc=fl.year.utc.range,fl.day=Ot(function(e){var t=new pl(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),fl.days=fl.day.range,fl.days.utc=fl.day.utc.range,fl.dayOfYear=function(e){var t=fl.year(e);return Math.floor((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var i=fl[e]=Ot(function(e){return(e=fl.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*Math.floor(t))},function(e){var i=fl.year(e).getDay();return Math.floor((fl.dayOfYear(e)+(i+t)%7)/7)-(i!==t)});fl[e+"s"]=i.range,fl[e+"s"].utc=i.utc.range,fl[e+"OfYear"]=function(e){var i=fl.year(e).getDay();return Math.floor((fl.dayOfYear(e)+(i+t)%7)/7)}}),fl.week=fl.sunday,fl.weeks=fl.sunday.range,fl.weeks.utc=fl.sunday.utc.range,fl.weekOfYear=fl.sundayOfYear;var ml={"-":"",_:" ",0:"0"},gl=/^\s*\d+/,vl=/^%/;is.locale=function(e){return{numberFormat:zt(e),timeFormat:Vt(e)}};var El=is.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});is.format=El.numberFormat,is.geo={},li.prototype={s:0,t:0,add:function(e){hi(e,this.t,yl),hi(yl.s,this.s,this),this.s?this.t+=yl.t:this.s=yl.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var yl=new li;is.geo.stream=function(e,t){e&&Tl.hasOwnProperty(e.type)?Tl[e.type](e,t):ci(e,t)};var Tl={Feature:function(e,t){ci(e.geometry,t)},FeatureCollection:function(e,t){for(var i=e.features,n=-1,r=i.length;++n<r;)ci(i[n].geometry,t)}},xl={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)e=i[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){ui(e.coordinates,t,0)},MultiLineString:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)ui(i[n],t,0)},Polygon:function(e,t){fi(e.coordinates,t)},MultiPolygon:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)fi(i[n],t)},GeometryCollection:function(e,t){for(var i=e.geometries,n=-1,r=i.length;++n<r;)ci(i[n],t)}};is.geo.area=function(e){return bl=0,is.geo.stream(e,wl),bl};var bl,_l=new li,wl={sphere:function(){bl+=4*zs},point:E,lineStart:E,lineEnd:E,polygonStart:function(){_l.reset(),wl.lineStart=pi},polygonEnd:function(){var e=2*_l;bl+=0>e?4*zs+e:e,wl.lineStart=wl.lineEnd=wl.point=E}};is.geo.bounds=function(){function e(e,t){y.push(T=[c=e,f=e]),u>t&&(u=t),t>p&&(p=t)}function t(t,i){var n=di([t*Us,i*Us]);if(v){var r=gi(v,n),o=[r[1],-r[0],0],a=gi(o,r);yi(a),a=Ti(a);var l=t-d,h=l>0?1:-1,m=a[0]*Vs*h,g=gs(l)>180;if(g^(m>h*d&&h*t>m)){var E=a[1]*Vs;E>p&&(p=E)}else if(m=(m+360)%360-180,g^(m>h*d&&h*t>m)){var E=-a[1]*Vs;u>E&&(u=E)}else u>i&&(u=i),i>p&&(p=i);g?d>t?s(c,t)>s(c,f)&&(f=t):s(t,f)>s(c,f)&&(c=t):f>=c?(c>t&&(c=t),t>f&&(f=t)):t>d?s(c,t)>s(c,f)&&(f=t):s(t,f)>s(c,f)&&(c=t)}else e(t,i);v=n,d=t}function i(){x.point=t}function n(){T[0]=c,T[1]=f,x.point=e,v=null}function r(e,i){if(v){var n=e-d;E+=gs(n)>180?n+(n>0?360:-360):n}else m=e,g=i;wl.point(e,i),t(e,i)}function o(){wl.lineStart()}function a(){r(m,g),wl.lineEnd(),gs(E)>Ls&&(c=-(f=180)),T[0]=c,T[1]=f,v=null}function s(e,t){return(t-=e)<0?t+360:t}function l(e,t){return e[0]-t[0]}function h(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var c,u,f,p,d,m,g,v,E,y,T,x={point:e,lineStart:i,lineEnd:n,polygonStart:function(){x.point=r,x.lineStart=o,x.lineEnd=a,E=0,wl.polygonStart()},polygonEnd:function(){wl.polygonEnd(),x.point=e,x.lineStart=i,x.lineEnd=n,0>_l?(c=-(f=180),u=-(p=90)):E>Ls?p=90:-Ls>E&&(u=-90),T[0]=c,T[1]=f}};return function(e){p=f=-(c=u=1/0),y=[],is.geo.stream(e,x);var t=y.length;if(t){y.sort(l);for(var i,n=1,r=y[0],o=[r];t>n;++n)i=y[n],h(i[0],r)||h(i[1],r)?(s(r[0],i[1])>s(r[0],r[1])&&(r[1]=i[1]),s(i[0],r[1])>s(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(var a,i,d=-1/0,t=o.length-1,n=0,r=o[t];t>=n;r=i,++n)i=o[n],(a=s(r[1],i[0]))>d&&(d=a,c=i[0],f=r[1])}return y=T=null,1/0===c||1/0===u?[[0/0,0/0],[0/0,0/0]]:[[c,u],[f,p]]}}(),is.geo.centroid=function(e){Rl=Hl=Ml=Sl=Cl=Al=Dl=kl=Pl=Ll=Nl=0,is.geo.stream(e,zl);var t=Pl,i=Ll,n=Nl,r=t*t+i*i+n*n;return Ns>r&&(t=Al,i=Dl,n=kl,Ls>Hl&&(t=Ml,i=Sl,n=Cl),r=t*t+i*i+n*n,Ns>r)?[0/0,0/0]:[Math.atan2(i,t)*Vs,et(n/Math.sqrt(r))*Vs]};var Rl,Hl,Ml,Sl,Cl,Al,Dl,kl,Pl,Ll,Nl,zl={sphere:E,point:bi,lineStart:wi,lineEnd:Ri,polygonStart:function(){zl.lineStart=Hi},polygonEnd:function(){zl.lineStart=wi}},Fl=ki(Si,zi,Ii,[-zs,-zs/2]),Il=1e9;is.geo.clipExtent=function(){var e,t,i,n,r,o,a={stream:function(e){return r&&(r.valid=!1),r=o(e),r.valid=!0,r},extent:function(s){return arguments.length?(o=Bi(e=+s[0][0],t=+s[0][1],i=+s[1][0],n=+s[1][1]),r&&(r.valid=!1,r=null),a):[[e,t],[i,n]]}};return a.extent([[0,0],[960,500]])},(is.geo.conicEqualArea=function(){return Wi(ji)}).raw=ji,is.geo.albers=function(){return is.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},is.geo.albersUsa=function(){function e(e){var o=e[0],a=e[1];return t=null,i(o,a),t||(n(o,a),t)||r(o,a),t}var t,i,n,r,o=is.geo.albers(),a=is.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=is.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,i){t=[e,i]}};return e.invert=function(e){var t=o.scale(),i=o.translate(),n=(e[0]-i[0])/t,r=(e[1]-i[1])/t;return(r>=.12&&.234>r&&n>=-.425&&-.214>n?a:r>=.166&&.234>r&&n>=-.214&&-.115>n?s:o).invert(e)},e.stream=function(e){var t=o.stream(e),i=a.stream(e),n=s.stream(e);return{point:function(e,r){t.point(e,r),i.point(e,r),n.point(e,r)},sphere:function(){t.sphere(),i.sphere(),n.sphere()},lineStart:function(){t.lineStart(),i.lineStart(),n.lineStart()},lineEnd:function(){t.lineEnd(),i.lineEnd(),n.lineEnd()},polygonStart:function(){t.polygonStart(),i.polygonStart(),n.polygonStart()},polygonEnd:function(){t.polygonEnd(),i.polygonEnd(),n.polygonEnd()}}},e.precision=function(t){return arguments.length?(o.precision(t),a.precision(t),s.precision(t),e):o.precision()},e.scale=function(t){return arguments.length?(o.scale(t),a.scale(.35*t),s.scale(t),e.translate(o.translate())):o.scale()},e.translate=function(t){if(!arguments.length)return o.translate();var h=o.scale(),c=+t[0],u=+t[1];return i=o.translate(t).clipExtent([[c-.455*h,u-.238*h],[c+.455*h,u+.238*h]]).stream(l).point,n=a.translate([c-.307*h,u+.201*h]).clipExtent([[c-.425*h+Ls,u+.12*h+Ls],[c-.214*h-Ls,u+.234*h-Ls]]).stream(l).point,r=s.translate([c-.205*h,u+.212*h]).clipExtent([[c-.214*h+Ls,u+.166*h+Ls],[c-.115*h-Ls,u+.234*h-Ls]]).stream(l).point,e},e.scale(1070)};var Ol,Ul,Vl,Bl,Wl,jl,Gl={point:E,lineStart:E,lineEnd:E,polygonStart:function(){Ul=0,Gl.lineStart=Gi},polygonEnd:function(){Gl.lineStart=Gl.lineEnd=Gl.point=E,Ol+=gs(Ul/2)}},ql={point:qi,lineStart:E,lineEnd:E,polygonStart:E,polygonEnd:E},Xl={point:Ki,lineStart:Qi,lineEnd:$i,polygonStart:function(){Xl.lineStart=Zi},polygonEnd:function(){Xl.point=Ki,Xl.lineStart=Qi,Xl.lineEnd=$i}};is.geo.path=function(){function e(e){return e&&("function"==typeof s&&o.pointRadius(+s.apply(this,arguments)),a&&a.valid||(a=r(o)),is.geo.stream(e,a)),o.result()}function t(){return a=null,e}var i,n,r,o,a,s=4.5;return e.area=function(e){return Ol=0,is.geo.stream(e,r(Gl)),Ol},e.centroid=function(e){return Ml=Sl=Cl=Al=Dl=kl=Pl=Ll=Nl=0,is.geo.stream(e,r(Xl)),Nl?[Pl/Nl,Ll/Nl]:kl?[Al/kl,Dl/kl]:Cl?[Ml/Cl,Sl/Cl]:[0/0,0/0]},e.bounds=function(e){return Wl=jl=-(Vl=Bl=1/0),is.geo.stream(e,r(ql)),[[Vl,Bl],[Wl,jl]]},e.projection=function(e){return arguments.length?(r=(i=e)?e.stream||tn(e):Ht,t()):i},e.context=function(e){return arguments.length?(o=null==(n=e)?new Xi:new Ji(e),"function"!=typeof s&&o.pointRadius(s),t()):n},e.pointRadius=function(t){return arguments.length?(s="function"==typeof t?t:(o.pointRadius(+t),+t),e):s},e.projection(is.geo.albersUsa()).context(null)},is.geo.transform=function(e){return{stream:function(t){var i=new nn(t);for(var n in e)i[n]=e[n];return i}}},nn.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},is.geo.projection=on,is.geo.projectionMutator=an,(is.geo.equirectangular=function(){return on(ln)}).raw=ln.invert=ln,is.geo.rotation=function(e){function t(t){return t=e(t[0]*Us,t[1]*Us),t[0]*=Vs,t[1]*=Vs,t}return e=cn(e[0]%360*Us,e[1]*Us,e.length>2?e[2]*Us:0),t.invert=function(t){return t=e.invert(t[0]*Us,t[1]*Us),t[0]*=Vs,t[1]*=Vs,t},t},hn.invert=ln,is.geo.circle=function(){function e(){var e="function"==typeof n?n.apply(this,arguments):n,t=cn(-e[0]*Us,-e[1]*Us,0).invert,r=[];return i(null,null,1,{point:function(e,i){r.push(e=t(e,i)),e[0]*=Vs,e[1]*=Vs}}),{type:"Polygon",coordinates:[r]}}var t,i,n=[0,0],r=6;return e.origin=function(t){return arguments.length?(n=t,e):n},e.angle=function(n){return arguments.length?(i=dn((t=+n)*Us,r*Us),e):t},e.precision=function(n){return arguments.length?(i=dn(t*Us,(r=+n)*Us),e):r},e.angle(90)},is.geo.distance=function(e,t){var i,n=(t[0]-e[0])*Us,r=e[1]*Us,o=t[1]*Us,a=Math.sin(n),s=Math.cos(n),l=Math.sin(r),h=Math.cos(r),c=Math.sin(o),u=Math.cos(o);return Math.atan2(Math.sqrt((i=u*a)*i+(i=h*c-l*u*s)*i),l*c+h*u*s)},is.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return is.range(Math.ceil(o/g)*g,r,g).map(f).concat(is.range(Math.ceil(h/v)*v,l,v).map(p)).concat(is.range(Math.ceil(n/d)*d,i,d).filter(function(e){return gs(e%g)>Ls}).map(c)).concat(is.range(Math.ceil(s/m)*m,a,m).filter(function(e){return gs(e%v)>Ls}).map(u))}var i,n,r,o,a,s,l,h,c,u,f,p,d=10,m=d,g=90,v=360,E=2.5;return e.lines=function(){return t().map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[f(o).concat(p(l).slice(1),f(r).reverse().slice(1),p(h).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(o=+t[0][0],r=+t[1][0],h=+t[0][1],l=+t[1][1],o>r&&(t=o,o=r,r=t),h>l&&(t=h,h=l,l=t),e.precision(E)):[[o,h],[r,l]]},e.minorExtent=function(t){return arguments.length?(n=+t[0][0],i=+t[1][0],s=+t[0][1],a=+t[1][1],n>i&&(t=n,n=i,i=t),s>a&&(t=s,s=a,a=t),e.precision(E)):[[n,s],[i,a]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(g=+t[0],v=+t[1],e):[g,v]},e.minorStep=function(t){return arguments.length?(d=+t[0],m=+t[1],e):[d,m]},e.precision=function(t){return arguments.length?(E=+t,c=gn(s,a,90),u=vn(n,i,E),f=gn(h,l,90),p=vn(o,r,E),e):E},e.majorExtent([[-180,-90+Ls],[180,90-Ls]]).minorExtent([[-180,-80-Ls],[180,80+Ls]])},is.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[t||n.apply(this,arguments),i||r.apply(this,arguments)]}}var t,i,n=En,r=yn;return e.distance=function(){return is.geo.distance(t||n.apply(this,arguments),i||r.apply(this,arguments))},e.source=function(i){return arguments.length?(n=i,t="function"==typeof i?null:i,e):n},e.target=function(t){return arguments.length?(r=t,i="function"==typeof t?null:t,e):r},e.precision=function(){return arguments.length?e:0},e},is.geo.interpolate=function(e,t){return Tn(e[0]*Us,e[1]*Us,t[0]*Us,t[1]*Us)},is.geo.length=function(e){return Yl=0,is.geo.stream(e,Kl),Yl};var Yl,Kl={sphere:E,point:E,lineStart:xn,lineEnd:E,polygonStart:E,polygonEnd:E},Ql=bn(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(is.geo.azimuthalEqualArea=function(){return on(Ql)}).raw=Ql;var $l=bn(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},Ht);(is.geo.azimuthalEquidistant=function(){return on($l)}).raw=$l,(is.geo.conicConformal=function(){return Wi(_n)}).raw=_n,(is.geo.conicEquidistant=function(){return Wi(wn)}).raw=wn;var Zl=bn(function(e){return 1/e},Math.atan);(is.geo.gnomonic=function(){return on(Zl)}).raw=Zl,Rn.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-Os]},(is.geo.mercator=function(){return Hn(Rn)}).raw=Rn;var Jl=bn(function(){return 1},Math.asin);(is.geo.orthographic=function(){return on(Jl)}).raw=Jl;var eh=bn(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(is.geo.stereographic=function(){return on(eh)}).raw=eh,Mn.invert=function(e,t){return[-t,2*Math.atan(Math.exp(e))-Os]},(is.geo.transverseMercator=function(){var e=Hn(Mn),t=e.center,i=e.rotate;return e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return e?i([e[0],e[1],e.length>2?e[2]+90:90]):(e=i(),[e[0],e[1],e[2]-90])},i([0,0,90])}).raw=Mn,is.geom={},is.geom.hull=function(e){function t(e){if(e.length<3)return[];var t,r=Rt(i),o=Rt(n),a=e.length,s=[],l=[];for(t=0;a>t;t++)s.push([+r.call(this,e[t],t),+o.call(this,e[t],t),t]);for(s.sort(Dn),t=0;a>t;t++)l.push([s[t][0],-s[t][1]]);var h=An(s),c=An(l),u=c[0]===h[0],f=c[c.length-1]===h[h.length-1],p=[];for(t=h.length-1;t>=0;--t)p.push(e[s[h[t]][2]]);for(t=+u;t<c.length-f;++t)p.push(e[s[c[t]][2]]);return p}var i=Sn,n=Cn;return arguments.length?t(e):(t.x=function(e){return arguments.length?(i=e,t):i},t.y=function(e){return arguments.length?(n=e,t):n},t)},is.geom.polygon=function(e){return xs(e,th),e};var th=is.geom.polygon.prototype=[];th.area=function(){for(var e,t=-1,i=this.length,n=this[i-1],r=0;++t<i;)e=n,n=this[t],r+=e[1]*n[0]-e[0]*n[1];return.5*r},th.centroid=function(e){var t,i,n=-1,r=this.length,o=0,a=0,s=this[r-1];for(arguments.length||(e=-1/(6*this.area()));++n<r;)t=s,s=this[n],i=t[0]*s[1]-s[0]*t[1],o+=(t[0]+s[0])*i,a+=(t[1]+s[1])*i;return[o*e,a*e]},th.clip=function(e){for(var t,i,n,r,o,a,s=Ln(e),l=-1,h=this.length-Ln(this),c=this[h-1];++l<h;){for(t=e.slice(),e.length=0,r=this[l],o=t[(n=t.length-s)-1],i=-1;++i<n;)a=t[i],kn(a,c,r)?(kn(o,c,r)||e.push(Pn(o,a,c,r)),e.push(a)):kn(o,c,r)&&e.push(Pn(o,a,c,r)),o=a;s&&e.push(e[0]),c=r}return e};var ih,nh,rh,oh,ah,sh=[],lh=[];Bn.prototype.prepare=function(){for(var e,t=this.edges,i=t.length;i--;)e=t[i].edge,e.b&&e.a||t.splice(i,1);return t.sort(jn),t.length},er.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},tr.prototype={insert:function(e,t){var i,n,r;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;i=e}else this._?(e=or(this._),t.P=null,t.N=e,e.P=e.L=t,i=e):(t.P=t.N=null,this._=t,i=null);for(t.L=t.R=null,t.U=i,t.C=!0,e=t;i&&i.C;)n=i.U,i===n.L?(r=n.R,r&&r.C?(i.C=r.C=!1,n.C=!0,e=n):(e===i.R&&(nr(this,i),e=i,i=e.U),i.C=!1,n.C=!0,rr(this,n))):(r=n.L,r&&r.C?(i.C=r.C=!1,n.C=!0,e=n):(e===i.L&&(rr(this,i),e=i,i=e.U),i.C=!1,n.C=!0,nr(this,n))),i=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,i,n,r=e.U,o=e.L,a=e.R;if(i=o?a?or(a):o:a,r?r.L===e?r.L=i:r.R=i:this._=i,o&&a?(n=i.C,i.C=e.C,i.L=o,o.U=i,i!==a?(r=i.U,i.U=e.U,e=i.R,r.L=e,i.R=a,a.U=i):(i.U=r,r=i,e=i.R)):(n=e.C,e=i),e&&(e.U=r),!n){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===r.L){if(t=r.R,t.C&&(t.C=!1,r.C=!0,nr(this,r),t=r.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,rr(this,t),t=r.R),t.C=r.C,r.C=t.R.C=!1,nr(this,r),e=this._;break}}else if(t=r.L,t.C&&(t.C=!1,r.C=!0,rr(this,r),t=r.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,nr(this,t),t=r.L),t.C=r.C,r.C=t.L.C=!1,rr(this,r),e=this._;break}t.C=!0,e=r,r=r.U}while(!e.C);e&&(e.C=!1)}}},is.geom.voronoi=function(e){function t(e){var t=new Array(e.length),n=s[0][0],r=s[0][1],o=s[1][0],a=s[1][1];return ar(i(e),s).cells.forEach(function(i,s){var l=i.edges,h=i.site,c=t[s]=l.length?l.map(function(e){var t=e.start();return[t.x,t.y]}):h.x>=n&&h.x<=o&&h.y>=r&&h.y<=a?[[n,a],[o,a],[o,r],[n,r]]:[];c.point=e[s]}),t}function i(e){return e.map(function(e,t){return{x:Math.round(o(e,t)/Ls)*Ls,y:Math.round(a(e,t)/Ls)*Ls,i:t}})}var n=Sn,r=Cn,o=n,a=r,s=hh;return e?t(e):(t.links=function(e){return ar(i(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})},t.triangles=function(e){var t=[];return ar(i(e)).cells.forEach(function(i,n){for(var r,o,a=i.site,s=i.edges.sort(jn),l=-1,h=s.length,c=s[h-1].edge,u=c.l===a?c.r:c.l;++l<h;)r=c,o=u,c=s[l].edge,u=c.l===a?c.r:c.l,n<o.i&&n<u.i&&lr(a,o,u)<0&&t.push([e[n],e[o.i],e[u.i]])}),t},t.x=function(e){return arguments.length?(o=Rt(n=e),t):n},t.y=function(e){return arguments.length?(a=Rt(r=e),t):r},t.clipExtent=function(e){return arguments.length?(s=null==e?hh:e,t):s===hh?null:s},t.size=function(e){return arguments.length?t.clipExtent(e&&[[0,0],e]):s===hh?null:s&&s[1]},t)};var hh=[[-1e6,-1e6],[1e6,1e6]];is.geom.delaunay=function(e){return is.geom.voronoi().triangles(e)},is.geom.quadtree=function(e,t,i,n,r){function o(e){function o(e,t,i,n,r,o,a,s){if(!isNaN(i)&&!isNaN(n))if(e.leaf){var l=e.x,c=e.y;if(null!=l)if(gs(l-i)+gs(c-n)<.01)h(e,t,i,n,r,o,a,s);else{var u=e.point;e.x=e.y=e.point=null,h(e,u,l,c,r,o,a,s),h(e,t,i,n,r,o,a,s)}else e.x=i,e.y=n,e.point=t}else h(e,t,i,n,r,o,a,s)}function h(e,t,i,n,r,a,s,l){var h=.5*(r+s),c=.5*(a+l),u=i>=h,f=n>=c,p=f<<1|u;e.leaf=!1,e=e.nodes[p]||(e.nodes[p]=ur()),u?r=h:s=h,f?a=c:l=c,o(e,t,i,n,r,a,s,l)}var c,u,f,p,d,m,g,v,E,y=Rt(s),T=Rt(l);if(null!=t)m=t,g=i,v=n,E=r;else if(v=E=-(m=g=1/0),u=[],f=[],d=e.length,a)for(p=0;d>p;++p)c=e[p],c.x<m&&(m=c.x),c.y<g&&(g=c.y),c.x>v&&(v=c.x),c.y>E&&(E=c.y),u.push(c.x),f.push(c.y);else for(p=0;d>p;++p){var x=+y(c=e[p],p),b=+T(c,p);m>x&&(m=x),g>b&&(g=b),x>v&&(v=x),b>E&&(E=b),u.push(x),f.push(b)}var _=v-m,w=E-g;_>w?E=g+_:v=m+w;var R=ur();if(R.add=function(e){o(R,e,+y(e,++p),+T(e,p),m,g,v,E)},R.visit=function(e){fr(e,R,m,g,v,E)},R.find=function(e){return pr(R,e[0],e[1],m,g,v,E)},p=-1,null==t){for(;++p<d;)o(R,e[p],u[p],f[p],m,g,v,E);--p}else e.forEach(R.add);return u=f=e=c=null,R}var a,s=Sn,l=Cn;return(a=arguments.length)?(s=hr,l=cr,3===a&&(r=i,n=t,i=t=0),o(e)):(o.x=function(e){return arguments.length?(s=e,o):s},o.y=function(e){return arguments.length?(l=e,o):l},o.extent=function(e){return arguments.length?(null==e?t=i=n=r=null:(t=+e[0][0],i=+e[0][1],n=+e[1][0],r=+e[1][1]),o):null==t?null:[[t,i],[n,r]]},o.size=function(e){return arguments.length?(null==e?t=i=n=r=null:(t=i=0,n=+e[0],r=+e[1]),o):null==t?null:[n-t,r-i]},o)},is.interpolateRgb=dr,is.interpolateObject=mr,is.interpolateNumber=gr,is.interpolateString=vr;var ch=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,uh=new RegExp(ch.source,"g");is.interpolate=Er,is.interpolators=[function(e,t){var i=typeof t;return("string"===i?il.has(t)||/^(#|rgb\(|hsl\()/.test(t)?dr:vr:t instanceof ot?dr:Array.isArray(t)?yr:"object"===i&&isNaN(t)?mr:gr)(e,t)}],is.interpolateArray=yr;var fh=function(){return Ht},ph=is.map({linear:fh,poly:Hr,quad:function(){return _r},cubic:function(){return wr},sin:function(){return Mr},exp:function(){return Sr},circle:function(){return Cr},elastic:Ar,back:Dr,bounce:function(){return kr}}),dh=is.map({"in":Ht,out:xr,"in-out":br,"out-in":function(e){return br(xr(e))
}});is.ease=function(e){var t=e.indexOf("-"),i=t>=0?e.slice(0,t):e,n=t>=0?e.slice(t+1):"in";return i=ph.get(i)||fh,n=dh.get(n)||Ht,Tr(n(i.apply(null,ns.call(arguments,1))))},is.interpolateHcl=Pr,is.interpolateHsl=Lr,is.interpolateLab=Nr,is.interpolateRound=zr,is.transform=function(e){var t=os.createElementNS(is.ns.prefix.svg,"g");return(is.transform=function(e){if(null!=e){t.setAttribute("transform",e);var i=t.transform.baseVal.consolidate()}return new Fr(i?i.matrix:mh)})(e)},Fr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var mh={a:1,b:0,c:0,d:1,e:0,f:0};is.interpolateTransform=Vr,is.layout={},is.layout.bundle=function(){return function(e){for(var t=[],i=-1,n=e.length;++i<n;)t.push(jr(e[i]));return t}},is.layout.chord=function(){function e(){var e,h,u,f,p,d={},m=[],g=is.range(o),v=[];for(i=[],n=[],e=0,f=-1;++f<o;){for(h=0,p=-1;++p<o;)h+=r[f][p];m.push(h),v.push(is.range(o)),e+=h}for(a&&g.sort(function(e,t){return a(m[e],m[t])}),s&&v.forEach(function(e,t){e.sort(function(e,i){return s(r[t][e],r[t][i])})}),e=(Fs-c*o)/e,h=0,f=-1;++f<o;){for(u=h,p=-1;++p<o;){var E=g[f],y=v[E][p],T=r[E][y],x=h,b=h+=T*e;d[E+"-"+y]={index:E,subindex:y,startAngle:x,endAngle:b,value:T}}n[E]={index:E,startAngle:u,endAngle:h,value:(h-u)/e},h+=c}for(f=-1;++f<o;)for(p=f-1;++p<o;){var _=d[f+"-"+p],w=d[p+"-"+f];(_.value||w.value)&&i.push(_.value<w.value?{source:w,target:_}:{source:_,target:w})}l&&t()}function t(){i.sort(function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var i,n,r,o,a,s,l,h={},c=0;return h.matrix=function(e){return arguments.length?(o=(r=e)&&r.length,i=n=null,h):r},h.padding=function(e){return arguments.length?(c=e,i=n=null,h):c},h.sortGroups=function(e){return arguments.length?(a=e,i=n=null,h):a},h.sortSubgroups=function(e){return arguments.length?(s=e,i=null,h):s},h.sortChords=function(e){return arguments.length?(l=e,i&&t(),h):l},h.chords=function(){return i||e(),i},h.groups=function(){return n||e(),n},h},is.layout.force=function(){function e(e){return function(t,i,n,r){if(t.point!==e){var o=t.cx-e.x,a=t.cy-e.y,s=r-i,l=o*o+a*a;if(l>s*s/g){if(d>l){var h=t.charge/l;e.px-=o*h,e.py-=a*h}return!0}if(t.point&&l&&d>l){var h=t.pointCharge/l;e.px-=o*h,e.py-=a*h}}return!t.charge}}function t(e){e.px=is.event.x,e.py=is.event.y,s.resume()}var i,n,r,o,a,s={},l=is.dispatch("start","tick","end"),h=[1,1],c=.9,u=gh,f=vh,p=-30,d=Eh,m=.1,g=.64,v=[],E=[];return s.tick=function(){if((n*=.99)<.005)return l.end({type:"end",alpha:n=0}),!0;var t,i,s,u,f,d,g,y,T,x=v.length,b=E.length;for(i=0;b>i;++i)s=E[i],u=s.source,f=s.target,y=f.x-u.x,T=f.y-u.y,(d=y*y+T*T)&&(d=n*o[i]*((d=Math.sqrt(d))-r[i])/d,y*=d,T*=d,f.x-=y*(g=u.weight/(f.weight+u.weight)),f.y-=T*g,u.x+=y*(g=1-g),u.y+=T*g);if((g=n*m)&&(y=h[0]/2,T=h[1]/2,i=-1,g))for(;++i<x;)s=v[i],s.x+=(y-s.x)*g,s.y+=(T-s.y)*g;if(p)for($r(t=is.geom.quadtree(v),n,a),i=-1;++i<x;)(s=v[i]).fixed||t.visit(e(s));for(i=-1;++i<x;)s=v[i],s.fixed?(s.x=s.px,s.y=s.py):(s.x-=(s.px-(s.px=s.x))*c,s.y-=(s.py-(s.py=s.y))*c);l.tick({type:"tick",alpha:n})},s.nodes=function(e){return arguments.length?(v=e,s):v},s.links=function(e){return arguments.length?(E=e,s):E},s.size=function(e){return arguments.length?(h=e,s):h},s.linkDistance=function(e){return arguments.length?(u="function"==typeof e?e:+e,s):u},s.distance=s.linkDistance,s.linkStrength=function(e){return arguments.length?(f="function"==typeof e?e:+e,s):f},s.friction=function(e){return arguments.length?(c=+e,s):c},s.charge=function(e){return arguments.length?(p="function"==typeof e?e:+e,s):p},s.chargeDistance=function(e){return arguments.length?(d=e*e,s):Math.sqrt(d)},s.gravity=function(e){return arguments.length?(m=+e,s):m},s.theta=function(e){return arguments.length?(g=e*e,s):Math.sqrt(g)},s.alpha=function(e){return arguments.length?(e=+e,n?n=e>0?e:0:e>0&&(l.start({type:"start",alpha:n=e}),is.timer(s.tick)),s):n},s.start=function(){function e(e,n){if(!i){for(i=new Array(l),s=0;l>s;++s)i[s]=[];for(s=0;h>s;++s){var r=E[s];i[r.source.index].push(r.target),i[r.target.index].push(r.source)}}for(var o,a=i[t],s=-1,h=a.length;++s<h;)if(!isNaN(o=a[s][e]))return o;return Math.random()*n}var t,i,n,l=v.length,c=E.length,d=h[0],m=h[1];for(t=0;l>t;++t)(n=v[t]).index=t,n.weight=0;for(t=0;c>t;++t)n=E[t],"number"==typeof n.source&&(n.source=v[n.source]),"number"==typeof n.target&&(n.target=v[n.target]),++n.source.weight,++n.target.weight;for(t=0;l>t;++t)n=v[t],isNaN(n.x)&&(n.x=e("x",d)),isNaN(n.y)&&(n.y=e("y",m)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(r=[],"function"==typeof u)for(t=0;c>t;++t)r[t]=+u.call(this,E[t],t);else for(t=0;c>t;++t)r[t]=u;if(o=[],"function"==typeof f)for(t=0;c>t;++t)o[t]=+f.call(this,E[t],t);else for(t=0;c>t;++t)o[t]=f;if(a=[],"function"==typeof p)for(t=0;l>t;++t)a[t]=+p.call(this,v[t],t);else for(t=0;l>t;++t)a[t]=p;return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){return i||(i=is.behavior.drag().origin(Ht).on("dragstart.force",Xr).on("drag.force",t).on("dragend.force",Yr)),arguments.length?void this.on("mouseover.force",Kr).on("mouseout.force",Qr).call(i):i},is.rebind(s,l,"on")};var gh=20,vh=1,Eh=1/0;is.layout.hierarchy=function(){function e(r){var o,a=[r],s=[];for(r.depth=0;null!=(o=a.pop());)if(s.push(o),(h=i.call(e,o,o.depth))&&(l=h.length)){for(var l,h,c;--l>=0;)a.push(c=h[l]),c.parent=o,c.depth=o.depth+1;n&&(o.value=0),o.children=h}else n&&(o.value=+n.call(e,o,o.depth)||0),delete o.children;return eo(r,function(e){var i,r;t&&(i=e.children)&&i.sort(t),n&&(r=e.parent)&&(r.value+=e.value)}),s}var t=no,i=to,n=io;return e.sort=function(i){return arguments.length?(t=i,e):t},e.children=function(t){return arguments.length?(i=t,e):i},e.value=function(t){return arguments.length?(n=t,e):n},e.revalue=function(t){return n&&(Jr(t,function(e){e.children&&(e.value=0)}),eo(t,function(t){var i;t.children||(t.value=+n.call(e,t,t.depth)||0),(i=t.parent)&&(i.value+=t.value)})),t},e},is.layout.partition=function(){function e(t,i,n,r){var o=t.children;if(t.x=i,t.y=t.depth*r,t.dx=n,t.dy=r,o&&(a=o.length)){var a,s,l,h=-1;for(n=t.value?n/t.value:0;++h<a;)e(s=o[h],i,l=s.value*n,r),i+=l}}function t(e){var i=e.children,n=0;if(i&&(r=i.length))for(var r,o=-1;++o<r;)n=Math.max(n,t(i[o]));return 1+n}function i(i,o){var a=n.call(this,i,o);return e(a[0],0,r[0],r[1]/t(a[0])),a}var n=is.layout.hierarchy(),r=[1,1];return i.size=function(e){return arguments.length?(r=e,i):r},Zr(i,n)},is.layout.pie=function(){function e(a){var s,l=a.length,h=a.map(function(i,n){return+t.call(e,i,n)}),c=+("function"==typeof n?n.apply(this,arguments):n),u=("function"==typeof r?r.apply(this,arguments):r)-c,f=Math.min(Math.abs(u)/l,+("function"==typeof o?o.apply(this,arguments):o)),p=f*(0>u?-1:1),d=(u-l*p)/is.sum(h),m=is.range(l),g=[];return null!=i&&m.sort(i===yh?function(e,t){return h[t]-h[e]}:function(e,t){return i(a[e],a[t])}),m.forEach(function(e){g[e]={data:a[e],value:s=h[e],startAngle:c,endAngle:c+=s*d+p,padAngle:f}}),g}var t=Number,i=yh,n=0,r=Fs,o=0;return e.value=function(i){return arguments.length?(t=i,e):t},e.sort=function(t){return arguments.length?(i=t,e):i},e.startAngle=function(t){return arguments.length?(n=t,e):n},e.endAngle=function(t){return arguments.length?(r=t,e):r},e.padAngle=function(t){return arguments.length?(o=t,e):o},e};var yh={};is.layout.stack=function(){function e(s,l){if(!(f=s.length))return s;var h=s.map(function(i,n){return t.call(e,i,n)}),c=h.map(function(t){return t.map(function(t,i){return[o.call(e,t,i),a.call(e,t,i)]})}),u=i.call(e,c,l);h=is.permute(h,u),c=is.permute(c,u);var f,p,d,m,g=n.call(e,c,l),v=h[0].length;for(d=0;v>d;++d)for(r.call(e,h[0][d],m=g[d],c[0][d][1]),p=1;f>p;++p)r.call(e,h[p][d],m+=c[p-1][d][1],c[p][d][1]);return s}var t=Ht,i=lo,n=ho,r=so,o=oo,a=ao;return e.values=function(i){return arguments.length?(t=i,e):t},e.order=function(t){return arguments.length?(i="function"==typeof t?t:Th.get(t)||lo,e):i},e.offset=function(t){return arguments.length?(n="function"==typeof t?t:xh.get(t)||ho,e):n},e.x=function(t){return arguments.length?(o=t,e):o},e.y=function(t){return arguments.length?(a=t,e):a},e.out=function(t){return arguments.length?(r=t,e):r},e};var Th=is.map({"inside-out":function(e){var t,i,n=e.length,r=e.map(co),o=e.map(uo),a=is.range(n).sort(function(e,t){return r[e]-r[t]}),s=0,l=0,h=[],c=[];for(t=0;n>t;++t)i=a[t],l>s?(s+=o[i],h.push(i)):(l+=o[i],c.push(i));return c.reverse().concat(h)},reverse:function(e){return is.range(e.length).reverse()},"default":lo}),xh=is.map({silhouette:function(e){var t,i,n,r=e.length,o=e[0].length,a=[],s=0,l=[];for(i=0;o>i;++i){for(t=0,n=0;r>t;t++)n+=e[t][i][1];n>s&&(s=n),a.push(n)}for(i=0;o>i;++i)l[i]=(s-a[i])/2;return l},wiggle:function(e){var t,i,n,r,o,a,s,l,h,c=e.length,u=e[0],f=u.length,p=[];for(p[0]=l=h=0,i=1;f>i;++i){for(t=0,r=0;c>t;++t)r+=e[t][i][1];for(t=0,o=0,s=u[i][0]-u[i-1][0];c>t;++t){for(n=0,a=(e[t][i][1]-e[t][i-1][1])/(2*s);t>n;++n)a+=(e[n][i][1]-e[n][i-1][1])/s;o+=a*e[t][i][1]}p[i]=l-=r?o/r*s:0,h>l&&(h=l)}for(i=0;f>i;++i)p[i]-=h;return p},expand:function(e){var t,i,n,r=e.length,o=e[0].length,a=1/r,s=[];for(i=0;o>i;++i){for(t=0,n=0;r>t;t++)n+=e[t][i][1];if(n)for(t=0;r>t;t++)e[t][i][1]/=n;else for(t=0;r>t;t++)e[t][i][1]=a}for(i=0;o>i;++i)s[i]=0;return s},zero:ho});is.layout.histogram=function(){function e(e,o){for(var a,s,l=[],h=e.map(i,this),c=n.call(this,h,o),u=r.call(this,c,h,o),o=-1,f=h.length,p=u.length-1,d=t?1:1/f;++o<p;)a=l[o]=[],a.dx=u[o+1]-(a.x=u[o]),a.y=0;if(p>0)for(o=-1;++o<f;)s=h[o],s>=c[0]&&s<=c[1]&&(a=l[is.bisect(u,s,1,p)-1],a.y+=d,a.push(e[o]));return l}var t=!0,i=Number,n=go,r=po;return e.value=function(t){return arguments.length?(i=t,e):i},e.range=function(t){return arguments.length?(n=Rt(t),e):n},e.bins=function(t){return arguments.length?(r="number"==typeof t?function(e){return mo(e,t)}:Rt(t),e):r},e.frequency=function(i){return arguments.length?(t=!!i,e):t},e},is.layout.pack=function(){function e(e,o){var a=i.call(this,e,o),s=a[0],l=r[0],h=r[1],c=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(s.x=s.y=0,eo(s,function(e){e.r=+c(e.value)}),eo(s,xo),n){var u=n*(t?1:Math.max(2*s.r/l,2*s.r/h))/2;eo(s,function(e){e.r+=u}),eo(s,xo),eo(s,function(e){e.r-=u})}return wo(s,l/2,h/2,t?1:1/Math.max(2*s.r/l,2*s.r/h)),a}var t,i=is.layout.hierarchy().sort(vo),n=0,r=[1,1];return e.size=function(t){return arguments.length?(r=t,e):r},e.radius=function(i){return arguments.length?(t=null==i||"function"==typeof i?i:+i,e):t},e.padding=function(t){return arguments.length?(n=+t,e):n},Zr(e,i)},is.layout.tree=function(){function e(e,r){var c=a.call(this,e,r),u=c[0],f=t(u);if(eo(f,i),f.parent.m=-f.z,Jr(f,n),h)Jr(u,o);else{var p=u,d=u,m=u;Jr(u,function(e){e.x<p.x&&(p=e),e.x>d.x&&(d=e),e.depth>m.depth&&(m=e)});var g=s(p,d)/2-p.x,v=l[0]/(d.x+s(d,p)/2+g),E=l[1]/(m.depth||1);Jr(u,function(e){e.x=(e.x+g)*v,e.y=e.depth*E})}return c}function t(e){for(var t,i={A:null,children:[e]},n=[i];null!=(t=n.pop());)for(var r,o=t.children,a=0,s=o.length;s>a;++a)n.push((o[a]=r={_:o[a],parent:t,children:(r=o[a].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=r);return i.children[0]}function i(e){var t=e.children,i=e.parent.children,n=e.i?i[e.i-1]:null;if(t.length){Ao(e);var o=(t[0].z+t[t.length-1].z)/2;n?(e.z=n.z+s(e._,n._),e.m=e.z-o):e.z=o}else n&&(e.z=n.z+s(e._,n._));e.parent.A=r(e,n,e.parent.A||i[0])}function n(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function r(e,t,i){if(t){for(var n,r=e,o=e,a=t,l=r.parent.children[0],h=r.m,c=o.m,u=a.m,f=l.m;a=So(a),r=Mo(r),a&&r;)l=Mo(l),o=So(o),o.a=e,n=a.z+u-r.z-h+s(a._,r._),n>0&&(Co(Do(a,e,i),e,n),h+=n,c+=n),u+=a.m,h+=r.m,f+=l.m,c+=o.m;a&&!So(o)&&(o.t=a,o.m+=u-c),r&&!Mo(l)&&(l.t=r,l.m+=h-f,i=e)}return i}function o(e){e.x*=l[0],e.y=e.depth*l[1]}var a=is.layout.hierarchy().sort(null).value(null),s=Ho,l=[1,1],h=null;return e.separation=function(t){return arguments.length?(s=t,e):s},e.size=function(t){return arguments.length?(h=null==(l=t)?o:null,e):h?null:l},e.nodeSize=function(t){return arguments.length?(h=null==(l=t)?null:o,e):h?l:null},Zr(e,a)},is.layout.cluster=function(){function e(e,o){var a,s=t.call(this,e,o),l=s[0],h=0;eo(l,function(e){var t=e.children;t&&t.length?(e.x=Po(t),e.y=ko(t)):(e.x=a?h+=i(e,a):0,e.y=0,a=e)});var c=Lo(l),u=No(l),f=c.x-i(c,u)/2,p=u.x+i(u,c)/2;return eo(l,r?function(e){e.x=(e.x-l.x)*n[0],e.y=(l.y-e.y)*n[1]}:function(e){e.x=(e.x-f)/(p-f)*n[0],e.y=(1-(l.y?e.y/l.y:1))*n[1]}),s}var t=is.layout.hierarchy().sort(null).value(null),i=Ho,n=[1,1],r=!1;return e.separation=function(t){return arguments.length?(i=t,e):i},e.size=function(t){return arguments.length?(r=null==(n=t),e):r?null:n},e.nodeSize=function(t){return arguments.length?(r=null!=(n=t),e):r?n:null},Zr(e,t)},is.layout.treemap=function(){function e(e,t){for(var i,n,r=-1,o=e.length;++r<o;)n=(i=e[r]).value*(0>t?0:t),i.area=isNaN(n)||0>=n?0:n}function t(i){var o=i.children;if(o&&o.length){var a,s,l,h=u(i),c=[],f=o.slice(),d=1/0,m="slice"===p?h.dx:"dice"===p?h.dy:"slice-dice"===p?1&i.depth?h.dy:h.dx:Math.min(h.dx,h.dy);for(e(f,h.dx*h.dy/i.value),c.area=0;(l=f.length)>0;)c.push(a=f[l-1]),c.area+=a.area,"squarify"!==p||(s=n(c,m))<=d?(f.pop(),d=s):(c.area-=c.pop().area,r(c,m,h,!1),m=Math.min(h.dx,h.dy),c.length=c.area=0,d=1/0);c.length&&(r(c,m,h,!0),c.length=c.area=0),o.forEach(t)}}function i(t){var n=t.children;if(n&&n.length){var o,a=u(t),s=n.slice(),l=[];for(e(s,a.dx*a.dy/t.value),l.area=0;o=s.pop();)l.push(o),l.area+=o.area,null!=o.z&&(r(l,o.z?a.dx:a.dy,a,!s.length),l.length=l.area=0);n.forEach(i)}}function n(e,t){for(var i,n=e.area,r=0,o=1/0,a=-1,s=e.length;++a<s;)(i=e[a].area)&&(o>i&&(o=i),i>r&&(r=i));return n*=n,t*=t,n?Math.max(t*r*d/n,n/(t*o*d)):1/0}function r(e,t,i,n){var r,o=-1,a=e.length,s=i.x,h=i.y,c=t?l(e.area/t):0;if(t==i.dx){for((n||c>i.dy)&&(c=i.dy);++o<a;)r=e[o],r.x=s,r.y=h,r.dy=c,s+=r.dx=Math.min(i.x+i.dx-s,c?l(r.area/c):0);r.z=!0,r.dx+=i.x+i.dx-s,i.y+=c,i.dy-=c}else{for((n||c>i.dx)&&(c=i.dx);++o<a;)r=e[o],r.x=s,r.y=h,r.dx=c,h+=r.dy=Math.min(i.y+i.dy-h,c?l(r.area/c):0);r.z=!1,r.dy+=i.y+i.dy-h,i.x+=c,i.dx-=c}}function o(n){var r=a||s(n),o=r[0];return o.x=0,o.y=0,o.dx=h[0],o.dy=h[1],a&&s.revalue(o),e([o],o.dx*o.dy/o.value),(a?i:t)(o),f&&(a=r),r}var a,s=is.layout.hierarchy(),l=Math.round,h=[1,1],c=null,u=zo,f=!1,p="squarify",d=.5*(1+Math.sqrt(5));return o.size=function(e){return arguments.length?(h=e,o):h},o.padding=function(e){function t(t){var i=e.call(o,t,t.depth);return null==i?zo(t):Fo(t,"number"==typeof i?[i,i,i,i]:i)}function i(t){return Fo(t,e)}if(!arguments.length)return c;var n;return u=null==(c=e)?zo:"function"==(n=typeof e)?t:"number"===n?(e=[e,e,e,e],i):i,o},o.round=function(e){return arguments.length?(l=e?Math.round:Number,o):l!=Number},o.sticky=function(e){return arguments.length?(f=e,a=null,o):f},o.ratio=function(e){return arguments.length?(d=e,o):d},o.mode=function(e){return arguments.length?(p=e+"",o):p},Zr(o,s)},is.random={normal:function(e,t){var i=arguments.length;return 2>i&&(t=1),1>i&&(e=0),function(){var i,n,r;do i=2*Math.random()-1,n=2*Math.random()-1,r=i*i+n*n;while(!r||r>1);return e+t*i*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var e=is.random.normal.apply(is,arguments);return function(){return Math.exp(e())}},bates:function(e){var t=is.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(e){return function(){for(var t=0,i=0;e>i;i++)t+=Math.random();return t}}},is.scale={};var bh={floor:Ht,ceil:Ht};is.scale.linear=function(){return jo([0,1],[0,1],Er,!1)};var _h={s:1,g:1,p:1,r:1,e:1};is.scale.log=function(){return Zo(is.scale.linear().domain([0,1]),10,!0,[1,10])};var wh=is.format(".0e"),Rh={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};is.scale.pow=function(){return Jo(is.scale.linear(),1,[0,1])},is.scale.sqrt=function(){return is.scale.pow().exponent(.5)},is.scale.ordinal=function(){return ta([],{t:"range",a:[[]]})},is.scale.category10=function(){return is.scale.ordinal().range(Hh)},is.scale.category20=function(){return is.scale.ordinal().range(Mh)},is.scale.category20b=function(){return is.scale.ordinal().range(Sh)},is.scale.category20c=function(){return is.scale.ordinal().range(Ch)};var Hh=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Et),Mh=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Et),Sh=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Et),Ch=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Et);is.scale.quantile=function(){return ia([],[])},is.scale.quantize=function(){return na(0,1,[0,1])},is.scale.threshold=function(){return ra([.5],[0,1])},is.scale.identity=function(){return oa([0,1])},is.svg={},is.svg.arc=function(){function e(){var e=Math.max(0,+i.apply(this,arguments)),h=Math.max(0,+n.apply(this,arguments)),c=a.apply(this,arguments)-Os,u=s.apply(this,arguments)-Os,f=Math.abs(u-c),p=c>u?0:1;if(e>h&&(d=h,h=e,e=d),f>=Is)return t(h,p)+(e?t(e,1-p):"")+"Z";var d,m,g,v,E,y,T,x,b,_,w,R,H=0,M=0,S=[];if((v=(+l.apply(this,arguments)||0)/2)&&(g=o===Ah?Math.sqrt(e*e+h*h):+o.apply(this,arguments),p||(M*=-1),h&&(M=et(g/h*Math.sin(v))),e&&(H=et(g/e*Math.sin(v)))),h){E=h*Math.cos(c+M),y=h*Math.sin(c+M),T=h*Math.cos(u-M),x=h*Math.sin(u-M);var C=Math.abs(u-c-2*M)<=zs?0:1;if(M&&fa(E,y,T,x)===p^C){var A=(c+u)/2;E=h*Math.cos(A),y=h*Math.sin(A),T=x=null}}else E=y=0;if(e){b=e*Math.cos(u-H),_=e*Math.sin(u-H),w=e*Math.cos(c+H),R=e*Math.sin(c+H);var D=Math.abs(c-u+2*H)<=zs?0:1;if(H&&fa(b,_,w,R)===1-p^D){var k=(c+u)/2;b=e*Math.cos(k),_=e*Math.sin(k),w=R=null}}else b=_=0;if((d=Math.min(Math.abs(h-e)/2,+r.apply(this,arguments)))>.001){m=h>e^p?0:1;var P=null==w?[b,_]:null==T?[E,y]:Pn([E,y],[w,R],[T,x],[b,_]),L=E-P[0],N=y-P[1],z=T-P[0],F=x-P[1],I=1/Math.sin(Math.acos((L*z+N*F)/(Math.sqrt(L*L+N*N)*Math.sqrt(z*z+F*F)))/2),O=Math.sqrt(P[0]*P[0]+P[1]*P[1]);if(null!=T){var U=Math.min(d,(h-O)/(I+1)),V=pa(null==w?[b,_]:[w,R],[E,y],h,U,p),B=pa([T,x],[b,_],h,U,p);d===U?S.push("M",V[0],"A",U,",",U," 0 0,",m," ",V[1],"A",h,",",h," 0 ",1-p^fa(V[1][0],V[1][1],B[1][0],B[1][1]),",",p," ",B[1],"A",U,",",U," 0 0,",m," ",B[0]):S.push("M",V[0],"A",U,",",U," 0 1,",m," ",B[0])}else S.push("M",E,",",y);if(null!=w){var W=Math.min(d,(e-O)/(I-1)),j=pa([E,y],[w,R],e,-W,p),G=pa([b,_],null==T?[E,y]:[T,x],e,-W,p);d===W?S.push("L",G[0],"A",W,",",W," 0 0,",m," ",G[1],"A",e,",",e," 0 ",p^fa(G[1][0],G[1][1],j[1][0],j[1][1]),",",1-p," ",j[1],"A",W,",",W," 0 0,",m," ",j[0]):S.push("L",G[0],"A",W,",",W," 0 0,",m," ",j[0])}else S.push("L",b,",",_)}else S.push("M",E,",",y),null!=T&&S.push("A",h,",",h," 0 ",C,",",p," ",T,",",x),S.push("L",b,",",_),null!=w&&S.push("A",e,",",e," 0 ",D,",",1-p," ",w,",",R);return S.push("Z"),S.join("")}function t(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}var i=sa,n=la,r=aa,o=Ah,a=ha,s=ca,l=ua;return e.innerRadius=function(t){return arguments.length?(i=Rt(t),e):i},e.outerRadius=function(t){return arguments.length?(n=Rt(t),e):n},e.cornerRadius=function(t){return arguments.length?(r=Rt(t),e):r},e.padRadius=function(t){return arguments.length?(o=t==Ah?Ah:Rt(t),e):o},e.startAngle=function(t){return arguments.length?(a=Rt(t),e):a},e.endAngle=function(t){return arguments.length?(s=Rt(t),e):s},e.padAngle=function(t){return arguments.length?(l=Rt(t),e):l},e.centroid=function(){var e=(+i.apply(this,arguments)+ +n.apply(this,arguments))/2,t=(+a.apply(this,arguments)+ +s.apply(this,arguments))/2-Os;return[Math.cos(t)*e,Math.sin(t)*e]},e};var Ah="auto";is.svg.line=function(){return da(Ht)};var Dh=is.map({linear:ma,"linear-closed":ga,step:va,"step-before":Ea,"step-after":ya,basis:Ra,"basis-open":Ha,"basis-closed":Ma,bundle:Sa,cardinal:ba,"cardinal-open":Ta,"cardinal-closed":xa,monotone:La});Dh.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var kh=[0,2/3,1/3,0],Ph=[0,1/3,2/3,0],Lh=[0,1/6,2/3,1/6];is.svg.line.radial=function(){var e=da(Na);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},Ea.reverse=ya,ya.reverse=Ea,is.svg.area=function(){return za(Ht)},is.svg.area.radial=function(){var e=za(Na);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},is.svg.chord=function(){function e(e,s){var l=t(this,o,e,s),h=t(this,a,e,s);return"M"+l.p0+n(l.r,l.p1,l.a1-l.a0)+(i(l,h)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,h.r,h.p0)+n(h.r,h.p1,h.a1-h.a0)+r(h.r,h.p1,l.r,l.p0))+"Z"}function t(e,t,i,n){var r=t.call(e,i,n),o=s.call(e,r,n),a=l.call(e,r,n)-Os,c=h.call(e,r,n)-Os;return{r:o,a0:a,a1:c,p0:[o*Math.cos(a),o*Math.sin(a)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function i(e,t){return e.a0==t.a0&&e.a1==t.a1}function n(e,t,i){return"A"+e+","+e+" 0 "+ +(i>zs)+",1 "+t}function r(e,t,i,n){return"Q 0,0 "+n}var o=En,a=yn,s=Fa,l=ha,h=ca;return e.radius=function(t){return arguments.length?(s=Rt(t),e):s},e.source=function(t){return arguments.length?(o=Rt(t),e):o},e.target=function(t){return arguments.length?(a=Rt(t),e):a},e.startAngle=function(t){return arguments.length?(l=Rt(t),e):l},e.endAngle=function(t){return arguments.length?(h=Rt(t),e):h},e},is.svg.diagonal=function(){function e(e,r){var o=t.call(this,e,r),a=i.call(this,e,r),s=(o.y+a.y)/2,l=[o,{x:o.x,y:s},{x:a.x,y:s},a];return l=l.map(n),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var t=En,i=yn,n=Ia;return e.source=function(i){return arguments.length?(t=Rt(i),e):t},e.target=function(t){return arguments.length?(i=Rt(t),e):i},e.projection=function(t){return arguments.length?(n=t,e):n},e},is.svg.diagonal.radial=function(){var e=is.svg.diagonal(),t=Ia,i=e.projection;return e.projection=function(e){return arguments.length?i(Oa(t=e)):t},e},is.svg.symbol=function(){function e(e,n){return(Nh.get(t.call(this,e,n))||Ba)(i.call(this,e,n))}var t=Va,i=Ua;return e.type=function(i){return arguments.length?(t=Rt(i),e):t},e.size=function(t){return arguments.length?(i=Rt(t),e):i},e};var Nh=is.map({circle:Ba,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*Fh)),i=t*Fh;return"M0,"+-t+"L"+i+",0 0,"+t+" "+-i+",0Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/zh),i=t*zh/2;return"M0,"+i+"L"+t+","+-i+" "+-t+","+-i+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/zh),i=t*zh/2;return"M0,"+-i+"L"+t+","+i+" "+-t+","+i+"Z"}});is.svg.symbolTypes=Nh.keys();var zh=Math.sqrt(3),Fh=Math.tan(30*Us);Hs.transition=function(e){for(var t,i,n=Ih||++Bh,r=Xa(e),o=[],a=Oh||{time:Date.now(),ease:Rr,delay:0,duration:250},s=-1,l=this.length;++s<l;){o.push(t=[]);for(var h=this[s],c=-1,u=h.length;++c<u;)(i=h[c])&&Ya(i,c,r,n,a),t.push(i)}return ja(o,r,n)},Hs.interrupt=function(e){return this.each(null==e?Uh:Wa(Xa(e)))};var Ih,Oh,Uh=Wa(Xa()),Vh=[],Bh=0;Vh.call=Hs.call,Vh.empty=Hs.empty,Vh.node=Hs.node,Vh.size=Hs.size,is.transition=function(e,t){return e&&e.transition?Ih?e.transition(t):e:Cs.transition(e)},is.transition.prototype=Vh,Vh.select=function(e){var t,i,n,r=this.id,o=this.namespace,a=[];e=R(e);for(var s=-1,l=this.length;++s<l;){a.push(t=[]);for(var h=this[s],c=-1,u=h.length;++c<u;)(n=h[c])&&(i=e.call(n,n.__data__,c,s))?("__data__"in n&&(i.__data__=n.__data__),Ya(i,c,o,r,n[o][r]),t.push(i)):t.push(null)}return ja(a,o,r)},Vh.selectAll=function(e){var t,i,n,r,o,a=this.id,s=this.namespace,l=[];e=H(e);for(var h=-1,c=this.length;++h<c;)for(var u=this[h],f=-1,p=u.length;++f<p;)if(n=u[f]){o=n[s][a],i=e.call(n,n.__data__,f,h),l.push(t=[]);for(var d=-1,m=i.length;++d<m;)(r=i[d])&&Ya(r,d,s,a,o),t.push(r)}return ja(l,s,a)},Vh.filter=function(e){var t,i,n,r=[];"function"!=typeof e&&(e=I(e));for(var o=0,a=this.length;a>o;o++){r.push(t=[]);for(var i=this[o],s=0,l=i.length;l>s;s++)(n=i[s])&&e.call(n,n.__data__,s,o)&&t.push(n)}return ja(r,this.namespace,this.id)},Vh.tween=function(e,t){var i=this.id,n=this.namespace;return arguments.length<2?this.node()[n][i].tween.get(e):U(this,null==t?function(t){t[n][i].tween.remove(e)}:function(r){r[n][i].tween.set(e,t)})},Vh.attr=function(e,t){function i(){this.removeAttribute(s)}function n(){this.removeAttributeNS(s.space,s.local)}function r(e){return null==e?i:(e+="",function(){var t,i=this.getAttribute(s);return i!==e&&(t=a(i,e),function(e){this.setAttribute(s,t(e))})})}function o(e){return null==e?n:(e+="",function(){var t,i=this.getAttributeNS(s.space,s.local);return i!==e&&(t=a(i,e),function(e){this.setAttributeNS(s.space,s.local,t(e))})})}if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var a="transform"==e?Vr:Er,s=is.ns.qualify(e);return Ga(this,"attr."+e,t,s.local?o:r)},Vh.attrTween=function(e,t){function i(e,i){var n=t.call(this,e,i,this.getAttribute(r));return n&&function(e){this.setAttribute(r,n(e))}}function n(e,i){var n=t.call(this,e,i,this.getAttributeNS(r.space,r.local));return n&&function(e){this.setAttributeNS(r.space,r.local,n(e))}}var r=is.ns.qualify(e);return this.tween("attr."+e,r.local?n:i)},Vh.style=function(e,t,i){function n(){this.style.removeProperty(e)}function r(t){return null==t?n:(t+="",function(){var n,r=ss.getComputedStyle(this,null).getPropertyValue(e);return r!==t&&(n=Er(r,t),function(t){this.style.setProperty(e,n(t),i)})})}var o=arguments.length;if(3>o){if("string"!=typeof e){2>o&&(t="");for(i in e)this.style(i,e[i],t);return this}i=""}return Ga(this,"style."+e,t,r)},Vh.styleTween=function(e,t,i){function n(n,r){var o=t.call(this,n,r,ss.getComputedStyle(this,null).getPropertyValue(e));return o&&function(t){this.style.setProperty(e,o(t),i)}}return arguments.length<3&&(i=""),this.tween("style."+e,n)},Vh.text=function(e){return Ga(this,"text",e,qa)},Vh.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;this[e].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Vh.ease=function(e){var t=this.id,i=this.namespace;return arguments.length<1?this.node()[i][t].ease:("function"!=typeof e&&(e=is.ease.apply(is,arguments)),U(this,function(n){n[i][t].ease=e}))},Vh.delay=function(e){var t=this.id,i=this.namespace;return arguments.length<1?this.node()[i][t].delay:U(this,"function"==typeof e?function(n,r,o){n[i][t].delay=+e.call(n,n.__data__,r,o)}:(e=+e,function(n){n[i][t].delay=e}))},Vh.duration=function(e){var t=this.id,i=this.namespace;return arguments.length<1?this.node()[i][t].duration:U(this,"function"==typeof e?function(n,r,o){n[i][t].duration=Math.max(1,e.call(n,n.__data__,r,o))}:(e=Math.max(1,e),function(n){n[i][t].duration=e}))},Vh.each=function(e,t){var i=this.id,n=this.namespace;if(arguments.length<2){var r=Oh,o=Ih;try{Ih=i,U(this,function(t,r,o){Oh=t[n][i],e.call(t,t.__data__,r,o)})}finally{Oh=r,Ih=o}}else U(this,function(r){var o=r[n][i];(o.event||(o.event=is.dispatch("start","end","interrupt"))).on(e,t)});return this},Vh.transition=function(){for(var e,t,i,n,r=this.id,o=++Bh,a=this.namespace,s=[],l=0,h=this.length;h>l;l++){s.push(e=[]);for(var t=this[l],c=0,u=t.length;u>c;c++)(i=t[c])&&(n=i[a][r],Ya(i,c,a,o,{time:n.time,ease:n.ease,delay:n.delay+n.duration,duration:n.duration})),e.push(i)}return ja(s,a,o)},is.svg.axis=function(){function e(e){e.each(function(){var e,h=is.select(this),c=this.__chart__||i,u=this.__chart__=i.copy(),f=null==l?u.ticks?u.ticks.apply(u,s):u.domain():l,p=null==t?u.tickFormat?u.tickFormat.apply(u,s):Ht:t,d=h.selectAll(".tick").data(f,u),m=d.enter().insert("g",".domain").attr("class","tick").style("opacity",Ls),g=is.transition(d.exit()).style("opacity",Ls).remove(),v=is.transition(d.order()).style("opacity",1),E=Math.max(r,0)+a,y=Oo(u),T=h.selectAll(".domain").data([0]),x=(T.enter().append("path").attr("class","domain"),is.transition(T));m.append("line"),m.append("text");var b,_,w,R,H=m.select("line"),M=v.select("line"),S=d.select("text").text(p),C=m.select("text"),A=v.select("text"),D="top"===n||"left"===n?-1:1;if("bottom"===n||"top"===n?(e=Ka,b="x",w="y",_="x2",R="y2",S.attr("dy",0>D?"0em":".71em").style("text-anchor","middle"),x.attr("d","M"+y[0]+","+D*o+"V0H"+y[1]+"V"+D*o)):(e=Qa,b="y",w="x",_="y2",R="x2",S.attr("dy",".32em").style("text-anchor",0>D?"end":"start"),x.attr("d","M"+D*o+","+y[0]+"H0V"+y[1]+"H"+D*o)),H.attr(R,D*r),C.attr(w,D*E),M.attr(_,0).attr(R,D*r),A.attr(b,0).attr(w,D*E),u.rangeBand){var k=u,P=k.rangeBand()/2;c=u=function(e){return k(e)+P}}else c.rangeBand?c=u:g.call(e,u,c);m.call(e,c,u),v.call(e,u,u)})}var t,i=is.scale.linear(),n=Wh,r=6,o=6,a=3,s=[10],l=null;return e.scale=function(t){return arguments.length?(i=t,e):i},e.orient=function(t){return arguments.length?(n=t in jh?t+"":Wh,e):n},e.ticks=function(){return arguments.length?(s=arguments,e):s},e.tickValues=function(t){return arguments.length?(l=t,e):l},e.tickFormat=function(i){return arguments.length?(t=i,e):t},e.tickSize=function(t){var i=arguments.length;return i?(r=+t,o=+arguments[i-1],e):r},e.innerTickSize=function(t){return arguments.length?(r=+t,e):r},e.outerTickSize=function(t){return arguments.length?(o=+t,e):o},e.tickPadding=function(t){return arguments.length?(a=+t,e):a},e.tickSubdivide=function(){return arguments.length&&e},e};var Wh="bottom",jh={top:1,right:1,bottom:1,left:1};is.svg.brush=function(){function e(o){o.each(function(){var o=is.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",r).on("touchstart.brush",r),a=o.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),o.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=o.selectAll(".resize").data(d,Ht);s.exit().remove(),s.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Gh[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",e.empty()?"none":null);var c,u=is.transition(o),f=is.transition(a);l&&(c=Oo(l),f.attr("x",c[0]).attr("width",c[1]-c[0]),i(u)),h&&(c=Oo(h),f.attr("y",c[0]).attr("height",c[1]-c[0]),n(u)),t(u)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+c[+/e$/.test(e)]+","+u[+/^s/.test(e)]+")"})}function i(e){e.select(".extent").attr("x",c[0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function n(e){e.select(".extent").attr("y",u[0]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",u[1]-u[0])}function r(){function r(){32==is.event.keyCode&&(S||(E=null,A[0]-=c[1],A[1]-=u[1],S=2),x())}function d(){32==is.event.keyCode&&2==S&&(A[0]+=c[1],A[1]+=u[1],S=0,x())}function m(){var e=is.mouse(T),r=!1;y&&(e[0]+=y[0],e[1]+=y[1]),S||(is.event.altKey?(E||(E=[(c[0]+c[1])/2,(u[0]+u[1])/2]),A[0]=c[+(e[0]<E[0])],A[1]=u[+(e[1]<E[1])]):E=null),H&&g(e,l,0)&&(i(w),r=!0),M&&g(e,h,1)&&(n(w),r=!0),r&&(t(w),_({type:"brush",mode:S?"move":"resize"}))}function g(e,t,i){var n,r,s=Oo(t),l=s[0],h=s[1],d=A[i],m=i?u:c,g=m[1]-m[0];return S&&(l-=d,h-=g+d),n=(i?p:f)?Math.max(l,Math.min(h,e[i])):e[i],S?r=(n+=d)+g:(E&&(d=Math.max(l,Math.min(h,2*E[i]-n))),n>d?(r=n,n=d):r=d),m[0]!=n||m[1]!=r?(i?a=null:o=null,m[0]=n,m[1]=r,!0):void 0}function v(){m(),w.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),is.select("body").style("cursor",null),D.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),C(),_({type:"brushend"})}var E,y,T=this,b=is.select(is.event.target),_=s.of(T,arguments),w=is.select(T),R=b.datum(),H=!/^(n|s)$/.test(R)&&l,M=!/^(e|w)$/.test(R)&&h,S=b.classed("extent"),C=q(),A=is.mouse(T),D=is.select(ss).on("keydown.brush",r).on("keyup.brush",d);
if(is.event.changedTouches?D.on("touchmove.brush",m).on("touchend.brush",v):D.on("mousemove.brush",m).on("mouseup.brush",v),w.interrupt().selectAll("*").interrupt(),S)A[0]=c[0]-A[0],A[1]=u[0]-A[1];else if(R){var k=+/w$/.test(R),P=+/^n/.test(R);y=[c[1-k]-A[0],u[1-P]-A[1]],A[0]=c[k],A[1]=u[P]}else is.event.altKey&&(E=A.slice());w.style("pointer-events","none").selectAll(".resize").style("display",null),is.select("body").style("cursor",b.style("cursor")),_({type:"brushstart"}),m()}var o,a,s=_(e,"brushstart","brush","brushend"),l=null,h=null,c=[0,0],u=[0,0],f=!0,p=!0,d=qh[0];return e.event=function(e){e.each(function(){var e=s.of(this,arguments),t={x:c,y:u,i:o,j:a},i=this.__chart__||t;this.__chart__=t,Ih?is.select(this).transition().each("start.brush",function(){o=i.i,a=i.j,c=i.x,u=i.y,e({type:"brushstart"})}).tween("brush:brush",function(){var i=yr(c,t.x),n=yr(u,t.y);return o=a=null,function(r){c=t.x=i(r),u=t.y=n(r),e({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=t.i,a=t.j,e({type:"brush",mode:"resize"}),e({type:"brushend"})}):(e({type:"brushstart"}),e({type:"brush",mode:"resize"}),e({type:"brushend"}))})},e.x=function(t){return arguments.length?(l=t,d=qh[!l<<1|!h],e):l},e.y=function(t){return arguments.length?(h=t,d=qh[!l<<1|!h],e):h},e.clamp=function(t){return arguments.length?(l&&h?(f=!!t[0],p=!!t[1]):l?f=!!t:h&&(p=!!t),e):l&&h?[f,p]:l?f:h?p:null},e.extent=function(t){var i,n,r,s,f;return arguments.length?(l&&(i=t[0],n=t[1],h&&(i=i[0],n=n[0]),o=[i,n],l.invert&&(i=l(i),n=l(n)),i>n&&(f=i,i=n,n=f),(i!=c[0]||n!=c[1])&&(c=[i,n])),h&&(r=t[0],s=t[1],l&&(r=r[1],s=s[1]),a=[r,s],h.invert&&(r=h(r),s=h(s)),r>s&&(f=r,r=s,s=f),(r!=u[0]||s!=u[1])&&(u=[r,s])),e):(l&&(o?(i=o[0],n=o[1]):(i=c[0],n=c[1],l.invert&&(i=l.invert(i),n=l.invert(n)),i>n&&(f=i,i=n,n=f))),h&&(a?(r=a[0],s=a[1]):(r=u[0],s=u[1],h.invert&&(r=h.invert(r),s=h.invert(s)),r>s&&(f=r,r=s,s=f))),l&&h?[[i,r],[n,s]]:l?[i,n]:h&&[r,s])},e.clear=function(){return e.empty()||(c=[0,0],u=[0,0],o=a=null),e},e.empty=function(){return!!l&&c[0]==c[1]||!!h&&u[0]==u[1]},is.rebind(e,s,"on")};var Gh={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},qh=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Xh=fl.format=El.timeFormat,Yh=Xh.utc,Kh=Yh("%Y-%m-%dT%H:%M:%S.%LZ");Xh.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?$a:Kh,$a.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},$a.toString=Kh.toString,fl.second=Ot(function(e){return new pl(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*Math.floor(t))},function(e){return e.getSeconds()}),fl.seconds=fl.second.range,fl.seconds.utc=fl.second.utc.range,fl.minute=Ot(function(e){return new pl(6e4*Math.floor(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*Math.floor(t))},function(e){return e.getMinutes()}),fl.minutes=fl.minute.range,fl.minutes.utc=fl.minute.utc.range,fl.hour=Ot(function(e){var t=e.getTimezoneOffset()/60;return new pl(36e5*(Math.floor(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*Math.floor(t))},function(e){return e.getHours()}),fl.hours=fl.hour.range,fl.hours.utc=fl.hour.utc.range,fl.month=Ot(function(e){return e=fl.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),fl.months=fl.month.range,fl.months.utc=fl.month.utc.range;var Qh=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],$h=[[fl.second,1],[fl.second,5],[fl.second,15],[fl.second,30],[fl.minute,1],[fl.minute,5],[fl.minute,15],[fl.minute,30],[fl.hour,1],[fl.hour,3],[fl.hour,6],[fl.hour,12],[fl.day,1],[fl.day,2],[fl.week,1],[fl.month,1],[fl.month,3],[fl.year,1]],Zh=Xh.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&1!=e.getDate()}],["%b %d",function(e){return 1!=e.getDate()}],["%B",function(e){return e.getMonth()}],["%Y",Si]]),Jh={range:function(e,t,i){return is.range(Math.ceil(e/i)*i,+t,i).map(Ja)},floor:Ht,ceil:Ht};$h.year=fl.year,fl.scale=function(){return Za(is.scale.linear(),$h,Zh)};var ec=$h.map(function(e){return[e[0].utc,e[1]]}),tc=Yh.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],["%b %d",function(e){return 1!=e.getUTCDate()}],["%B",function(e){return e.getUTCMonth()}],["%Y",Si]]);ec.year=fl.year.utc,fl.scale.utc=function(){return Za(is.scale.linear(),ec,tc)},is.text=Mt(function(e){return e.responseText}),is.json=function(e,t){return St(e,"application/json",es,t)},is.html=function(e,t){return St(e,"text/html",ts,t)},is.xml=Mt(function(e){return e.responseXML}),"function"==typeof define&&define.amd?define(is):"object"==typeof module&&module.exports&&(module.exports=is),this.d3=is}(),d3.parcoords=function(e){function t(e,t,i){d3.keys(t).forEach(function(n){e[n]=function(r){if(!arguments.length)return t[n];var o=t[n];return t[n]=r,w[n].call(u,{value:r,previous:o}),i[n].call(u,{value:r,previous:o}),e}})}function i(e,t){for(key in t)e[key]=t[key];return e}function n(e,t){t.strokeStyle=d3.functor(c.color)(e),t.beginPath(),c.dimensions.map(function(i,n){0==n?t.moveTo(h(i),v[i](e[i])):t.lineTo(h(i),v[i](e[i]))}),t.stroke()}function r(e,t){t.clearRect(-1,-1,p()+2,d()+2),t.beginPath(),e.forEach(function(e){c.dimensions.map(function(i,n){0==n?t.moveTo(h(i),v[i](e[i])):t.lineTo(h(i),v[i](e[i]))})}),t.stroke()}function o(e){return n(e,b.foreground)}function a(e){return n(e,b.highlight)}function s(e){return!v[e].brush.empty()}function l(){var e=c.dimensions.filter(s),t=e.map(function(e){return v[e].brush.extent()}),i={number:function(e,i,n){return t[n][0]<=e[i]&&e[i]<=t[n][1]},string:function(e,i,n){return t[n][0]<=v[i](e[i])&&v[i](e[i])<=t[n][1]}};return c.data.filter(function(t){return e.every(function(e,n){return i[c.types[e]](t,e,n)})})}function h(e){var t=E[e];return null==t?g(e):t}var c={data:[],dimensions:[],types:{},brushed:!1,mode:"default",rate:20,width:600,height:300,margin:{top:24,right:0,bottom:12,left:0},color:"#069",composite:"source-over",alpha:.7};i(c,e);var u=function(e){return e=u.selection=d3.select(e),c.width=e[0][0].clientWidth,c.height=e[0][0].clientHeight,["shadows","marks","foreground","highlight"].forEach(function(t){_[t]=e.append("canvas").attr("class",t)[0][0],b[t]=_[t].getContext("2d")}),u.svg=e.append("svg").attr("width",c.width).attr("height",c.height).append("svg:g").attr("transform","translate("+c.margin.left+","+c.margin.top+")"),u},f=d3.dispatch.apply(this,["render","resize","highlight","brush"].concat(d3.keys(c))),p=function(){return c.width-c.margin.right-c.margin.left},d=function(){return c.height-c.margin.top-c.margin.bottom},m={brushable:!1,reorderable:!1,axes:!1,interactive:!1,shadows:!1,debug:!1},g=d3.scale.ordinal(),v={},E={},y=d3.svg.line(),T=d3.svg.axis().orient("right").ticks(0),x,b={},_={},w=d3.dispatch.apply(this,d3.keys(c)).on("composite",function(e){b.foreground.globalCompositeOperation=e.value}).on("alpha",function(e){b.foreground.globalAlpha=e.value}).on("width",function(e){u.resize()}).on("height",function(e){u.resize()}).on("margin",function(e){u.resize()}).on("rate",function(e){R.rate(e.value)}).on("data",function(e){m.shadows&&r(c.data,b.shadows)}).on("dimensions",function(e){g.domain(c.dimensions),m.interactive&&u.render().updateAxes()});u.state=c,u.flags=m,t(u,c,f),d3.rebind(u,f,"on"),d3.rebind(u,T,"ticks","orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat"),u.autoscale=function(){var e={number:function(e){return d3.scale.linear().domain(d3.extent(c.data,function(t){return+t[e]})).range([d()+1,1])},string:function(e){return d3.scale.ordinal().domain(c.data.map(function(t){return t[e]})).rangePoints([d()+1,1])}};return c.dimensions.forEach(function(t){v[t]=e[c.types[t]](t)}),u.dimensions(u.dimensions().filter(function(e,t){var i=v[e].domain().length;return"string"==c.types[e]&&(i>60||2>i)?!1:!0})),g.rangePoints([0,p()],1),u.selection.selectAll("canvas").style("margin-top",c.margin.top+"px").style("margin-left",c.margin.left+"px").attr("width",p()+2).attr("height",d()+2),b.foreground.strokeStyle=c.color,b.foreground.lineWidth=1.4,b.foreground.globalCompositeOperation=c.composite,b.foreground.globalAlpha=c.alpha,b.highlight.lineWidth=3,b.shadows.strokeStyle="#dadada",this},u.detectDimensions=function(){return u.types(u.detectDimensionTypes(c.data)),u.dimensions(d3.keys(u.types())),this},u.toType=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},u.toTypeCoerceNumbers=function(e){return parseFloat(e)==e&&null!=e?"number":u.toType(e)},u.detectDimensionTypes=function(e){var t={};return d3.keys(e[0]).forEach(function(i){t[i]=u.toTypeCoerceNumbers(e[0][i])}),t},u.render=function(){return c.dimensions.length||u.detectDimensions(),c.dimensions[0]in v||u.autoscale(),u.render[c.mode](),f.render.call(this),this},u.render["default"]=function(){u.clear("foreground"),c.brushed?c.brushed.forEach(o):c.data.forEach(o)};var R=d3.renderQueue(o).rate(50).clear(function(){u.clear("foreground")});return u.render.queue=function(){R(c.brushed?c.brushed:c.data)},u.shadows=function(){return m.shadows=!0,c.data.length>0&&r(c.data,b.shadows),this},u.axisDots=function(){var e=u.ctx.marks;return e.globalAlpha=d3.min([1/Math.pow(data.length,.5),1]),c.data.forEach(function(t){c.dimensions.map(function(i,n){e.fillRect(h(i)-.75,v[i](t[i])-.75,1.5,1.5)})}),this},u.clear=function(e){return b[e].clearRect(0,0,p()+2,d()+2),this},u.createAxes=function(){return x&&u.removeAxes(),x=u.svg.selectAll(".dimension").data(c.dimensions,function(e){return e}).enter().append("svg:g").attr("class","dimension").attr("transform",function(e){return"translate("+g(e)+")"}),x.append("svg:g").attr("class","axis").attr("transform","translate(0,0)").each(function(e){d3.select(this).call(T.scale(v[e]))}).append("svg:text").attr({"text-anchor":"middle",y:0,transform:"translate(0,-12)",x:0,"class":"label"}).text(function(e){return"Axis "+e}),m.axes=!0,this},u.removeAxes=function(){return x.remove(),this},u.updateAxes=function(){var e=u.svg.selectAll(".dimension").data(c.dimensions,function(e){return e});return e.enter().append("svg:g").attr("class","dimension").attr("transform",function(e){return"translate("+h(e)+")"}).style("opacity",0).append("svg:g").attr("class","axis").attr("transform","translate(0,0)").each(function(e){d3.select(this).call(T.scale(v[e]))}).append("svg:text").attr({"text-anchor":"middle",y:0,transform:"translate(0,-12)",x:0,"class":"label"}).text(String),e.exit().remove(),x=u.svg.selectAll(".dimension"),x.transition().duration(1100).attr("transform",function(e){return"translate("+h(e)+")"}).style("opacity",1),m.shadows&&r(c.data,b.shadows),this},u.brushable=function(){return x||u.createAxes(),x.append("svg:g").attr("class","brush").each(function(e){d3.select(this).call(v[e].brush=d3.svg.brush().y(v[e]).on("brush",u.brush))}).selectAll("rect").style("visibility",null).attr("x",-15).attr("width",30),m.brushable=!0,this},u.reorderable=function(){return x||u.createAxes(),x.style("cursor","move").call(d3.behavior.drag().on("dragstart",function(e){E[e]=this.__origin__=g(e)}).on("drag",function(e){E[e]=Math.min(p(),Math.max(0,this.__origin__+=d3.event.dx)),c.dimensions.sort(function(e,t){return h(e)-h(t)}),g.domain(c.dimensions),u.render(),x.attr("transform",function(e){return"translate("+h(e)+")"})}).on("dragend",function(e){delete this.__origin__,delete E[e],d3.select(this).transition().attr("transform","translate("+g(e)+")"),u.render()})),m.reorderable=!0,this},u.adjacent_pairs=function(e){for(var t=[],i=0;i<e.length-1;i++)t.push([e[i],e[i+1]]);return t},u.interactive=function(){return m.interactive=!0,this},u.brush=function(){c.brushed=l(),f.brush.call(u,c.brushed),u.render()},u.xscale=g,u.yscale=v,u.ctx=b,u.canvas=_,u.g=function(){return x},u.brushReset=function(e){return v[e].brush.clear()(u.g().filter(function(t){return e==t})),this},u.resize=function(){return u.selection.select("svg").attr("width",c.width).attr("height",c.height),u.svg.attr("transform","translate("+c.margin.left+","+c.margin.top+")"),u.autoscale(),x&&u.createAxes().brushable(),f.resize.call(this,{width:c.width,height:c.height,margin:c.margin}),this},u.highlight=function(e){return u.clear("highlight"),d3.select(_.foreground).classed("faded",!0),e.forEach(a),f.highlight.call(this,e),this},u.unhighlight=function(e){return u.clear("highlight"),d3.select(_.foreground).classed("faded",!1),this},u.intersection=function(e,t,i,n){return{x:((e.x*t.y-e.y*t.x)*(i.x-n.x)-(e.x-t.x)*(i.x*n.y-i.y*n.x))/((e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x)),y:((e.x*t.y-e.y*t.x)*(i.y-n.y)-(e.y-t.y)*(i.x*n.y-i.y*n.x))/((e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x))}},u.toString=function(){return"Parallel Coordinates: "+c.dimensions.length+" dimensions ("+d3.keys(c.data[0]).length+" total) , "+c.data.length+" rows"},u.version="0.1.7",u},d3.renderQueue=function(e){var t=[],i=10,n=function(){},r=0,o=function(e){e&&o.data(e),o.invalidate(),n(),o.render()};return o.render=function(){function n(){if(!a)return!1;if(r>t.length)return!1;var o=t.slice(r,r+i);r+=i,o.map(e),d3.timer(n)}r=0;var a=!0;o.invalidate=function(){a=!1},n()},o.data=function(e){return o.invalidate(),t=e.slice(0),o},o.rate=function(e){return arguments.length?(i=e,o):i},o.remaining=function(){return t.length-r},o.clear=function(e){return arguments.length?(n=e,o):(n(),o)},o.invalidate=function(){},o},!d3)throw"d3 wasn't included!";!function(){function e(e,t){var i=function(e,t){if(t(e),e.children)for(var n=e.children.length-1;n>=0;n--)i(e.children[n],t)};i(e[0],function(e){e.rootDist=(e.parent?e.parent.rootDist:0)+(e.length||0)});var n=e.map(function(e){return e.rootDist}),r=d3.scale.linear().domain([0,d3.max(n)]).range([0,t]);return i(e[0],function(e){e.y=r(e.rootDist)}),r}d3.phylogram={},d3.phylogram.rightAngleDiagonal=function(){function e(e,n){var r=e.source,o=e.target,a=(r.x+o.x)/2,s=(r.y+o.y)/2,l=[r,{x:o.x,y:r.y},o];return l=l.map(t),i(l)}var t=function(e){return[e.y,e.x]},i=function(e){return"M"+e[0]+" "+e[1]+" "+e[2]};return e.projection=function(i){return arguments.length?(t=i,e):t},e.path=function(t){return arguments.length?(i=t,e):i},e},d3.phylogram.radialRightAngleDiagonal=function(){return d3.phylogram.rightAngleDiagonal().path(function(e){var t=e[0],i=e[1],n=e[2],r=Math.sqrt(t[0]*t[0]+t[1]*t[1]),o=d3.phylogram.coordinateToAngle(t,r),a=d3.phylogram.coordinateToAngle(i,r),s=Math.abs(a-o)>Math.PI?o>=a:a>o,l=0,h=0,c=s?0:1;return"M"+t+" A"+[r,r]+" "+l+" "+h+","+c+" "+i+"L"+n}).projection(function(e){var t=e.y,i=(e.x-90)/180*Math.PI;return[t*Math.cos(i),t*Math.sin(i)]})},d3.phylogram.coordinateToAngle=function(e,t){var i=2*Math.PI,n=i/4,r=e[0]>=0?e[1]>=0?1:2:e[1]>=0?4:3,o=Math.abs(Math.asin(e[1]/t));switch(r){case 1:coordAngle=n-o;break;case 2:coordAngle=n+o;break;case 3:coordAngle=2*n+n-o;break;case 4:coordAngle=3*n+o}return coordAngle},d3.phylogram.styleTreeNodes=function(e){e.selectAll("g.leaf.node").append("svg:circle").attr("r",4.5).attr("stroke","yellowGreen").attr("fill","greenYellow").attr("stroke-width","2px"),e.selectAll("g.root.node").append("svg:circle").attr("r",4.5).attr("fill","steelblue").attr("stroke","#369").attr("stroke-width","2px")},d3.phylogram.build=function(t,i,n){n=n||{};var r=n.width||d3.select(t).style("width")||d3.select(t).attr("width"),o=n.height||d3.select(t).style("height")||d3.select(t).attr("height"),r=parseInt(r),o=parseInt(o),a=n.tree||d3.layout.cluster().size([o,r]).sort(function(e){return e.children?e.children.length:-1}).children(n.children||function(e){return e.branchset}),s=n.diagonal||d3.phylogram.rightAngleDiagonal(),l=n.vis||d3.select(t).append("svg:svg").attr("width",r+300).attr("height",o+30).append("svg:g").attr("transform","translate(20, 20)"),i=a(i);if(n.skipBranchLengthScaling)var h=d3.scale.linear().domain([0,r]).range([0,r]);else var h=e(i,r);n.skipTicks||(l.selectAll("line").data(h.ticks(10)).enter().append("svg:line").attr("y1",0).attr("y2",o).attr("x1",h).attr("x2",h).attr("stroke","#ddd"),l.selectAll("text.rule").data(h.ticks(10)).enter().append("svg:text").attr("class","rule").attr("x",h).attr("y",0).attr("dy",-3).attr("text-anchor","middle").attr("font-size","8px").attr("fill","#ccc").text(function(e){return Math.round(100*e)/100}));var c=l.selectAll("path.link").data(a.links(i)).enter().append("svg:path").attr("class","link").attr("d",s).attr("fill","none").attr("stroke","#aaa").attr("stroke-width","4px"),u=l.selectAll("g.node").data(i).enter().append("svg:g").attr("class",function(e){return e.children?0==e.depth?"root node":"inner node":"leaf node"}).attr("transform",function(e){return"translate("+e.y+","+e.x+")"});return d3.phylogram.styleTreeNodes(l),n.skipLabels||(l.selectAll("g.inner.node").append("svg:text").attr("dx",-6).attr("dy",-6).attr("text-anchor","end").attr("font-size","8px").attr("fill","#ccc").text(function(e){return e.length}),l.selectAll("g.leaf.node").append("svg:text").attr("dx",8).attr("dy",3).attr("text-anchor","start").attr("font-family","Helvetica Neue, Helvetica, sans-serif").attr("font-size","10px").attr("fill","black").text(function(e){return e.name+" ("+e.length+")"})),{tree:a,vis:l}},d3.phylogram.buildRadial=function(e,t,i){i=i||{};var n=i.width||d3.select(e).style("width")||d3.select(e).attr("width"),r=n/2,o=i.skipLabels?10:i.labelWidth||120,a=d3.select(e).append("svg:svg").attr("width",2*r).attr("height",2*r).append("svg:g").attr("transform","translate("+r+","+r+")"),s=d3.layout.tree().size([360,r-o]).sort(function(e){return e.children?e.children.length:-1}).children(i.children||function(e){return e.branchset}).separation(function(e,t){return(e.parent==t.parent?1:2)/e.depth}),l=d3.phylogram.build(e,t,{vis:a,tree:s,skipBranchLengthScaling:!0,skipTicks:!0,skipLabels:i.skipLabels,diagonal:d3.phylogram.radialRightAngleDiagonal()});return a.selectAll("g.node").attr("transform",function(e){return"rotate("+(e.x-90)+")translate("+e.y+")"}),i.skipLabels||(a.selectAll("g.leaf.node text").attr("dx",function(e){return e.x<180?8:-8}).attr("dy",".31em").attr("text-anchor",function(e){return e.x<180?"start":"end"}).attr("transform",function(e){return e.x<180?null:"rotate(180)"}).attr("font-family","Helvetica Neue, Helvetica, sans-serif").attr("font-size","10px").attr("fill","black").text(function(e){return e.data.name}),a.selectAll("g.inner.node text").attr("dx",function(e){return e.x<180?-6:6}).attr("text-anchor",function(e){return e.x<180?"end":"start"}).attr("transform",function(e){return e.x<180?null:"rotate(180)"})),{tree:s,vis:a}}}(),!function(){function e(e){function n(){for(;s=c<h.length&&e>u;){var t=c++,n=h[t],o=i.call(n,1);o.push(r(t)),++u,n[0].apply(null,o)}}function r(e){return function(t,i){--u,null==p&&(null!=t?(p=t,c=f=0/0,o()):(h[e]=i,--f?s||n():o()))}}function o(){null!=p?d(p):l?d(p,h):d.apply(null,[p].concat(h))}var a,s,l,h=[],c=0,u=0,f=0,p=null,d=t;return e||(e=1/0),a={defer:function(){return p||(h.push(arguments),++f,n()),a},await:function(e){return d=e,l=!1,f||o(),a},awaitAll:function(e){return d=e,l=!0,f||o(),a}}}function t(){}var i=[].slice;e.version="1.0.7","function"==typeof define&&define.amd?define(function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.queue=e}(),function(e){e.parse=function(e){for(var t=[],i={},n=e.split(/\s*(;|\(|\)|,|:)\s*/),r=0;r<n.length;r++){var o=n[r];switch(o){case"(":var a={};i.branchset=[a],t.push(i),i=a;break;case",":var a={};t[t.length-1].branchset.push(a),i=a;break;case")":i=t.pop();break;case":":break;default:var s=n[r-1];")"==s||"("==s||","==s?i.name=o:":"==s&&(i.length=parseFloat(o))}}return i}}("undefined"!=typeof exports?exports:this.Newick={});var THREE=THREE||{REVISION:"58"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}},self.Int32Array=self.Int32Array||Array,self.Float32Array=self.Float32Array||Array,String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},THREE.extend=function(e,t){if(Object.keys)for(var i=Object.keys(t),n=0,r=i.length;r>n;n++){var o=i[n];Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}else{var a={}.hasOwnProperty;for(var o in t)a.call(t,o)&&(e[o]=t[o])}return e},function(){for(var e=0,t=["ms","moz","webkit","o"],i=0;i<t.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[t[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[i]+"CancelAnimationFrame"]||window[t[i]+"CancelRequestAnimationFrame"];void 0===window.requestAnimationFrame&&(window.requestAnimationFrame=function(t){var i=Date.now(),n=Math.max(0,16-(i-e)),r=window.setTimeout(function(){t(i+n)},n);return e=i+n,r}),window.cancelAnimationFrame=window.cancelAnimationFrame||function(e){window.clearTimeout(e)}}(),THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.Color=function(e){return void 0!==e&&this.set(e),this},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(e){return e instanceof THREE.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,i){return this.r=e,this.g=t,this.b=i,this},setHSL:function(e,t,i){if(0===t)this.r=this.g=this.b=i;else{var n=function(e,t,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?e+6*(t-e)*i:.5>i?t:2/3>i?e+6*(t-e)*(2/3-i):e},r=.5>=i?i*(1+t):i+t-i*t,o=2*i-r;this.r=n(o,r,e+1/3),this.g=n(o,r,e),this.b=n(o,r,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(e)){var t=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(e);return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(e)){var t=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(e);return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(e)){var t=/^\#([0-9a-f]{6})$/i.exec(e);return this.setHex(parseInt(t[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)){var t=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);return this.setHex(parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3],16)),this}return/^(\w+)$/i.test(e)?(this.setHex(THREE.ColorKeywords[e]),this):void 0},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e){return this.r=e.r*e.r,this.g=e.g*e.g,this.b=e.b*e.b,this},copyLinearToGamma:function(e){return this.r=Math.sqrt(e.r),this.g=Math.sqrt(e.g),this.b=Math.sqrt(e.b),this},convertGammaToLinear:function(){var e=this.r,t=this.g,i=this.b;return this.r=e*e,this.g=t*t,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var e={h:0,s:0,l:0};return function(){var t=this.r,i=this.g,n=this.b,r=Math.max(t,i,n),o=Math.min(t,i,n),a,s,l=(o+r)/2;if(o===r)a=0,s=0;else{var h=r-o;switch(s=.5>=l?h/(r+o):h/(2-r-o),r){case t:a=(i-n)/h+(n>i?6:0);break;case i:a=(n-t)/h+2;break;case n:a=(t-i)/h+4}a/=6}return e.h=a,e.s=s,e.l=l,e}}(),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,i){var n=this.getHSL();return n.h+=e,n.s+=t,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==n?n:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEuler:function(e,t){var i=Math.cos(e.x/2),n=Math.cos(e.y/2),r=Math.cos(e.z/2),o=Math.sin(e.x/2),a=Math.sin(e.y/2),s=Math.sin(e.z/2);return void 0===t||"XYZ"===t?(this.x=o*n*r+i*a*s,this.y=i*a*r-o*n*s,this.z=i*n*s+o*a*r,this.w=i*n*r-o*a*s):"YXZ"===t?(this.x=o*n*r+i*a*s,this.y=i*a*r-o*n*s,this.z=i*n*s-o*a*r,this.w=i*n*r+o*a*s):"ZXY"===t?(this.x=o*n*r-i*a*s,this.y=i*a*r+o*n*s,this.z=i*n*s+o*a*r,this.w=i*n*r-o*a*s):"ZYX"===t?(this.x=o*n*r-i*a*s,this.y=i*a*r+o*n*s,this.z=i*n*s-o*a*r,this.w=i*n*r+o*a*s):"YZX"===t?(this.x=o*n*r+i*a*s,this.y=i*a*r+o*n*s,this.z=i*n*s-o*a*r,this.w=i*n*r-o*a*s):"XZY"===t&&(this.x=o*n*r-i*a*s,this.y=i*a*r-o*n*s,this.z=i*n*s+o*a*r,this.w=i*n*r+o*a*s),this},setFromAxisAngle:function(e,t){var i=t/2,n=Math.sin(i);return this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this.w=Math.cos(i),this},setFromRotationMatrix:function(e){var t=e.elements,i=t[0],n=t[4],r=t[8],o=t[1],a=t[5],s=t[9],l=t[2],h=t[6],c=t[10],u=i+a+c,f;return u>0?(f=.5/Math.sqrt(u+1),this.w=.25/f,this.x=(h-s)*f,this.y=(r-l)*f,this.z=(o-n)*f):i>a&&i>c?(f=2*Math.sqrt(1+i-a-c),this.w=(h-s)/f,this.x=.25*f,this.y=(n+o)/f,this.z=(r+l)/f):a>c?(f=2*Math.sqrt(1+a-i-c),this.w=(r-l)/f,this.x=(n+o)/f,this.y=.25*f,this.z=(s+h)/f):(f=2*Math.sqrt(1+c-i-a),this.w=(o-n)/f,this.x=(r+l)/f,this.y=(s+h)/f,this.z=.25*f),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var e=this.length();return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var i=e.x,n=e.y,r=e.z,o=e.w,a=t.x,s=t.y,l=t.z,h=t.w;return this.x=i*h+o*a+n*l-r*s,this.y=n*h+o*s+r*a-i*l,this.z=r*h+o*l+i*s-n*a,this.w=o*h-i*a-n*s-r*l,this},multiplyVector3:function(e){return console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},slerp:function(e,t){var i=this.x,n=this.y,r=this.z,o=this.w,a=o*e.w+i*e.x+n*e.y+r*e.z;if(0>a?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,a=-a):this.copy(e),a>=1)return this.w=o,this.x=i,this.y=n,this.z=r,this;var s=Math.acos(a),l=Math.sqrt(1-a*a);if(Math.abs(l)<.001)return this.w=.5*(o+this.w),this.x=.5*(i+this.x),this.y=.5*(n+this.y),this.z=.5*(r+this.z),this;
var h=Math.sin((1-t)*s)/l,c=Math.sin(t*s)/l;return this.w=o*h+this.w*c,this.x=i*h+this.x*c,this.y=n*h+this.y*c,this.z=r*h+this.z*c,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this.w=e[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}},THREE.Quaternion.slerp=function(e,t,i,n){return i.copy(e).slerp(t,n)},THREE.Vector2=function(e,t){this.x=e||0,this.y=t||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScalar:function(e){return this.x+=e,this.y+=e,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divideScalar:function(e){return 0!==e?(this.x/=e,this.y/=e):this.set(0,0),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e){return this.x=e[0],this.y=e[1],this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyMatrix3:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n+r[12],this.y=r[1]*t+r[5]*i+r[9]*n+r[13],this.z=r[2]*t+r[6]*i+r[10]*n+r[14],this},applyProjection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements,o=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*o,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*o,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*o,this},applyQuaternion:function(e){var t=this.x,i=this.y,n=this.z,r=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*n-a*i,h=s*i+a*t-r*n,c=s*n+r*i-o*t,u=-r*t-o*i-a*n;return this.x=l*s+u*-r+h*-a-c*-o,this.y=h*s+u*-o+c*-r-l*-a,this.z=c*s+u*-a+l*-o-h*-r,this},transformDirection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return 0!==e?(this.x/=e,this.y/=e,this.z/=e):(this.x=0,this.y=0,this.z=0),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},cross:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var i=this.x,n=this.y,r=this.z;return this.x=n*e.z-r*e.y,this.y=r*e.x-i*e.z,this.z=i*e.y-n*e.x,this},crossVectors:function(e,t){return this.x=e.y*t.z-e.z*t.y,this.y=e.z*t.x-e.x*t.z,this.z=e.x*t.y-e.y*t.x,this},angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos(THREE.Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n},setEulerFromRotationMatrix:function(e,t){function i(e){return Math.min(Math.max(e,-1),1)}var n=e.elements,r=n[0],o=n[4],a=n[8],s=n[1],l=n[5],h=n[9],c=n[2],u=n[6],f=n[10];return void 0===t||"XYZ"===t?(this.y=Math.asin(i(a)),Math.abs(a)<.99999?(this.x=Math.atan2(-h,f),this.z=Math.atan2(-o,r)):(this.x=Math.atan2(u,l),this.z=0)):"YXZ"===t?(this.x=Math.asin(-i(h)),Math.abs(h)<.99999?(this.y=Math.atan2(a,f),this.z=Math.atan2(s,l)):(this.y=Math.atan2(-c,r),this.z=0)):"ZXY"===t?(this.x=Math.asin(i(u)),Math.abs(u)<.99999?(this.y=Math.atan2(-c,f),this.z=Math.atan2(-o,l)):(this.y=0,this.z=Math.atan2(s,r))):"ZYX"===t?(this.y=Math.asin(-i(c)),Math.abs(c)<.99999?(this.x=Math.atan2(u,f),this.z=Math.atan2(s,r)):(this.x=0,this.z=Math.atan2(-o,l))):"YZX"===t?(this.z=Math.asin(i(s)),Math.abs(s)<.99999?(this.x=Math.atan2(-h,l),this.y=Math.atan2(-c,r)):(this.x=0,this.y=Math.atan2(a,f))):"XZY"===t&&(this.z=Math.asin(-i(o)),Math.abs(o)<.99999?(this.x=Math.atan2(u,l),this.y=Math.atan2(a,r)):(this.x=Math.atan2(-h,f),this.y=0)),this},setEulerFromQuaternion:function(e,t){function i(e){return Math.min(Math.max(e,-1),1)}var n=e.x*e.x,r=e.y*e.y,o=e.z*e.z,a=e.w*e.w;return void 0===t||"XYZ"===t?(this.x=Math.atan2(2*(e.x*e.w-e.y*e.z),a-n-r+o),this.y=Math.asin(i(2*(e.x*e.z+e.y*e.w))),this.z=Math.atan2(2*(e.z*e.w-e.x*e.y),a+n-r-o)):"YXZ"===t?(this.x=Math.asin(i(2*(e.x*e.w-e.y*e.z))),this.y=Math.atan2(2*(e.x*e.z+e.y*e.w),a-n-r+o),this.z=Math.atan2(2*(e.x*e.y+e.z*e.w),a-n+r-o)):"ZXY"===t?(this.x=Math.asin(i(2*(e.x*e.w+e.y*e.z))),this.y=Math.atan2(2*(e.y*e.w-e.z*e.x),a-n-r+o),this.z=Math.atan2(2*(e.z*e.w-e.x*e.y),a-n+r-o)):"ZYX"===t?(this.x=Math.atan2(2*(e.x*e.w+e.z*e.y),a-n-r+o),this.y=Math.asin(i(2*(e.y*e.w-e.x*e.z))),this.z=Math.atan2(2*(e.x*e.y+e.z*e.w),a+n-r-o)):"YZX"===t?(this.x=Math.atan2(2*(e.x*e.w-e.z*e.y),a-n+r-o),this.y=Math.atan2(2*(e.y*e.w-e.x*e.z),a+n-r-o),this.z=Math.asin(i(2*(e.x*e.y+e.z*e.w)))):"XZY"===t&&(this.x=Math.atan2(2*(e.x*e.w+e.y*e.z),a-n+r-o),this.y=Math.atan2(2*(e.x*e.z+e.y*e.w),a+n-r-o),this.z=Math.asin(i(2*(e.z*e.w-e.x*e.y)))),this},getPositionFromMatrix:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},getScaleFromMatrix:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),i=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),n=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=i,this.z=n,this},getColumnFromMatrix:function(e,t){var i=4*e,n=t.elements;return this.x=n[i],this.y=n[i+1],this.z=n[i+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var e=new THREE.Quaternion;return function(t,i){var n=e.setFromEuler(t,i);return this.applyQuaternion(n),this}}(),applyAxisAngle:function(){var e=new THREE.Quaternion;return function(t,i){var n=e.setFromAxisAngle(t,i);return this.applyQuaternion(n),this}}(),projectOnVector:function(){var e=new THREE.Vector3;return function(t){e.copy(t).normalize();var i=this.dot(e);return this.copy(e).multiplyScalar(i)}}(),projectOnPlane:function(){var e=new THREE.Vector3;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new THREE.Vector3;return function(t){return e.copy(this).projectOnVector(t).multiplyScalar(2),this.subVectors(e,this)}}()}),THREE.Vector4=function(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==n?n:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*n+o[12]*r,this.y=o[1]*t+o[5]*i+o[9]*n+o[13]*r,this.z=o[2]*t+o[6]*i+o[10]*n+o[14]*r,this.w=o[3]*t+o[7]*i+o[11]*n+o[15]*r,this},divideScalar:function(e){return 0!==e?(this.x/=e,this.y/=e,this.z/=e,this.w/=e):(this.x=0,this.y=0,this.z=0,this.w=1),this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,n,r,o=.01,a=.1,s=e.elements,l=s[0],h=s[4],c=s[8],u=s[1],f=s[5],p=s[9],d=s[2],m=s[6],g=s[10];if(Math.abs(h-u)<o&&Math.abs(c-d)<o&&Math.abs(p-m)<o){if(Math.abs(h+u)<a&&Math.abs(c+d)<a&&Math.abs(p+m)<a&&Math.abs(l+f+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;var v=(l+1)/2,E=(f+1)/2,y=(g+1)/2,T=(h+u)/4,x=(c+d)/4,b=(p+m)/4;return v>E&&v>y?o>v?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(v),n=T/i,r=x/i):E>y?o>E?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(E),i=T/n,r=b/n):o>y?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(y),i=x/r,n=b/r),this.set(i,n,r,t),this}var _=Math.sqrt((m-p)*(m-p)+(c-d)*(c-d)+(u-h)*(u-h));return Math.abs(_)<.001&&(_=1),this.x=(m-p)/_,this.y=(c-d)/_,this.z=(u-h)/_,this.w=Math.acos((l+f+g-1)/2),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this.w>e.w&&(this.w=e.w),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this.w<e.w&&(this.w=e.w),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this.w<e.w?this.w=e.w:this.w>t.w&&(this.w=t.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this.w=e[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Line3=function(e,t){this.start=void 0!==e?e:new THREE.Vector3,this.end=void 0!==t?t:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var t=e||new THREE.Vector3;return t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var i=t||new THREE.Vector3;return this.delta(i).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n){e.subVectors(i,this.start),t.subVectors(this.end,this.start);var r=t.dot(t),o=t.dot(e),a=o/r;return n&&(a=THREE.Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(e,t,i){var n=this.closestPointToPointParameter(e,t),r=i||new THREE.Vector3;return this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}},THREE.Box2=function(e,t){this.min=void 0!==e?e:new THREE.Vector2(1/0,1/0),this.max=void 0!==t?t:new THREE.Vector2(-1/0,-1/0)},THREE.Box2.prototype={constructor:THREE.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){if(e.length>0){var t=e[0];this.min.copy(t),this.max.copy(t);for(var i=1,n=e.length;n>i;i++)t=e[i],t.x<this.min.x?this.min.x=t.x:t.x>this.max.x&&(this.max.x=t.x),t.y<this.min.y?this.min.y=t.y:t.y>this.max.y&&(this.max.y=t.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new THREE.Vector2;return function(t,i){var n=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){var t=e||new THREE.Vector2;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new THREE.Vector2;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y?!0:!1},getParameter:function(e){return new THREE.Vector2((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y?!1:!0},clampPoint:function(e,t){var i=t||new THREE.Vector2;return i.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector2;return function(t){var i=e.copy(t).clamp(this.min,this.max);return i.sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}},THREE.Box3=function(e,t){this.min=void 0!==e?e:new THREE.Vector3(1/0,1/0,1/0),this.max=void 0!==t?t:new THREE.Vector3(-1/0,-1/0,-1/0)},THREE.Box3.prototype={constructor:THREE.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){if(e.length>0){var t=e[0];this.min.copy(t),this.max.copy(t);for(var i=1,n=e.length;n>i;i++)t=e[i],t.x<this.min.x?this.min.x=t.x:t.x>this.max.x&&(this.max.x=t.x),t.y<this.min.y?this.min.y=t.y:t.y>this.max.y&&(this.max.y=t.y),t.z<this.min.z?this.min.z=t.z:t.z>this.max.z&&(this.max.z=t.z)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new THREE.Vector3;return function(t,i){var n=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){var t=e||new THREE.Vector3;return t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z?!0:!1},getParameter:function(e){return new THREE.Vector3((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},clampPoint:function(e,t){var i=t||new THREE.Vector3;return i.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){var i=e.copy(t).clamp(this.min,this.max);return i.sub(t).length()}}(),getBoundingSphere:function(){var e=new THREE.Vector3;return function(t){var i=t||new THREE.Sphere;return i.center=this.center(),i.radius=.5*this.size(e).length(),i}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(t){return e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(e),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}},THREE.Matrix3=function(e,t,i,n,r,o,a,s,l){this.elements=new Float32Array(9),this.set(void 0!==e?e:1,t||0,i||0,n||0,void 0!==r?r:1,o||0,a||0,s||0,void 0!==l?l:1)},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(e,t,i,n,r,o,a,s,l){var h=this.elements;return h[0]=e,h[3]=t,h[6]=i,h[1]=n,h[4]=r,h[7]=o,h[2]=a,h[5]=s,h[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(e){return console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var i=0,n=t.length;n>i;i+=3)e.x=t[i],e.y=t[i+1],e.z=t[i+2],e.applyMatrix3(this),t[i]=e.x,t[i+1]=e.y,t[i+2]=e.z;return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],h=e[8];return t*o*h-t*a*l-i*r*h+i*a*s+n*r*l-n*o*s},getInverse:function(e,t){var i=e.elements,n=this.elements;n[0]=i[10]*i[5]-i[6]*i[9],n[1]=-i[10]*i[1]+i[2]*i[9],n[2]=i[6]*i[1]-i[2]*i[5],n[3]=-i[10]*i[4]+i[6]*i[8],n[4]=i[10]*i[0]-i[2]*i[8],n[5]=-i[6]*i[0]+i[2]*i[4],n[6]=i[9]*i[4]-i[5]*i[8],n[7]=-i[9]*i[0]+i[1]*i[8],n[8]=i[5]*i[0]-i[1]*i[4];var r=i[0]*n[0]+i[1]*n[3]+i[2]*n[6];if(0===r){var o="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(o);return console.warn(o),this.identity(),this}return this.multiplyScalar(1/r),this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.getInverse(e).transpose(),this},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},clone:function(){var e=this.elements;return new THREE.Matrix3(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])}},THREE.Matrix4=function(e,t,i,n,r,o,a,s,l,h,c,u,f,p,d,m){var g=this.elements=new Float32Array(16);g[0]=void 0!==e?e:1,g[4]=t||0,g[8]=i||0,g[12]=n||0,g[1]=r||0,g[5]=void 0!==o?o:1,g[9]=a||0,g[13]=s||0,g[2]=l||0,g[6]=h||0,g[10]=void 0!==c?c:1,g[14]=u||0,g[3]=f||0,g[7]=p||0,g[11]=d||0,g[15]=void 0!==m?m:1},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(e,t,i,n,r,o,a,s,l,h,c,u,f,p,d,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=n,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=h,g[10]=c,g[14]=u,g[3]=f,g[7]=p,g[11]=d,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]),this},extractPosition:function(e){return console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractRotation:function(){var e=new THREE.Vector3;return function(t){var i=this.elements,n=t.elements,r=1/e.set(n[0],n[1],n[2]).length(),o=1/e.set(n[4],n[5],n[6]).length(),a=1/e.set(n[8],n[9],n[10]).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[4]=n[4]*o,i[5]=n[5]*o,i[6]=n[6]*o,i[8]=n[8]*a,i[9]=n[9]*a,i[10]=n[10]*a,this}}(),setRotationFromEuler:function(e,t){return console.warn("DEPRECATED: Matrix4's .setRotationFromEuler() has been deprecated in favor of makeRotationFromEuler.  Please update your code."),this.makeRotationFromEuler(e,t)},makeRotationFromEuler:function(e,t){var i=this.elements,n=e.x,r=e.y,o=e.z,a=Math.cos(n),s=Math.sin(n),l=Math.cos(r),h=Math.sin(r),c=Math.cos(o),u=Math.sin(o);if(void 0===t||"XYZ"===t){var f=a*c,p=a*u,d=s*c,m=s*u;i[0]=l*c,i[4]=-l*u,i[8]=h,i[1]=p+d*h,i[5]=f-m*h,i[9]=-s*l,i[2]=m-f*h,i[6]=d+p*h,i[10]=a*l}else if("YXZ"===t){var g=l*c,v=l*u,E=h*c,y=h*u;i[0]=g+y*s,i[4]=E*s-v,i[8]=a*h,i[1]=a*u,i[5]=a*c,i[9]=-s,i[2]=v*s-E,i[6]=y+g*s,i[10]=a*l}else if("ZXY"===t){var g=l*c,v=l*u,E=h*c,y=h*u;i[0]=g-y*s,i[4]=-a*u,i[8]=E+v*s,i[1]=v+E*s,i[5]=a*c,i[9]=y-g*s,i[2]=-a*h,i[6]=s,i[10]=a*l}else if("ZYX"===t){var f=a*c,p=a*u,d=s*c,m=s*u;i[0]=l*c,i[4]=d*h-p,i[8]=f*h+m,i[1]=l*u,i[5]=m*h+f,i[9]=p*h-d,i[2]=-h,i[6]=s*l,i[10]=a*l}else if("YZX"===t){var T=a*l,x=a*h,b=s*l,_=s*h;i[0]=l*c,i[4]=_-T*u,i[8]=b*u+x,i[1]=u,i[5]=a*c,i[9]=-s*c,i[2]=-h*c,i[6]=x*u+b,i[10]=T-_*u}else if("XZY"===t){var T=a*l,x=a*h,b=s*l,_=s*h;i[0]=l*c,i[4]=-u,i[8]=h*c,i[1]=T*u+_,i[5]=a*c,i[9]=x*u-b,i[2]=b*u-x,i[6]=s*c,i[10]=_*u+T}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},setRotationFromQuaternion:function(e){return console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z,o=e.w,a=i+i,s=n+n,l=r+r,h=i*a,c=i*s,u=i*l,f=n*s,p=n*l,d=r*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(f+d),t[4]=c-v,t[8]=u+g,t[1]=c+v,t[5]=1-(h+d),t[9]=p-m,t[2]=u-g,t[6]=p+m,t[10]=1-(h+f),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3;return function(n,r,o){var a=this.elements;return i.subVectors(n,r).normalize(),0===i.length()&&(i.z=1),e.crossVectors(o,i).normalize(),0===e.length()&&(i.x+=1e-4,e.crossVectors(o,i).normalize()),t.crossVectors(i,e),a[0]=e.x,a[4]=t.x,a[8]=i.x,a[1]=e.y,a[5]=t.y,a[9]=i.y,a[2]=e.z,a[6]=t.z,a[10]=i.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,o=i[0],a=i[4],s=i[8],l=i[12],h=i[1],c=i[5],u=i[9],f=i[13],p=i[2],d=i[6],m=i[10],g=i[14],v=i[3],E=i[7],y=i[11],T=i[15],x=n[0],b=n[4],_=n[8],w=n[12],R=n[1],H=n[5],M=n[9],S=n[13],C=n[2],A=n[6],D=n[10],k=n[14],P=n[3],L=n[7],N=n[11],z=n[15];return r[0]=o*x+a*R+s*C+l*P,r[4]=o*b+a*H+s*A+l*L,r[8]=o*_+a*M+s*D+l*N,r[12]=o*w+a*S+s*k+l*z,r[1]=h*x+c*R+u*C+f*P,r[5]=h*b+c*H+u*A+f*L,r[9]=h*_+c*M+u*D+f*N,r[13]=h*w+c*S+u*k+f*z,r[2]=p*x+d*R+m*C+g*P,r[6]=p*b+d*H+m*A+g*L,r[10]=p*_+d*M+m*D+g*N,r[14]=p*w+d*S+m*k+g*z,r[3]=v*x+E*R+y*C+T*P,r[7]=v*b+E*H+y*A+T*L,r[11]=v*_+E*M+y*D+T*N,r[15]=v*w+E*S+y*k+T*z,this},multiplyToArray:function(e,t,i){var n=this.elements;return this.multiplyMatrices(e,t),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var i=0,n=t.length;n>i;i+=3)e.x=t[i],e.y=t[i+1],e.z=t[i+2],e.applyProjection(this),t[i]=e.x,t[i+1]=e.y,t[i+2]=e.z;return t}}(),rotateAxis:function(e){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],o=e[1],a=e[5],s=e[9],l=e[13],h=e[2],c=e[6],u=e[10],f=e[14],p=e[3],d=e[7],m=e[11],g=e[15];return p*(+r*s*c-n*l*c-r*a*u+i*l*u+n*a*f-i*s*f)+d*(+t*s*f-t*l*u+r*o*u-n*o*f+n*l*h-r*s*h)+m*(+t*l*c-t*a*f-r*o*c+i*o*f+r*a*h-i*l*h)+g*(-n*a*h-t*s*c+t*a*u+n*o*c-i*o*u+i*s*h)},transpose:function(){var e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},flattenToArrayOffset:function(e,t){var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e},getPosition:function(){var e=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this
},getInverse:function(e,t){var i=this.elements,n=e.elements,r=n[0],o=n[4],a=n[8],s=n[12],l=n[1],h=n[5],c=n[9],u=n[13],f=n[2],p=n[6],d=n[10],m=n[14],g=n[3],v=n[7],E=n[11],y=n[15];i[0]=c*m*v-u*d*v+u*p*E-h*m*E-c*p*y+h*d*y,i[4]=s*d*v-a*m*v-s*p*E+o*m*E+a*p*y-o*d*y,i[8]=a*u*v-s*c*v+s*h*E-o*u*E-a*h*y+o*c*y,i[12]=s*c*p-a*u*p-s*h*d+o*u*d+a*h*m-o*c*m,i[1]=u*d*g-c*m*g-u*f*E+l*m*E+c*f*y-l*d*y,i[5]=a*m*g-s*d*g+s*f*E-r*m*E-a*f*y+r*d*y,i[9]=s*c*g-a*u*g-s*l*E+r*u*E+a*l*y-r*c*y,i[13]=a*u*f-s*c*f+s*l*d-r*u*d-a*l*m+r*c*m,i[2]=h*m*g-u*p*g+u*f*v-l*m*v-h*f*y+l*p*y,i[6]=s*p*g-o*m*g-s*f*v+r*m*v+o*f*y-r*p*y,i[10]=o*u*g-s*h*g+s*l*v-r*u*v-o*l*y+r*h*y,i[14]=s*h*f-o*u*f-s*l*p+r*u*p+o*l*m-r*h*m,i[3]=c*p*g-h*d*g-c*f*v+l*d*v+h*f*E-l*p*E,i[7]=o*d*g-a*p*g+a*f*v-r*d*v-o*f*E+r*p*E,i[11]=a*h*g-o*c*g-a*l*v+r*c*v+o*l*E-r*h*E,i[15]=o*c*f-a*h*f+a*l*p-r*c*p-o*l*d+r*h*d;var T=n[0]*i[0]+n[1]*i[4]+n[2]*i[8]+n[3]*i[12];if(0==T){var x="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(x);return console.warn(x),this.identity(),this}return this.multiplyScalar(1/T),this},translate:function(e){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(e){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(e){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(e){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(e,t){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(i,n)))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=1-i,o=e.x,a=e.y,s=e.z,l=r*o,h=r*a;return this.set(l*o+i,l*a-n*s,l*s+n*a,0,l*a+n*s,h*a+i,h*s-n*o,0,l*s-n*a,h*s+n*o,r*s*s+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},compose:function(e,t,i){return console.warn("DEPRECATED: Matrix4's .compose() has been deprecated in favor of makeFromPositionQuaternionScale. Please update your code."),this.makeFromPositionQuaternionScale(e,t,i)},makeFromPositionQuaternionScale:function(e,t,i){return this.makeRotationFromQuaternion(t),this.scale(i),this.setPosition(e),this},makeFromPositionEulerScale:function(e,t,i,n){return this.makeRotationFromEuler(t,i),this.scale(n),this.setPosition(e),this},makeFrustum:function(e,t,i,n,r,o){var a=this.elements,s=2*r/(t-e),l=2*r/(n-i),h=(t+e)/(t-e),c=(n+i)/(n-i),u=-(o+r)/(o-r),f=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(e,t,i,n){var r=i*Math.tan(THREE.Math.degToRad(.5*e)),o=-r,a=o*t,s=r*t;return this.makeFrustum(a,s,o,r,i,n)},makeOrthographic:function(e,t,i,n,r,o){var a=this.elements,s=t-e,l=i-n,h=o-r,c=(t+e)/s,u=(i+n)/l,f=(o+r)/h;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2/l,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2/h,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},clone:function(){var e=this.elements;return new THREE.Matrix4(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}},THREE.extend(THREE.Matrix4.prototype,{decompose:function(){var e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Matrix4;return function(r,o,a){var s=this.elements;return e.set(s[0],s[1],s[2]),t.set(s[4],s[5],s[6]),i.set(s[8],s[9],s[10]),r=r instanceof THREE.Vector3?r:new THREE.Vector3,o=o instanceof THREE.Quaternion?o:new THREE.Quaternion,a=a instanceof THREE.Vector3?a:new THREE.Vector3,a.x=e.length(),a.y=t.length(),a.z=i.length(),r.x=s[12],r.y=s[13],r.z=s[14],n.copy(this),n.elements[0]/=a.x,n.elements[1]/=a.x,n.elements[2]/=a.x,n.elements[4]/=a.y,n.elements[5]/=a.y,n.elements[6]/=a.y,n.elements[8]/=a.z,n.elements[9]/=a.z,n.elements[10]/=a.z,o.setFromRotationMatrix(n),[r,o,a]}}()}),THREE.Ray=function(e,t){this.origin=void 0!==e?e:new THREE.Vector3,this.direction=void 0!==t?t:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){var i=t||new THREE.Vector3;return i.copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new THREE.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var i=t||new THREE.Vector3;i.subVectors(e,this.origin);var n=i.dot(this.direction);return i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){var i=e.subVectors(t,this.origin).dot(this.direction);return e.copy(this.direction).multiplyScalar(i).add(this.origin),e.distanceTo(t)}}(),isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},isIntersectionPlane:function(e){var t=e.normal.dot(this.direction);return 0!=t?!0:0==e.distanceToPoint(this.origin)?!0:!1},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0==t)return 0==e.distanceToPoint(this.origin)?0:void 0;var i=-(this.origin.dot(e.normal)+e.constant)/t;return i},intersectPlane:function(e,t){var i=this.distanceToPlane(e);return void 0===i?void 0:this.at(i,t)},applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}},THREE.Sphere=function(e,t){this.center=void 0!==e?e:new THREE.Vector3,this.radius=void 0!==t?t:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromCenterAndPoints:function(e,t){for(var i=0,n=0,r=t.length;r>n;n++){var o=e.distanceToSquared(t[n]);i=Math.max(i,o)}return this.center=e,this.radius=Math.sqrt(i),this},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var i=this.center.distanceToSquared(e),n=t||new THREE.Vector3;return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){var t=e||new THREE.Box3;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}},THREE.Frustum=function(e,t,i,n,r,o){this.planes=[void 0!==e?e:new THREE.Plane,void 0!==t?t:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==o?o:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(e,t,i,n,r,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(o),this},copy:function(e){for(var t=this.planes,i=0;6>i;i++)t[i].copy(e.planes[i]);return this},setFromMatrix:function(e){var t=this.planes,i=e.elements,n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],l=i[5],h=i[6],c=i[7],u=i[8],f=i[9],p=i[10],d=i[11],m=i[12],g=i[13],v=i[14],E=i[15];return t[0].setComponents(a-n,c-s,d-u,E-m).normalize(),t[1].setComponents(a+n,c+s,d+u,E+m).normalize(),t[2].setComponents(a+r,c+l,d+f,E+g).normalize(),t[3].setComponents(a-r,c-l,d-f,E-g).normalize(),t[4].setComponents(a-o,c-h,d-p,E-v).normalize(),t[5].setComponents(a+o,c+h,d+p,E+v).normalize(),this},intersectsObject:function(){var e=new THREE.Vector3;return function(t){var i=t.matrixWorld,n=this.planes,r=-t.geometry.boundingSphere.radius*i.getMaxScaleOnAxis();e.getPositionFromMatrix(i);for(var o=0;6>o;o++){var a=n[o].distanceToPoint(e);if(r>a)return!1}return!0}}(),intersectsSphere:function(e){for(var t=this.planes,i=e.center,n=-e.radius,r=0;6>r;r++){var o=t[r].distanceToPoint(i);if(n>o)return!1}return!0},containsPoint:function(e){for(var t=this.planes,i=0;6>i;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}},THREE.Plane=function(e,t){this.normal=void 0!==e?e:new THREE.Vector3(1,0,0),this.constant=void 0!==t?t:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n,r){var o=e.subVectors(r,n).cross(t.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,i),this}}(),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var i=this.distanceToPoint(e),n=t||new THREE.Vector3;return n.copy(this.normal).multiplyScalar(i)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return 0>t&&i>0||0>i&&t>0},intersectLine:function(){var e=new THREE.Vector3;return function(t,i){var n=i||new THREE.Vector3,r=t.delta(e),o=this.normal.dot(r);if(0==o)return 0==this.distanceToPoint(t.start)?n.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/o;return 0>a||a>1?void 0:n.copy(r).multiplyScalar(a).add(t.start)}}(),coplanarPoint:function(e){var t=e||new THREE.Vector3;return t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(i,n){n=n||(new THREE.Matrix3).getNormalMatrix(i);var r=e.copy(this.normal).applyMatrix3(n),o=this.coplanarPoint(t);return o.applyMatrix4(i),this.setFromNormalAndCoplanarPoint(r,o),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}},THREE.Math={clamp:function(e,t,i){return t>e?t:e>i?i:e},clampBottom:function(e,t){return t>e?t:e},mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},smoothstep:function(e,t,i){return t>=e?0:e>=i?1:(e=(e-t)/(i-t),e*e*(3-2*e))},smootherstep:function(e,t,i){return t>=e?0:e>=i?1:(e=(e-t)/(i-t),e*e*e*(e*(6*e-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},sign:function(e){return 0>e?-1:e>0?1:0},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}()},THREE.Spline=function(e){function t(e,t,i,n,r,o,a){var s=.5*(i-e),l=.5*(n-t);return(2*(t-i)+s+l)*a+(-3*(t-i)-2*s-l)*o+s*r+t}this.points=e;var i=[],n={x:0,y:0,z:0},r,o,a,s,l,h,c,u,f;this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return r=(this.points.length-1)*e,o=Math.floor(r),a=r-o,i[0]=0===o?o:o-1,i[1]=o,i[2]=o>this.points.length-2?this.points.length-1:o+1,i[3]=o>this.points.length-3?this.points.length-1:o+2,h=this.points[i[0]],c=this.points[i[1]],u=this.points[i[2]],f=this.points[i[3]],s=a*a,l=a*s,n.x=t(h.x,c.x,u.x,f.x,a,s,l),n.y=t(h.y,c.y,u.y,f.y,a,s,l),n.z=t(h.z,c.z,u.z,f.z,a,s,l),n},this.getControlPointsArray=function(){var e,t,i=this.points.length,n=[];for(e=0;i>e;e++)t=this.points[e],n[e]=[t.x,t.y,t.z];return n},this.getLength=function(e){var t,i,n,r,o=0,a=0,s=0,l=new THREE.Vector3,h=new THREE.Vector3,c=[],u=0;for(c[0]=0,e||(e=100),n=this.points.length*e,l.copy(this.points[0]),t=1;n>t;t++)i=t/n,r=this.getPoint(i),h.copy(r),u+=h.distanceTo(l),l.copy(r),o=(this.points.length-1)*i,a=Math.floor(o),a!=s&&(c[a]=u,s=a);return c[c.length]=u,{chunks:c,total:u}},this.reparametrizeByArcLength=function(e){var t,i,n,r,o,a,s,l,h,c=[],u=new THREE.Vector3,f=this.getLength();for(c.push(u.copy(this.points[0]).clone()),t=1;t<this.points.length;t++){for(s=f.chunks[t]-f.chunks[t-1],l=Math.ceil(e*s/f.total),r=(t-1)/(this.points.length-1),o=t/(this.points.length-1),i=1;l-1>i;i++)n=r+i*(1/l)*(o-r),h=this.getPoint(n),c.push(u.copy(h).clone());c.push(u.copy(this.points[t]).clone())}this.points=c}},THREE.Triangle=function(e,t,i){this.a=void 0!==e?e:new THREE.Vector3,this.b=void 0!==t?t:new THREE.Vector3,this.c=void 0!==i?i:new THREE.Vector3},THREE.Triangle.normal=function(){var e=new THREE.Vector3;return function(t,i,n,r){var o=r||new THREE.Vector3;o.subVectors(n,i),e.subVectors(t,i),o.cross(e);var a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3;return function(n,r,o,a,s){e.subVectors(a,r),t.subVectors(o,r),i.subVectors(n,r);var l=e.dot(e),h=e.dot(t),c=e.dot(i),u=t.dot(t),f=t.dot(i),p=l*u-h*h,d=s||new THREE.Vector3;if(0==p)return d.set(-2,-1,-1);var m=1/p,g=(u*c-h*f)*m,v=(l*f-h*c)*m;return d.set(1-g-v,v,g)}}(),THREE.Triangle.containsPoint=function(){var e=new THREE.Vector3;return function(t,i,n,r){var o=THREE.Triangle.barycoordFromPoint(t,i,n,r,e);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this},setFromPointsAndIndices:function(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){var t=e||new THREE.Vector3;return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return THREE.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){var t=e||new THREE.Plane;return t.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return THREE.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return THREE.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}},THREE.Vertex=function(e){return console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead."),e},THREE.UV=function(e,t){return console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead."),new THREE.Vector2(e,t)},THREE.Clock=function(e){this.autoStart=void 0!==e?e:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running&&this.start(),this.running){var t=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();e=.001*(t-this.oldTime),this.oldTime=t,this.elapsedTime+=e}return e}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)?!0:!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners,n=i[e].indexOf(t);-1!==n&&i[e].splice(n,1)}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,i=t[e.type];if(void 0!==i){e.target=this;for(var n=0,r=i.length;r>n;n++)i[n].call(this,e)}}}},function(THREE){THREE.Raycaster=function(e,t,i,n){this.ray=new THREE.Ray(e,t),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=i||0,this.far=n||1/0};var e=new THREE.Sphere,t=new THREE.Ray,i=new THREE.Plane,n=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Matrix4,a=function(e,t){return e.distance-t.distance},s=function(a,l,h){if(a instanceof THREE.Particle){r.getPositionFromMatrix(a.matrixWorld);var c=l.ray.distanceToPoint(r);if(c>a.scale.x)return h;h.push({distance:c,point:a.position,face:null,object:a})}else if(a instanceof THREE.LOD){r.getPositionFromMatrix(a.matrixWorld);var c=l.ray.origin.distanceTo(r);s(a.getObjectForDistance(c),l,h)}else if(a instanceof THREE.Mesh){if(r.getPositionFromMatrix(a.matrixWorld),e.set(r,a.geometry.boundingSphere.radius*a.matrixWorld.getMaxScaleOnAxis()),!l.ray.isIntersectionSphere(e))return h;var u=a.geometry,f=u.vertices,p=a.material instanceof THREE.MeshFaceMaterial,d=p===!0?a.material.materials:null,m=a.material.side,g,v,E,y,T=l.precision;o.getInverse(a.matrixWorld),t.copy(l.ray).applyMatrix4(o);for(var x=0,b=u.faces.length;b>x;x++){var _=u.faces[x],w=p===!0?d[_.materialIndex]:a.material;if(void 0!==w){i.setFromNormalAndCoplanarPoint(_.normal,f[_.a]);var R=t.distanceToPlane(i);if(!(Math.abs(R)<T||0>R)){if(m=w.side,m!==THREE.DoubleSide){var H=t.direction.dot(i.normal);if(!(m===THREE.FrontSide?0>H:H>0))continue}if(!(R<l.near||R>l.far)){if(n=t.at(R,n),_ instanceof THREE.Face3){if(g=f[_.a],v=f[_.b],E=f[_.c],!THREE.Triangle.containsPoint(n,g,v,E))continue}else{if(!(_ instanceof THREE.Face4))throw Error("face type not supported");if(g=f[_.a],v=f[_.b],E=f[_.c],y=f[_.d],!THREE.Triangle.containsPoint(n,g,v,y)&&!THREE.Triangle.containsPoint(n,v,E,y))continue}h.push({distance:R,point:l.ray.at(R),face:_,faceIndex:x,object:a})}}}}}},l=function(e,t,i){for(var n=e.getDescendants(),r=0,o=n.length;o>r;r++)s(n[r],t,i)};THREE.Raycaster.prototype.precision=1e-4,THREE.Raycaster.prototype.set=function(e,t){this.ray.set(e,t),this.ray.direction.length()>0&&this.ray.direction.normalize()},THREE.Raycaster.prototype.intersectObject=function(e,t){var i=[];return t===!0&&l(e,this,i),s(e,this,i),i.sort(a),i},THREE.Raycaster.prototype.intersectObjects=function(e,t){for(var i=[],n=0,r=e.length;r>n;n++)s(e[n],this,i),t===!0&&l(e[n],this,i);return i.sort(a),i}}(THREE),THREE.Object3D=function(){this.id=THREE.Object3DIdCount++,this.name="",this.parent=void 0,this.children=[],this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this.rotation=new THREE.Vector3,this.eulerOrder=THREE.Object3D.defaultEulerOrder,this.scale=new THREE.Vector3(1,1,1),this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.quaternion=new THREE.Quaternion,this.useQuaternion=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.userData={}},THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(){var e=new THREE.Matrix4;return function(t){this.matrix.multiplyMatrices(t,this.matrix),this.position.getPositionFromMatrix(this.matrix),this.scale.getScaleFromMatrix(this.matrix),e.extractRotation(this.matrix),this.useQuaternion===!0?this.quaternion.setFromRotationMatrix(e):this.rotation.setEulerFromRotationMatrix(e,this.eulerOrder)}}(),rotateOnAxis:function(){var e=new THREE.Quaternion,t=new THREE.Quaternion;return function(i,n){return e.setFromAxisAngle(i,n),this.useQuaternion===!0?this.quaternion.multiply(e):(t.setFromEuler(this.rotation,this.eulerOrder),t.multiply(e),this.rotation.setEulerFromQuaternion(t,this.eulerOrder)),this}}(),translateOnAxis:function(){var e=new THREE.Vector3;return function(t,i){return e.copy(t),this.useQuaternion===!0?e.applyQuaternion(this.quaternion):e.applyEuler(this.rotation,this.eulerOrder),this.position.add(e.multiplyScalar(i)),this}}(),translate:function(e,t){return console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed."),this.translateOnAxis(t,e)},translateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new THREE.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new THREE.Matrix4;return function(t){e.lookAt(t,this.position,this.up),this.useQuaternion===!0?this.quaternion.setFromRotationMatrix(e):this.rotation.setEulerFromRotationMatrix(e,this.eulerOrder)}}(),add:function(e){if(e===this)return void console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");if(e instanceof THREE.Object3D){void 0!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e);for(var t=this;void 0!==t.parent;)t=t.parent;void 0!==t&&t instanceof THREE.Scene&&t.__addObject(e)}},remove:function(e){var t=this.children.indexOf(e);if(-1!==t){e.parent=void 0,this.children.splice(t,1);for(var i=this;void 0!==i.parent;)i=i.parent;void 0!==i&&i instanceof THREE.Scene&&i.__removeObject(e)}},traverse:function(e){e(this);for(var t=0,i=this.children.length;i>t;t++)this.children[t].traverse(e)},getObjectById:function(e,t){for(var i=0,n=this.children.length;n>i;i++){var r=this.children[i];if(r.id===e)return r;if(t===!0&&(r=r.getObjectById(e,t),void 0!==r))return r}return void 0},getObjectByName:function(e,t){for(var i=0,n=this.children.length;n>i;i++){var r=this.children[i];if(r.name===e)return r;if(t===!0&&(r=r.getObjectByName(e,t),void 0!==r))return r}return void 0},getChildByName:function(e,t){return console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e,t)},getDescendants:function(e){void 0===e&&(e=[]),Array.prototype.push.apply(e,this.children);for(var t=0,i=this.children.length;i>t;t++)this.children[t].getDescendants(e);return e},updateMatrix:function(){this.useQuaternion===!1?this.matrix.makeFromPositionEulerScale(this.position,this.rotation,this.eulerOrder,this.scale):this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||e===!0)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateMatrixWorld(e)},clone:function(e){void 0===e&&(e=new THREE.Object3D),e.name=this.name,e.up.copy(this.up),e.position.copy(this.position),e.rotation instanceof THREE.Vector3&&e.rotation.copy(this.rotation),e.eulerOrder=this.eulerOrder,e.scale.copy(this.scale),e.renderDepth=this.renderDepth,e.rotationAutoUpdate=this.rotationAutoUpdate,e.matrix.copy(this.matrix),e.matrixWorld.copy(this.matrixWorld),e.matrixAutoUpdate=this.matrixAutoUpdate,e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,e.quaternion.copy(this.quaternion),e.useQuaternion=this.useQuaternion,e.visible=this.visible,e.castShadow=this.castShadow,e.receiveShadow=this.receiveShadow,e.frustumCulled=this.frustumCulled,e.userData=JSON.parse(JSON.stringify(this.userData));for(var t=0;t<this.children.length;t++){var i=this.children[t];e.add(i.clone())}return e}},THREE.Object3D.defaultEulerOrder="XYZ",THREE.Object3DIdCount=0,THREE.Projector=function(){function e(){if(h===u){var e=new THREE.RenderableObject;return c.push(e),u++,h++,e}return c[h++]}function t(){if(p===m){var e=new THREE.RenderableVertex;return d.push(e),m++,p++,e}return d[p++]}function i(){if(v===y){var e=new THREE.RenderableFace3;return E.push(e),y++,v++,e}return E[v++]}function n(){if(T===b){var e=new THREE.RenderableFace4;return x.push(e),b++,T++,e}return x[T++]}function r(){if(w===H){var e=new THREE.RenderableLine;return R.push(e),H++,w++,e}return R[w++]}function o(){if(S===A){var e=new THREE.RenderableParticle;return C.push(e),A++,S++,e}return C[S++]}function a(e,t){return t.z-e.z}function s(e,t){var i=0,n=1,r=e.z+e.w,o=t.z+t.w,a=-e.z+e.w,s=-t.z+t.w;return r>=0&&o>=0&&a>=0&&s>=0?!0:0>r&&0>o||0>a&&0>s?!1:(0>r?i=Math.max(i,r/(r-o)):0>o&&(n=Math.min(n,r/(r-o))),0>a?i=Math.max(i,a/(a-s)):0>s&&(n=Math.min(n,a/(a-s))),i>n?!1:(e.lerp(t,i),t.lerp(e,1-n),!0))}var l,h,c=[],u=0,f,p,d=[],m=0,g,v,E=[],y=0,T,x=[],b=0,_,w,R=[],H=0,M,S,C=[],A=0,D={objects:[],sprites:[],lights:[],elements:[]},k=new THREE.Vector3,P=new THREE.Vector4,L=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),N=new THREE.Box3,z=new Array(3),F=new Array(4),I=new THREE.Matrix4,O=new THREE.Matrix4,U,V=new THREE.Matrix4,B=new THREE.Matrix3,W=new THREE.Matrix3,j=new THREE.Vector3,G=new THREE.Frustum,q=new THREE.Vector4,X=new THREE.Vector4;this.projectVector=function(e,t){return t.matrixWorldInverse.getInverse(t.matrixWorld),O.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),e.applyProjection(O)},this.unprojectVector=function(e,t){return t.projectionMatrixInverse.getInverse(t.projectionMatrix),O.multiplyMatrices(t.matrixWorld,t.projectionMatrixInverse),e.applyProjection(O)},this.pickingRay=function(e,t){e.z=-1;var i=new THREE.Vector3(e.x,e.y,1);return this.unprojectVector(e,t),this.unprojectVector(i,t),i.sub(e).normalize(),new THREE.Raycaster(e,i)};var Y=function(t,i){h=0,D.objects.length=0,D.sprites.length=0,D.lights.length=0;var n=function(t){for(var i=0,r=t.children.length;r>i;i++){var o=t.children[i];o.visible!==!1&&(o instanceof THREE.Light?D.lights.push(o):o instanceof THREE.Mesh||o instanceof THREE.Line?(o.frustumCulled===!1||G.intersectsObject(o)===!0)&&(l=e(),l.object=o,null!==o.renderDepth?l.z=o.renderDepth:(k.getPositionFromMatrix(o.matrixWorld),k.applyProjection(O),l.z=k.z),D.objects.push(l)):o instanceof THREE.Sprite||o instanceof THREE.Particle?(l=e(),l.object=o,null!==o.renderDepth?l.z=o.renderDepth:(k.getPositionFromMatrix(o.matrixWorld),k.applyProjection(O),l.z=k.z),D.sprites.push(l)):(l=e(),l.object=o,null!==o.renderDepth?l.z=o.renderDepth:(k.getPositionFromMatrix(o.matrixWorld),k.applyProjection(O),l.z=k.z),D.objects.push(l)),n(o))}};return n(t),i===!0&&D.objects.sort(a),D};this.projectScene=function(e,l,h,c){var u=!1,m,E,y,x,b,R,H,C,A,k,K,Q,Z,J,et,tt,it,nt,rt,ot,at,st,lt,ht,ct,ut;for(v=0,T=0,w=0,S=0,D.elements.length=0,e.autoUpdate===!0&&e.updateMatrixWorld(),void 0===l.parent&&l.updateMatrixWorld(),I.copy(l.matrixWorldInverse.getInverse(l.matrixWorld)),O.multiplyMatrices(l.projectionMatrix,I),W.getNormalMatrix(I),G.setFromMatrix(O),D=Y(e,h),m=0,E=D.objects.length;E>m;m++)if(Z=D.objects[m].object,U=Z.matrixWorld,p=0,Z instanceof THREE.Mesh){for(J=Z.geometry,et=J.vertices,tt=J.faces,rt=J.faceVertexUvs,B.getNormalMatrix(U),ct=Z.material instanceof THREE.MeshFaceMaterial,ut=ct===!0?Z.material:null,y=0,x=et.length;x>y;y++)f=t(),f.positionWorld.copy(et[y]).applyMatrix4(U),f.positionScreen.copy(f.positionWorld).applyMatrix4(O),f.positionScreen.x/=f.positionScreen.w,f.positionScreen.y/=f.positionScreen.w,f.positionScreen.z/=f.positionScreen.w,f.visible=!(f.positionScreen.x<-1||f.positionScreen.x>1||f.positionScreen.y<-1||f.positionScreen.y>1||f.positionScreen.z<-1||f.positionScreen.z>1);for(b=0,R=tt.length;R>b;b++){it=tt[b];var ft=ct===!0?ut.materials[it.materialIndex]:Z.material;if(void 0!==ft){var pt=ft.side;if(it instanceof THREE.Face3){if(at=d[it.a],st=d[it.b],lt=d[it.c],z[0]=at.positionScreen,z[1]=st.positionScreen,z[2]=lt.positionScreen,at.visible!==!0&&st.visible!==!0&&lt.visible!==!0&&!L.isIntersectionBox(N.setFromPoints(z)))continue;if(u=(lt.positionScreen.x-at.positionScreen.x)*(st.positionScreen.y-at.positionScreen.y)-(lt.positionScreen.y-at.positionScreen.y)*(st.positionScreen.x-at.positionScreen.x)<0,pt!==THREE.DoubleSide&&u!==(pt===THREE.FrontSide))continue;g=i(),g.v1.copy(at),g.v2.copy(st),g.v3.copy(lt)}else if(it instanceof THREE.Face4){if(at=d[it.a],st=d[it.b],lt=d[it.c],ht=d[it.d],F[0]=at.positionScreen,F[1]=st.positionScreen,F[2]=lt.positionScreen,F[3]=ht.positionScreen,at.visible!==!0&&st.visible!==!0&&lt.visible!==!0&&ht.visible!==!0&&!L.isIntersectionBox(N.setFromPoints(F)))continue;if(u=(ht.positionScreen.x-at.positionScreen.x)*(st.positionScreen.y-at.positionScreen.y)-(ht.positionScreen.y-at.positionScreen.y)*(st.positionScreen.x-at.positionScreen.x)<0||(st.positionScreen.x-lt.positionScreen.x)*(ht.positionScreen.y-lt.positionScreen.y)-(st.positionScreen.y-lt.positionScreen.y)*(ht.positionScreen.x-lt.positionScreen.x)<0,pt!==THREE.DoubleSide&&u!==(pt===THREE.FrontSide))continue;g=n(),g.v1.copy(at),g.v2.copy(st),g.v3.copy(lt),g.v4.copy(ht)}for(g.normalModel.copy(it.normal),u!==!1||pt!==THREE.BackSide&&pt!==THREE.DoubleSide||g.normalModel.negate(),g.normalModel.applyMatrix3(B).normalize(),g.normalModelView.copy(g.normalModel).applyMatrix3(W),g.centroidModel.copy(it.centroid).applyMatrix4(U),nt=it.vertexNormals,H=0,C=nt.length;C>H;H++){var dt=g.vertexNormalsModel[H];dt.copy(nt[H]),u!==!1||pt!==THREE.BackSide&&pt!==THREE.DoubleSide||dt.negate(),dt.applyMatrix3(B).normalize();var mt=g.vertexNormalsModelView[H];mt.copy(dt).applyMatrix3(W)}for(g.vertexNormalsLength=nt.length,A=0,k=rt.length;k>A;A++)if(ot=rt[A][b],void 0!==ot)for(K=0,Q=ot.length;Q>K;K++)g.uvs[A][K]=ot[K];g.color=it.color,g.material=ft,j.copy(g.centroidModel).applyProjection(O),g.z=j.z,D.elements.push(g)}}}else if(Z instanceof THREE.Line){V.multiplyMatrices(O,U),et=Z.geometry.vertices,at=t(),at.positionScreen.copy(et[0]).applyMatrix4(V);var gt=Z.type===THREE.LinePieces?2:1;for(y=1,x=et.length;x>y;y++)at=t(),at.positionScreen.copy(et[y]).applyMatrix4(V),(y+1)%gt>0||(st=d[p-2],q.copy(at.positionScreen),X.copy(st.positionScreen),s(q,X)===!0&&(q.multiplyScalar(1/q.w),X.multiplyScalar(1/X.w),_=r(),_.v1.positionScreen.copy(q),_.v2.positionScreen.copy(X),_.z=Math.max(q.z,X.z),_.material=Z.material,Z.material.vertexColors===THREE.VertexColors&&(_.vertexColors[0].copy(Z.geometry.colors[y]),_.vertexColors[1].copy(Z.geometry.colors[y-1])),D.elements.push(_)))}for(m=0,E=D.sprites.length;E>m;m++)Z=D.sprites[m].object,U=Z.matrixWorld,Z instanceof THREE.Particle&&(P.set(U.elements[12],U.elements[13],U.elements[14],1),P.applyMatrix4(O),P.z/=P.w,P.z>0&&P.z<1&&(M=o(),M.object=Z,M.x=P.x/P.w,M.y=P.y/P.w,M.z=P.z,M.rotation=Z.rotation.z,M.scale.x=Z.scale.x*Math.abs(M.x-(P.x+l.projectionMatrix.elements[0])/(P.w+l.projectionMatrix.elements[12])),M.scale.y=Z.scale.y*Math.abs(M.y-(P.y+l.projectionMatrix.elements[5])/(P.w+l.projectionMatrix.elements[13])),M.material=Z.material,D.elements.push(M)));
return c===!0&&D.elements.sort(a),D}},THREE.Face3=function(e,t,i,n,r,o){this.a=e,this.b=t,this.c=i,this.normal=n instanceof THREE.Vector3?n:new THREE.Vector3,this.vertexNormals=n instanceof Array?n:[],this.color=r instanceof THREE.Color?r:new THREE.Color,this.vertexColors=r instanceof Array?r:[],this.vertexTangents=[],this.materialIndex=void 0!==o?o:0,this.centroid=new THREE.Vector3},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var e=new THREE.Face3(this.a,this.b,this.c);e.normal.copy(this.normal),e.color.copy(this.color),e.centroid.copy(this.centroid),e.materialIndex=this.materialIndex;var t,i;for(t=0,i=this.vertexNormals.length;i>t;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();for(t=0,i=this.vertexColors.length;i>t;t++)e.vertexColors[t]=this.vertexColors[t].clone();for(t=0,i=this.vertexTangents.length;i>t;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}},THREE.Face4=function(e,t,i,n,r,o,a){this.a=e,this.b=t,this.c=i,this.d=n,this.normal=r instanceof THREE.Vector3?r:new THREE.Vector3,this.vertexNormals=r instanceof Array?r:[],this.color=o instanceof THREE.Color?o:new THREE.Color,this.vertexColors=o instanceof Array?o:[],this.vertexTangents=[],this.materialIndex=void 0!==a?a:0,this.centroid=new THREE.Vector3},THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var e=new THREE.Face4(this.a,this.b,this.c,this.d);e.normal.copy(this.normal),e.color.copy(this.color),e.centroid.copy(this.centroid),e.materialIndex=this.materialIndex;var t,i;for(t=0,i=this.vertexNormals.length;i>t;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();for(t=0,i=this.vertexColors.length;i>t;t++)e.vertexColors[t]=this.vertexColors[t].clone();for(t=0,i=this.vertexTangents.length;i>t;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}},THREE.Geometry=function(){this.id=THREE.GeometryIdCount++,this.name="",this.vertices=[],this.colors=[],this.normals=[],this.faces=[],this.faceUvs=[[]],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.buffersNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(e){for(var t=(new THREE.Matrix3).getNormalMatrix(e),i=0,n=this.vertices.length;n>i;i++){var r=this.vertices[i];r.applyMatrix4(e)}for(var i=0,n=this.faces.length;n>i;i++){var o=this.faces[i];o.normal.applyMatrix3(t).normalize();for(var a=0,s=o.vertexNormals.length;s>a;a++)o.vertexNormals[a].applyMatrix3(t).normalize();o.centroid.applyMatrix4(e)}},computeCentroids:function(){var e,t,i;for(e=0,t=this.faces.length;t>e;e++)i=this.faces[e],i.centroid.set(0,0,0),i instanceof THREE.Face3?(i.centroid.add(this.vertices[i.a]),i.centroid.add(this.vertices[i.b]),i.centroid.add(this.vertices[i.c]),i.centroid.divideScalar(3)):i instanceof THREE.Face4&&(i.centroid.add(this.vertices[i.a]),i.centroid.add(this.vertices[i.b]),i.centroid.add(this.vertices[i.c]),i.centroid.add(this.vertices[i.d]),i.centroid.divideScalar(4))},computeFaceNormals:function(){for(var e=new THREE.Vector3,t=new THREE.Vector3,i=0,n=this.faces.length;n>i;i++){var r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,i,n,r,o,a;if(void 0===this.__tmpVertices){for(this.__tmpVertices=new Array(this.vertices.length),a=this.__tmpVertices,t=0,i=this.vertices.length;i>t;t++)a[t]=new THREE.Vector3;for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],o instanceof THREE.Face3?o.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:o instanceof THREE.Face4&&(o.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else for(a=this.__tmpVertices,t=0,i=this.vertices.length;i>t;t++)a[t].set(0,0,0);if(e){var s,l,h,c,u=new THREE.Vector3,f=new THREE.Vector3,p=new THREE.Vector3,d=new THREE.Vector3,m=new THREE.Vector3;for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],o instanceof THREE.Face3?(s=this.vertices[o.a],l=this.vertices[o.b],h=this.vertices[o.c],u.subVectors(h,l),f.subVectors(s,l),u.cross(f),a[o.a].add(u),a[o.b].add(u),a[o.c].add(u)):o instanceof THREE.Face4&&(s=this.vertices[o.a],l=this.vertices[o.b],h=this.vertices[o.c],c=this.vertices[o.d],p.subVectors(c,l),f.subVectors(s,l),p.cross(f),a[o.a].add(p),a[o.b].add(p),a[o.d].add(p),d.subVectors(c,h),m.subVectors(l,h),d.cross(m),a[o.b].add(d),a[o.c].add(d),a[o.d].add(d))}else for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],o instanceof THREE.Face3?(a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal)):o instanceof THREE.Face4&&(a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal),a[o.d].add(o.normal));for(t=0,i=this.vertices.length;i>t;t++)a[t].normalize();for(n=0,r=this.faces.length;r>n;n++)o=this.faces[n],o instanceof THREE.Face3?(o.vertexNormals[0].copy(a[o.a]),o.vertexNormals[1].copy(a[o.b]),o.vertexNormals[2].copy(a[o.c])):o instanceof THREE.Face4&&(o.vertexNormals[0].copy(a[o.a]),o.vertexNormals[1].copy(a[o.b]),o.vertexNormals[2].copy(a[o.c]),o.vertexNormals[3].copy(a[o.d]))},computeMorphNormals:function(){var e,t,i,n,r;for(i=0,n=this.faces.length;n>i;i++)for(r=this.faces[i],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;t>e;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var o=new THREE.Geometry;for(o.faces=this.faces,e=0,t=this.morphTargets.length;t>e;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals,l,h;for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],l=new THREE.Vector3,h=r instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},a.push(l),s.push(h)}var c=this.morphNormals[e];o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals();var l,h;for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],l=c.faceNormals[i],h=c.vertexNormals[i],l.copy(r.normal),r instanceof THREE.Face3?(h.a.copy(r.vertexNormals[0]),h.b.copy(r.vertexNormals[1]),h.c.copy(r.vertexNormals[2])):(h.a.copy(r.vertexNormals[0]),h.b.copy(r.vertexNormals[1]),h.c.copy(r.vertexNormals[2]),h.d.copy(r.vertexNormals[3]))}for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){function e(e,t,i,n,r,o,a){c=e.vertices[t],u=e.vertices[i],f=e.vertices[n],p=h[r],d=h[o],m=h[a],g=u.x-c.x,v=f.x-c.x,E=u.y-c.y,y=f.y-c.y,T=u.z-c.z,x=f.z-c.z,b=d.x-p.x,_=m.x-p.x,w=d.y-p.y,R=m.y-p.y,H=1/(b*R-_*w),D.set((R*g-w*v)*H,(R*E-w*y)*H,(R*T-w*x)*H),k.set((b*v-_*g)*H,(b*y-_*E)*H,(b*x-_*T)*H),C[t].add(D),C[i].add(D),C[n].add(D),A[t].add(k),A[i].add(k),A[n].add(k)}var t,i,n,r,o,a,s,l,h,c,u,f,p,d,m,g,v,E,y,T,x,b,_,w,R,H,M,S,C=[],A=[],D=new THREE.Vector3,k=new THREE.Vector3,P=new THREE.Vector3,L=new THREE.Vector3,N=new THREE.Vector3,z;for(n=0,r=this.vertices.length;r>n;n++)C[n]=new THREE.Vector3,A[n]=new THREE.Vector3;for(t=0,i=this.faces.length;i>t;t++)l=this.faces[t],h=this.faceVertexUvs[0][t],l instanceof THREE.Face3?e(this,l.a,l.b,l.c,0,1,2):l instanceof THREE.Face4&&(e(this,l.a,l.b,l.d,0,1,3),e(this,l.b,l.c,l.d,1,2,3));var F=["a","b","c","d"];for(t=0,i=this.faces.length;i>t;t++)for(l=this.faces[t],o=0;o<l.vertexNormals.length;o++)N.copy(l.vertexNormals[o]),s=l[F[o]],M=C[s],P.copy(M),P.sub(N.multiplyScalar(N.dot(M))).normalize(),L.crossVectors(l.vertexNormals[o],M),S=L.dot(A[s]),z=0>S?-1:1,l.vertexTangents[o]=new THREE.Vector4(P.x,P.y,P.z,z);this.hasTangents=!0},computeLineDistances:function(){for(var e=0,t=this.vertices,i=0,n=t.length;n>i;i++)i>0&&(e+=t[i].distanceTo(t[i-1])),this.lineDistances[i]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromCenterAndPoints(this.boundingSphere.center,this.vertices)},mergeVertices:function(){var e={},t=[],i=[],n,r,o=4,a=Math.pow(10,o),s,l,h,c,u,f,p,d;for(this.__tmpVertices=void 0,s=0,l=this.vertices.length;l>s;s++)n=this.vertices[s],r=[Math.round(n.x*a),Math.round(n.y*a),Math.round(n.z*a)].join("_"),void 0===e[r]?(e[r]=s,t.push(this.vertices[s]),i[s]=t.length-1):i[s]=i[e[r]];var m=[];for(s=0,l=this.faces.length;l>s;s++)if(h=this.faces[s],h instanceof THREE.Face3){h.a=i[h.a],h.b=i[h.b],h.c=i[h.c],c=[h.a,h.b,h.c];for(var g=-1,v=0;3>v;v++)if(c[v]==c[(v+1)%3]){g=v,m.push(s);break}}else if(h instanceof THREE.Face4){h.a=i[h.a],h.b=i[h.b],h.c=i[h.c],h.d=i[h.d],c=[h.a,h.b,h.c,h.d];for(var g=-1,v=0;4>v;v++)c[v]==c[(v+1)%4]&&(g>=0&&m.push(s),g=v);if(g>=0){c.splice(g,1);var E=new THREE.Face3(c[0],c[1],c[2],h.normal,h.color,h.materialIndex);for(f=0,p=this.faceVertexUvs.length;p>f;f++)d=this.faceVertexUvs[f][s],d&&d.splice(g,1);h.vertexNormals&&h.vertexNormals.length>0&&(E.vertexNormals=h.vertexNormals,E.vertexNormals.splice(g,1)),h.vertexColors&&h.vertexColors.length>0&&(E.vertexColors=h.vertexColors,E.vertexColors.splice(g,1)),this.faces[s]=E}}for(s=m.length-1;s>=0;s--)for(this.faces.splice(s,1),f=0,p=this.faceVertexUvs.length;p>f;f++)this.faceVertexUvs[f].splice(s,1);var y=this.vertices.length-t.length;return this.vertices=t,y},clone:function(){for(var e=new THREE.Geometry,t=this.vertices,i=0,n=t.length;n>i;i++)e.vertices.push(t[i].clone());for(var r=this.faces,i=0,n=r.length;n>i;i++)e.faces.push(r[i].clone());for(var o=this.faceVertexUvs[0],i=0,n=o.length;n>i;i++){for(var a=o[i],s=[],l=0,h=a.length;h>l;l++)s.push(new THREE.Vector2(a[l].x,a[l].y));e.faceVertexUvs[0].push(s)}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.GeometryIdCount=0,THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++,this.attributes={},this.dynamic=!1,this.offsets=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.morphTargets=[]},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(e){var t,i;if(this.attributes.position&&(t=this.attributes.position.array),this.attributes.normal&&(i=this.attributes.normal.array),void 0!==t&&(e.multiplyVector3Array(t),this.verticesNeedUpdate=!0),void 0!==i){var n=(new THREE.Matrix3).getNormalMatrix(e);n.multiplyVector3Array(i),this.normalizeNormals(),this.normalsNeedUpdate=!0}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.attributes.position.array;if(e){var t=this.boundingBox,i,n,r;e.length>=3&&(t.min.x=t.max.x=e[0],t.min.y=t.max.y=e[1],t.min.z=t.max.z=e[2]);for(var o=3,a=e.length;a>o;o+=3)i=e[o],n=e[o+1],r=e[o+2],i<t.min.x?t.min.x=i:i>t.max.x&&(t.max.x=i),n<t.min.y?t.min.y=n:n>t.max.y&&(t.max.y=n),r<t.min.z?t.min.z=r:r>t.max.z&&(t.max.z=r)}(void 0===e||0===e.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0))},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var e=this.attributes.position.array;if(e){for(var t,i=0,n,r,o,a=0,s=e.length;s>a;a+=3)n=e[a],r=e[a+1],o=e[a+2],t=n*n+r*r+o*o,t>i&&(i=t);this.boundingSphere.radius=Math.sqrt(i)}},computeVertexNormals:function(){if(this.attributes.position){var e,t,i,n,r=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(r),numItems:r};else for(e=0,t=this.attributes.normal.array.length;t>e;e++)this.attributes.normal.array[e]=0;var o=this.attributes.position.array,a=this.attributes.normal.array,s,l,h,c,u,f,p=new THREE.Vector3,d=new THREE.Vector3,m=new THREE.Vector3,g=new THREE.Vector3,v=new THREE.Vector3;if(this.attributes.index){var E=this.attributes.index.array,y=this.offsets;for(i=0,n=y.length;n>i;++i){var T=y[i].start,x=y[i].count,b=y[i].index;for(e=T,t=T+x;t>e;e+=3)s=b+E[e],l=b+E[e+1],h=b+E[e+2],c=o[3*s],u=o[3*s+1],f=o[3*s+2],p.set(c,u,f),c=o[3*l],u=o[3*l+1],f=o[3*l+2],d.set(c,u,f),c=o[3*h],u=o[3*h+1],f=o[3*h+2],m.set(c,u,f),g.subVectors(m,d),v.subVectors(p,d),g.cross(v),a[3*s]+=g.x,a[3*s+1]+=g.y,a[3*s+2]+=g.z,a[3*l]+=g.x,a[3*l+1]+=g.y,a[3*l+2]+=g.z,a[3*h]+=g.x,a[3*h+1]+=g.y,a[3*h+2]+=g.z}}else for(e=0,t=o.length;t>e;e+=9)c=o[e],u=o[e+1],f=o[e+2],p.set(c,u,f),c=o[e+3],u=o[e+4],f=o[e+5],d.set(c,u,f),c=o[e+6],u=o[e+7],f=o[e+8],m.set(c,u,f),g.subVectors(m,d),v.subVectors(p,d),g.cross(v),a[e]=g.x,a[e+1]=g.y,a[e+2]=g.z,a[e+3]=g.x,a[e+4]=g.y,a[e+5]=g.z,a[e+6]=g.x,a[e+7]=g.y,a[e+8]=g.z;this.normalizeNormals(),this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var e=this.attributes.normal.array,t,i,n,r,o=0,a=e.length;a>o;o+=3)t=e[o],i=e[o+1],n=e[o+2],r=1/Math.sqrt(t*t+i*i+n*n),e[o]*=r,e[o+1]*=r,e[o+2]*=r},computeTangents:function(){function e(e,t,i){f=n[3*e],p=n[3*e+1],d=n[3*e+2],m=n[3*t],g=n[3*t+1],v=n[3*t+2],E=n[3*i],y=n[3*i+1],T=n[3*i+2],x=o[2*e],b=o[2*e+1],_=o[2*t],w=o[2*t+1],R=o[2*i],H=o[2*i+1],M=m-f,S=E-f,C=g-p,A=y-p,D=v-d,k=T-d,P=_-x,L=R-x,N=w-b,z=H-b,F=1/(P*z-L*N),I.set((z*M-N*S)*F,(z*C-N*A)*F,(z*D-N*k)*F),O.set((P*S-L*M)*F,(P*A-L*C)*F,(P*k-L*D)*F),h[e].add(I),h[t].add(I),h[i].add(I),c[e].add(O),c[t].add(O),c[i].add(O)}function t(e){et.x=r[3*e],et.y=r[3*e+1],et.z=r[3*e+2],tt.copy(et),nt=h[e],Z.copy(nt),Z.sub(et.multiplyScalar(et.dot(nt))).normalize(),J.crossVectors(tt,nt),rt=J.dot(c[e]),it=0>rt?-1:1,l[4*e]=Z.x,l[4*e+1]=Z.y,l[4*e+2]=Z.z,l[4*e+3]=it}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)return void console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");var i=this.attributes.index.array,n=this.attributes.position.array,r=this.attributes.normal.array,o=this.attributes.uv.array,a=n.length/3;if(void 0===this.attributes.tangent){var s=4*a;this.attributes.tangent={itemSize:4,array:new Float32Array(s),numItems:s}}for(var l=this.attributes.tangent.array,h=[],c=[],u=0;a>u;u++)h[u]=new THREE.Vector3,c[u]=new THREE.Vector3;var f,p,d,m,g,v,E,y,T,x,b,_,w,R,H,M,S,C,A,D,k,P,L,N,z,F,I=new THREE.Vector3,O=new THREE.Vector3,U,V,B,W,j,G,q,X=this.offsets;for(B=0,W=X.length;W>B;++B){var Y=X[B].start,K=X[B].count,Q=X[B].index;for(U=Y,V=Y+K;V>U;U+=3)j=Q+i[U],G=Q+i[U+1],q=Q+i[U+2],e(j,G,q)}var Z=new THREE.Vector3,J=new THREE.Vector3,et=new THREE.Vector3,tt=new THREE.Vector3,it,nt,rt;for(B=0,W=X.length;W>B;++B){var Y=X[B].start,K=X[B].count,Q=X[B].index;for(U=Y,V=Y+K;V>U;U+=3)j=Q+i[U],G=Q+i[U+1],q=Q+i[U+2],t(j),t(G),t(q)}this.hasTangents=!0,this.tangentsNeedUpdate=!0},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4,this.projectionMatrixInverse=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.lookAt=function(){var e=new THREE.Matrix4;return function(t){e.lookAt(this.position,t,this.up),this.useQuaternion===!0?this.quaternion.setFromRotationMatrix(e):this.rotation.setEulerFromRotationMatrix(e,this.eulerOrder)}}(),THREE.OrthographicCamera=function(e,t,i,n,r,o){THREE.Camera.call(this),this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.PerspectiveCamera=function(e,t,i,n){THREE.Camera.call(this),this.fov=void 0!==e?e:50,this.aspect=void 0!==t?t:1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24),this.fov=2*THREE.Math.radToDeg(Math.atan(t/(2*e))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(e,t,i,n,r,o){this.fullWidth=e,this.fullHeight=t,this.x=i,this.y=n,this.width=r,this.height=o,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var e=this.fullWidth/this.fullHeight,t=Math.tan(THREE.Math.degToRad(.5*this.fov))*this.near,i=-t,n=e*i,r=e*t,o=Math.abs(r-n),a=Math.abs(t-i);this.projectionMatrix.makeFrustum(n+this.x*o/this.fullWidth,n+(this.x+this.width)*o/this.fullWidth,t-(this.y+this.height)*a/this.fullHeight,t-this.y*a/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.Light=function(e){THREE.Object3D.call(this),this.color=new THREE.Color(e)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.clone=function(e){return void 0===e&&(e=new THREE.Light),THREE.Object3D.prototype.clone.call(this,e),e.color.copy(this.color),e},THREE.AmbientLight=function(e){THREE.Light.call(this,e)},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.clone=function(){var e=new THREE.AmbientLight;return THREE.Light.prototype.clone.call(this,e),e},THREE.AreaLight=function(e,t){THREE.Light.call(this,e),this.normal=new THREE.Vector3(0,-1,0),this.right=new THREE.Vector3(1,0,0),this.intensity=void 0!==t?t:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},THREE.AreaLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight=function(e,t){THREE.Light.call(this,e),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.clone=function(){var e=new THREE.DirectionalLight;return THREE.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e},THREE.HemisphereLight=function(e,t,i){THREE.Light.call(this,e),this.position.set(0,100,0),this.groundColor=new THREE.Color(t),this.intensity=void 0!==i?i:1},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.clone=function(){var e=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,e),e.groundColor.copy(this.groundColor),e.intensity=this.intensity,e},THREE.PointLight=function(e,t,i){THREE.Light.call(this,e),this.intensity=void 0!==t?t:1,this.distance=void 0!==i?i:0},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.clone=function(){var e=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,e),e.intensity=this.intensity,e.distance=this.distance,e},THREE.SpotLight=function(e,t,i,n,r){THREE.Light.call(this,e),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.exponent=void 0!==r?r:10,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.clone=function(){var e=new THREE.SpotLight;return THREE.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.distance=this.distance,e.angle=this.angle,e.exponent=this.exponent,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e},THREE.Loader=function(e){this.showStatus=e,this.statusDomElement=e?THREE.Loader.prototype.addStatusElement():null,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.right="0px",e.style.top="0px",e.style.fontSize="0.8em",e.style.textAlign="left",e.style.background="rgba(0,0,0,0.25)",e.style.color="#fff",e.style.width="120px",e.style.padding="0.5em 0.5em 0.5em 0.5em",e.style.zIndex=1e3,e.innerHTML="Loading ...",e},updateProgress:function(e){var t="Loaded ";t+=e.total?(100*e.loaded/e.total).toFixed(0)+"%":(e.loaded/1e3).toFixed(2)+" KB",this.statusDomElement.innerHTML=t},extractUrlBase:function(e){var t=e.split("/");return t.pop(),(t.length<1?".":t.join("/"))+"/"},initMaterials:function(e,t){for(var i=[],n=0;n<e.length;++n)i[n]=THREE.Loader.prototype.createMaterial(e[n],t);return i},needsTangents:function(e){for(var t=0,i=e.length;i>t;t++){var n=e[t];if(n instanceof THREE.ShaderMaterial)return!0}return!1},createMaterial:function(e,t){function i(e){var t=Math.log(e)/Math.LN2;return Math.floor(t)==t}function n(e){var t=Math.log(e)/Math.LN2;return Math.pow(2,Math.round(t))}function r(e,t){var r=new Image;r.onload=function(){if(i(this.width)&&i(this.height))e.image=this;else{var t=n(this.width),r=n(this.height);e.image.width=t,e.image.height=r,e.image.getContext("2d").drawImage(this,0,0,t,r)}e.needsUpdate=!0},r.crossOrigin=s.crossOrigin,r.src=t}function o(e,i,n,o,a,s,l){var h=/\.dds$/i.test(n),c=t+"/"+n;if(h){var u=THREE.ImageUtils.loadCompressedTexture(c);e[i]=u}else{var u=document.createElement("canvas");e[i]=new THREE.Texture(u)}if(e[i].sourceFile=n,o&&(e[i].repeat.set(o[0],o[1]),1!==o[0]&&(e[i].wrapS=THREE.RepeatWrapping),1!==o[1]&&(e[i].wrapT=THREE.RepeatWrapping)),a&&e[i].offset.set(a[0],a[1]),s){var f={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};void 0!==f[s[0]]&&(e[i].wrapS=f[s[0]]),void 0!==f[s[1]]&&(e[i].wrapT=f[s[1]])}l&&(e[i].anisotropy=l),h||r(e[i],c)}function a(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var s=this,l="MeshLambertMaterial",h={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(e.shading){var c=e.shading.toLowerCase();"phong"===c?l="MeshPhongMaterial":"basic"===c&&(l="MeshBasicMaterial")}if(void 0!==e.blending&&void 0!==THREE[e.blending]&&(h.blending=THREE[e.blending]),(void 0!==e.transparent||e.opacity<1)&&(h.transparent=e.transparent),void 0!==e.depthTest&&(h.depthTest=e.depthTest),void 0!==e.depthWrite&&(h.depthWrite=e.depthWrite),void 0!==e.visible&&(h.visible=e.visible),void 0!==e.flipSided&&(h.side=THREE.BackSide),void 0!==e.doubleSided&&(h.side=THREE.DoubleSide),void 0!==e.wireframe&&(h.wireframe=e.wireframe),void 0!==e.vertexColors&&("face"===e.vertexColors?h.vertexColors=THREE.FaceColors:e.vertexColors&&(h.vertexColors=THREE.VertexColors)),e.colorDiffuse?h.color=a(e.colorDiffuse):e.DbgColor&&(h.color=e.DbgColor),e.colorSpecular&&(h.specular=a(e.colorSpecular)),e.colorAmbient&&(h.ambient=a(e.colorAmbient)),e.transparency&&(h.opacity=e.transparency),e.specularCoef&&(h.shininess=e.specularCoef),e.mapDiffuse&&t&&o(h,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy),e.mapLight&&t&&o(h,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy),e.mapBump&&t&&o(h,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy),e.mapNormal&&t&&o(h,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy),e.mapSpecular&&t&&o(h,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy),e.mapBumpScale&&(h.bumpScale=e.mapBumpScale),e.mapNormal){var u=THREE.ShaderLib.normalmap,f=THREE.UniformsUtils.clone(u.uniforms);f.tNormal.value=h.normalMap,e.mapNormalFactor&&f.uNormalScale.value.set(e.mapNormalFactor,e.mapNormalFactor),h.map&&(f.tDiffuse.value=h.map,f.enableDiffuse.value=!0),h.specularMap&&(f.tSpecular.value=h.specularMap,f.enableSpecular.value=!0),h.lightMap&&(f.tAO.value=h.lightMap,f.enableAO.value=!0),f.uDiffuseColor.value.setHex(h.color),f.uSpecularColor.value.setHex(h.specular),f.uAmbientColor.value.setHex(h.ambient),f.uShininess.value=h.shininess,void 0!==h.opacity&&(f.uOpacity.value=h.opacity);var p={fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:f,lights:!0,fog:!0},d=new THREE.ShaderMaterial(p);h.transparent&&(d.transparent=!0)}else var d=new THREE[l](h);return void 0!==e.DbgName&&(d.name=e.DbgName),d}},THREE.ImageLoader=function(){this.crossOrigin=null},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(e,t){var i=this;void 0===t&&(t=new Image),t.addEventListener("load",function(){i.dispatchEvent({type:"load",content:t})},!1),t.addEventListener("error",function(){i.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},!1),i.crossOrigin&&(t.crossOrigin=i.crossOrigin),t.src=e}},THREE.JSONLoader=function(e){THREE.Loader.call(this,e),this.withCredentials=!1},THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype),THREE.JSONLoader.prototype.load=function(e,t,i){var n=this;i=i&&"string"==typeof i?i:this.extractUrlBase(e),this.onLoadStart(),this.loadAjaxJSON(this,e,t,i)},THREE.JSONLoader.prototype.loadAjaxJSON=function(e,t,i,n,r){var o=new XMLHttpRequest,a=0;o.onreadystatechange=function(){if(o.readyState===o.DONE)if(200===o.status||0===o.status){if(o.responseText){var s=JSON.parse(o.responseText),l=e.parse(s,n);i(l.geometry,l.materials)}else console.warn("THREE.JSONLoader: ["+t+"] seems to be unreachable or file there is empty");e.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+t+"] ["+o.status+"]");else o.readyState===o.LOADING?r&&(0===a&&(a=o.getResponseHeader("Content-Length")),r({total:a,loaded:o.responseText.length})):o.readyState===o.HEADERS_RECEIVED&&void 0!==r&&(a=o.getResponseHeader("Content-Length"))},o.open("GET",t,!0),o.withCredentials=this.withCredentials,o.send(null)},THREE.JSONLoader.prototype.parse=function(e,t){function i(t){function i(e,t){return e&1<<t}var n,r,o,s,l,h,c,u,f,p,d,m,g,v,E,y,T,x,b,_,w,R,H,M,S,C,A,D=e.faces,k=e.vertices,P=e.normals,L=e.colors,N=0;for(n=0;n<e.uvs.length;n++)e.uvs[n].length&&N++;for(n=0;N>n;n++)a.faceUvs[n]=[],a.faceVertexUvs[n]=[];for(s=0,l=k.length;l>s;)_=new THREE.Vector3,_.x=k[s++]*t,_.y=k[s++]*t,_.z=k[s++]*t,a.vertices.push(_);for(s=0,l=D.length;l>s;){if(d=D[s++],m=i(d,0),g=i(d,1),v=i(d,2),E=i(d,3),y=i(d,4),T=i(d,5),x=i(d,6),b=i(d,7),m?(w=new THREE.Face4,w.a=D[s++],w.b=D[s++],w.c=D[s++],w.d=D[s++],h=4):(w=new THREE.Face3,w.a=D[s++],w.b=D[s++],w.c=D[s++],h=3),g&&(p=D[s++],w.materialIndex=p),o=a.faces.length,v)for(n=0;N>n;n++)M=e.uvs[n],f=D[s++],C=M[2*f],A=M[2*f+1],a.faceUvs[n][o]=new THREE.Vector2(C,A);if(E)for(n=0;N>n;n++){for(M=e.uvs[n],S=[],r=0;h>r;r++)f=D[s++],C=M[2*f],A=M[2*f+1],S[r]=new THREE.Vector2(C,A);a.faceVertexUvs[n][o]=S}if(y&&(u=3*D[s++],H=new THREE.Vector3,H.x=P[u++],H.y=P[u++],H.z=P[u],w.normal=H),T)for(n=0;h>n;n++)u=3*D[s++],H=new THREE.Vector3,H.x=P[u++],H.y=P[u++],H.z=P[u],w.vertexNormals.push(H);if(x&&(c=D[s++],R=new THREE.Color(L[c]),w.color=R),b)for(n=0;h>n;n++)c=D[s++],R=new THREE.Color(L[c]),w.vertexColors.push(R);a.faces.push(w)}}function n(){var t,i,n,r,o,s,l,h,c,u;if(e.skinWeights)for(t=0,i=e.skinWeights.length;i>t;t+=2)n=e.skinWeights[t],r=e.skinWeights[t+1],o=0,s=0,a.skinWeights.push(new THREE.Vector4(n,r,o,s));if(e.skinIndices)for(t=0,i=e.skinIndices.length;i>t;t+=2)l=e.skinIndices[t],h=e.skinIndices[t+1],c=0,u=0,a.skinIndices.push(new THREE.Vector4(l,h,c,u));a.bones=e.bones,a.animation=e.animation}function r(t){if(void 0!==e.morphTargets){var i,n,r,o,s,l;for(i=0,n=e.morphTargets.length;n>i;i++)for(a.morphTargets[i]={},a.morphTargets[i].name=e.morphTargets[i].name,a.morphTargets[i].vertices=[],s=a.morphTargets[i].vertices,l=e.morphTargets[i].vertices,r=0,o=l.length;o>r;r+=3){var h=new THREE.Vector3;h.x=l[r]*t,h.y=l[r+1]*t,h.z=l[r+2]*t,s.push(h)}}if(void 0!==e.morphColors){var i,n,c,u,f,p,d;for(i=0,n=e.morphColors.length;n>i;i++)for(a.morphColors[i]={},a.morphColors[i].name=e.morphColors[i].name,a.morphColors[i].colors=[],f=a.morphColors[i].colors,p=e.morphColors[i].colors,c=0,u=p.length;u>c;c+=3)d=new THREE.Color(16755200),d.setRGB(p[c],p[c+1],p[c+2]),f.push(d)}}var o=this,a=new THREE.Geometry,s=void 0!==e.scale?1/e.scale:1;if(i(s),n(),r(s),a.computeCentroids(),a.computeFaceNormals(),void 0===e.materials)return{geometry:a};var l=this.initMaterials(e.materials,t);return this.needsTangents(l)&&a.computeTangents(),{geometry:a,materials:l}},THREE.LoadingMonitor=function(){var e=this,t=0,i=0,n=function(n){t++,e.dispatchEvent({type:"progress",loaded:t,total:i}),t===i&&e.dispatchEvent({type:"load"})};this.add=function(e){i++,e.addEventListener("load",n,!1)}},THREE.LoadingMonitor.prototype={constructor:THREE.LoadingMonitor,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent},THREE.GeometryLoader=function(){},THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(e){var t=this,i=new XMLHttpRequest;i.addEventListener("load",function(e){var i=t.parse(JSON.parse(e.target.responseText));t.dispatchEvent({type:"load",content:i})},!1),i.addEventListener("progress",function(e){t.dispatchEvent({type:"progress",loaded:e.loaded,total:e.total})},!1),i.addEventListener("error",function(){t.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},!1),i.open("GET",e,!0),i.send(null)},parse:function(e){}},THREE.MaterialLoader=function(){},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(e){var t=this,i=new XMLHttpRequest;
i.addEventListener("load",function(e){var i=t.parse(JSON.parse(e.target.responseText));t.dispatchEvent({type:"load",content:i})},!1),i.addEventListener("progress",function(e){t.dispatchEvent({type:"progress",loaded:e.loaded,total:e.total})},!1),i.addEventListener("error",function(){t.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},!1),i.open("GET",e,!0),i.send(null)},parse:function(e){var t;switch(e.type){case"MeshBasicMaterial":t=new THREE.MeshBasicMaterial({color:e.color,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshLambertMaterial":t=new THREE.MeshLambertMaterial({color:e.color,ambient:e.ambient,emissive:e.emissive,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshPhongMaterial":t=new THREE.MeshPhongMaterial({color:e.color,ambient:e.ambient,emissive:e.emissive,specular:e.specular,shininess:e.shininess,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshNormalMaterial":t=new THREE.MeshNormalMaterial({opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshDepthMaterial":t=new THREE.MeshDepthMaterial({opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe})}return t}},THREE.SceneLoader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){},this.callbackSync=function(){},this.callbackProgress=function(){},this.geometryHandlerMap={},this.hierarchyHandlerMap={},this.addGeometryHandler("ascii",THREE.JSONLoader)},THREE.SceneLoader.prototype.constructor=THREE.SceneLoader,THREE.SceneLoader.prototype.load=function(e,t){var i=this,n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status||0===n.status){var r=JSON.parse(n.responseText);i.parse(r,t,e)}else console.error("THREE.SceneLoader: Couldn't load ["+e+"] ["+n.status+"]")},n.open("GET",e,!0),n.send(null)},THREE.SceneLoader.prototype.addGeometryHandler=function(e,t){this.geometryHandlerMap[e]={loaderClass:t}},THREE.SceneLoader.prototype.addHierarchyHandler=function(e,t){this.hierarchyHandlerMap[e]={loaderClass:t}},THREE.SceneLoader.prototype.parse=function(e,t,i){function n(e,t){return"relativeToHTML"==t?e:d+"/"+e}function r(){o(C.scene,D.objects)}function o(e,t){var i,r,a,s,l,c;for(var u in t)if(void 0===C.objects[u]){var f=t[u],d=null;if(f.type&&f.type in p.hierarchyHandlerMap){if(void 0===f.loading){var E={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1},y={};for(var T in f)T in E||(y[T]=f[T]);g=C.materials[f.material],f.loading=!0;var x=p.hierarchyHandlerMap[f.type].loaderObject;x.options?x.load(n(f.url,D.urlBaseType),h(u,e,g,f)):x.load(n(f.url,D.urlBaseType),h(u,e,g,f),y)}}else if(void 0!==f.geometry){if(m=C.geometries[f.geometry]){var R=!1;if(g=C.materials[f.material],R=g instanceof THREE.ShaderMaterial,a=f.position,s=f.rotation,l=f.scale,i=f.matrix,c=f.quaternion,f.material||(g=new THREE.MeshFaceMaterial(C.face_materials[f.geometry])),g instanceof THREE.MeshFaceMaterial&&0===g.materials.length&&(g=new THREE.MeshFaceMaterial(C.face_materials[f.geometry])),g instanceof THREE.MeshFaceMaterial)for(var H=0;H<g.materials.length;H++)R=R||g.materials[H]instanceof THREE.ShaderMaterial;R&&m.computeTangents(),f.skin?d=new THREE.SkinnedMesh(m,g):f.morph?(d=new THREE.MorphAnimMesh(m,g),void 0!==f.duration&&(d.duration=f.duration),void 0!==f.time&&(d.time=f.time),void 0!==f.mirroredLoop&&(d.mirroredLoop=f.mirroredLoop),g.morphNormals&&m.computeMorphNormals()):d=new THREE.Mesh(m,g),d.name=u,i?(d.matrixAutoUpdate=!1,d.matrix.set(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])):(d.position.set(a[0],a[1],a[2]),c?(d.quaternion.set(c[0],c[1],c[2],c[3]),d.useQuaternion=!0):d.rotation.set(s[0],s[1],s[2]),d.scale.set(l[0],l[1],l[2])),d.visible=f.visible,d.castShadow=f.castShadow,d.receiveShadow=f.receiveShadow,e.add(d),C.objects[u]=d}}else"DirectionalLight"===f.type||"PointLight"===f.type||"AmbientLight"===f.type?(_=void 0!==f.color?f.color:16777215,w=void 0!==f.intensity?f.intensity:1,"DirectionalLight"===f.type?(a=f.direction,b=new THREE.DirectionalLight(_,w),b.position.set(a[0],a[1],a[2]),f.target&&(A.push({object:b,targetName:f.target}),b.target=null)):"PointLight"===f.type?(a=f.position,r=f.distance,b=new THREE.PointLight(_,w,r),b.position.set(a[0],a[1],a[2])):"AmbientLight"===f.type&&(b=new THREE.AmbientLight(_)),e.add(b),b.name=u,C.lights[u]=b,C.objects[u]=b):"PerspectiveCamera"===f.type||"OrthographicCamera"===f.type?(a=f.position,s=f.rotation,c=f.quaternion,"PerspectiveCamera"===f.type?v=new THREE.PerspectiveCamera(f.fov,f.aspect,f.near,f.far):"OrthographicCamera"===f.type&&(v=new THREE.OrthographicCamera(f.left,f.right,f.top,f.bottom,f.near,f.far)),v.name=u,v.position.set(a[0],a[1],a[2]),void 0!==c?(v.quaternion.set(c[0],c[1],c[2],c[3]),v.useQuaternion=!0):void 0!==s&&v.rotation.set(s[0],s[1],s[2]),e.add(v),C.cameras[u]=v,C.objects[u]=v):(a=f.position,s=f.rotation,l=f.scale,c=f.quaternion,d=new THREE.Object3D,d.name=u,d.position.set(a[0],a[1],a[2]),c?(d.quaternion.set(c[0],c[1],c[2],c[3]),d.useQuaternion=!0):d.rotation.set(s[0],s[1],s[2]),d.scale.set(l[0],l[1],l[2]),d.visible=void 0!==f.visible?f.visible:!1,e.add(d),C.objects[u]=d,C.empties[u]=d);if(d){if(void 0!==f.userData)for(var M in f.userData){var S=f.userData[M];d.userData[M]=S}if(void 0!==f.groups)for(var H=0;H<f.groups.length;H++){var k=f.groups[H];void 0===C.groups[k]&&(C.groups[k]=[]),C.groups[k].push(u)}void 0!==f.children&&o(d,f.children)}}}function a(e,t,i){C.geometries[i]=e,C.face_materials[i]=t,r()}function s(e,t,i,n,o){var a=o.position,s=o.rotation,l=o.quaternion,h=o.scale;e.position.set(a[0],a[1],a[2]),l?(e.quaternion.set(l[0],l[1],l[2],l[3]),e.useQuaternion=!0):e.rotation.set(s[0],s[1],s[2]),e.scale.set(h[0],h[1],h[2]),n&&e.traverse(function(e){e.material=n});var c=void 0!==o.visible?o.visible:!0;e.traverse(function(e){e.visible=c}),i.add(e),e.name=t,C.objects[t]=e,r()}function l(e){return function(t,i){t.name=e,a(t,i,e),R-=1,p.onLoadComplete(),u()}}function h(e,t,i,n){return function(r){var o;o=r.content?r.content:r.dae?r.scene:r,s(o,e,t,i,n),R-=1,p.onLoadComplete(),u()}}function c(e){return function(t,i){t.name=e,C.geometries[e]=t,C.face_materials[e]=i}}function u(){var e={totalModels:M,totalTextures:S,loadedModels:M-R,loadedTextures:S-H};p.callbackProgress(e,C),p.onLoadProgress(),0===R&&0===H&&(f(),t(C))}function f(){for(var e=0;e<A.length;e++){var t=A[e],i=C.objects[t.targetName];i?t.object.target=i:(t.object.target=new THREE.Object3D,C.scene.add(t.object.target)),t.object.target.userData.targetInverse=t.object}}var p=this,d=THREE.Loader.prototype.extractUrlBase(i),m,g,v,E,y,T,x,b,_,w,R,H,M,S,C,A=[],D=e;for(var k in this.geometryHandlerMap){var P=this.geometryHandlerMap[k].loaderClass;this.geometryHandlerMap[k].loaderObject=new P}for(var k in this.hierarchyHandlerMap){var P=this.hierarchyHandlerMap[k].loaderClass;this.hierarchyHandlerMap[k].loaderObject=new P}if(R=0,H=0,C={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}},D.transform){var L=D.transform.position,N=D.transform.rotation,z=D.transform.scale;L&&C.scene.position.set(L[0],L[1],L[2]),N&&C.scene.rotation.set(N[0],N[1],N[2]),z&&C.scene.scale.set(z[0],z[1],z[2]),(L||N||z)&&(C.scene.updateMatrix(),C.scene.updateMatrixWorld())}var F=function(e){H-=e,u(),p.onLoadComplete()},I=function(e){return function(){F(e)}},O,U;for(O in D.fogs)U=D.fogs[O],"linear"===U.type?E=new THREE.Fog(0,U.near,U.far):"exp2"===U.type&&(E=new THREE.FogExp2(0,U.density)),x=U.color,E.color.setRGB(x[0],x[1],x[2]),C.fogs[O]=E;var V,B;for(V in D.geometries)B=D.geometries[V],B.type in this.geometryHandlerMap&&(R+=1,p.onLoadStart());var W,j;for(W in D.objects)j=D.objects[W],j.type&&j.type in this.hierarchyHandlerMap&&(R+=1,p.onLoadStart());M=R;for(V in D.geometries)if(B=D.geometries[V],"cube"===B.type)m=new THREE.CubeGeometry(B.width,B.height,B.depth,B.widthSegments,B.heightSegments,B.depthSegments),m.name=V,C.geometries[V]=m;else if("plane"===B.type)m=new THREE.PlaneGeometry(B.width,B.height,B.widthSegments,B.heightSegments),m.name=V,C.geometries[V]=m;else if("sphere"===B.type)m=new THREE.SphereGeometry(B.radius,B.widthSegments,B.heightSegments),m.name=V,C.geometries[V]=m;else if("cylinder"===B.type)m=new THREE.CylinderGeometry(B.topRad,B.botRad,B.height,B.radSegs,B.heightSegs),m.name=V,C.geometries[V]=m;else if("torus"===B.type)m=new THREE.TorusGeometry(B.radius,B.tube,B.segmentsR,B.segmentsT),m.name=V,C.geometries[V]=m;else if("icosahedron"===B.type)m=new THREE.IcosahedronGeometry(B.radius,B.subdivisions),m.name=V,C.geometries[V]=m;else if(B.type in this.geometryHandlerMap){var G={};for(var q in B)"type"!==q&&"url"!==q&&(G[q]=B[q]);var X=this.geometryHandlerMap[B.type].loaderObject;X.load(n(B.url,D.urlBaseType),l(V),G)}else if("embedded"===B.type){var Y=D.embeds[B.id],K="";if(Y.metadata=D.metadata,Y){var Q=this.geometryHandlerMap.ascii.loaderObject,Z=Q.parse(Y,K);c(V)(Z.geometry,Z.materials)}}var J,et;for(J in D.textures)if(et=D.textures[J],et.url instanceof Array){H+=et.url.length;for(var tt=0;tt<et.url.length;tt++)p.onLoadStart()}else H+=1,p.onLoadStart();S=H;for(J in D.textures){if(et=D.textures[J],void 0!==et.mapping&&void 0!==THREE[et.mapping]&&(et.mapping=new THREE[et.mapping]),et.url instanceof Array){for(var it=et.url.length,nt=[],rt=0;it>rt;rt++)nt[rt]=n(et.url[rt],D.urlBaseType);var ot=/\.dds$/i.test(nt[0]);y=ot?THREE.ImageUtils.loadCompressedTextureCube(nt,et.mapping,I(it)):THREE.ImageUtils.loadTextureCube(nt,et.mapping,I(it))}else{var ot=/\.dds$/i.test(et.url),at=n(et.url,D.urlBaseType),st=I(1);if(y=ot?THREE.ImageUtils.loadCompressedTexture(at,et.mapping,st):THREE.ImageUtils.loadTexture(at,et.mapping,st),void 0!==THREE[et.minFilter]&&(y.minFilter=THREE[et.minFilter]),void 0!==THREE[et.magFilter]&&(y.magFilter=THREE[et.magFilter]),et.anisotropy&&(y.anisotropy=et.anisotropy),et.repeat&&(y.repeat.set(et.repeat[0],et.repeat[1]),1!==et.repeat[0]&&(y.wrapS=THREE.RepeatWrapping),1!==et.repeat[1]&&(y.wrapT=THREE.RepeatWrapping)),et.offset&&y.offset.set(et.offset[0],et.offset[1]),et.wrap){var lt={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};void 0!==lt[et.wrap[0]]&&(y.wrapS=lt[et.wrap[0]]),void 0!==lt[et.wrap[1]]&&(y.wrapT=lt[et.wrap[1]])}}C.textures[J]=y}var ht,ct,ut;for(ht in D.materials){ct=D.materials[ht];for(ut in ct.parameters)if("envMap"===ut||"map"===ut||"lightMap"===ut||"bumpMap"===ut)ct.parameters[ut]=C.textures[ct.parameters[ut]];else if("shading"===ut)ct.parameters[ut]="flat"===ct.parameters[ut]?THREE.FlatShading:THREE.SmoothShading;else if("side"===ut)ct.parameters[ut]="double"==ct.parameters[ut]?THREE.DoubleSide:"back"==ct.parameters[ut]?THREE.BackSide:THREE.FrontSide;else if("blending"===ut)ct.parameters[ut]=ct.parameters[ut]in THREE?THREE[ct.parameters[ut]]:THREE.NormalBlending;else if("combine"===ut)ct.parameters[ut]=ct.parameters[ut]in THREE?THREE[ct.parameters[ut]]:THREE.MultiplyOperation;else if("vertexColors"===ut)"face"==ct.parameters[ut]?ct.parameters[ut]=THREE.FaceColors:ct.parameters[ut]&&(ct.parameters[ut]=THREE.VertexColors);else if("wrapRGB"===ut){var ft=ct.parameters[ut];ct.parameters[ut]=new THREE.Vector3(ft[0],ft[1],ft[2])}if(void 0!==ct.parameters.opacity&&ct.parameters.opacity<1&&(ct.parameters.transparent=!0),ct.parameters.normalMap){var pt=THREE.ShaderLib.normalmap,dt=THREE.UniformsUtils.clone(pt.uniforms),mt=ct.parameters.color,gt=ct.parameters.specular,vt=ct.parameters.ambient,Et=ct.parameters.shininess;dt.tNormal.value=C.textures[ct.parameters.normalMap],ct.parameters.normalScale&&dt.uNormalScale.value.set(ct.parameters.normalScale[0],ct.parameters.normalScale[1]),ct.parameters.map&&(dt.tDiffuse.value=ct.parameters.map,dt.enableDiffuse.value=!0),ct.parameters.envMap&&(dt.tCube.value=ct.parameters.envMap,dt.enableReflection.value=!0,dt.uReflectivity.value=ct.parameters.reflectivity),ct.parameters.lightMap&&(dt.tAO.value=ct.parameters.lightMap,dt.enableAO.value=!0),ct.parameters.specularMap&&(dt.tSpecular.value=C.textures[ct.parameters.specularMap],dt.enableSpecular.value=!0),ct.parameters.displacementMap&&(dt.tDisplacement.value=C.textures[ct.parameters.displacementMap],dt.enableDisplacement.value=!0,dt.uDisplacementBias.value=ct.parameters.displacementBias,dt.uDisplacementScale.value=ct.parameters.displacementScale),dt.uDiffuseColor.value.setHex(mt),dt.uSpecularColor.value.setHex(gt),dt.uAmbientColor.value.setHex(vt),dt.uShininess.value=Et,ct.parameters.opacity&&(dt.uOpacity.value=ct.parameters.opacity);var yt={fragmentShader:pt.fragmentShader,vertexShader:pt.vertexShader,uniforms:dt,lights:!0,fog:!0};g=new THREE.ShaderMaterial(yt)}else g=new THREE[ct.type](ct.parameters);g.name=ht,C.materials[ht]=g}for(ht in D.materials)if(ct=D.materials[ht],ct.parameters.materials){for(var Tt=[],rt=0;rt<ct.parameters.materials.length;rt++){var xt=ct.parameters.materials[rt];Tt.push(C.materials[xt])}C.materials[ht].materials=Tt}r(),C.cameras&&D.defaults.camera&&(C.currentCamera=C.cameras[D.defaults.camera]),C.fogs&&D.defaults.fog&&(C.scene.fog=C.fogs[D.defaults.fog]),p.callbackSync(C),u()},THREE.TextureLoader=function(){this.crossOrigin=null},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(e){var t=this,i=new Image;i.addEventListener("load",function(){var e=new THREE.Texture(i);e.needsUpdate=!0,t.dispatchEvent({type:"load",content:e})},!1),i.addEventListener("error",function(){t.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},!1),t.crossOrigin&&(i.crossOrigin=t.crossOrigin),i.src=e}},THREE.Material=function(){this.id=THREE.MaterialIdCount++,this.name="",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=!1,this.visible=!0,this.needsUpdate=!0},THREE.Material.prototype={constructor:THREE.Material,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,setValues:function(e){if(void 0!==e)for(var t in e){var i=e[t];if(void 0!==i){if(t in this){var n=this[t];n instanceof THREE.Color?n.set(i):n instanceof THREE.Vector3&&i instanceof THREE.Vector3?n.copy(i):this[t]=i}}else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},clone:function(e){return void 0===e&&(e=new THREE.Material),e.name=this.name,e.side=this.side,e.opacity=this.opacity,e.transparent=this.transparent,e.blending=this.blending,e.blendSrc=this.blendSrc,e.blendDst=this.blendDst,e.blendEquation=this.blendEquation,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.polygonOffset=this.polygonOffset,e.polygonOffsetFactor=this.polygonOffsetFactor,e.polygonOffsetUnits=this.polygonOffsetUnits,e.alphaTest=this.alphaTest,e.overdraw=this.overdraw,e.visible=this.visible,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.clone=function(){var e=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.linecap=this.linecap,e.linejoin=this.linejoin,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.LineDashedMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.clone=function(){var e=new THREE.LineDashedMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.scale=this.scale,e.dashSize=this.dashSize,e.gapSize=this.gapSize,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.MeshBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(e)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.clone=function(){var e=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e},THREE.MeshLambertMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.clone=function(){var e=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.ambient.copy(this.ambient),e.emissive.copy(this.emissive),e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.MeshPhongMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.perPixel=!0,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.specularMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.clone=function(){var e=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.ambient.copy(this.ambient),e.emissive.copy(this.emissive),e.specular.copy(this.specular),e.shininess=this.shininess,e.metal=this.metal,e.perPixel=this.perPixel,e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.bumpMap=this.bumpMap,e.bumpScale=this.bumpScale,e.normalMap=this.normalMap,e.normalScale.copy(this.normalScale),e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.MeshDepthMaterial=function(e){THREE.Material.call(this),this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.clone=function(){var e=new THREE.MeshDepthMaterial;return THREE.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},THREE.MeshNormalMaterial=function(e){THREE.Material.call(this,e),this.shading=THREE.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(e)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.clone=function(){var e=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,e),e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},THREE.MeshFaceMaterial=function(e){this.materials=e instanceof Array?e:[]},THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))},THREE.ParticleBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleBasicMaterial.prototype.clone=function(){var e=new THREE.ParticleBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.ParticleCanvasMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.program=function(e,t){},this.setValues(e)},THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleCanvasMaterial.prototype.clone=function(){var e=new THREE.ParticleCanvasMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.program=this.program,e},THREE.ShaderMaterial=function(e){THREE.Material.call(this),this.fragmentShader="void main() {}",this.vertexShader="void main() {}",this.uniforms={},this.defines={},this.attributes=null,this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.clone=function(){var e=new THREE.ShaderMaterial;return THREE.Material.prototype.clone.call(this,e),e.fragmentShader=this.fragmentShader,e.vertexShader=this.vertexShader,e.uniforms=THREE.UniformsUtils.clone(this.uniforms),e.attributes=this.attributes,e.defines=this.defines,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.fog=this.fog,e.lights=this.lights,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.SpriteMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=new THREE.Texture,this.useScreenCoordinates=!0,this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.scaleByViewport=!this.sizeAttenuation,this.alignment=THREE.SpriteAlignment.center.clone(),this.fog=!1,this.uvOffset=new THREE.Vector2(0,0),this.uvScale=new THREE.Vector2(1,1),this.setValues(e),e=e||{},void 0===e.depthTest&&(this.depthTest=!this.useScreenCoordinates),void 0===e.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates),void 0===e.scaleByViewport&&(this.scaleByViewport=!this.sizeAttenuation)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.clone=function(){var e=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.useScreenCoordinates=this.useScreenCoordinates,e.sizeAttenuation=this.sizeAttenuation,e.scaleByViewport=this.scaleByViewport,e.alignment.copy(this.alignment),e.uvOffset.copy(this.uvOffset),e.uvScale.copy(this.uvScale),e.fog=this.fog,e},THREE.SpriteAlignment={},THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1),THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1),THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1),THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0),THREE.SpriteAlignment.center=new THREE.Vector2(0,0),THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0),THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1),THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1),THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1),THREE.Texture=function(e,t,i,n,r,o,a,s,l){this.id=THREE.TextureIdCount++,this.name="",this.image=e,this.mipmaps=[],this.mapping=void 0!==t?t:new THREE.UVMapping,this.wrapS=void 0!==i?i:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==n?n:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==r?r:THREE.LinearFilter,this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:THREE.RGBAFormat,this.type=void 0!==s?s:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.needsUpdate=!1,this.onUpdate=null},THREE.Texture.prototype={constructor:THREE.Texture,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(e){return void 0===e&&(e=new THREE.Texture),e.image=this.image,e.mipmaps=this.mipmaps.slice(0),e.mapping=this.mapping,e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.format=this.format,e.type=this.type,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.generateMipmaps=this.generateMipmaps,e.premultiplyAlpha=this.premultiplyAlpha,e.flipY=this.flipY,e.unpackAlignment=this.unpackAlignment,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.TextureIdCount=0,THREE.CompressedTexture=function(e,t,i,n,r,o,a,s,l,h,c){THREE.Texture.call(this,null,o,a,s,l,h,n,r,c),this.image={width:t,height:i},this.mipmaps=e,this.generateMipmaps=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.clone=function(){var e=new THREE.CompressedTexture;return THREE.Texture.prototype.clone.call(this,e),e},THREE.DataTexture=function(e,t,i,n,r,o,a,s,l,h,c){THREE.Texture.call(this,null,o,a,s,l,h,n,r,c),this.image={data:e,width:t,height:i}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.clone=function(){var e=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,e),e},THREE.Particle=function(e){THREE.Object3D.call(this),this.material=e},THREE.Particle.prototype=Object.create(THREE.Object3D.prototype),THREE.Particle.prototype.clone=function(e){return void 0===e&&(e=new THREE.Particle(this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.ParticleSystem=function(e,t){THREE.Object3D.call(this),this.geometry=e,this.material=void 0!==t?t:new THREE.ParticleBasicMaterial({color:16777215*Math.random()}),this.sortParticles=!1,this.geometry&&null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.frustumCulled=!1},THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype),THREE.ParticleSystem.prototype.clone=function(e){return void 0===e&&(e=new THREE.ParticleSystem(this.geometry,this.material)),e.sortParticles=this.sortParticles,THREE.Object3D.prototype.clone.call(this,e),e},THREE.Line=function(e,t,i){THREE.Object3D.call(this),this.geometry=e,this.material=void 0!==t?t:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==i?i:THREE.LineStrip,this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.clone=function(e){return void 0===e&&(e=new THREE.Line(this.geometry,this.material,this.type)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Mesh=function(e,t){THREE.Object3D.call(this),this.geometry=null,this.material=null,this.setGeometry(e),this.setMaterial(t)},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.setGeometry=function(e){void 0!==e&&(this.geometry=e,null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.updateMorphTargets())},THREE.Mesh.prototype.setMaterial=function(e){this.material=void 0!==e?e:new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0})},THREE.Mesh.prototype.updateMorphTargets=function(){if(this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;t>e;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Bone=function(e){THREE.Object3D.call(this),this.skin=e,this.skinMatrix=new THREE.Matrix4},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.update=function(e,t){this.matrixAutoUpdate&&(t|=this.updateMatrix()),(t||this.matrixWorldNeedsUpdate)&&(e?this.skinMatrix.multiplyMatrices(e,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);var i,n,r=this.children.length;for(n=0;r>n;n++)this.children[n].update(this.skinMatrix,t)},THREE.SkinnedMesh=function(e,t,i){THREE.Mesh.call(this,e,t),this.useVertexTexture=void 0!==i?i:!0,this.identityMatrix=new THREE.Matrix4,this.bones=[],this.boneMatrices=[];var n,r,o,a,s,l;if(this.geometry&&void 0!==this.geometry.bones){for(n=0;n<this.geometry.bones.length;n++)o=this.geometry.bones[n],a=o.pos,s=o.rotq,l=o.scl,r=this.addBone(),r.name=o.name,r.position.set(a[0],a[1],a[2]),r.quaternion.set(s[0],s[1],s[2],s[3]),r.useQuaternion=!0,void 0!==l?r.scale.set(l[0],l[1],l[2]):r.scale.set(1,1,1);
for(n=0;n<this.bones.length;n++)o=this.geometry.bones[n],r=this.bones[n],-1===o.parent?this.add(r):this.bones[o.parent].add(r);var h=this.bones.length;if(this.useVertexTexture){var c;c=h>256?64:h>64?32:h>16?16:8,this.boneTextureWidth=c,this.boneTextureHeight=c,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1}else this.boneMatrices=new Float32Array(16*h);this.pose()}},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.addBone=function(e){return void 0===e&&(e=new THREE.Bone(this)),this.bones.push(e),e},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,i=this.children.length;i>t;t++){var n=this.children[t];n instanceof THREE.Bone?n.update(this.identityMatrix,!1):n.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[];for(var r=0,o=this.bones.length;o>r;r++){var a=new THREE.Matrix4;a.getInverse(this.bones[r].skinMatrix),this.boneInverses.push(a)}}for(var r=0,o=this.bones.length;o>r;r++)THREE.SkinnedMesh.offsetMatrix.multiplyMatrices(this.bones[r].skinMatrix,this.boneInverses[r]),THREE.SkinnedMesh.offsetMatrix.flattenToArrayOffset(this.boneMatrices,16*r);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)},THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);for(var e=0;e<this.geometry.skinIndices.length;e++){var t=this.geometry.skinWeights[e],i=1/t.lengthManhattan();1/0!==i?t.multiplyScalar(i):t.set(1)}},THREE.SkinnedMesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),THREE.Mesh.prototype.clone.call(this,e),e},THREE.SkinnedMesh.offsetMatrix=new THREE.Matrix4,THREE.MorphAnimMesh=function(e,t){THREE.Mesh.call(this,e,t),this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e,this.endKeyframe=t,this.length=this.endKeyframe-this.startKeyframe+1},THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},THREE.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;e.animations||(e.animations={});for(var t,i=e.animations,n=/([a-z]+)(\d+)/,r=0,o=e.morphTargets.length;o>r;r++){var a=e.morphTargets[r],s=a.name.match(n);if(s&&s.length>1){var l=s[1],h=s[2];i[l]||(i[l]={start:1/0,end:-1/0});var c=i[l];r<c.start&&(c.start=r),r>c.end&&(c.end=r),t||(t=l)}}e.firstAnimation=t},THREE.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,i){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[e]={start:t,end:i}},THREE.MorphAnimMesh.prototype.playAnimation=function(e,t){var i=this.geometry.animations[e];i?(this.setFrameRange(i.start,i.end),this.duration=1e3*((i.end-i.start)/t),this.time=0):console.warn("animation["+e+"] undefined")},THREE.MorphAnimMesh.prototype.updateAnimation=function(e){var t=this.duration/this.length;this.time+=this.direction*e,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var i=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/t),0,this.length-1);i!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[i]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=i);var n=this.time%t/t;this.directionBackwards&&(n=1-n),this.morphTargetInfluences[this.currentKeyframe]=n,this.morphTargetInfluences[this.lastKeyframe]=1-n},THREE.MorphAnimMesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.MorphAnimMesh(this.geometry,this.material)),e.duration=this.duration,e.mirroredLoop=this.mirroredLoop,e.time=this.time,e.lastKeyframe=this.lastKeyframe,e.currentKeyframe=this.currentKeyframe,e.direction=this.direction,e.directionBackwards=this.directionBackwards,THREE.Mesh.prototype.clone.call(this,e),e},THREE.Ribbon=function(e,t){THREE.Object3D.call(this),this.geometry=e,this.material=t},THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype),THREE.Ribbon.prototype.clone=function(e){return void 0===e&&(e=new THREE.Ribbon(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var i=0;i<this.objects.length&&!(t<this.objects[i].distance);i++);this.objects.splice(i,0,{distance:t,object:e}),this.add(e)},THREE.LOD.prototype.getObjectForDistance=function(e){for(var t=1,i=this.objects.length;i>t&&!(e<this.objects[t].distance);t++);return this.objects[t-1].object},THREE.LOD.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(i){if(this.objects.length>1){e.getPositionFromMatrix(i.matrixWorld),t.getPositionFromMatrix(this.matrixWorld);var n=e.distanceTo(t);this.objects[0].object.visible=!0;for(var r=1,o=this.objects.length;o>r&&n>=this.objects[r].distance;r++)this.objects[r-1].object.visible=!1,this.objects[r].object.visible=!0;for(;o>r;r++)this.objects[r].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(){},THREE.Sprite=function(e){THREE.Object3D.call(this),this.material=void 0!==e?e:new THREE.SpriteMaterial,this.rotation3d=this.rotation,this.rotation=0},THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation),this.quaternion.setFromEuler(this.rotation3d,this.eulerOrder),this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},THREE.Sprite.prototype.clone=function(e){return void 0===e&&(e=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Scene=function(){THREE.Object3D.call(this),this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.__addObject=function(e){if(e instanceof THREE.Light)-1===this.__lights.indexOf(e)&&this.__lights.push(e),e.target&&void 0===e.target.parent&&this.add(e.target);else if(!(e instanceof THREE.Camera||e instanceof THREE.Bone)&&-1===this.__objects.indexOf(e)){this.__objects.push(e),this.__objectsAdded.push(e);var t=this.__objectsRemoved.indexOf(e);-1!==t&&this.__objectsRemoved.splice(t,1)}for(var i=0;i<e.children.length;i++)this.__addObject(e.children[i])},THREE.Scene.prototype.__removeObject=function(e){if(e instanceof THREE.Light){var t=this.__lights.indexOf(e);-1!==t&&this.__lights.splice(t,1)}else if(!(e instanceof THREE.Camera)){var t=this.__objects.indexOf(e);if(-1!==t){this.__objects.splice(t,1),this.__objectsRemoved.push(e);var i=this.__objectsAdded.indexOf(e);-1!==i&&this.__objectsAdded.splice(i,1)}}for(var n=0;n<e.children.length;n++)this.__removeObject(e.children[n])},THREE.Fog=function(e,t,i){this.name="",this.color=new THREE.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==i?i:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(e,t){this.name="",this.color=new THREE.Color(e),this.density=void 0!==t?t:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.CanvasRenderer=function(e){function t(e){_!==e&&(T.globalAlpha=e,_=e)}function i(e){w!==e&&(e===THREE.NormalBlending?T.globalCompositeOperation="source-over":e===THREE.AdditiveBlending?T.globalCompositeOperation="lighter":e===THREE.SubtractiveBlending&&(T.globalCompositeOperation="darker"),w=e)}function n(e){M!==e&&(T.lineWidth=e,M=e)}function r(e){S!==e&&(T.lineCap=e,S=e)}function o(e){C!==e&&(T.lineJoin=e,C=e)}function a(e){R!==e&&(T.strokeStyle=e,R=e)}function s(e){H!==e&&(T.fillStyle=e,H=e)}function l(e,t){(A!==e||D!==t)&&(T.setLineDash([e,t]),A=e,D=t)}console.log("THREE.CanvasRenderer",THREE.REVISION);var h=THREE.Math.smoothstep;e=e||{};var c=this,u,f,p,d=new THREE.Projector,m=void 0!==e.canvas?e.canvas:document.createElement("canvas"),g,v,E,y,T=m.getContext("2d"),x=new THREE.Color(0),b=0,_=1,w=0,R=null,H=null,M=null,S=null,C=null,A=null,D=0,k,P,L,N,z=new THREE.RenderableVertex,F=new THREE.RenderableVertex,I,O,U,V,B,W,j,G,q,X,Y,K,Q=new THREE.Color,Z=new THREE.Color,J=new THREE.Color,et=new THREE.Color,tt=new THREE.Color,it=new THREE.Color,nt=new THREE.Color,rt=new THREE.Color,ot={},at={},st,lt,ht,ct,ut,ft,pt,dt,mt,gt,vt=new THREE.Box2,Et=new THREE.Box2,yt=new THREE.Box2,Tt=new THREE.Color,xt=new THREE.Color,bt=new THREE.Color,_t=new THREE.Vector3,wt,Rt,Ht,Mt,St,Ct,At=16;wt=document.createElement("canvas"),wt.width=wt.height=2,Rt=wt.getContext("2d"),Rt.fillStyle="rgba(0,0,0,1)",Rt.fillRect(0,0,2,2),Ht=Rt.getImageData(0,0,2,2),Mt=Ht.data,St=document.createElement("canvas"),St.width=St.height=At,Ct=St.getContext("2d"),Ct.translate(-At/2,-At/2),Ct.scale(At,At),At--,void 0===T.setLineDash&&(T.setLineDash=void 0!==T.mozDash?function(e){T.mozDash=null!==e[0]?e:null}:function(){}),this.domElement=m,this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setSize=function(e,t,i){g=e*this.devicePixelRatio,v=t*this.devicePixelRatio,E=Math.floor(g/2),y=Math.floor(v/2),m.width=g,m.height=v,1!==this.devicePixelRatio&&i!==!1&&(m.style.width=e+"px",m.style.height=t+"px"),vt.set(new THREE.Vector2(-E,-y),new THREE.Vector2(E,y)),Et.set(new THREE.Vector2(-E,-y),new THREE.Vector2(E,y)),_=1,w=0,R=null,H=null,M=null,S=null,C=null},this.setClearColor=function(e,t){x.set(e),b=void 0!==t?t:1,Et.set(new THREE.Vector2(-E,-y),new THREE.Vector2(E,y))},this.setClearColorHex=function(e,t){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getMaxAnisotropy=function(){return 0},this.clear=function(){T.setTransform(1,0,0,-1,E,y),Et.empty()===!1&&(Et.intersect(vt),Et.expandByScalar(2),1>b&&T.clearRect(0|Et.min.x,0|Et.min.y,Et.max.x-Et.min.x|0,Et.max.y-Et.min.y|0),b>0&&(i(THREE.NormalBlending),t(1),s("rgba("+Math.floor(255*x.r)+","+Math.floor(255*x.g)+","+Math.floor(255*x.b)+","+b+")"),T.fillRect(0|Et.min.x,0|Et.min.y,Et.max.x-Et.min.x|0,Et.max.y-Et.min.y|0)),Et.makeEmpty())},this.render=function(e,m){function g(){Tt.setRGB(0,0,0),xt.setRGB(0,0,0),bt.setRGB(0,0,0);for(var e=0,t=p.length;t>e;e++){var i=p[e],n=i.color;i instanceof THREE.AmbientLight?Tt.add(n):i instanceof THREE.DirectionalLight?xt.add(n):i instanceof THREE.PointLight&&bt.add(n)}}function v(e,t,i){for(var n=0,r=p.length;r>n;n++){var o=p[n];if(rt.copy(o.color),o instanceof THREE.DirectionalLight){var a=_t.getPositionFromMatrix(o.matrixWorld).normalize(),s=t.dot(a);if(0>=s)continue;s*=o.intensity,i.add(rt.multiplyScalar(s))}else if(o instanceof THREE.PointLight){var a=_t.getPositionFromMatrix(o.matrixWorld),s=t.dot(_t.subVectors(a,e).normalize());if(0>=s)continue;if(s*=0==o.distance?1:1-Math.min(e.distanceTo(a)/o.distance,1),0==s)continue;s*=o.intensity,i.add(rt.multiplyScalar(s))}}}function x(e,n,r){t(r.opacity),i(r.blending);var o,l,h,c,u,f,p;if(r instanceof THREE.ParticleBasicMaterial)if(null===r.map){if(h=n.object.scale.x,c=n.object.scale.y,h*=n.scale.x*E,c*=n.scale.y*y,yt.min.set(e.x-h,e.y-c),yt.max.set(e.x+h,e.y+c),vt.isIntersectionBox(yt)===!1)return void yt.makeEmpty();s(r.color.getStyle()),T.save(),T.translate(e.x,e.y),T.rotate(-n.rotation),T.scale(h,c),T.fillRect(-1,-1,2,2),T.restore()}else{if(u=r.map.image,f=u.width>>1,p=u.height>>1,h=n.scale.x*E,c=n.scale.y*y,o=h*f,l=c*p,yt.min.set(e.x-o,e.y-l),yt.max.set(e.x+o,e.y+l),vt.isIntersectionBox(yt)===!1)return void yt.makeEmpty();T.save(),T.translate(e.x,e.y),T.rotate(-n.rotation),T.scale(h,-c),T.translate(-f,-p),T.drawImage(u,0,0),T.restore()}else if(r instanceof THREE.ParticleCanvasMaterial){if(o=n.scale.x*E,l=n.scale.y*y,yt.min.set(e.x-o,e.y-l),yt.max.set(e.x+o,e.y+l),vt.isIntersectionBox(yt)===!1)return void yt.makeEmpty();a(r.color.getStyle()),s(r.color.getStyle()),T.save(),T.translate(e.x,e.y),T.rotate(-n.rotation),T.scale(o,l),r.program(T),T.restore()}}function b(e,s,h,c){if(t(c.opacity),i(c.blending),T.beginPath(),T.moveTo(e.positionScreen.x,e.positionScreen.y),T.lineTo(s.positionScreen.x,s.positionScreen.y),c instanceof THREE.LineBasicMaterial){if(n(c.linewidth),r(c.linecap),o(c.linejoin),c.vertexColors!==THREE.VertexColors)a(c.color.getStyle());else{var u=h.vertexColors[0].getStyle(),f=h.vertexColors[1].getStyle();if(u===f)a(u);else{try{var p=T.createLinearGradient(e.positionScreen.x,e.positionScreen.y,s.positionScreen.x,s.positionScreen.y);p.addColorStop(0,u),p.addColorStop(1,f)}catch(d){p=u}a(p)}}T.stroke(),yt.expandByScalar(2*c.linewidth)}else c instanceof THREE.LineDashedMaterial&&(n(c.linewidth),r(c.linecap),o(c.linejoin),a(c.color.getStyle()),l(c.dashSize,c.gapSize),T.stroke(),yt.expandByScalar(2*c.linewidth),l(null,null))}function _(e,n,r,o,a,s,l,u){if(c.info.render.vertices+=3,c.info.render.faces++,t(u.opacity),i(u.blending),I=e.positionScreen.x,O=e.positionScreen.y,U=n.positionScreen.x,V=n.positionScreen.y,B=r.positionScreen.x,W=r.positionScreen.y,R(I,O,U,V,B,W),(u instanceof THREE.MeshLambertMaterial||u instanceof THREE.MeshPhongMaterial)&&null===u.map)it.copy(u.color),nt.copy(u.emissive),u.vertexColors===THREE.FaceColors&&it.multiply(l.color),u.wireframe===!1&&u.shading==THREE.SmoothShading&&3==l.vertexNormalsLength?(Z.copy(Tt),J.copy(Tt),et.copy(Tt),v(l.v1.positionWorld,l.vertexNormalsModel[0],Z),v(l.v2.positionWorld,l.vertexNormalsModel[1],J),v(l.v3.positionWorld,l.vertexNormalsModel[2],et),Z.multiply(it).add(nt),J.multiply(it).add(nt),et.multiply(it).add(nt),tt.addColors(J,et).multiplyScalar(.5),ht=D(Z,J,et,tt),A(I,O,U,V,B,W,0,0,1,0,0,1,ht)):(Q.copy(Tt),v(l.centroidModel,l.normalModel,Q),Q.multiply(it).add(nt),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q));else if(u instanceof THREE.MeshBasicMaterial||u instanceof THREE.MeshLambertMaterial||u instanceof THREE.MeshPhongMaterial)null!==u.map?u.map.mapping instanceof THREE.UVMapping&&(ct=l.uvs[0],C(I,O,U,V,B,W,ct[o].x,ct[o].y,ct[a].x,ct[a].y,ct[s].x,ct[s].y,u.map)):null!==u.envMap?u.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(_t.copy(l.vertexNormalsModelView[o]),ut=.5*_t.x+.5,ft=.5*_t.y+.5,_t.copy(l.vertexNormalsModelView[a]),pt=.5*_t.x+.5,dt=.5*_t.y+.5,_t.copy(l.vertexNormalsModelView[s]),mt=.5*_t.x+.5,gt=.5*_t.y+.5,C(I,O,U,V,B,W,ut,ft,pt,dt,mt,gt,u.envMap)):(Q.copy(u.color),u.vertexColors===THREE.FaceColors&&Q.multiply(l.color),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q));else if(u instanceof THREE.MeshDepthMaterial)st=m.near,lt=m.far,Z.r=Z.g=Z.b=1-h(e.positionScreen.z*e.positionScreen.w,st,lt),J.r=J.g=J.b=1-h(n.positionScreen.z*n.positionScreen.w,st,lt),et.r=et.g=et.b=1-h(r.positionScreen.z*r.positionScreen.w,st,lt),tt.addColors(J,et).multiplyScalar(.5),ht=D(Z,J,et,tt),A(I,O,U,V,B,W,0,0,1,0,0,1,ht);else if(u instanceof THREE.MeshNormalMaterial){var f;u.shading==THREE.FlatShading?(f=l.normalModelView,Q.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q)):u.shading==THREE.SmoothShading&&(f=l.vertexNormalsModelView[o],Z.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),f=l.vertexNormalsModelView[a],J.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),f=l.vertexNormalsModelView[s],et.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),tt.addColors(J,et).multiplyScalar(.5),ht=D(Z,J,et,tt),A(I,O,U,V,B,W,0,0,1,0,0,1,ht))}}function w(e,n,r,o,a,s,l,u){if(c.info.render.vertices+=4,c.info.render.faces++,t(u.opacity),i(u.blending),void 0!==u.map&&null!==u.map||void 0!==u.envMap&&null!==u.envMap)return _(e,n,o,0,1,3,l,u),void _(a,r,s,1,2,3,l,u);if(I=e.positionScreen.x,O=e.positionScreen.y,U=n.positionScreen.x,V=n.positionScreen.y,B=r.positionScreen.x,W=r.positionScreen.y,j=o.positionScreen.x,G=o.positionScreen.y,q=a.positionScreen.x,X=a.positionScreen.y,Y=s.positionScreen.x,K=s.positionScreen.y,u instanceof THREE.MeshLambertMaterial||u instanceof THREE.MeshPhongMaterial)it.copy(u.color),nt.copy(u.emissive),u.vertexColors===THREE.FaceColors&&it.multiply(l.color),u.wireframe===!1&&u.shading==THREE.SmoothShading&&4==l.vertexNormalsLength?(Z.copy(Tt),J.copy(Tt),et.copy(Tt),tt.copy(Tt),v(l.v1.positionWorld,l.vertexNormalsModel[0],Z),v(l.v2.positionWorld,l.vertexNormalsModel[1],J),v(l.v4.positionWorld,l.vertexNormalsModel[3],et),v(l.v3.positionWorld,l.vertexNormalsModel[2],tt),Z.multiply(it).add(nt),J.multiply(it).add(nt),et.multiply(it).add(nt),tt.multiply(it).add(nt),ht=D(Z,J,et,tt),R(I,O,U,V,j,G),A(I,O,U,V,j,G,0,0,1,0,0,1,ht),R(q,X,B,W,Y,K),A(q,X,B,W,Y,K,1,0,1,1,0,1,ht)):(Q.copy(Tt),v(l.centroidModel,l.normalModel,Q),Q.multiply(it).add(nt),H(I,O,U,V,B,W,j,G),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q));else if(u instanceof THREE.MeshBasicMaterial)Q.copy(u.color),u.vertexColors===THREE.FaceColors&&Q.multiply(l.color),H(I,O,U,V,B,W,j,G),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q);else if(u instanceof THREE.MeshNormalMaterial){var f;u.shading==THREE.FlatShading?(f=l.normalModelView,Q.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),H(I,O,U,V,B,W,j,G),u.wireframe===!0?M(Q,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):S(Q)):u.shading==THREE.SmoothShading&&(f=l.vertexNormalsModelView[0],Z.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),f=l.vertexNormalsModelView[1],J.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),f=l.vertexNormalsModelView[3],et.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),f=l.vertexNormalsModelView[2],tt.setRGB(f.x,f.y,f.z).multiplyScalar(.5).addScalar(.5),ht=D(Z,J,et,tt),R(I,O,U,V,j,G),A(I,O,U,V,j,G,0,0,1,0,0,1,ht),R(q,X,B,W,Y,K),A(q,X,B,W,Y,K,1,0,1,1,0,1,ht))}else u instanceof THREE.MeshDepthMaterial&&(st=m.near,lt=m.far,Z.r=Z.g=Z.b=1-h(e.positionScreen.z*e.positionScreen.w,st,lt),J.r=J.g=J.b=1-h(n.positionScreen.z*n.positionScreen.w,st,lt),et.r=et.g=et.b=1-h(o.positionScreen.z*o.positionScreen.w,st,lt),tt.r=tt.g=tt.b=1-h(r.positionScreen.z*r.positionScreen.w,st,lt),ht=D(Z,J,et,tt),R(I,O,U,V,j,G),A(I,O,U,V,j,G,0,0,1,0,0,1,ht),R(q,X,B,W,Y,K),A(q,X,B,W,Y,K,1,0,1,1,0,1,ht))}function R(e,t,i,n,r,o){T.beginPath(),T.moveTo(e,t),T.lineTo(i,n),T.lineTo(r,o),T.closePath()}function H(e,t,i,n,r,o,a,s){T.beginPath(),T.moveTo(e,t),T.lineTo(i,n),T.lineTo(r,o),T.lineTo(a,s),T.closePath()}function M(e,t,i,s){n(t),r(i),o(s),a(e.getStyle()),T.stroke(),yt.expandByScalar(2*t)}function S(e){s(e.getStyle()),T.fill()}function C(e,t,i,n,r,o,a,l,h,c,u,f,p){if(!(p instanceof THREE.DataTexture||void 0===p.image||0==p.image.width)){if(p.needsUpdate===!0){var d=p.wrapS==THREE.RepeatWrapping,m=p.wrapT==THREE.RepeatWrapping;ot[p.id]=T.createPattern(p.image,d===!0&&m===!0?"repeat":d===!0&&m===!1?"repeat-x":d===!1&&m===!0?"repeat-y":"no-repeat"),p.needsUpdate=!1}s(void 0===ot[p.id]?"rgba(0,0,0,1)":ot[p.id]);var g,v,E,y,x,b,_,w,R=p.offset.x/p.repeat.x,H=p.offset.y/p.repeat.y,M=p.image.width*p.repeat.x,C=p.image.height*p.repeat.y;if(a=(a+R)*M,l=(1-l+H)*C,h=(h+R)*M,c=(1-c+H)*C,u=(u+R)*M,f=(1-f+H)*C,i-=e,n-=t,r-=e,o-=t,h-=a,c-=l,u-=a,f-=l,_=h*f-u*c,0===_){if(void 0===at[p.id]){var A=document.createElement("canvas");A.width=p.image.width,A.height=p.image.height;var D=A.getContext("2d");D.drawImage(p.image,0,0),at[p.id]=D.getImageData(0,0,p.image.width,p.image.height).data}var k=at[p.id],P=4*(Math.floor(a)+Math.floor(l)*p.image.width);return Q.setRGB(k[P]/255,k[P+1]/255,k[P+2]/255),void S(Q)}w=1/_,g=(f*i-c*r)*w,v=(f*n-c*o)*w,E=(h*r-u*i)*w,y=(h*o-u*n)*w,x=e-g*a-E*l,b=t-v*a-y*l,T.save(),T.transform(g,v,E,y,x,b),T.fill(),T.restore()}}function A(e,t,i,n,r,o,a,s,l,h,c,u,f){var p,d,m,g,v,E,y,x,b=f.width-1,_=f.height-1;a*=b,s*=_,l*=b,h*=_,c*=b,u*=_,i-=e,n-=t,r-=e,o-=t,l-=a,h-=s,c-=a,u-=s,y=l*u-c*h,x=1/y,p=(u*i-h*r)*x,d=(u*n-h*o)*x,m=(l*r-c*i)*x,g=(l*o-c*n)*x,v=e-p*a-m*s,E=t-d*a-g*s,T.save(),T.transform(p,d,m,g,v,E),T.clip(),T.drawImage(f,0,0),T.restore()}function D(e,t,i,n){return Mt[0]=255*e.r|0,Mt[1]=255*e.g|0,Mt[2]=255*e.b|0,Mt[4]=255*t.r|0,Mt[5]=255*t.g|0,Mt[6]=255*t.b|0,Mt[8]=255*i.r|0,Mt[9]=255*i.g|0,Mt[10]=255*i.b|0,Mt[12]=255*n.r|0,Mt[13]=255*n.g|0,Mt[14]=255*n.b|0,Rt.putImageData(Ht,0,0),Ct.drawImage(wt,0,0),St}function At(e,t){var i=t.x-e.x,n=t.y-e.y,r=i*i+n*n,o;0!==r&&(o=1/Math.sqrt(r),i*=o,n*=o,t.x+=i,t.y+=n,e.x-=i,e.y-=n)}if(m instanceof THREE.Camera==!1)return void console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");this.autoClear===!0&&this.clear(),T.setTransform(1,0,0,-1,E,y),c.info.render.vertices=0,c.info.render.faces=0,u=d.projectScene(e,m,this.sortObjects,this.sortElements),f=u.elements,p=u.lights,g();for(var Dt=0,kt=f.length;kt>Dt;Dt++){var Pt=f[Dt],Lt=Pt.material;if(void 0!==Lt&&Lt.visible!==!1){if(yt.makeEmpty(),Pt instanceof THREE.RenderableParticle)k=Pt,k.x*=E,k.y*=y,x(k,Pt,Lt);else if(Pt instanceof THREE.RenderableLine)k=Pt.v1,P=Pt.v2,k.positionScreen.x*=E,k.positionScreen.y*=y,P.positionScreen.x*=E,P.positionScreen.y*=y,yt.setFromPoints([k.positionScreen,P.positionScreen]),vt.isIntersectionBox(yt)===!0&&b(k,P,Pt,Lt);else if(Pt instanceof THREE.RenderableFace3){if(k=Pt.v1,P=Pt.v2,L=Pt.v3,k.positionScreen.z<-1||k.positionScreen.z>1)continue;if(P.positionScreen.z<-1||P.positionScreen.z>1)continue;if(L.positionScreen.z<-1||L.positionScreen.z>1)continue;k.positionScreen.x*=E,k.positionScreen.y*=y,P.positionScreen.x*=E,P.positionScreen.y*=y,L.positionScreen.x*=E,L.positionScreen.y*=y,Lt.overdraw===!0&&(At(k.positionScreen,P.positionScreen),At(P.positionScreen,L.positionScreen),At(L.positionScreen,k.positionScreen)),yt.setFromPoints([k.positionScreen,P.positionScreen,L.positionScreen]),vt.isIntersectionBox(yt)===!0&&_(k,P,L,0,1,2,Pt,Lt)}else if(Pt instanceof THREE.RenderableFace4){if(k=Pt.v1,P=Pt.v2,L=Pt.v3,N=Pt.v4,k.positionScreen.z<-1||k.positionScreen.z>1)continue;if(P.positionScreen.z<-1||P.positionScreen.z>1)continue;if(L.positionScreen.z<-1||L.positionScreen.z>1)continue;if(N.positionScreen.z<-1||N.positionScreen.z>1)continue;k.positionScreen.x*=E,k.positionScreen.y*=y,P.positionScreen.x*=E,P.positionScreen.y*=y,L.positionScreen.x*=E,L.positionScreen.y*=y,N.positionScreen.x*=E,N.positionScreen.y*=y,z.positionScreen.copy(P.positionScreen),F.positionScreen.copy(N.positionScreen),Lt.overdraw===!0&&(At(k.positionScreen,P.positionScreen),At(P.positionScreen,N.positionScreen),At(N.positionScreen,k.positionScreen),At(L.positionScreen,z.positionScreen),At(L.positionScreen,F.positionScreen)),yt.setFromPoints([k.positionScreen,P.positionScreen,L.positionScreen,N.positionScreen]),vt.isIntersectionBox(yt)===!0&&w(k,P,L,N,z,F,Pt,Lt)}Et.union(yt)}}T.setTransform(1,0,0,1,0,0)}},THREE.ShaderChunk={fog_pars_fragment:["#ifdef USE_FOG","uniform vec3 fogColor;","#ifdef FOG_EXP2","uniform float fogDensity;","#else","uniform float fogNear;","uniform float fogFar;","#endif","#endif"].join("\n"),fog_fragment:["#ifdef USE_FOG","float depth = gl_FragCoord.z / gl_FragCoord.w;","#ifdef FOG_EXP2","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","#else","float fogFactor = smoothstep( fogNear, fogFar, depth );","#endif","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","#endif"].join("\n"),envmap_pars_fragment:["#ifdef USE_ENVMAP","uniform float reflectivity;","uniform samplerCube envMap;","uniform float flipEnvMap;","uniform int combine;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","uniform bool useRefract;","uniform float refractionRatio;","#else","varying vec3 vReflect;","#endif","#endif"].join("\n"),envmap_fragment:["#ifdef USE_ENVMAP","vec3 reflectVec;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","reflectVec = refract( cameraToVertex, normal, refractionRatio );","} else { ","reflectVec = reflect( cameraToVertex, normal );","}","#else","reflectVec = vReflect;","#endif","#ifdef DOUBLE_SIDED","float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );","vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#else","vec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#endif","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","if ( combine == 1 ) {","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );","} else if ( combine == 2 ) {","gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;","} else {","gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );","}","#endif"].join("\n"),envmap_pars_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","varying vec3 vReflect;","uniform float refractionRatio;","uniform bool useRefract;","#endif"].join("\n"),worldpos_vertex:["#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )","#ifdef USE_SKINNING","vec4 worldPosition = modelMatrix * skinned;","#endif","#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );","#endif","#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","#endif","#endif"].join("\n"),envmap_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;","worldNormal = normalize( worldNormal );","vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, worldNormal, refractionRatio );","} else {","vReflect = reflect( cameraToVertex, worldNormal );","}","#endif"].join("\n"),map_particle_pars_fragment:["#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_particle_fragment:["#ifdef USE_MAP","gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );","#endif"].join("\n"),map_pars_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","uniform vec4 offsetRepeat;","#endif"].join("\n"),map_pars_fragment:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","#endif","#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","#endif"].join("\n"),map_fragment:["#ifdef USE_MAP","vec4 texelColor = texture2D( map, vUv );","#ifdef GAMMA_INPUT","texelColor.xyz *= texelColor.xyz;","#endif","gl_FragColor = gl_FragColor * texelColor;","#endif"].join("\n"),lightmap_pars_fragment:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","uniform sampler2D lightMap;","#endif"].join("\n"),lightmap_pars_vertex:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","#endif"].join("\n"),lightmap_fragment:["#ifdef USE_LIGHTMAP","gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );","#endif"].join("\n"),lightmap_vertex:["#ifdef USE_LIGHTMAP","vUv2 = uv2;","#endif"].join("\n"),bumpmap_pars_fragment:["#ifdef USE_BUMPMAP","uniform sampler2D bumpMap;","uniform float bumpScale;","vec2 dHdxy_fwd() {","vec2 dSTdx = dFdx( vUv );","vec2 dSTdy = dFdy( vUv );","float Hll = bumpScale * texture2D( bumpMap, vUv ).x;","float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","return vec2( dBx, dBy );","}","vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","vec3 vSigmaX = dFdx( surf_pos );","vec3 vSigmaY = dFdy( surf_pos );","vec3 vN = surf_norm;","vec3 R1 = cross( vSigmaY, vN );","vec3 R2 = cross( vN, vSigmaX );","float fDet = dot( vSigmaX, R1 );","vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","return normalize( abs( fDet ) * surf_norm - vGrad );","}","#endif"].join("\n"),normalmap_pars_fragment:["#ifdef USE_NORMALMAP","uniform sampler2D normalMap;","uniform vec2 normalScale;","vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {","vec3 q0 = dFdx( eye_pos.xyz );","vec3 q1 = dFdy( eye_pos.xyz );","vec2 st0 = dFdx( vUv.st );","vec2 st1 = dFdy( vUv.st );","vec3 S = normalize(  q0 * st1.t - q1 * st0.t );","vec3 T = normalize( -q0 * st1.s + q1 * st0.s );","vec3 N = normalize( surf_norm );","vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;","mapN.xy = normalScale * mapN.xy;","mat3 tsn = mat3( S, T, N );","return normalize( tsn * mapN );","}","#endif"].join("\n"),specularmap_pars_fragment:["#ifdef USE_SPECULARMAP","uniform sampler2D specularMap;","#endif"].join("\n"),specularmap_fragment:["float specularStrength;","#ifdef USE_SPECULARMAP","vec4 texelSpecular = texture2D( specularMap, vUv );","specularStrength = texelSpecular.r;","#else","specularStrength = 1.0;","#endif"].join("\n"),lights_lambert_pars_vertex:["uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif"].join("\n"),lights_lambert_vertex:["vLightFront = vec3( 0.0 );","#ifdef DOUBLE_SIDED","vLightBack = vec3( 0.0 );","#endif","transformedNormal = normalize( transformedNormal );","#if MAX_DIR_LIGHTS > 0","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, dirVector );","vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += directionalLightColor[ i ] * directionalLightWeighting;","#ifdef DOUBLE_SIDED","vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;","#endif","}","#endif","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;","#ifdef DOUBLE_SIDED","vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;","#ifdef DOUBLE_SIDED","vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_HEMI_LIGHTS > 0","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;","vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","#ifdef DOUBLE_SIDED","vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );","#endif","}","#endif","vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;","#ifdef DOUBLE_SIDED","vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;","#endif"].join("\n"),lights_phong_pars_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif"].join("\n"),lights_phong_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","vPointLight[ i ] = vec4( lVector, lDistance );","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","vSpotLight[ i ] = vec4( lVector, lDistance );","}","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","vWorldPosition = worldPosition.xyz;","#endif"].join("\n"),lights_phong_pars_fragment:["uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#else","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#else","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vViewPosition;","varying vec3 vNormal;"].join("\n"),lights_phong_fragment:["vec3 normal = normalize( vNormal );","vec3 viewPosition = normalize( vViewPosition );","#ifdef DOUBLE_SIDED","normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );","#endif","#ifdef USE_NORMALMAP","normal = perturbNormal2Arb( -vViewPosition, normal );","#elif defined( USE_BUMPMAP )","normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse  = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vPointLight[ i ].xyz );","float lDistance = vPointLight[ i ].w;","#endif","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dotProduct, 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dotProduct, 0.0 );","#endif","pointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;","vec3 pointHalfVector = normalize( lVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;","#else","pointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse  = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vSpotLight[ i ].xyz );","float lDistance = vSpotLight[ i ].w;","#endif","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dotProduct, 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dotProduct, 0.0 );","#endif","spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;","vec3 spotHalfVector = normalize( lVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;","#else","spotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse  = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, dirVector );","#ifdef WRAP_AROUND","float dirDiffuseWeightFull = max( dotProduct, 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dotProduct, 0.0 );","#endif","dirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += diffuse * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;","#endif"].join("\n"),color_pars_fragment:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_fragment:["#ifdef USE_COLOR","gl_FragColor = gl_FragColor * vec4( vColor, opacity );","#endif"].join("\n"),color_pars_vertex:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_vertex:["#ifdef USE_COLOR","#ifdef GAMMA_INPUT","vColor = color * color;","#else","vColor = color;","#endif","#endif"].join("\n"),skinning_pars_vertex:["#ifdef USE_SKINNING","#ifdef BONE_TEXTURE","uniform sampler2D boneTexture;","mat4 getBoneMatrix( const in float i ) {","float j = i * 4.0;","float x = mod( j, N_BONE_PIXEL_X );","float y = floor( j / N_BONE_PIXEL_X );","const float dx = 1.0 / N_BONE_PIXEL_X;","const float dy = 1.0 / N_BONE_PIXEL_Y;","y = dy * ( y + 0.5 );","vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );","vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );","vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );","vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );","mat4 bone = mat4( v1, v2, v3, v4 );","return bone;","}","#else","uniform mat4 boneGlobalMatrices[ MAX_BONES ];","mat4 getBoneMatrix( const in float i ) {","mat4 bone = boneGlobalMatrices[ int(i) ];","return bone;","}","#endif","#endif"].join("\n"),skinbase_vertex:["#ifdef USE_SKINNING","mat4 boneMatX = getBoneMatrix( skinIndex.x );","mat4 boneMatY = getBoneMatrix( skinIndex.y );","#endif"].join("\n"),skinning_vertex:["#ifdef USE_SKINNING","#ifdef USE_MORPHTARGETS","vec4 skinVertex = vec4( morphed, 1.0 );","#else","vec4 skinVertex = vec4( position, 1.0 );","#endif","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","#endif"].join("\n"),morphtarget_pars_vertex:["#ifdef USE_MORPHTARGETS","#ifndef USE_MORPHNORMALS","uniform float morphTargetInfluences[ 8 ];","#else","uniform float morphTargetInfluences[ 4 ];","#endif","#endif"].join("\n"),morphtarget_vertex:["#ifdef USE_MORPHTARGETS","vec3 morphed = vec3( 0.0 );","morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];","morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];","morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];","morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];","#ifndef USE_MORPHNORMALS","morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];","morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];","morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];","morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];","#endif","morphed += position;","#endif"].join("\n"),default_vertex:["vec4 mvPosition;","#ifdef USE_SKINNING","mvPosition = modelViewMatrix * skinned;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( morphed, 1.0 );","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;"].join("\n"),morphnormal_vertex:["#ifdef USE_MORPHNORMALS","vec3 morphedNormal = vec3( 0.0 );","morphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];","morphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];","morphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];","morphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];","morphedNormal += normal;","#endif"].join("\n"),skinnormal_vertex:["#ifdef USE_SKINNING","mat4 skinMatrix = skinWeight.x * boneMatX;","skinMatrix 	+= skinWeight.y * boneMatY;","#ifdef USE_MORPHNORMALS","vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );","#else","vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );","#endif","#endif"].join("\n"),defaultnormal_vertex:["vec3 objectNormal;","#ifdef USE_SKINNING","objectNormal = skinnedNormal.xyz;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )","objectNormal = morphedNormal;","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )","objectNormal = normal;","#endif","#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","vec3 transformedNormal = normalMatrix * objectNormal;"].join("\n"),shadowmap_pars_fragment:["#ifdef USE_SHADOWMAP","uniform sampler2D shadowMap[ MAX_SHADOWS ];","uniform vec2 shadowMapSize[ MAX_SHADOWS ];","uniform float shadowDarkness[ MAX_SHADOWS ];","uniform float shadowBias[ MAX_SHADOWS ];","varying vec4 vShadowCoord[ MAX_SHADOWS ];","float unpackDepth( const in vec4 rgba_depth ) {","const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );","float depth = dot( rgba_depth, bit_shift );","return depth;","}","#endif"].join("\n"),shadowmap_fragment:["#ifdef USE_SHADOWMAP","#ifdef SHADOWMAP_DEBUG","vec3 frustumColors[3];","frustumColors[0] = vec3( 1.0, 0.5, 0.0 );","frustumColors[1] = vec3( 0.0, 1.0, 0.8 );","frustumColors[2] = vec3( 0.0, 0.5, 1.0 );","#endif","#ifdef SHADOWMAP_CASCADE","int inFrustumCount = 0;","#endif","float fDepth;","vec3 shadowColor = vec3( 1.0 );","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;","bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );","bool inFrustum = all( inFrustumVec );","#ifdef SHADOWMAP_CASCADE","inFrustumCount += int( inFrustum );","bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );","#else","bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );","#endif","bool frustumTest = all( frustumTestVec );","if ( frustumTest ) {","shadowCoord.z += shadowBias[ i ];","#if defined( SHADOWMAP_TYPE_PCF )","float shadow = 0.0;","const float shadowDelta = 1.0 / 9.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.25 * xPixelOffset;","float dy0 = -1.25 * yPixelOffset;","float dx1 = 1.25 * xPixelOffset;","float dy1 = 1.25 * yPixelOffset;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#elif defined( SHADOWMAP_TYPE_PCF_SOFT )","float shadow = 0.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.0 * xPixelOffset;","float dy0 = -1.0 * yPixelOffset;","float dx1 = 1.0 * xPixelOffset;","float dy1 = 1.0 * yPixelOffset;","mat3 shadowKernel;","mat3 depthKernel;","depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","vec3 shadowZ = vec3( shadowCoord.z );","shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));","shadowKernel[0] *= vec3(0.25);","shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));","shadowKernel[1] *= vec3(0.25);","shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));","shadowKernel[2] *= vec3(0.25);","vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );","shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );","shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );","vec4 shadowValues;","shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );","shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );","shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );","shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );","shadow = dot( shadowValues, vec4( 1.0 ) );","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#else","vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );","float fDepth = unpackDepth( rgbaDepth );","if ( fDepth < shadowCoord.z )","shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );","#endif","}","#ifdef SHADOWMAP_DEBUG","#ifdef SHADOWMAP_CASCADE","if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];","#else","if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];","#endif","#endif","}","#ifdef GAMMA_OUTPUT","shadowColor *= shadowColor;","#endif","gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;","#endif"].join("\n"),shadowmap_pars_vertex:["#ifdef USE_SHADOWMAP","varying vec4 vShadowCoord[ MAX_SHADOWS ];","uniform mat4 shadowMatrix[ MAX_SHADOWS ];","#endif"].join("\n"),shadowmap_vertex:["#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif"].join("\n"),alphatest_fragment:["#ifdef ALPHATEST","if ( gl_FragColor.a < ALPHATEST ) discard;","#endif"].join("\n"),linear_to_gamma_fragment:["#ifdef GAMMA_OUTPUT","gl_FragColor.xyz = sqrt( gl_FragColor.xyz );","#endif"].join("\n")},THREE.UniformsUtils={merge:function(e){var t,i,n,r={};
for(t=0;t<e.length;t++){n=this.clone(e[t]);for(i in n)r[i]=n[i]}return r},clone:function(e){var t,i,n,r,o={};for(t in e){o[t]={};for(i in e[t])r=e[t][i],o[t][i]=r instanceof THREE.Color||r instanceof THREE.Vector2||r instanceof THREE.Vector3||r instanceof THREE.Vector4||r instanceof THREE.Matrix4||r instanceof THREE.Texture?r.clone():r instanceof Array?r.slice():r}return o}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED","if ( gl_FrontFacing )","gl_FragColor.xyz *= vLightFront;","else","gl_FragColor.xyz *= vLightBack;","#else","gl_FragColor.xyz *= vLightFront;","#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#ifdef USE_SIZEATTENUATION","gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","#else","gl_PointSize = size;","#endif","gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {","gl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {","if ( mod( vLineDistance, totalSize ) > dashSize ) {","discard;","}","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;","void main() {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float color = 1.0 - smoothstep( mNear, mFar, depth );","gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {","vNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;","void main() {","gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );","}"].join("\n")},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:.98},uReflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;","uniform vec3 uDiffuseColor;","uniform vec3 uSpecularColor;","uniform float uShininess;","uniform float uOpacity;","uniform bool enableDiffuse;","uniform bool enableSpecular;","uniform bool enableAO;","uniform bool enableReflection;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tAO;","uniform samplerCube tCube;","uniform vec2 uNormalScale;","uniform bool useRefract;","uniform float uRefractionRatio;","uniform float uReflectivity;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {","gl_FragColor = vec4( vec3( 1.0 ), uOpacity );","vec3 specularTex = vec3( 1.0 );","vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( enableDiffuse ) {","#ifdef GAMMA_INPUT","vec4 texelColor = texture2D( tDiffuse, vUv );","texelColor.xyz *= texelColor.xyz;","gl_FragColor = gl_FragColor * texelColor;","#else","gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );","#endif","}","if( enableAO ) {","#ifdef GAMMA_INPUT","vec4 aoColor = texture2D( tAO, vUv );","aoColor.xyz *= aoColor.xyz;","gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;","#else","gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;","#endif","}","if( enableSpecular )","specularTex = texture2D( tSpecular, vUv ).xyz;","mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );","vec3 finalNormal = tsb * normalTex;","#ifdef FLIP_SIDED","finalNormal = -finalNormal;","#endif","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 pointVector = lPosition.xyz + vViewPosition.xyz;","float pointDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );","pointVector = normalize( pointVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","#endif","pointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;","vec3 pointHalfVector = normalize( pointVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;","#else","pointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 spotVector = lPosition.xyz + vViewPosition.xyz;","float spotDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );","spotVector = normalize( spotVector );","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );","#endif","spotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;","vec3 spotHalfVector = normalize( spotVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;","#else","spotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","#ifdef WRAP_AROUND","float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );","float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","#endif","dirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += uDiffuseColor * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;","#endif","if ( enableReflection ) {","vec3 vReflect;","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, normal, uRefractionRatio );","} else {","vReflect = reflect( cameraToVertex, normal );","}","vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );","}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uOffset;","uniform vec2 uRepeat;","uniform bool enableDisplacement;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING","vNormal = normalize( normalMatrix * skinnedNormal.xyz );","vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );","vTangent = normalize( normalMatrix * skinnedTangent.xyz );","#else","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","#endif","vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );","vUv = uv * uRepeat + uOffset;","vec3 displacedPosition;","#ifdef VERTEX_TEXTURES","if ( enableDisplacement ) {","vec3 dv = texture2D( tDisplacement, uv ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","displacedPosition = position + normalize( normal ) * df;","} else {","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","}","#else","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","#endif","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","gl_Position = projectionMatrix * mvPosition;","vWorldPosition = worldPosition.xyz;","vViewPosition = -mvPosition.xyz;","#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif","}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;","void main() {","gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );","}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:["vec4 pack_depth( const in float depth ) {","const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","const vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","vec4 res = fract( depth * bit_shift );","res -= res.xxyz * bit_mask;","return res;","}","void main() {","gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","}"].join("\n")}},THREE.WebGLRenderer=function(e){function t(e){e.__webglVertexBuffer=xi.createBuffer(),e.__webglColorBuffer=xi.createBuffer(),Ot.info.memory.geometries++}function i(e){e.__webglVertexBuffer=xi.createBuffer(),e.__webglColorBuffer=xi.createBuffer(),e.__webglLineDistanceBuffer=xi.createBuffer(),Ot.info.memory.geometries++}function n(e){e.__webglVertexBuffer=xi.createBuffer(),e.__webglColorBuffer=xi.createBuffer(),e.__webglNormalBuffer=xi.createBuffer(),Ot.info.memory.geometries++}function r(e){e.__webglVertexBuffer=xi.createBuffer(),e.__webglNormalBuffer=xi.createBuffer(),e.__webglTangentBuffer=xi.createBuffer(),e.__webglColorBuffer=xi.createBuffer(),e.__webglUVBuffer=xi.createBuffer(),e.__webglUV2Buffer=xi.createBuffer(),e.__webglSkinIndicesBuffer=xi.createBuffer(),e.__webglSkinWeightsBuffer=xi.createBuffer(),e.__webglFaceBuffer=xi.createBuffer(),e.__webglLineBuffer=xi.createBuffer();var t,i;if(e.numMorphTargets)for(e.__webglMorphTargetsBuffers=[],t=0,i=e.numMorphTargets;i>t;t++)e.__webglMorphTargetsBuffers.push(xi.createBuffer());if(e.numMorphNormals)for(e.__webglMorphNormalsBuffers=[],t=0,i=e.numMorphNormals;i>t;t++)e.__webglMorphNormalsBuffers.push(xi.createBuffer());Ot.info.memory.geometries++}function o(e){if(e.__webglCustomAttributesList)for(var t in e.__webglCustomAttributesList)xi.deleteBuffer(e.__webglCustomAttributesList[t].buffer)}function a(e,t){var i=e.vertices.length,n=t.material;if(n.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var r in n.attributes){var o=n.attributes[r];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var a=1;"v2"===o.type?a=2:"v3"===o.type?a=3:"v4"===o.type?a=4:"c"===o.type&&(a=3),o.size=a,o.array=new Float32Array(i*a),o.buffer=xi.createBuffer(),o.buffer.belongsToAttribute=r,o.needsUpdate=!0}e.__webglCustomAttributesList.push(o)}}}function s(e,t){var i=e.vertices.length;e.__vertexArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__sortArray=[],e.__webglParticleCount=i,a(e,t)}function l(e,t){var i=e.vertices.length;e.__vertexArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__lineDistanceArray=new Float32Array(1*i),e.__webglLineCount=i,a(e,t)}function h(e,t){var i=e.vertices.length;e.__vertexArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__normalArray=new Float32Array(3*i),e.__webglVertexCount=i,a(e,t)}function c(e,t){var i=t.geometry,n=e.faces3,r=e.faces4,o=3*n.length+4*r.length,a=1*n.length+2*r.length,s=3*n.length+4*r.length,l=u(t,e),h=m(l),c=p(l),f=d(l);e.__vertexArray=new Float32Array(3*o),c&&(e.__normalArray=new Float32Array(3*o)),i.hasTangents&&(e.__tangentArray=new Float32Array(4*o)),f&&(e.__colorArray=new Float32Array(3*o)),h&&((i.faceUvs.length>0||i.faceVertexUvs.length>0)&&(e.__uvArray=new Float32Array(2*o)),(i.faceUvs.length>1||i.faceVertexUvs.length>1)&&(e.__uv2Array=new Float32Array(2*o))),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*o),e.__skinWeightArray=new Float32Array(4*o)),e.__faceArray=new Uint16Array(3*a),e.__lineArray=new Uint16Array(2*s);var g,v;if(e.numMorphTargets)for(e.__morphTargetsArrays=[],g=0,v=e.numMorphTargets;v>g;g++)e.__morphTargetsArrays.push(new Float32Array(3*o));if(e.numMorphNormals)for(e.__morphNormalsArrays=[],g=0,v=e.numMorphNormals;v>g;g++)e.__morphNormalsArrays.push(new Float32Array(3*o));if(e.__webglFaceCount=3*a,e.__webglLineCount=2*s,l.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var E in l.attributes){var y=l.attributes[E],T={};for(var x in y)T[x]=y[x];if(!T.__webglInitialized||T.createUniqueBuffers){T.__webglInitialized=!0;var b=1;"v2"===T.type?b=2:"v3"===T.type?b=3:"v4"===T.type?b=4:"c"===T.type&&(b=3),T.size=b,T.array=new Float32Array(o*b),T.buffer=xi.createBuffer(),T.buffer.belongsToAttribute=E,y.needsUpdate=!0,T.__original=y}e.__webglCustomAttributesList.push(T)}}e.__inittedArrays=!0}function u(e,t){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function f(e){return e&&void 0!==e.shading&&e.shading===THREE.SmoothShading}function p(e){return e instanceof THREE.MeshBasicMaterial&&!e.envMap||e instanceof THREE.MeshDepthMaterial?!1:f(e)?THREE.SmoothShading:THREE.FlatShading}function d(e){return e.vertexColors?e.vertexColors:!1}function m(e){return e.map||e.lightMap||e.bumpMap||e.normalMap||e.specularMap||e instanceof THREE.ShaderMaterial?!0:!1}function g(e){var t,i,n;for(t in e.attributes)n="index"===t?xi.ELEMENT_ARRAY_BUFFER:xi.ARRAY_BUFFER,i=e.attributes[t],i.buffer=xi.createBuffer(),xi.bindBuffer(n,i.buffer),xi.bufferData(n,i.array,xi.STATIC_DRAW)}function v(e,t,i){var n,r,o,a,s,l,h=e.vertices,c=h.length,u=e.colors,f=u.length,p=e.__vertexArray,d=e.__colorArray,m=e.__sortArray,g=e.verticesNeedUpdate,v=e.elementsNeedUpdate,E=e.colorsNeedUpdate,y=e.__webglCustomAttributesList,T,x,b,_,w,R,M;
if(i.sortParticles){for(gi.copy(mi),gi.multiply(i.matrixWorld),n=0;c>n;n++)o=h[n],vi.copy(o),vi.applyProjection(gi),m[n]=[vi.z,n];for(m.sort(H),n=0;c>n;n++)o=h[m[n][1]],a=3*n,p[a]=o.x,p[a+1]=o.y,p[a+2]=o.z;for(r=0;f>r;r++)a=3*r,l=u[m[r][1]],d[a]=l.r,d[a+1]=l.g,d[a+2]=l.b;if(y)for(T=0,x=y.length;x>T;T++)if(M=y[T],void 0===M.boundTo||"vertices"===M.boundTo)if(a=0,w=M.value.length,1===M.size)for(_=0;w>_;_++)s=m[_][1],M.array[_]=M.value[s];else if(2===M.size)for(_=0;w>_;_++)s=m[_][1],R=M.value[s],M.array[a]=R.x,M.array[a+1]=R.y,a+=2;else if(3===M.size)if("c"===M.type)for(_=0;w>_;_++)s=m[_][1],R=M.value[s],M.array[a]=R.r,M.array[a+1]=R.g,M.array[a+2]=R.b,a+=3;else for(_=0;w>_;_++)s=m[_][1],R=M.value[s],M.array[a]=R.x,M.array[a+1]=R.y,M.array[a+2]=R.z,a+=3;else if(4===M.size)for(_=0;w>_;_++)s=m[_][1],R=M.value[s],M.array[a]=R.x,M.array[a+1]=R.y,M.array[a+2]=R.z,M.array[a+3]=R.w,a+=4}else{if(g)for(n=0;c>n;n++)o=h[n],a=3*n,p[a]=o.x,p[a+1]=o.y,p[a+2]=o.z;if(E)for(r=0;f>r;r++)l=u[r],a=3*r,d[a]=l.r,d[a+1]=l.g,d[a+2]=l.b;if(y)for(T=0,x=y.length;x>T;T++)if(M=y[T],M.needsUpdate&&(void 0===M.boundTo||"vertices"===M.boundTo))if(w=M.value.length,a=0,1===M.size)for(_=0;w>_;_++)M.array[_]=M.value[_];else if(2===M.size)for(_=0;w>_;_++)R=M.value[_],M.array[a]=R.x,M.array[a+1]=R.y,a+=2;else if(3===M.size)if("c"===M.type)for(_=0;w>_;_++)R=M.value[_],M.array[a]=R.r,M.array[a+1]=R.g,M.array[a+2]=R.b,a+=3;else for(_=0;w>_;_++)R=M.value[_],M.array[a]=R.x,M.array[a+1]=R.y,M.array[a+2]=R.z,a+=3;else if(4===M.size)for(_=0;w>_;_++)R=M.value[_],M.array[a]=R.x,M.array[a+1]=R.y,M.array[a+2]=R.z,M.array[a+3]=R.w,a+=4}if((g||i.sortParticles)&&(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglVertexBuffer),xi.bufferData(xi.ARRAY_BUFFER,p,t)),(E||i.sortParticles)&&(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglColorBuffer),xi.bufferData(xi.ARRAY_BUFFER,d,t)),y)for(T=0,x=y.length;x>T;T++)M=y[T],(M.needsUpdate||i.sortParticles)&&(xi.bindBuffer(xi.ARRAY_BUFFER,M.buffer),xi.bufferData(xi.ARRAY_BUFFER,M.array,t))}function E(e,t){var i,n,r,o,a,s,l=e.vertices,h=e.colors,c=e.lineDistances,u=l.length,f=h.length,p=c.length,d=e.__vertexArray,m=e.__colorArray,g=e.__lineDistanceArray,v=e.verticesNeedUpdate,E=e.colorsNeedUpdate,y=e.lineDistancesNeedUpdate,T=e.__webglCustomAttributesList,x,b,_,w,R,H,M;if(v){for(i=0;u>i;i++)o=l[i],a=3*i,d[a]=o.x,d[a+1]=o.y,d[a+2]=o.z;xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglVertexBuffer),xi.bufferData(xi.ARRAY_BUFFER,d,t)}if(E){for(n=0;f>n;n++)s=h[n],a=3*n,m[a]=s.r,m[a+1]=s.g,m[a+2]=s.b;xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglColorBuffer),xi.bufferData(xi.ARRAY_BUFFER,m,t)}if(y){for(r=0;p>r;r++)g[r]=c[r];xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglLineDistanceBuffer),xi.bufferData(xi.ARRAY_BUFFER,g,t)}if(T)for(x=0,b=T.length;b>x;x++)if(M=T[x],M.needsUpdate&&(void 0===M.boundTo||"vertices"===M.boundTo)){if(a=0,R=M.value.length,1===M.size)for(w=0;R>w;w++)M.array[w]=M.value[w];else if(2===M.size)for(w=0;R>w;w++)H=M.value[w],M.array[a]=H.x,M.array[a+1]=H.y,a+=2;else if(3===M.size)if("c"===M.type)for(w=0;R>w;w++)H=M.value[w],M.array[a]=H.r,M.array[a+1]=H.g,M.array[a+2]=H.b,a+=3;else for(w=0;R>w;w++)H=M.value[w],M.array[a]=H.x,M.array[a+1]=H.y,M.array[a+2]=H.z,a+=3;else if(4===M.size)for(w=0;R>w;w++)H=M.value[w],M.array[a]=H.x,M.array[a+1]=H.y,M.array[a+2]=H.z,M.array[a+3]=H.w,a+=4;xi.bindBuffer(xi.ARRAY_BUFFER,M.buffer),xi.bufferData(xi.ARRAY_BUFFER,M.array,t)}}function y(e,t){var i,n,r,o,a,s,l,h,c,u,f,p,d,m=e.vertices,g=e.colors,v=e.normals,E=m.length,y=g.length,T=v.length,x=e.__vertexArray,b=e.__colorArray,_=e.__normalArray,w=e.verticesNeedUpdate,R=e.colorsNeedUpdate,H=e.normalsNeedUpdate,M=e.__webglCustomAttributesList;if(w){for(i=0;E>i;i++)o=m[i],a=3*i,x[a]=o.x,x[a+1]=o.y,x[a+2]=o.z;xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglVertexBuffer),xi.bufferData(xi.ARRAY_BUFFER,x,t)}if(R){for(n=0;y>n;n++)s=g[n],a=3*n,b[a]=s.r,b[a+1]=s.g,b[a+2]=s.b;xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglColorBuffer),xi.bufferData(xi.ARRAY_BUFFER,b,t)}if(H){for(r=0;T>r;r++)l=v[r],a=3*r,_[a]=l.x,_[a+1]=l.y,_[a+2]=l.z;xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglNormalBuffer),xi.bufferData(xi.ARRAY_BUFFER,_,t)}if(M)for(h=0,c=M.length;c>h;h++)if(p=M[h],p.needsUpdate&&(void 0===p.boundTo||"vertices"===p.boundTo)){if(a=0,f=p.value.length,1===p.size)for(u=0;f>u;u++)p.array[u]=p.value[u];else if(2===p.size)for(u=0;f>u;u++)d=p.value[u],p.array[a]=d.x,p.array[a+1]=d.y,a+=2;else if(3===p.size)if("c"===p.type)for(u=0;f>u;u++)d=p.value[u],p.array[a]=d.r,p.array[a+1]=d.g,p.array[a+2]=d.b,a+=3;else for(u=0;f>u;u++)d=p.value[u],p.array[a]=d.x,p.array[a+1]=d.y,p.array[a+2]=d.z,a+=3;else if(4===p.size)for(u=0;f>u;u++)d=p.value[u],p.array[a]=d.x,p.array[a+1]=d.y,p.array[a+2]=d.z,p.array[a+3]=d.w,a+=4;xi.bindBuffer(xi.ARRAY_BUFFER,p.buffer),xi.bufferData(xi.ARRAY_BUFFER,p.array,t)}}function T(e,t,i,n,r){if(e.__inittedArrays){var o=p(r),a=d(r),s=m(r),l=o===THREE.SmoothShading,h,c,u,f,g,v,E,y,T,x,b,_,w,R,H,M,S,C,A,D,k,P,L,N,z,F,I,O,U,V,B,W,j,G,q,X,Y,K,Q,Z,J,et,tt,it,nt,rt,ot,at,st,lt,ht,ct,ut,ft,pt,dt,mt,gt,vt=0,Et=0,yt=0,Tt=0,xt=0,bt=0,_t=0,wt=0,Rt=0,Ht=0,Mt=0,St=0,Ct=0,At,Dt=e.__vertexArray,kt=e.__uvArray,Pt=e.__uv2Array,Lt=e.__normalArray,Nt=e.__tangentArray,zt=e.__colorArray,Ft=e.__skinIndexArray,It=e.__skinWeightArray,Ot=e.__morphTargetsArrays,Ut=e.__morphNormalsArrays,Vt=e.__webglCustomAttributesList,Bt,Wt=e.__faceArray,jt=e.__lineArray,Gt=t.geometry,qt=Gt.verticesNeedUpdate,Xt=Gt.elementsNeedUpdate,Yt=Gt.uvsNeedUpdate,Kt=Gt.normalsNeedUpdate,Qt=Gt.tangentsNeedUpdate,$t=Gt.colorsNeedUpdate,Zt=Gt.morphTargetsNeedUpdate,Jt=Gt.vertices,ei=e.faces3,ti=e.faces4,ii=Gt.faces,ni=Gt.faceVertexUvs[0],ri=Gt.faceVertexUvs[1],oi=Gt.colors,ai=Gt.skinIndices,si=Gt.skinWeights,li=Gt.morphTargets,hi=Gt.morphNormals;if(qt){for(h=0,c=ei.length;c>h;h++)f=ii[ei[h]],w=Jt[f.a],R=Jt[f.b],H=Jt[f.c],Dt[Et]=w.x,Dt[Et+1]=w.y,Dt[Et+2]=w.z,Dt[Et+3]=R.x,Dt[Et+4]=R.y,Dt[Et+5]=R.z,Dt[Et+6]=H.x,Dt[Et+7]=H.y,Dt[Et+8]=H.z,Et+=9;for(h=0,c=ti.length;c>h;h++)f=ii[ti[h]],w=Jt[f.a],R=Jt[f.b],H=Jt[f.c],M=Jt[f.d],Dt[Et]=w.x,Dt[Et+1]=w.y,Dt[Et+2]=w.z,Dt[Et+3]=R.x,Dt[Et+4]=R.y,Dt[Et+5]=R.z,Dt[Et+6]=H.x,Dt[Et+7]=H.y,Dt[Et+8]=H.z,Dt[Et+9]=M.x,Dt[Et+10]=M.y,Dt[Et+11]=M.z,Et+=12;xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglVertexBuffer),xi.bufferData(xi.ARRAY_BUFFER,Dt,i)}if(Zt)for(ct=0,ut=li.length;ut>ct;ct++){for(Mt=0,h=0,c=ei.length;c>h;h++)dt=ei[h],f=ii[dt],w=li[ct].vertices[f.a],R=li[ct].vertices[f.b],H=li[ct].vertices[f.c],ft=Ot[ct],ft[Mt]=w.x,ft[Mt+1]=w.y,ft[Mt+2]=w.z,ft[Mt+3]=R.x,ft[Mt+4]=R.y,ft[Mt+5]=R.z,ft[Mt+6]=H.x,ft[Mt+7]=H.y,ft[Mt+8]=H.z,r.morphNormals&&(l?(mt=hi[ct].vertexNormals[dt],k=mt.a,P=mt.b,L=mt.c):(k=hi[ct].faceNormals[dt],P=k,L=k),pt=Ut[ct],pt[Mt]=k.x,pt[Mt+1]=k.y,pt[Mt+2]=k.z,pt[Mt+3]=P.x,pt[Mt+4]=P.y,pt[Mt+5]=P.z,pt[Mt+6]=L.x,pt[Mt+7]=L.y,pt[Mt+8]=L.z),Mt+=9;for(h=0,c=ti.length;c>h;h++)dt=ti[h],f=ii[dt],w=li[ct].vertices[f.a],R=li[ct].vertices[f.b],H=li[ct].vertices[f.c],M=li[ct].vertices[f.d],ft=Ot[ct],ft[Mt]=w.x,ft[Mt+1]=w.y,ft[Mt+2]=w.z,ft[Mt+3]=R.x,ft[Mt+4]=R.y,ft[Mt+5]=R.z,ft[Mt+6]=H.x,ft[Mt+7]=H.y,ft[Mt+8]=H.z,ft[Mt+9]=M.x,ft[Mt+10]=M.y,ft[Mt+11]=M.z,r.morphNormals&&(l?(mt=hi[ct].vertexNormals[dt],k=mt.a,P=mt.b,L=mt.c,N=mt.d):(k=hi[ct].faceNormals[dt],P=k,L=k,N=k),pt=Ut[ct],pt[Mt]=k.x,pt[Mt+1]=k.y,pt[Mt+2]=k.z,pt[Mt+3]=P.x,pt[Mt+4]=P.y,pt[Mt+5]=P.z,pt[Mt+6]=L.x,pt[Mt+7]=L.y,pt[Mt+8]=L.z,pt[Mt+9]=N.x,pt[Mt+10]=N.y,pt[Mt+11]=N.z),Mt+=12;xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[ct]),xi.bufferData(xi.ARRAY_BUFFER,Ot[ct],i),r.morphNormals&&(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[ct]),xi.bufferData(xi.ARRAY_BUFFER,Ut[ct],i))}if(si.length){for(h=0,c=ei.length;c>h;h++)f=ii[ei[h]],U=si[f.a],V=si[f.b],B=si[f.c],It[Ht]=U.x,It[Ht+1]=U.y,It[Ht+2]=U.z,It[Ht+3]=U.w,It[Ht+4]=V.x,It[Ht+5]=V.y,It[Ht+6]=V.z,It[Ht+7]=V.w,It[Ht+8]=B.x,It[Ht+9]=B.y,It[Ht+10]=B.z,It[Ht+11]=B.w,j=ai[f.a],G=ai[f.b],q=ai[f.c],Ft[Ht]=j.x,Ft[Ht+1]=j.y,Ft[Ht+2]=j.z,Ft[Ht+3]=j.w,Ft[Ht+4]=G.x,Ft[Ht+5]=G.y,Ft[Ht+6]=G.z,Ft[Ht+7]=G.w,Ft[Ht+8]=q.x,Ft[Ht+9]=q.y,Ft[Ht+10]=q.z,Ft[Ht+11]=q.w,Ht+=12;for(h=0,c=ti.length;c>h;h++)f=ii[ti[h]],U=si[f.a],V=si[f.b],B=si[f.c],W=si[f.d],It[Ht]=U.x,It[Ht+1]=U.y,It[Ht+2]=U.z,It[Ht+3]=U.w,It[Ht+4]=V.x,It[Ht+5]=V.y,It[Ht+6]=V.z,It[Ht+7]=V.w,It[Ht+8]=B.x,It[Ht+9]=B.y,It[Ht+10]=B.z,It[Ht+11]=B.w,It[Ht+12]=W.x,It[Ht+13]=W.y,It[Ht+14]=W.z,It[Ht+15]=W.w,j=ai[f.a],G=ai[f.b],q=ai[f.c],X=ai[f.d],Ft[Ht]=j.x,Ft[Ht+1]=j.y,Ft[Ht+2]=j.z,Ft[Ht+3]=j.w,Ft[Ht+4]=G.x,Ft[Ht+5]=G.y,Ft[Ht+6]=G.z,Ft[Ht+7]=G.w,Ft[Ht+8]=q.x,Ft[Ht+9]=q.y,Ft[Ht+10]=q.z,Ft[Ht+11]=q.w,Ft[Ht+12]=X.x,Ft[Ht+13]=X.y,Ft[Ht+14]=X.z,Ft[Ht+15]=X.w,Ht+=16;Ht>0&&(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglSkinIndicesBuffer),xi.bufferData(xi.ARRAY_BUFFER,Ft,i),xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),xi.bufferData(xi.ARRAY_BUFFER,It,i))}if($t&&a){for(h=0,c=ei.length;c>h;h++)f=ii[ei[h]],y=f.vertexColors,T=f.color,3===y.length&&a===THREE.VertexColors?(z=y[0],F=y[1],I=y[2]):(z=T,F=T,I=T),zt[Rt]=z.r,zt[Rt+1]=z.g,zt[Rt+2]=z.b,zt[Rt+3]=F.r,zt[Rt+4]=F.g,zt[Rt+5]=F.b,zt[Rt+6]=I.r,zt[Rt+7]=I.g,zt[Rt+8]=I.b,Rt+=9;for(h=0,c=ti.length;c>h;h++)f=ii[ti[h]],y=f.vertexColors,T=f.color,4===y.length&&a===THREE.VertexColors?(z=y[0],F=y[1],I=y[2],O=y[3]):(z=T,F=T,I=T,O=T),zt[Rt]=z.r,zt[Rt+1]=z.g,zt[Rt+2]=z.b,zt[Rt+3]=F.r,zt[Rt+4]=F.g,zt[Rt+5]=F.b,zt[Rt+6]=I.r,zt[Rt+7]=I.g,zt[Rt+8]=I.b,zt[Rt+9]=O.r,zt[Rt+10]=O.g,zt[Rt+11]=O.b,Rt+=12;Rt>0&&(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglColorBuffer),xi.bufferData(xi.ARRAY_BUFFER,zt,i))}if(Qt&&Gt.hasTangents){for(h=0,c=ei.length;c>h;h++)f=ii[ei[h]],x=f.vertexTangents,S=x[0],C=x[1],A=x[2],Nt[_t]=S.x,Nt[_t+1]=S.y,Nt[_t+2]=S.z,Nt[_t+3]=S.w,Nt[_t+4]=C.x,Nt[_t+5]=C.y,Nt[_t+6]=C.z,Nt[_t+7]=C.w,Nt[_t+8]=A.x,Nt[_t+9]=A.y,Nt[_t+10]=A.z,Nt[_t+11]=A.w,_t+=12;for(h=0,c=ti.length;c>h;h++)f=ii[ti[h]],x=f.vertexTangents,S=x[0],C=x[1],A=x[2],D=x[3],Nt[_t]=S.x,Nt[_t+1]=S.y,Nt[_t+2]=S.z,Nt[_t+3]=S.w,Nt[_t+4]=C.x,Nt[_t+5]=C.y,Nt[_t+6]=C.z,Nt[_t+7]=C.w,Nt[_t+8]=A.x,Nt[_t+9]=A.y,Nt[_t+10]=A.z,Nt[_t+11]=A.w,Nt[_t+12]=D.x,Nt[_t+13]=D.y,Nt[_t+14]=D.z,Nt[_t+15]=D.w,_t+=16;xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglTangentBuffer),xi.bufferData(xi.ARRAY_BUFFER,Nt,i)}if(Kt&&o){for(h=0,c=ei.length;c>h;h++)if(f=ii[ei[h]],g=f.vertexNormals,v=f.normal,3===g.length&&l)for(ot=0;3>ot;ot++)st=g[ot],Lt[bt]=st.x,Lt[bt+1]=st.y,Lt[bt+2]=st.z,bt+=3;else for(ot=0;3>ot;ot++)Lt[bt]=v.x,Lt[bt+1]=v.y,Lt[bt+2]=v.z,bt+=3;for(h=0,c=ti.length;c>h;h++)if(f=ii[ti[h]],g=f.vertexNormals,v=f.normal,4===g.length&&l)for(ot=0;4>ot;ot++)st=g[ot],Lt[bt]=st.x,Lt[bt+1]=st.y,Lt[bt+2]=st.z,bt+=3;else for(ot=0;4>ot;ot++)Lt[bt]=v.x,Lt[bt+1]=v.y,Lt[bt+2]=v.z,bt+=3;xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglNormalBuffer),xi.bufferData(xi.ARRAY_BUFFER,Lt,i)}if(Yt&&ni&&s){for(h=0,c=ei.length;c>h;h++)if(u=ei[h],b=ni[u],void 0!==b)for(ot=0;3>ot;ot++)lt=b[ot],kt[yt]=lt.x,kt[yt+1]=lt.y,yt+=2;for(h=0,c=ti.length;c>h;h++)if(u=ti[h],b=ni[u],void 0!==b)for(ot=0;4>ot;ot++)lt=b[ot],kt[yt]=lt.x,kt[yt+1]=lt.y,yt+=2;yt>0&&(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglUVBuffer),xi.bufferData(xi.ARRAY_BUFFER,kt,i))}if(Yt&&ri&&s){for(h=0,c=ei.length;c>h;h++)if(u=ei[h],_=ri[u],void 0!==_)for(ot=0;3>ot;ot++)ht=_[ot],Pt[Tt]=ht.x,Pt[Tt+1]=ht.y,Tt+=2;for(h=0,c=ti.length;c>h;h++)if(u=ti[h],_=ri[u],void 0!==_)for(ot=0;4>ot;ot++)ht=_[ot],Pt[Tt]=ht.x,Pt[Tt+1]=ht.y,Tt+=2;Tt>0&&(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglUV2Buffer),xi.bufferData(xi.ARRAY_BUFFER,Pt,i))}if(Xt){for(h=0,c=ei.length;c>h;h++)Wt[xt]=vt,Wt[xt+1]=vt+1,Wt[xt+2]=vt+2,xt+=3,jt[wt]=vt,jt[wt+1]=vt+1,jt[wt+2]=vt,jt[wt+3]=vt+2,jt[wt+4]=vt+1,jt[wt+5]=vt+2,wt+=6,vt+=3;for(h=0,c=ti.length;c>h;h++)Wt[xt]=vt,Wt[xt+1]=vt+1,Wt[xt+2]=vt+3,Wt[xt+3]=vt+1,Wt[xt+4]=vt+2,Wt[xt+5]=vt+3,xt+=6,jt[wt]=vt,jt[wt+1]=vt+1,jt[wt+2]=vt,jt[wt+3]=vt+3,jt[wt+4]=vt+1,jt[wt+5]=vt+2,jt[wt+6]=vt+2,jt[wt+7]=vt+3,wt+=8,vt+=4;xi.bindBuffer(xi.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),xi.bufferData(xi.ELEMENT_ARRAY_BUFFER,Wt,i),xi.bindBuffer(xi.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),xi.bufferData(xi.ELEMENT_ARRAY_BUFFER,jt,i)}if(Vt)for(ot=0,at=Vt.length;at>ot;ot++)if(Bt=Vt[ot],Bt.__original.needsUpdate){if(St=0,Ct=0,1===Bt.size){if(void 0===Bt.boundTo||"vertices"===Bt.boundTo){for(h=0,c=ei.length;c>h;h++)f=ii[ei[h]],Bt.array[St]=Bt.value[f.a],Bt.array[St+1]=Bt.value[f.b],Bt.array[St+2]=Bt.value[f.c],St+=3;for(h=0,c=ti.length;c>h;h++)f=ii[ti[h]],Bt.array[St]=Bt.value[f.a],Bt.array[St+1]=Bt.value[f.b],Bt.array[St+2]=Bt.value[f.c],Bt.array[St+3]=Bt.value[f.d],St+=4}else if("faces"===Bt.boundTo){for(h=0,c=ei.length;c>h;h++)At=Bt.value[ei[h]],Bt.array[St]=At,Bt.array[St+1]=At,Bt.array[St+2]=At,St+=3;for(h=0,c=ti.length;c>h;h++)At=Bt.value[ti[h]],Bt.array[St]=At,Bt.array[St+1]=At,Bt.array[St+2]=At,Bt.array[St+3]=At,St+=4}}else if(2===Bt.size){if(void 0===Bt.boundTo||"vertices"===Bt.boundTo){for(h=0,c=ei.length;c>h;h++)f=ii[ei[h]],w=Bt.value[f.a],R=Bt.value[f.b],H=Bt.value[f.c],Bt.array[St]=w.x,Bt.array[St+1]=w.y,Bt.array[St+2]=R.x,Bt.array[St+3]=R.y,Bt.array[St+4]=H.x,Bt.array[St+5]=H.y,St+=6;for(h=0,c=ti.length;c>h;h++)f=ii[ti[h]],w=Bt.value[f.a],R=Bt.value[f.b],H=Bt.value[f.c],M=Bt.value[f.d],Bt.array[St]=w.x,Bt.array[St+1]=w.y,Bt.array[St+2]=R.x,Bt.array[St+3]=R.y,Bt.array[St+4]=H.x,Bt.array[St+5]=H.y,Bt.array[St+6]=M.x,Bt.array[St+7]=M.y,St+=8}else if("faces"===Bt.boundTo){for(h=0,c=ei.length;c>h;h++)At=Bt.value[ei[h]],w=At,R=At,H=At,Bt.array[St]=w.x,Bt.array[St+1]=w.y,Bt.array[St+2]=R.x,Bt.array[St+3]=R.y,Bt.array[St+4]=H.x,Bt.array[St+5]=H.y,St+=6;for(h=0,c=ti.length;c>h;h++)At=Bt.value[ti[h]],w=At,R=At,H=At,M=At,Bt.array[St]=w.x,Bt.array[St+1]=w.y,Bt.array[St+2]=R.x,Bt.array[St+3]=R.y,Bt.array[St+4]=H.x,Bt.array[St+5]=H.y,Bt.array[St+6]=M.x,Bt.array[St+7]=M.y,St+=8}}else if(3===Bt.size){var ci;if(ci="c"===Bt.type?["r","g","b"]:["x","y","z"],void 0===Bt.boundTo||"vertices"===Bt.boundTo){for(h=0,c=ei.length;c>h;h++)f=ii[ei[h]],w=Bt.value[f.a],R=Bt.value[f.b],H=Bt.value[f.c],Bt.array[St]=w[ci[0]],Bt.array[St+1]=w[ci[1]],Bt.array[St+2]=w[ci[2]],Bt.array[St+3]=R[ci[0]],Bt.array[St+4]=R[ci[1]],Bt.array[St+5]=R[ci[2]],Bt.array[St+6]=H[ci[0]],Bt.array[St+7]=H[ci[1]],Bt.array[St+8]=H[ci[2]],St+=9;for(h=0,c=ti.length;c>h;h++)f=ii[ti[h]],w=Bt.value[f.a],R=Bt.value[f.b],H=Bt.value[f.c],M=Bt.value[f.d],Bt.array[St]=w[ci[0]],Bt.array[St+1]=w[ci[1]],Bt.array[St+2]=w[ci[2]],Bt.array[St+3]=R[ci[0]],Bt.array[St+4]=R[ci[1]],Bt.array[St+5]=R[ci[2]],Bt.array[St+6]=H[ci[0]],Bt.array[St+7]=H[ci[1]],Bt.array[St+8]=H[ci[2]],Bt.array[St+9]=M[ci[0]],Bt.array[St+10]=M[ci[1]],Bt.array[St+11]=M[ci[2]],St+=12}else if("faces"===Bt.boundTo){for(h=0,c=ei.length;c>h;h++)At=Bt.value[ei[h]],w=At,R=At,H=At,Bt.array[St]=w[ci[0]],Bt.array[St+1]=w[ci[1]],Bt.array[St+2]=w[ci[2]],Bt.array[St+3]=R[ci[0]],Bt.array[St+4]=R[ci[1]],Bt.array[St+5]=R[ci[2]],Bt.array[St+6]=H[ci[0]],Bt.array[St+7]=H[ci[1]],Bt.array[St+8]=H[ci[2]],St+=9;for(h=0,c=ti.length;c>h;h++)At=Bt.value[ti[h]],w=At,R=At,H=At,M=At,Bt.array[St]=w[ci[0]],Bt.array[St+1]=w[ci[1]],Bt.array[St+2]=w[ci[2]],Bt.array[St+3]=R[ci[0]],Bt.array[St+4]=R[ci[1]],Bt.array[St+5]=R[ci[2]],Bt.array[St+6]=H[ci[0]],Bt.array[St+7]=H[ci[1]],Bt.array[St+8]=H[ci[2]],Bt.array[St+9]=M[ci[0]],Bt.array[St+10]=M[ci[1]],Bt.array[St+11]=M[ci[2]],St+=12}else if("faceVertices"===Bt.boundTo){for(h=0,c=ei.length;c>h;h++)At=Bt.value[ei[h]],w=At[0],R=At[1],H=At[2],Bt.array[St]=w[ci[0]],Bt.array[St+1]=w[ci[1]],Bt.array[St+2]=w[ci[2]],Bt.array[St+3]=R[ci[0]],Bt.array[St+4]=R[ci[1]],Bt.array[St+5]=R[ci[2]],Bt.array[St+6]=H[ci[0]],Bt.array[St+7]=H[ci[1]],Bt.array[St+8]=H[ci[2]],St+=9;for(h=0,c=ti.length;c>h;h++)At=Bt.value[ti[h]],w=At[0],R=At[1],H=At[2],M=At[3],Bt.array[St]=w[ci[0]],Bt.array[St+1]=w[ci[1]],Bt.array[St+2]=w[ci[2]],Bt.array[St+3]=R[ci[0]],Bt.array[St+4]=R[ci[1]],Bt.array[St+5]=R[ci[2]],Bt.array[St+6]=H[ci[0]],Bt.array[St+7]=H[ci[1]],Bt.array[St+8]=H[ci[2]],Bt.array[St+9]=M[ci[0]],Bt.array[St+10]=M[ci[1]],Bt.array[St+11]=M[ci[2]],St+=12}}else if(4===Bt.size)if(void 0===Bt.boundTo||"vertices"===Bt.boundTo){for(h=0,c=ei.length;c>h;h++)f=ii[ei[h]],w=Bt.value[f.a],R=Bt.value[f.b],H=Bt.value[f.c],Bt.array[St]=w.x,Bt.array[St+1]=w.y,Bt.array[St+2]=w.z,Bt.array[St+3]=w.w,Bt.array[St+4]=R.x,Bt.array[St+5]=R.y,Bt.array[St+6]=R.z,Bt.array[St+7]=R.w,Bt.array[St+8]=H.x,Bt.array[St+9]=H.y,Bt.array[St+10]=H.z,Bt.array[St+11]=H.w,St+=12;for(h=0,c=ti.length;c>h;h++)f=ii[ti[h]],w=Bt.value[f.a],R=Bt.value[f.b],H=Bt.value[f.c],M=Bt.value[f.d],Bt.array[St]=w.x,Bt.array[St+1]=w.y,Bt.array[St+2]=w.z,Bt.array[St+3]=w.w,Bt.array[St+4]=R.x,Bt.array[St+5]=R.y,Bt.array[St+6]=R.z,Bt.array[St+7]=R.w,Bt.array[St+8]=H.x,Bt.array[St+9]=H.y,Bt.array[St+10]=H.z,Bt.array[St+11]=H.w,Bt.array[St+12]=M.x,Bt.array[St+13]=M.y,Bt.array[St+14]=M.z,Bt.array[St+15]=M.w,St+=16}else if("faces"===Bt.boundTo){for(h=0,c=ei.length;c>h;h++)At=Bt.value[ei[h]],w=At,R=At,H=At,Bt.array[St]=w.x,Bt.array[St+1]=w.y,Bt.array[St+2]=w.z,Bt.array[St+3]=w.w,Bt.array[St+4]=R.x,Bt.array[St+5]=R.y,Bt.array[St+6]=R.z,Bt.array[St+7]=R.w,Bt.array[St+8]=H.x,Bt.array[St+9]=H.y,Bt.array[St+10]=H.z,Bt.array[St+11]=H.w,St+=12;for(h=0,c=ti.length;c>h;h++)At=Bt.value[ti[h]],w=At,R=At,H=At,M=At,Bt.array[St]=w.x,Bt.array[St+1]=w.y,Bt.array[St+2]=w.z,Bt.array[St+3]=w.w,Bt.array[St+4]=R.x,Bt.array[St+5]=R.y,Bt.array[St+6]=R.z,Bt.array[St+7]=R.w,Bt.array[St+8]=H.x,Bt.array[St+9]=H.y,Bt.array[St+10]=H.z,Bt.array[St+11]=H.w,Bt.array[St+12]=M.x,Bt.array[St+13]=M.y,Bt.array[St+14]=M.z,Bt.array[St+15]=M.w,St+=16}else if("faceVertices"===Bt.boundTo){for(h=0,c=ei.length;c>h;h++)At=Bt.value[ei[h]],w=At[0],R=At[1],H=At[2],Bt.array[St]=w.x,Bt.array[St+1]=w.y,Bt.array[St+2]=w.z,Bt.array[St+3]=w.w,Bt.array[St+4]=R.x,Bt.array[St+5]=R.y,Bt.array[St+6]=R.z,Bt.array[St+7]=R.w,Bt.array[St+8]=H.x,Bt.array[St+9]=H.y,Bt.array[St+10]=H.z,Bt.array[St+11]=H.w,St+=12;for(h=0,c=ti.length;c>h;h++)At=Bt.value[ti[h]],w=At[0],R=At[1],H=At[2],M=At[3],Bt.array[St]=w.x,Bt.array[St+1]=w.y,Bt.array[St+2]=w.z,Bt.array[St+3]=w.w,Bt.array[St+4]=R.x,Bt.array[St+5]=R.y,Bt.array[St+6]=R.z,Bt.array[St+7]=R.w,Bt.array[St+8]=H.x,Bt.array[St+9]=H.y,Bt.array[St+10]=H.z,Bt.array[St+11]=H.w,Bt.array[St+12]=M.x,Bt.array[St+13]=M.y,Bt.array[St+14]=M.z,Bt.array[St+15]=M.w,St+=16}xi.bindBuffer(xi.ARRAY_BUFFER,Bt.buffer),xi.bufferData(xi.ARRAY_BUFFER,Bt.array,i)}n&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function x(e,t,i){var n=e.attributes,r,o;for(r in n)o=n[r],o.needsUpdate&&("index"===r?(xi.bindBuffer(xi.ELEMENT_ARRAY_BUFFER,o.buffer),xi.bufferData(xi.ELEMENT_ARRAY_BUFFER,o.array,t)):(xi.bindBuffer(xi.ARRAY_BUFFER,o.buffer),xi.bufferData(xi.ARRAY_BUFFER,o.array,t)),o.needsUpdate=!1),i&&!o.dynamic&&delete o.array}function b(e){pi[e]||(xi.enableVertexAttribArray(e),pi[e]=!0)}function _(){for(var e in pi)pi[e]&&(xi.disableVertexAttribArray(e),pi[e]=!1)}function w(e,t,i){var n=e.program.attributes;if(-1!==i.morphTargetBase&&n.position>=0?(xi.bindBuffer(xi.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[i.morphTargetBase]),b(n.position),xi.vertexAttribPointer(n.position,3,xi.FLOAT,!1,0,0)):n.position>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,t.__webglVertexBuffer),b(n.position),xi.vertexAttribPointer(n.position,3,xi.FLOAT,!1,0,0)),i.morphTargetForcedOrder.length)for(var r=0,o=i.morphTargetForcedOrder,a=i.morphTargetInfluences;r<e.numSupportedMorphTargets&&r<o.length;)n["morphTarget"+r]>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[o[r]]),b(n["morphTarget"+r]),xi.vertexAttribPointer(n["morphTarget"+r],3,xi.FLOAT,!1,0,0)),n["morphNormal"+r]>=0&&e.morphNormals&&(xi.bindBuffer(xi.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[o[r]]),b(n["morphNormal"+r]),xi.vertexAttribPointer(n["morphNormal"+r],3,xi.FLOAT,!1,0,0)),i.__webglMorphTargetInfluences[r]=a[o[r]],r++;else{var s,l=[],a=i.morphTargetInfluences,h,c=a.length;for(h=0;c>h;h++)s=a[h],s>0&&l.push([s,h]);l.length>e.numSupportedMorphTargets?(l.sort(H),l.length=e.numSupportedMorphTargets):l.length>e.numSupportedMorphNormals?l.sort(H):0===l.length&&l.push([0,0]);for(var u,r=0;r<e.numSupportedMorphTargets;)l[r]?(u=l[r][1],n["morphTarget"+r]>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[u]),b(n["morphTarget"+r]),xi.vertexAttribPointer(n["morphTarget"+r],3,xi.FLOAT,!1,0,0)),n["morphNormal"+r]>=0&&e.morphNormals&&(xi.bindBuffer(xi.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[u]),b(n["morphNormal"+r]),xi.vertexAttribPointer(n["morphNormal"+r],3,xi.FLOAT,!1,0,0)),i.__webglMorphTargetInfluences[r]=a[u]):i.__webglMorphTargetInfluences[r]=0,r++}null!==e.program.uniforms.morphTargetInfluences&&xi.uniform1fv(e.program.uniforms.morphTargetInfluences,i.__webglMorphTargetInfluences)}function R(e,t){return e.z!==t.z?t.z-e.z:e.id-t.id}function H(e,t){return t[0]-e[0]}function M(e,t,i){if(e.length)for(var n=0,r=e.length;r>n;n++)Bt=null,qt=null,$t=-1,ti=-1,ii=-1,Kt=-1,Qt=-1,Gt=-1,jt=-1,yi=!0,e[n].render(t,i,ui,fi),Bt=null,qt=null,$t=-1,ti=-1,ii=-1,Kt=-1,Qt=-1,Gt=-1,jt=-1,yi=!0}function S(e,t,i,n,r,o,a,s){var l,h,c,u,f,p,d;t?(f=e.length-1,p=-1,d=-1):(f=0,p=e.length,d=1);for(var m=f;m!==p;m+=d)if(l=e[m],l.render){if(h=l.object,c=l.buffer,s)u=s;else{if(u=l[i],!u)continue;a&&Ot.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst),Ot.setDepthTest(u.depthTest),Ot.setDepthWrite(u.depthWrite),lt(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits)}Ot.setMaterialFaces(u),c instanceof THREE.BufferGeometry?Ot.renderBufferDirect(n,r,o,u,c,h):Ot.renderBuffer(n,r,o,u,c,h)}}function C(e,t,i,n,r,o,a){for(var s,l,h,c,u=0,f=e.length;f>u;u++)if(s=e[u],l=s.object,l.visible){if(a)h=a;else{if(h=s[t],!h)continue;o&&Ot.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst),Ot.setDepthTest(h.depthTest),Ot.setDepthWrite(h.depthWrite),lt(h.polygonOffset,h.polygonOffsetFactor,h.polygonOffsetUnits)}Ot.renderImmediateObject(i,n,r,h,l)}}function A(e){var t=e.object,i=t.material;i.transparent?(e.transparent=i,e.opaque=null):(e.opaque=i,e.transparent=null)}function D(e){var t=e.object,i=e.buffer,n,r,o;o=t.material,o instanceof THREE.MeshFaceMaterial?(r=i.materialIndex,n=o.materials[r],n.transparent?(e.transparent=n,e.opaque=null):(e.opaque=n,e.transparent=null)):(n=o,n&&(n.transparent?(e.transparent=n,e.opaque=null):(e.opaque=n,e.transparent=null)))}function k(e,t){var i,n,r,o,a,s,l={},h=e.morphTargets.length,c=e.morphNormals.length,u=t instanceof THREE.MeshFaceMaterial;for(e.geometryGroups={},i=0,n=e.faces.length;n>i;i++)r=e.faces[i],o=u?r.materialIndex:0,void 0===l[o]&&(l[o]={hash:o,counter:0}),s=l[o].hash+"_"+l[o].counter,void 0===e.geometryGroups[s]&&(e.geometryGroups[s]={faces3:[],faces4:[],materialIndex:o,vertices:0,numMorphTargets:h,numMorphNormals:c}),a=r instanceof THREE.Face3?3:4,e.geometryGroups[s].vertices+a>65535&&(l[o].counter+=1,s=l[o].hash+"_"+l[o].counter,void 0===e.geometryGroups[s]&&(e.geometryGroups[s]={faces3:[],faces4:[],materialIndex:o,vertices:0,numMorphTargets:h,numMorphNormals:c})),r instanceof THREE.Face3?e.geometryGroups[s].faces3.push(i):e.geometryGroups[s].faces4.push(i),e.geometryGroups[s].vertices+=a;e.geometryGroupsList=[];for(var f in e.geometryGroups)e.geometryGroups[f].id=Xt++,e.geometryGroupsList.push(e.geometryGroups[f])}function P(e,o){var a,u,f,p;if(void 0===e.__webglInit)if(e.__webglInit=!0,e._modelViewMatrix=new THREE.Matrix4,e._normalMatrix=new THREE.Matrix3,void 0!==e.geometry&&void 0===e.geometry.__webglInit&&(e.geometry.__webglInit=!0,e.geometry.addEventListener("dispose",Yi)),u=e.geometry,void 0===u);else if(u instanceof THREE.BufferGeometry)g(u);else if(e instanceof THREE.Mesh){f=e.material,void 0===u.geometryGroups&&k(u,f);for(a in u.geometryGroups)p=u.geometryGroups[a],p.__webglVertexBuffer||(r(p),c(p,e),u.verticesNeedUpdate=!0,u.morphTargetsNeedUpdate=!0,u.elementsNeedUpdate=!0,u.uvsNeedUpdate=!0,u.normalsNeedUpdate=!0,u.tangentsNeedUpdate=!0,u.colorsNeedUpdate=!0)}else e instanceof THREE.Ribbon?u.__webglVertexBuffer||(n(u),h(u,e),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0,u.normalsNeedUpdate=!0):e instanceof THREE.Line?u.__webglVertexBuffer||(i(u),l(u,e),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0,u.lineDistancesNeedUpdate=!0):e instanceof THREE.ParticleSystem&&(u.__webglVertexBuffer||(t(u),s(u,e),u.verticesNeedUpdate=!0,u.colorsNeedUpdate=!0));if(void 0===e.__webglActive){if(e instanceof THREE.Mesh){if(u=e.geometry,u instanceof THREE.BufferGeometry)L(o.__webglObjects,u,e);else if(u instanceof THREE.Geometry)for(a in u.geometryGroups)p=u.geometryGroups[a],L(o.__webglObjects,p,e)}else e instanceof THREE.Ribbon||e instanceof THREE.Line||e instanceof THREE.ParticleSystem?(u=e.geometry,L(o.__webglObjects,u,e)):e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback?N(o.__webglObjectsImmediate,e):e instanceof THREE.Sprite?o.__webglSprites.push(e):e instanceof THREE.LensFlare&&o.__webglFlares.push(e);e.__webglActive=!0}}function L(e,t,i){e.push({buffer:t,object:i,opaque:null,transparent:null})}function N(e,t){e.push({object:t,opaque:null,transparent:null})}function z(e){var t=e.geometry,i,n,r;if(t instanceof THREE.BufferGeometry)x(t,xi.DYNAMIC_DRAW,!t.dynamic);else if(e instanceof THREE.Mesh){for(var o=0,a=t.geometryGroupsList.length;a>o;o++)i=t.geometryGroupsList[o],r=u(e,i),t.buffersNeedUpdate&&c(i,e),n=r.attributes&&F(r),(t.verticesNeedUpdate||t.morphTargetsNeedUpdate||t.elementsNeedUpdate||t.uvsNeedUpdate||t.normalsNeedUpdate||t.colorsNeedUpdate||t.tangentsNeedUpdate||n)&&T(i,e,xi.DYNAMIC_DRAW,!t.dynamic,r);t.verticesNeedUpdate=!1,t.morphTargetsNeedUpdate=!1,t.elementsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.tangentsNeedUpdate=!1,t.buffersNeedUpdate=!1,r.attributes&&I(r)}else e instanceof THREE.Ribbon?(r=u(e,t),n=r.attributes&&F(r),(t.verticesNeedUpdate||t.colorsNeedUpdate||t.normalsNeedUpdate||n)&&y(t,xi.DYNAMIC_DRAW),t.verticesNeedUpdate=!1,t.colorsNeedUpdate=!1,t.normalsNeedUpdate=!1,r.attributes&&I(r)):e instanceof THREE.Line?(r=u(e,t),n=r.attributes&&F(r),(t.verticesNeedUpdate||t.colorsNeedUpdate||t.lineDistancesNeedUpdate||n)&&E(t,xi.DYNAMIC_DRAW),t.verticesNeedUpdate=!1,t.colorsNeedUpdate=!1,t.lineDistancesNeedUpdate=!1,r.attributes&&I(r)):e instanceof THREE.ParticleSystem&&(r=u(e,t),n=r.attributes&&F(r),(t.verticesNeedUpdate||t.colorsNeedUpdate||e.sortParticles||n)&&v(t,xi.DYNAMIC_DRAW,e),t.verticesNeedUpdate=!1,t.colorsNeedUpdate=!1,r.attributes&&I(r))}function F(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function I(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function O(e,t){e instanceof THREE.Mesh||e instanceof THREE.ParticleSystem||e instanceof THREE.Ribbon||e instanceof THREE.Line?U(t.__webglObjects,e):e instanceof THREE.Sprite?V(t.__webglSprites,e):e instanceof THREE.LensFlare?V(t.__webglFlares,e):(e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback)&&U(t.__webglObjectsImmediate,e),delete e.__webglActive}function U(e,t){for(var i=e.length-1;i>=0;i--)e[i].object===t&&e.splice(i,1)}function V(e,t){for(var i=e.length-1;i>=0;i--)e[i]===t&&e.splice(i,1)}function B(e,t){e.uniforms=THREE.UniformsUtils.clone(t.uniforms),e.vertexShader=t.vertexShader,e.fragmentShader=t.fragmentShader}function W(e,t,i,n,r){Yt=0,n.needsUpdate&&(n.program&&tn(n),Ot.initMaterial(n,t,i,r),n.needsUpdate=!1),n.morphTargets&&(r.__webglMorphTargetInfluences||(r.__webglMorphTargetInfluences=new Float32Array(Ot.maxMorphTargets)));var o=!1,a=n.program,s=a.uniforms,l=n.uniforms;if(a!==Bt&&(xi.useProgram(a),Bt=a,o=!0),n.id!==jt&&(jt=n.id,o=!0),(o||e!==qt)&&(xi.uniformMatrix4fv(s.projectionMatrix,!1,e.projectionMatrix.elements),e!==qt&&(qt=e)),n.skinning)if(ki&&r.useVertexTexture){if(null!==s.boneTexture){var h=tt();xi.uniform1i(s.boneTexture,h),Ot.setTexture(r.boneTexture,h)}}else null!==s.boneGlobalMatrices&&xi.uniformMatrix4fv(s.boneGlobalMatrices,!1,r.boneMatrices);return o&&(i&&n.fog&&Y(l,i),(n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n.lights)&&(yi&&(at(a,t),yi=!1),Z(l,Ti)),(n instanceof THREE.MeshBasicMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.MeshPhongMaterial)&&j(l,n),n instanceof THREE.LineBasicMaterial?G(l,n):n instanceof THREE.LineDashedMaterial?(G(l,n),q(l,n)):n instanceof THREE.ParticleBasicMaterial?X(l,n):n instanceof THREE.MeshPhongMaterial?K(l,n):n instanceof THREE.MeshLambertMaterial?Q(l,n):n instanceof THREE.MeshDepthMaterial?(l.mNear.value=e.near,l.mFar.value=e.far,l.opacity.value=n.opacity):n instanceof THREE.MeshNormalMaterial&&(l.opacity.value=n.opacity),r.receiveShadow&&!n._shadowPass&&J(l,t),it(a,n.uniformsList),(n instanceof THREE.ShaderMaterial||n instanceof THREE.MeshPhongMaterial||n.envMap)&&null!==s.cameraPosition&&(vi.getPositionFromMatrix(e.matrixWorld),xi.uniform3f(s.cameraPosition,vi.x,vi.y,vi.z)),(n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.ShaderMaterial||n.skinning)&&null!==s.viewMatrix&&xi.uniformMatrix4fv(s.viewMatrix,!1,e.matrixWorldInverse.elements)),et(s,r),null!==s.modelMatrix&&xi.uniformMatrix4fv(s.modelMatrix,!1,r.matrixWorld.elements),a}function j(e,t){e.opacity.value=t.opacity,Ot.gammaInput?e.diffuse.value.copyGammaToLinear(t.color):e.diffuse.value=t.color,e.map.value=t.map,e.lightMap.value=t.lightMap,e.specularMap.value=t.specularMap,t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));var i;if(t.map?i=t.map:t.specularMap?i=t.specularMap:t.normalMap?i=t.normalMap:t.bumpMap&&(i=t.bumpMap),void 0!==i){var n=i.offset,r=i.repeat;e.offsetRepeat.value.set(n.x,n.y,r.x,r.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,e.reflectivity.value=Ot.gammaInput?t.reflectivity:t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.combine.value=t.combine,e.useRefract.value=t.envMap&&t.envMap.mapping instanceof THREE.CubeRefractionMapping}function G(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function q(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function X(e,t){e.psColor.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size,e.scale.value=At.height/2,e.map.value=t.map}function Y(e,t){e.fogColor.value=t.color,t instanceof THREE.Fog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t instanceof THREE.FogExp2&&(e.fogDensity.value=t.density)}function K(e,t){e.shininess.value=t.shininess,Ot.gammaInput?(e.ambient.value.copyGammaToLinear(t.ambient),e.emissive.value.copyGammaToLinear(t.emissive),e.specular.value.copyGammaToLinear(t.specular)):(e.ambient.value=t.ambient,e.emissive.value=t.emissive,e.specular.value=t.specular),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function Q(e,t){Ot.gammaInput?(e.ambient.value.copyGammaToLinear(t.ambient),e.emissive.value.copyGammaToLinear(t.emissive)):(e.ambient.value=t.ambient,e.emissive.value=t.emissive),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function Z(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}function J(e,t){if(e.shadowMatrix)for(var i=0,n=0,r=t.length;r>n;n++){var o=t[n];o.castShadow&&(o instanceof THREE.SpotLight||o instanceof THREE.DirectionalLight&&!o.shadowCascade)&&(e.shadowMap.value[i]=o.shadowMap,e.shadowMapSize.value[i]=o.shadowMapSize,e.shadowMatrix.value[i]=o.shadowMatrix,e.shadowDarkness.value[i]=o.shadowDarkness,e.shadowBias.value[i]=o.shadowBias,i++)
}}function et(e,t){xi.uniformMatrix4fv(e.modelViewMatrix,!1,t._modelViewMatrix.elements),e.normalMatrix&&xi.uniformMatrix3fv(e.normalMatrix,!1,t._normalMatrix.elements)}function tt(){var e=Yt;return e>=Hi&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+Hi),Yt+=1,e}function it(e,t){var i,n,r,o,a,s,l,h,c,u,f;for(c=0,u=t.length;u>c;c++)if(o=e.uniforms[t[c][1]])if(i=t[c][0],r=i.type,n=i.value,"i"===r)xi.uniform1i(o,n);else if("f"===r)xi.uniform1f(o,n);else if("v2"===r)xi.uniform2f(o,n.x,n.y);else if("v3"===r)xi.uniform3f(o,n.x,n.y,n.z);else if("v4"===r)xi.uniform4f(o,n.x,n.y,n.z,n.w);else if("c"===r)xi.uniform3f(o,n.r,n.g,n.b);else if("iv1"===r)xi.uniform1iv(o,n);else if("iv"===r)xi.uniform3iv(o,n);else if("fv1"===r)xi.uniform1fv(o,n);else if("fv"===r)xi.uniform3fv(o,n);else if("v2v"===r){for(void 0===i._array&&(i._array=new Float32Array(2*n.length)),l=0,h=n.length;h>l;l++)f=2*l,i._array[f]=n[l].x,i._array[f+1]=n[l].y;xi.uniform2fv(o,i._array)}else if("v3v"===r){for(void 0===i._array&&(i._array=new Float32Array(3*n.length)),l=0,h=n.length;h>l;l++)f=3*l,i._array[f]=n[l].x,i._array[f+1]=n[l].y,i._array[f+2]=n[l].z;xi.uniform3fv(o,i._array)}else if("v4v"===r){for(void 0===i._array&&(i._array=new Float32Array(4*n.length)),l=0,h=n.length;h>l;l++)f=4*l,i._array[f]=n[l].x,i._array[f+1]=n[l].y,i._array[f+2]=n[l].z,i._array[f+3]=n[l].w;xi.uniform4fv(o,i._array)}else if("m4"===r)void 0===i._array&&(i._array=new Float32Array(16)),n.flattenToArray(i._array),xi.uniformMatrix4fv(o,!1,i._array);else if("m4v"===r){for(void 0===i._array&&(i._array=new Float32Array(16*n.length)),l=0,h=n.length;h>l;l++)n[l].flattenToArrayOffset(i._array,16*l);xi.uniformMatrix4fv(o,!1,i._array)}else if("t"===r){if(a=n,s=tt(),xi.uniform1i(o,s),!a)continue;a.image instanceof Array&&6===a.image.length?Et(a,s):a instanceof THREE.WebGLRenderTargetCube?yt(a,s):Ot.setTexture(a,s)}else if("tv"===r){for(void 0===i._array&&(i._array=[]),l=0,h=i.value.length;h>l;l++)i._array[l]=tt();for(xi.uniform1iv(o,i._array),l=0,h=i.value.length;h>l;l++)a=i.value[l],s=i._array[l],a&&Ot.setTexture(a,s)}}function nt(e,t){e._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld),e._normalMatrix.getNormalMatrix(e._modelViewMatrix)}function rt(e,t,i,n){e[t]=i.r*i.r*n,e[t+1]=i.g*i.g*n,e[t+2]=i.b*i.b*n}function ot(e,t,i,n){e[t]=i.r*n,e[t+1]=i.g*n,e[t+2]=i.b*n}function at(e,t){var i,n,r,o,a=0,s=0,l=0,h,c,u,f,p,d,m,g=Ti,v=g.directional.colors,E=g.directional.positions,y=g.point.colors,T=g.point.positions,x=g.point.distances,b=g.spot.colors,_=g.spot.positions,w=g.spot.distances,R=g.spot.directions,H=g.spot.anglesCos,M=g.spot.exponents,S=g.hemi.skyColors,C=g.hemi.groundColors,A=g.hemi.positions,D=0,k=0,P=0,L=0,N=0,z=0,F=0,I=0,O=0,U=0,V=0,B=0;for(i=0,n=t.length;n>i;i++)if(r=t[i],!r.onlyShadow)if(h=r.color,f=r.intensity,m=r.distance,r instanceof THREE.AmbientLight){if(!r.visible)continue;Ot.gammaInput?(a+=h.r*h.r,s+=h.g*h.g,l+=h.b*h.b):(a+=h.r,s+=h.g,l+=h.b)}else if(r instanceof THREE.DirectionalLight){if(N+=1,!r.visible)continue;if(Ei.getPositionFromMatrix(r.matrixWorld),vi.getPositionFromMatrix(r.target.matrixWorld),Ei.sub(vi),Ei.normalize(),0===Ei.x&&0===Ei.y&&0===Ei.z)continue;O=3*D,E[O]=Ei.x,E[O+1]=Ei.y,E[O+2]=Ei.z,Ot.gammaInput?rt(v,O,h,f*f):ot(v,O,h,f),D+=1}else if(r instanceof THREE.PointLight){if(z+=1,!r.visible)continue;U=3*k,Ot.gammaInput?rt(y,U,h,f*f):ot(y,U,h,f),vi.getPositionFromMatrix(r.matrixWorld),T[U]=vi.x,T[U+1]=vi.y,T[U+2]=vi.z,x[k]=m,k+=1}else if(r instanceof THREE.SpotLight){if(F+=1,!r.visible)continue;V=3*P,Ot.gammaInput?rt(b,V,h,f*f):ot(b,V,h,f),vi.getPositionFromMatrix(r.matrixWorld),_[V]=vi.x,_[V+1]=vi.y,_[V+2]=vi.z,w[P]=m,Ei.copy(vi),vi.getPositionFromMatrix(r.target.matrixWorld),Ei.sub(vi),Ei.normalize(),R[V]=Ei.x,R[V+1]=Ei.y,R[V+2]=Ei.z,H[P]=Math.cos(r.angle),M[P]=r.exponent,P+=1}else if(r instanceof THREE.HemisphereLight){if(I+=1,!r.visible)continue;if(Ei.getPositionFromMatrix(r.matrixWorld),Ei.normalize(),0===Ei.x&&0===Ei.y&&0===Ei.z)continue;B=3*L,A[B]=Ei.x,A[B+1]=Ei.y,A[B+2]=Ei.z,c=r.color,u=r.groundColor,Ot.gammaInput?(p=f*f,rt(S,B,c,p),rt(C,B,u,p)):(ot(S,B,c,f),ot(C,B,u,f)),L+=1}for(i=3*D,n=Math.max(v.length,3*N);n>i;i++)v[i]=0;for(i=3*k,n=Math.max(y.length,3*z);n>i;i++)y[i]=0;for(i=3*P,n=Math.max(b.length,3*F);n>i;i++)b[i]=0;for(i=3*L,n=Math.max(S.length,3*I);n>i;i++)S[i]=0;for(i=3*L,n=Math.max(C.length,3*I);n>i;i++)C[i]=0;g.directional.length=D,g.point.length=k,g.spot.length=P,g.hemi.length=L,g.ambient[0]=a,g.ambient[1]=s,g.ambient[2]=l}function st(e){e!==ai&&(xi.lineWidth(e),ai=e)}function lt(e,t,i){ni!==e&&(e?xi.enable(xi.POLYGON_OFFSET_FILL):xi.disable(xi.POLYGON_OFFSET_FILL),ni=e),!e||ri===t&&oi===i||(xi.polygonOffset(t,i),ri=t,oi=i)}function ht(e){var t,i,n=[];for(var r in e)t=e[r],t!==!1&&(i="#define "+r+" "+t,n.push(i));return n.join("\n")}function ct(e,t,i,n,r,o,a){var s,l,h,c,u,f=[];e?f.push(e):(f.push(t),f.push(i));for(h in o)f.push(h),f.push(o[h]);for(s in a)f.push(s),f.push(a[s]);for(u=f.join(),s=0,l=Ut.length;l>s;s++){var p=Ut[s];if(p.code===u)return p.usedTimes++,p.program}var d="SHADOWMAP_TYPE_BASIC";a.shadowMapType===THREE.PCFShadowMap?d="SHADOWMAP_TYPE_PCF":a.shadowMapType===THREE.PCFSoftShadowMap&&(d="SHADOWMAP_TYPE_PCF_SOFT");var m=ht(o);c=xi.createProgram();var g=["precision "+Dt+" float;",m,Di?"#define VERTEX_TEXTURES":"",Ot.gammaInput?"#define GAMMA_INPUT":"",Ot.gammaOutput?"#define GAMMA_OUTPUT":"",Ot.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,"#define MAX_BONES "+a.maxBones,a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.lightMap?"#define USE_LIGHTMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.vertexColors?"#define USE_COLOR":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.boneTextureWidth?"#define N_BONE_PIXEL_X "+a.boneTextureWidth.toFixed(1):"",a.boneTextureHeight?"#define N_BONE_PIXEL_Y "+a.boneTextureHeight.toFixed(1):"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals?"#define USE_MORPHNORMALS":"",a.perPixel?"#define PHONG_PER_PIXEL":"",a.wrapAround?"#define WRAP_AROUND":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+d:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",a.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","attribute vec3 morphTarget0;","attribute vec3 morphTarget1;","attribute vec3 morphTarget2;","attribute vec3 morphTarget3;","#ifdef USE_MORPHNORMALS","attribute vec3 morphNormal0;","attribute vec3 morphNormal1;","attribute vec3 morphNormal2;","attribute vec3 morphNormal3;","#else","attribute vec3 morphTarget4;","attribute vec3 morphTarget5;","attribute vec3 morphTarget6;","attribute vec3 morphTarget7;","#endif","#endif","#ifdef USE_SKINNING","attribute vec4 skinIndex;","attribute vec4 skinWeight;","#endif",""].join("\n"),v=["precision "+Dt+" float;",a.bumpMap||a.normalMap?"#extension GL_OES_standard_derivatives : enable":"",m,"#define MAX_DIR_LIGHTS "+a.maxDirLights,"#define MAX_POINT_LIGHTS "+a.maxPointLights,"#define MAX_SPOT_LIGHTS "+a.maxSpotLights,"#define MAX_HEMI_LIGHTS "+a.maxHemiLights,"#define MAX_SHADOWS "+a.maxShadows,a.alphaTest?"#define ALPHATEST "+a.alphaTest:"",Ot.gammaInput?"#define GAMMA_INPUT":"",Ot.gammaOutput?"#define GAMMA_OUTPUT":"",Ot.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.lightMap?"#define USE_LIGHTMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.vertexColors?"#define USE_COLOR":"",a.metal?"#define METAL":"",a.perPixel?"#define PHONG_PER_PIXEL":"",a.wrapAround?"#define WRAP_AROUND":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+d:"",a.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",a.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n"),E=dt("vertex",g+i),y=dt("fragment",v+t);xi.attachShader(c,E),xi.attachShader(c,y),xi.linkProgram(c),xi.getProgramParameter(c,xi.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+xi.getProgramParameter(c,xi.VALIDATE_STATUS)+", gl error ["+xi.getError()+"]"),xi.deleteShader(y),xi.deleteShader(E),c.uniforms={},c.attributes={};var T,x,b,_;T=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences"],T.push(a.useVertexTexture?"boneTexture":"boneGlobalMatrices");for(x in n)T.push(x);for(ut(c,T),T=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"],_=0;_<a.maxMorphTargets;_++)T.push("morphTarget"+_);for(_=0;_<a.maxMorphNormals;_++)T.push("morphNormal"+_);for(b in r)T.push(b);return ft(c,T),c.id=Vt++,Ut.push({program:c,code:u,usedTimes:1}),Ot.info.memory.programs=Ut.length,c}function ut(e,t){var i,n,r;for(i=0,n=t.length;n>i;i++)r=t[i],e.uniforms[r]=xi.getUniformLocation(e,r)}function ft(e,t){var i,n,r;for(i=0,n=t.length;n>i;i++)r=t[i],e.attributes[r]=xi.getAttribLocation(e,r)}function pt(e){for(var t=e.split("\n"),i=0,n=t.length;n>i;i++)t[i]=i+1+": "+t[i];return t.join("\n")}function dt(e,t){var i;return"fragment"===e?i=xi.createShader(xi.FRAGMENT_SHADER):"vertex"===e&&(i=xi.createShader(xi.VERTEX_SHADER)),xi.shaderSource(i,t),xi.compileShader(i),xi.getShaderParameter(i,xi.COMPILE_STATUS)?i:(console.error(xi.getShaderInfoLog(i)),console.error(pt(t)),null)}function mt(e){return 0===(e&e-1)}function gt(e,t,i){i?(xi.texParameteri(e,xi.TEXTURE_WRAP_S,wt(t.wrapS)),xi.texParameteri(e,xi.TEXTURE_WRAP_T,wt(t.wrapT)),xi.texParameteri(e,xi.TEXTURE_MAG_FILTER,wt(t.magFilter)),xi.texParameteri(e,xi.TEXTURE_MIN_FILTER,wt(t.minFilter))):(xi.texParameteri(e,xi.TEXTURE_WRAP_S,xi.CLAMP_TO_EDGE),xi.texParameteri(e,xi.TEXTURE_WRAP_T,xi.CLAMP_TO_EDGE),xi.texParameteri(e,xi.TEXTURE_MAG_FILTER,_t(t.magFilter)),xi.texParameteri(e,xi.TEXTURE_MIN_FILTER,_t(t.minFilter))),wi&&t.type!==THREE.FloatType&&(t.anisotropy>1||t.__oldAnisotropy)&&(xi.texParameterf(e,wi.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,Ai)),t.__oldAnisotropy=t.anisotropy)}function vt(e,t){if(e.width<=t&&e.height<=t)return e;var i=Math.max(e.width,e.height),n=Math.floor(e.width*t/i),r=Math.floor(e.height*t/i),o=document.createElement("canvas");o.width=n,o.height=r;var a=o.getContext("2d");return a.drawImage(e,0,0,e.width,e.height,0,0,n,r),o}function Et(e,t){if(6===e.image.length)if(e.needsUpdate){e.image.__webglTextureCube||(e.image.__webglTextureCube=xi.createTexture(),Ot.info.memory.textures++),xi.activeTexture(xi.TEXTURE0+t),xi.bindTexture(xi.TEXTURE_CUBE_MAP,e.image.__webglTextureCube),xi.pixelStorei(xi.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var i=e instanceof THREE.CompressedTexture,n=[],r=0;6>r;r++)n[r]=Ot.autoScaleCubemaps&&!i?vt(e.image[r],Ci):e.image[r];var o=n[0],a=mt(o.width)&&mt(o.height),s=wt(e.format),l=wt(e.type);gt(xi.TEXTURE_CUBE_MAP,e,a);for(var r=0;6>r;r++)if(i)for(var h,c=n[r].mipmaps,u=0,f=c.length;f>u;u++)h=c[u],xi.compressedTexImage2D(xi.TEXTURE_CUBE_MAP_POSITIVE_X+r,u,s,h.width,h.height,0,h.data);else xi.texImage2D(xi.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,s,s,l,n[r]);e.generateMipmaps&&a&&xi.generateMipmap(xi.TEXTURE_CUBE_MAP),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else xi.activeTexture(xi.TEXTURE0+t),xi.bindTexture(xi.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}function yt(e,t){xi.activeTexture(xi.TEXTURE0+t),xi.bindTexture(xi.TEXTURE_CUBE_MAP,e.__webglTexture)}function Tt(e,t,i){xi.bindFramebuffer(xi.FRAMEBUFFER,e),xi.framebufferTexture2D(xi.FRAMEBUFFER,xi.COLOR_ATTACHMENT0,i,t.__webglTexture,0)}function xt(e,t){xi.bindRenderbuffer(xi.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(xi.renderbufferStorage(xi.RENDERBUFFER,xi.DEPTH_COMPONENT16,t.width,t.height),xi.framebufferRenderbuffer(xi.FRAMEBUFFER,xi.DEPTH_ATTACHMENT,xi.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(xi.renderbufferStorage(xi.RENDERBUFFER,xi.DEPTH_STENCIL,t.width,t.height),xi.framebufferRenderbuffer(xi.FRAMEBUFFER,xi.DEPTH_STENCIL_ATTACHMENT,xi.RENDERBUFFER,e)):xi.renderbufferStorage(xi.RENDERBUFFER,xi.RGBA4,t.width,t.height)}function bt(e){e instanceof THREE.WebGLRenderTargetCube?(xi.bindTexture(xi.TEXTURE_CUBE_MAP,e.__webglTexture),xi.generateMipmap(xi.TEXTURE_CUBE_MAP),xi.bindTexture(xi.TEXTURE_CUBE_MAP,null)):(xi.bindTexture(xi.TEXTURE_2D,e.__webglTexture),xi.generateMipmap(xi.TEXTURE_2D),xi.bindTexture(xi.TEXTURE_2D,null))}function _t(e){return e===THREE.NearestFilter||e===THREE.NearestMipMapNearestFilter||e===THREE.NearestMipMapLinearFilter?xi.NEAREST:xi.LINEAR}function wt(e){if(e===THREE.RepeatWrapping)return xi.REPEAT;if(e===THREE.ClampToEdgeWrapping)return xi.CLAMP_TO_EDGE;if(e===THREE.MirroredRepeatWrapping)return xi.MIRRORED_REPEAT;if(e===THREE.NearestFilter)return xi.NEAREST;if(e===THREE.NearestMipMapNearestFilter)return xi.NEAREST_MIPMAP_NEAREST;if(e===THREE.NearestMipMapLinearFilter)return xi.NEAREST_MIPMAP_LINEAR;if(e===THREE.LinearFilter)return xi.LINEAR;if(e===THREE.LinearMipMapNearestFilter)return xi.LINEAR_MIPMAP_NEAREST;if(e===THREE.LinearMipMapLinearFilter)return xi.LINEAR_MIPMAP_LINEAR;if(e===THREE.UnsignedByteType)return xi.UNSIGNED_BYTE;if(e===THREE.UnsignedShort4444Type)return xi.UNSIGNED_SHORT_4_4_4_4;if(e===THREE.UnsignedShort5551Type)return xi.UNSIGNED_SHORT_5_5_5_1;if(e===THREE.UnsignedShort565Type)return xi.UNSIGNED_SHORT_5_6_5;if(e===THREE.ByteType)return xi.BYTE;if(e===THREE.ShortType)return xi.SHORT;if(e===THREE.UnsignedShortType)return xi.UNSIGNED_SHORT;if(e===THREE.IntType)return xi.INT;if(e===THREE.UnsignedIntType)return xi.UNSIGNED_INT;if(e===THREE.FloatType)return xi.FLOAT;if(e===THREE.AlphaFormat)return xi.ALPHA;if(e===THREE.RGBFormat)return xi.RGB;if(e===THREE.RGBAFormat)return xi.RGBA;if(e===THREE.LuminanceFormat)return xi.LUMINANCE;if(e===THREE.LuminanceAlphaFormat)return xi.LUMINANCE_ALPHA;if(e===THREE.AddEquation)return xi.FUNC_ADD;if(e===THREE.SubtractEquation)return xi.FUNC_SUBTRACT;if(e===THREE.ReverseSubtractEquation)return xi.FUNC_REVERSE_SUBTRACT;if(e===THREE.ZeroFactor)return xi.ZERO;if(e===THREE.OneFactor)return xi.ONE;if(e===THREE.SrcColorFactor)return xi.SRC_COLOR;if(e===THREE.OneMinusSrcColorFactor)return xi.ONE_MINUS_SRC_COLOR;if(e===THREE.SrcAlphaFactor)return xi.SRC_ALPHA;if(e===THREE.OneMinusSrcAlphaFactor)return xi.ONE_MINUS_SRC_ALPHA;if(e===THREE.DstAlphaFactor)return xi.DST_ALPHA;if(e===THREE.OneMinusDstAlphaFactor)return xi.ONE_MINUS_DST_ALPHA;if(e===THREE.DstColorFactor)return xi.DST_COLOR;if(e===THREE.OneMinusDstColorFactor)return xi.ONE_MINUS_DST_COLOR;if(e===THREE.SrcAlphaSaturateFactor)return xi.SRC_ALPHA_SATURATE;if(void 0!==Ri){if(e===THREE.RGB_S3TC_DXT1_Format)return Ri.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT1_Format)return Ri.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT3_Format)return Ri.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===THREE.RGBA_S3TC_DXT5_Format)return Ri.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}function Rt(e){if(ki&&e&&e.useVertexTexture)return 1024;var t=xi.getParameter(xi.MAX_VERTEX_UNIFORM_VECTORS),i=Math.floor((t-20)/4),n=i;return void 0!==e&&e instanceof THREE.SkinnedMesh&&(n=Math.min(e.bones.length,n),n<e.bones.length&&console.warn("WebGLRenderer: too many bones - "+e.bones.length+", this GPU supports just "+n+" (try OpenGL instead of ANGLE)")),n}function Ht(e){var t,i,n,r,o,a,s;for(r=o=a=s=0,t=0,i=e.length;i>t;t++)n=e[t],n.onlyShadow||(n instanceof THREE.DirectionalLight&&r++,n instanceof THREE.PointLight&&o++,n instanceof THREE.SpotLight&&a++,n instanceof THREE.HemisphereLight&&s++);return{directional:r,point:o,spot:a,hemi:s}}function Mt(e){var t,i,n,r=0;for(t=0,i=e.length;i>t;t++)n=e[t],n.castShadow&&(n instanceof THREE.SpotLight&&r++,n instanceof THREE.DirectionalLight&&!n.shadowCascade&&r++);return r}function St(){try{if(!(xi=At.getContext("experimental-webgl",{alpha:kt,premultipliedAlpha:Pt,antialias:Lt,stencil:Nt,preserveDrawingBuffer:zt})))throw"Error creating WebGL context."}catch(e){console.error(e)}bi=xi.getExtension("OES_texture_float"),_i=xi.getExtension("OES_standard_derivatives"),wi=xi.getExtension("EXT_texture_filter_anisotropic")||xi.getExtension("MOZ_EXT_texture_filter_anisotropic")||xi.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),Ri=xi.getExtension("WEBGL_compressed_texture_s3tc")||xi.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||xi.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),bi||console.log("THREE.WebGLRenderer: Float textures not supported."),_i||console.log("THREE.WebGLRenderer: Standard derivatives not supported."),wi||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported."),Ri||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported."),void 0===xi.getShaderPrecisionFormat&&(xi.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}function Ct(){xi.clearColor(0,0,0,1),xi.clearDepth(1),xi.clearStencil(0),xi.enable(xi.DEPTH_TEST),xi.depthFunc(xi.LEQUAL),xi.frontFace(xi.CCW),xi.cullFace(xi.BACK),xi.enable(xi.CULL_FACE),xi.enable(xi.BLEND),xi.blendEquation(xi.FUNC_ADD),xi.blendFunc(xi.SRC_ALPHA,xi.ONE_MINUS_SRC_ALPHA),xi.clearColor(Ft.r,Ft.g,Ft.b,It)}console.log("THREE.WebGLRenderer",THREE.REVISION),e=e||{};var At=void 0!==e.canvas?e.canvas:document.createElement("canvas"),Dt=void 0!==e.precision?e.precision:"highp",kt=void 0!==e.alpha?e.alpha:!0,Pt=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,Lt=void 0!==e.antialias?e.antialias:!1,Nt=void 0!==e.stencil?e.stencil:!0,zt=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!1,Ft=new THREE.Color(0),It=0;void 0!==e.clearColor&&(console.warn("DEPRECATED: clearColor in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),Ft.setHex(e.clearColor)),void 0!==e.clearAlpha&&(console.warn("DEPRECATED: clearAlpha in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),It=e.clearAlpha),this.domElement=At,this.context=null,this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.autoUpdateObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyBasedShading=!1,this.shadowMapEnabled=!1,this.shadowMapAutoUpdate=!0,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.renderPluginsPre=[],this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var Ot=this,Ut=[],Vt=0,Bt=null,Wt=null,jt=-1,Gt=null,qt=null,Xt=0,Yt=0,Kt=-1,Qt=-1,$t=-1,Zt=-1,Jt=-1,ei=-1,ti=-1,ii=-1,ni=null,ri=null,oi=null,ai=null,si=0,li=0,hi=0,ci=0,ui=0,fi=0,pi={},di=new THREE.Frustum,mi=new THREE.Matrix4,gi=new THREE.Matrix4,vi=new THREE.Vector3,Ei=new THREE.Vector3,yi=!0,Ti={ambient:[0,0,0],directional:{length:0,colors:new Array,positions:new Array},point:{length:0,colors:new Array,positions:new Array,distances:new Array},spot:{length:0,colors:new Array,positions:new Array,distances:new Array,directions:new Array,anglesCos:new Array,exponents:new Array},hemi:{length:0,skyColors:new Array,groundColors:new Array,positions:new Array}},xi,bi,_i,wi,Ri;St(),Ct(),this.context=xi;var Hi=xi.getParameter(xi.MAX_TEXTURE_IMAGE_UNITS),Mi=xi.getParameter(xi.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Si=xi.getParameter(xi.MAX_TEXTURE_SIZE),Ci=xi.getParameter(xi.MAX_CUBE_MAP_TEXTURE_SIZE),Ai=wi?xi.getParameter(wi.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,Di=Mi>0,ki=Di&&bi,Pi=Ri?xi.getParameter(xi.COMPRESSED_TEXTURE_FORMATS):[],Li=xi.getShaderPrecisionFormat(xi.VERTEX_SHADER,xi.HIGH_FLOAT),Ni=xi.getShaderPrecisionFormat(xi.VERTEX_SHADER,xi.MEDIUM_FLOAT),zi=xi.getShaderPrecisionFormat(xi.VERTEX_SHADER,xi.LOW_FLOAT),Fi=xi.getShaderPrecisionFormat(xi.FRAGMENT_SHADER,xi.HIGH_FLOAT),Ii=xi.getShaderPrecisionFormat(xi.FRAGMENT_SHADER,xi.MEDIUM_FLOAT),Oi=xi.getShaderPrecisionFormat(xi.FRAGMENT_SHADER,xi.LOW_FLOAT),Ui=xi.getShaderPrecisionFormat(xi.VERTEX_SHADER,xi.HIGH_INT),Vi=xi.getShaderPrecisionFormat(xi.VERTEX_SHADER,xi.MEDIUM_INT),Bi=xi.getShaderPrecisionFormat(xi.VERTEX_SHADER,xi.LOW_INT),Wi=xi.getShaderPrecisionFormat(xi.FRAGMENT_SHADER,xi.HIGH_INT),ji=xi.getShaderPrecisionFormat(xi.FRAGMENT_SHADER,xi.MEDIUM_INT),Gi=xi.getShaderPrecisionFormat(xi.FRAGMENT_SHADER,xi.LOW_INT),qi=Li.precision>0&&Fi.precision>0,Xi=Ni.precision>0&&Ii.precision>0;"highp"!==Dt||qi||(Xi?(Dt="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(Dt="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==Dt||Xi||(Dt="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),this.getContext=function(){return xi},this.supportsVertexTextures=function(){return Di},this.supportsFloatTextures=function(){return bi},this.supportsStandardDerivatives=function(){return _i},this.supportsCompressedTextureS3TC=function(){return Ri},this.getMaxAnisotropy=function(){return Ai},this.getPrecision=function(){return Dt},this.setSize=function(e,t,i){At.width=e*this.devicePixelRatio,At.height=t*this.devicePixelRatio,1!==this.devicePixelRatio&&i!==!1&&(At.style.width=e+"px",At.style.height=t+"px"),this.setViewport(0,0,At.width,At.height)},this.setViewport=function(e,t,i,n){si=void 0!==e?e:0,li=void 0!==t?t:0,hi=void 0!==i?i:At.width,ci=void 0!==n?n:At.height,xi.viewport(si,li,hi,ci)},this.setScissor=function(e,t,i,n){xi.scissor(e,t,i,n)},this.enableScissorTest=function(e){e?xi.enable(xi.SCISSOR_TEST):xi.disable(xi.SCISSOR_TEST)},this.setClearColor=function(e,t){Ft.set(e),It=void 0!==t?t:1,xi.clearColor(Ft.r,Ft.g,Ft.b,It)},this.setClearColorHex=function(e,t){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getClearColor=function(){return Ft},this.getClearAlpha=function(){return It},this.clear=function(e,t,i){var n=0;(void 0===e||e)&&(n|=xi.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=xi.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=xi.STENCIL_BUFFER_BIT),xi.clear(n)},this.clearTarget=function(e,t,i,n){this.setRenderTarget(e),this.clear(t,i,n)},this.addPostPlugin=function(e){e.init(this),this.renderPluginsPost.push(e)},this.addPrePlugin=function(e){e.init(this),this.renderPluginsPre.push(e)},this.updateShadowMap=function(e,t){Bt=null,$t=-1,ti=-1,ii=-1,Gt=-1,jt=-1,yi=!0,Kt=-1,Qt=-1,this.shadowMapPlugin.update(e,t)};var Yi=function(e){var t=e.target;t.removeEventListener("dispose",Yi),Zi(t),Ot.info.memory.geometries--},Ki=function(e){var t=e.target;t.removeEventListener("dispose",Ki),Ji(t),Ot.info.memory.textures--},Qi=function(e){var t=e.target;t.removeEventListener("dispose",Qi),en(t),Ot.info.memory.textures--},$i=function(e){var t=e.target;t.removeEventListener("dispose",$i),tn(t)},Zi=function(e){if(e.__webglInit=void 0,void 0!==e.__webglVertexBuffer&&xi.deleteBuffer(e.__webglVertexBuffer),void 0!==e.__webglNormalBuffer&&xi.deleteBuffer(e.__webglNormalBuffer),void 0!==e.__webglTangentBuffer&&xi.deleteBuffer(e.__webglTangentBuffer),void 0!==e.__webglColorBuffer&&xi.deleteBuffer(e.__webglColorBuffer),void 0!==e.__webglUVBuffer&&xi.deleteBuffer(e.__webglUVBuffer),void 0!==e.__webglUV2Buffer&&xi.deleteBuffer(e.__webglUV2Buffer),void 0!==e.__webglSkinIndicesBuffer&&xi.deleteBuffer(e.__webglSkinIndicesBuffer),void 0!==e.__webglSkinWeightsBuffer&&xi.deleteBuffer(e.__webglSkinWeightsBuffer),void 0!==e.__webglFaceBuffer&&xi.deleteBuffer(e.__webglFaceBuffer),void 0!==e.__webglLineBuffer&&xi.deleteBuffer(e.__webglLineBuffer),void 0!==e.__webglLineDistanceBuffer&&xi.deleteBuffer(e.__webglLineDistanceBuffer),void 0!==e.geometryGroups)for(var t in e.geometryGroups){var i=e.geometryGroups[t];if(void 0!==i.numMorphTargets)for(var n=0,r=i.numMorphTargets;r>n;n++)xi.deleteBuffer(i.__webglMorphTargetsBuffers[n]);if(void 0!==i.numMorphNormals)for(var n=0,r=i.numMorphNormals;r>n;n++)xi.deleteBuffer(i.__webglMorphNormalsBuffers[n]);o(i)}o(e)},Ji=function(e){if(e.image&&e.image.__webglTextureCube)xi.deleteTexture(e.image.__webglTextureCube);else{if(!e.__webglInit)return;e.__webglInit=!1,xi.deleteTexture(e.__webglTexture)}},en=function(e){if(e&&e.__webglTexture)if(xi.deleteTexture(e.__webglTexture),e instanceof THREE.WebGLRenderTargetCube)for(var t=0;6>t;t++)xi.deleteFramebuffer(e.__webglFramebuffer[t]),xi.deleteRenderbuffer(e.__webglRenderbuffer[t]);else xi.deleteFramebuffer(e.__webglFramebuffer),xi.deleteRenderbuffer(e.__webglRenderbuffer)},tn=function(e){var t=e.program;if(void 0!==t){e.program=void 0;var i,n,r,o=!1;for(i=0,n=Ut.length;n>i;i++)if(r=Ut[i],r.program===t){r.usedTimes--,0===r.usedTimes&&(o=!0);break}if(o===!0){var a=[];for(i=0,n=Ut.length;n>i;i++)r=Ut[i],r.program!==t&&a.push(r);Ut=a,xi.deleteProgram(t),Ot.info.memory.programs--}}};this.renderBufferImmediate=function(e,t,i){if(e.hasPositions&&!e.__webglVertexBuffer&&(e.__webglVertexBuffer=xi.createBuffer()),e.hasNormals&&!e.__webglNormalBuffer&&(e.__webglNormalBuffer=xi.createBuffer()),e.hasUvs&&!e.__webglUvBuffer&&(e.__webglUvBuffer=xi.createBuffer()),e.hasColors&&!e.__webglColorBuffer&&(e.__webglColorBuffer=xi.createBuffer()),e.hasPositions&&(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglVertexBuffer),xi.bufferData(xi.ARRAY_BUFFER,e.positionArray,xi.DYNAMIC_DRAW),xi.enableVertexAttribArray(t.attributes.position),xi.vertexAttribPointer(t.attributes.position,3,xi.FLOAT,!1,0,0)),e.hasNormals){if(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglNormalBuffer),i.shading===THREE.FlatShading){var n,r,o,a,s,l,h,c,u,f,p,d,m,g,v=3*e.count;for(g=0;v>g;g+=9)m=e.normalArray,a=m[g],h=m[g+1],f=m[g+2],s=m[g+3],c=m[g+4],p=m[g+5],l=m[g+6],u=m[g+7],d=m[g+8],n=(a+s+l)/3,r=(h+c+u)/3,o=(f+p+d)/3,m[g]=n,m[g+1]=r,m[g+2]=o,m[g+3]=n,m[g+4]=r,m[g+5]=o,m[g+6]=n,m[g+7]=r,m[g+8]=o}xi.bufferData(xi.ARRAY_BUFFER,e.normalArray,xi.DYNAMIC_DRAW),xi.enableVertexAttribArray(t.attributes.normal),xi.vertexAttribPointer(t.attributes.normal,3,xi.FLOAT,!1,0,0)}e.hasUvs&&i.map&&(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglUvBuffer),xi.bufferData(xi.ARRAY_BUFFER,e.uvArray,xi.DYNAMIC_DRAW),xi.enableVertexAttribArray(t.attributes.uv),xi.vertexAttribPointer(t.attributes.uv,2,xi.FLOAT,!1,0,0)),e.hasColors&&i.vertexColors!==THREE.NoColors&&(xi.bindBuffer(xi.ARRAY_BUFFER,e.__webglColorBuffer),xi.bufferData(xi.ARRAY_BUFFER,e.colorArray,xi.DYNAMIC_DRAW),xi.enableVertexAttribArray(t.attributes.color),xi.vertexAttribPointer(t.attributes.color,3,xi.FLOAT,!1,0,0)),xi.drawArrays(xi.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,i,n,r,o){if(n.visible!==!1){var a,s,l,h,c,u,f,p,d,m,g;a=W(e,t,i,n,o),s=a.attributes,f=r.attributes;var v=!1,E=n.wireframe?1:0,y=16777215*r.id+2*a.id+E;if(y!==Gt&&(Gt=y,v=!0),v&&_(),o instanceof THREE.Mesh){var T=f.index;if(T){var x=r.offsets;x.length>1&&(v=!0);for(var w=0,R=x.length;R>w;w++){var H=x[w].index;if(v){for(d in f)"index"!==d&&(m=s[d],p=f[d],g=p.itemSize,m>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,p.buffer),b(m),xi.vertexAttribPointer(m,g,xi.FLOAT,!1,0,H*g*4)));xi.bindBuffer(xi.ELEMENT_ARRAY_BUFFER,T.buffer)}xi.drawElements(xi.TRIANGLES,x[w].count,xi.UNSIGNED_SHORT,2*x[w].start),Ot.info.render.calls++,Ot.info.render.vertices+=x[w].count,Ot.info.render.faces+=x[w].count/3}}else{if(v)for(d in f)"index"!==d&&(m=s[d],p=f[d],g=p.itemSize,m>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,p.buffer),b(m),xi.vertexAttribPointer(m,g,xi.FLOAT,!1,0,0)));var M=r.attributes.position;xi.drawArrays(xi.TRIANGLES,0,M.numItems/3),Ot.info.render.calls++,Ot.info.render.vertices+=M.numItems/3,Ot.info.render.faces+=M.numItems/3/3}}else if(o instanceof THREE.ParticleSystem){if(v){for(d in f)m=s[d],p=f[d],g=p.itemSize,m>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,p.buffer),b(m),xi.vertexAttribPointer(m,g,xi.FLOAT,!1,0,0));var M=f.position;xi.drawArrays(xi.POINTS,0,M.numItems/3),Ot.info.render.calls++,Ot.info.render.points+=M.numItems/3}}else if(o instanceof THREE.Line&&v){for(d in f)m=s[d],p=f[d],g=p.itemSize,m>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,p.buffer),b(m),xi.vertexAttribPointer(m,g,xi.FLOAT,!1,0,0));st(n.linewidth);var M=f.position;xi.drawArrays(xi.LINE_STRIP,0,M.numItems/3),Ot.info.render.calls++,Ot.info.render.points+=M.numItems}}},this.renderBuffer=function(e,t,i,n,r,o){if(n.visible!==!1){var a,s,l,h,c,u,f,p;a=W(e,t,i,n,o),s=a.attributes;var d=!1,m=n.wireframe?1:0,g=16777215*r.id+2*a.id+m;if(g!==Gt&&(Gt=g,d=!0),d&&_(),!n.morphTargets&&s.position>=0?d&&(xi.bindBuffer(xi.ARRAY_BUFFER,r.__webglVertexBuffer),b(s.position),xi.vertexAttribPointer(s.position,3,xi.FLOAT,!1,0,0)):o.morphTargetBase&&w(n,r,o),d){if(r.__webglCustomAttributesList)for(f=0,p=r.__webglCustomAttributesList.length;p>f;f++)u=r.__webglCustomAttributesList[f],s[u.buffer.belongsToAttribute]>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,u.buffer),b(s[u.buffer.belongsToAttribute]),xi.vertexAttribPointer(s[u.buffer.belongsToAttribute],u.size,xi.FLOAT,!1,0,0));s.color>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,r.__webglColorBuffer),b(s.color),xi.vertexAttribPointer(s.color,3,xi.FLOAT,!1,0,0)),s.normal>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,r.__webglNormalBuffer),b(s.normal),xi.vertexAttribPointer(s.normal,3,xi.FLOAT,!1,0,0)),s.tangent>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,r.__webglTangentBuffer),b(s.tangent),xi.vertexAttribPointer(s.tangent,4,xi.FLOAT,!1,0,0)),s.uv>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,r.__webglUVBuffer),b(s.uv),xi.vertexAttribPointer(s.uv,2,xi.FLOAT,!1,0,0)),s.uv2>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,r.__webglUV2Buffer),b(s.uv2),xi.vertexAttribPointer(s.uv2,2,xi.FLOAT,!1,0,0)),n.skinning&&s.skinIndex>=0&&s.skinWeight>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,r.__webglSkinIndicesBuffer),b(s.skinIndex),xi.vertexAttribPointer(s.skinIndex,4,xi.FLOAT,!1,0,0),xi.bindBuffer(xi.ARRAY_BUFFER,r.__webglSkinWeightsBuffer),b(s.skinWeight),xi.vertexAttribPointer(s.skinWeight,4,xi.FLOAT,!1,0,0)),s.lineDistance>=0&&(xi.bindBuffer(xi.ARRAY_BUFFER,r.__webglLineDistanceBuffer),b(s.lineDistance),xi.vertexAttribPointer(s.lineDistance,1,xi.FLOAT,!1,0,0))}o instanceof THREE.Mesh?(n.wireframe?(st(n.wireframeLinewidth),d&&xi.bindBuffer(xi.ELEMENT_ARRAY_BUFFER,r.__webglLineBuffer),xi.drawElements(xi.LINES,r.__webglLineCount,xi.UNSIGNED_SHORT,0)):(d&&xi.bindBuffer(xi.ELEMENT_ARRAY_BUFFER,r.__webglFaceBuffer),xi.drawElements(xi.TRIANGLES,r.__webglFaceCount,xi.UNSIGNED_SHORT,0)),Ot.info.render.calls++,Ot.info.render.vertices+=r.__webglFaceCount,Ot.info.render.faces+=r.__webglFaceCount/3):o instanceof THREE.Line?(h=o.type===THREE.LineStrip?xi.LINE_STRIP:xi.LINES,st(n.linewidth),xi.drawArrays(h,0,r.__webglLineCount),Ot.info.render.calls++):o instanceof THREE.ParticleSystem?(xi.drawArrays(xi.POINTS,0,r.__webglParticleCount),Ot.info.render.calls++,Ot.info.render.points+=r.__webglParticleCount):o instanceof THREE.Ribbon&&(xi.drawArrays(xi.TRIANGLE_STRIP,0,r.__webglVertexCount),Ot.info.render.calls++)}},this.render=function(e,t,i,n){if(t instanceof THREE.Camera==!1)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");var r,o,a,s,l,h=e.__lights,c=e.fog;for(jt=-1,yi=!0,e.autoUpdate===!0&&e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),mi.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),di.setFromMatrix(mi),this.autoUpdateObjects&&this.initWebGLObjects(e),M(this.renderPluginsPre,e,t),Ot.info.render.calls=0,Ot.info.render.vertices=0,Ot.info.render.faces=0,Ot.info.render.points=0,this.setRenderTarget(i),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),l=e.__webglObjects,r=0,o=l.length;o>r;r++)a=l[r],s=a.object,a.id=r,a.render=!1,s.visible&&((s instanceof THREE.Mesh||s instanceof THREE.ParticleSystem)&&s.frustumCulled&&!di.intersectsObject(s)||(nt(s,t),D(a),a.render=!0,this.sortObjects===!0&&(null!==s.renderDepth?a.z=s.renderDepth:(vi.getPositionFromMatrix(s.matrixWorld),vi.applyProjection(mi),a.z=vi.z))));
for(this.sortObjects&&l.sort(R),l=e.__webglObjectsImmediate,r=0,o=l.length;o>r;r++)a=l[r],s=a.object,s.visible&&(nt(s,t),A(a));if(e.overrideMaterial){var u=e.overrideMaterial;this.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst),this.setDepthTest(u.depthTest),this.setDepthWrite(u.depthWrite),lt(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits),S(e.__webglObjects,!1,"",t,h,c,!0,u),C(e.__webglObjectsImmediate,"",t,h,c,!1,u)}else{var u=null;this.setBlending(THREE.NoBlending),S(e.__webglObjects,!0,"opaque",t,h,c,!1,u),C(e.__webglObjectsImmediate,"opaque",t,h,c,!1,u),S(e.__webglObjects,!1,"transparent",t,h,c,!0,u),C(e.__webglObjectsImmediate,"transparent",t,h,c,!0,u)}M(this.renderPluginsPost,e,t),i&&i.generateMipmaps&&i.minFilter!==THREE.NearestFilter&&i.minFilter!==THREE.LinearFilter&&bt(i),this.setDepthTest(!0),this.setDepthWrite(!0)},this.renderImmediateObject=function(e,t,i,n,r){var o=W(e,t,i,n,r);Gt=-1,Ot.setMaterialFaces(n),r.immediateRenderCallback?r.immediateRenderCallback(o,xi,di):r.render(function(e){Ot.renderBufferImmediate(e,o,n)})},this.initWebGLObjects=function(e){for(e.__webglObjects||(e.__webglObjects=[],e.__webglObjectsImmediate=[],e.__webglSprites=[],e.__webglFlares=[]);e.__objectsAdded.length;)P(e.__objectsAdded[0],e),e.__objectsAdded.splice(0,1);for(;e.__objectsRemoved.length;)O(e.__objectsRemoved[0],e),e.__objectsRemoved.splice(0,1);for(var t=0,i=e.__webglObjects.length;i>t;t++){var n=e.__webglObjects[t].object;void 0===n.__webglInit&&(void 0!==n.__webglActive&&O(n,e),P(n,e)),z(n)}},this.initMaterial=function(e,t,i,n){e.addEventListener("dispose",$i);var r,o,a,s,l,h,c,u,f;e instanceof THREE.MeshDepthMaterial?f="depth":e instanceof THREE.MeshNormalMaterial?f="normal":e instanceof THREE.MeshBasicMaterial?f="basic":e instanceof THREE.MeshLambertMaterial?f="lambert":e instanceof THREE.MeshPhongMaterial?f="phong":e instanceof THREE.LineBasicMaterial?f="basic":e instanceof THREE.LineDashedMaterial?f="dashed":e instanceof THREE.ParticleBasicMaterial&&(f="particle_basic"),f&&B(e,THREE.ShaderLib[f]),h=Ht(t),u=Mt(t),c=Rt(n),l={map:!!e.map,envMap:!!e.envMap,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,vertexColors:e.vertexColors,fog:i,useFog:e.fog,fogExp:i instanceof THREE.FogExp2,sizeAttenuation:e.sizeAttenuation,skinning:e.skinning,maxBones:c,useVertexTexture:ki&&n&&n.useVertexTexture,boneTextureWidth:n&&n.boneTextureWidth,boneTextureHeight:n&&n.boneTextureHeight,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:h.directional,maxPointLights:h.point,maxSpotLights:h.spot,maxHemiLights:h.hemi,maxShadows:u,shadowMapEnabled:this.shadowMapEnabled&&n.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,perPixel:e.perPixel,wrapAround:e.wrapAround,doubleSided:e.side===THREE.DoubleSide,flipSided:e.side===THREE.BackSide},e.program=ct(f,e.fragmentShader,e.vertexShader,e.uniforms,e.attributes,e.defines,l);var p=e.program.attributes;if(e.morphTargets){e.numSupportedMorphTargets=0;var d,m="morphTarget";for(s=0;s<this.maxMorphTargets;s++)d=m+s,p[d]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;var d,m="morphNormal";for(s=0;s<this.maxMorphNormals;s++)d=m+s,p[d]>=0&&e.numSupportedMorphNormals++}e.uniformsList=[];for(r in e.uniforms)e.uniformsList.push([e.uniforms[r],r])},this.setFaceCulling=function(e,t){e===THREE.CullFaceNone?xi.disable(xi.CULL_FACE):(xi.frontFace(t===THREE.FrontFaceDirectionCW?xi.CW:xi.CCW),xi.cullFace(e===THREE.CullFaceBack?xi.BACK:e===THREE.CullFaceFront?xi.FRONT:xi.FRONT_AND_BACK),xi.enable(xi.CULL_FACE))},this.setMaterialFaces=function(e){var t=e.side===THREE.DoubleSide,i=e.side===THREE.BackSide;Kt!==t&&(t?xi.disable(xi.CULL_FACE):xi.enable(xi.CULL_FACE),Kt=t),Qt!==i&&(xi.frontFace(i?xi.CW:xi.CCW),Qt=i)},this.setDepthTest=function(e){ti!==e&&(e?xi.enable(xi.DEPTH_TEST):xi.disable(xi.DEPTH_TEST),ti=e)},this.setDepthWrite=function(e){ii!==e&&(xi.depthMask(e),ii=e)},this.setBlending=function(e,t,i,n){e!==$t&&(e===THREE.NoBlending?xi.disable(xi.BLEND):e===THREE.AdditiveBlending?(xi.enable(xi.BLEND),xi.blendEquation(xi.FUNC_ADD),xi.blendFunc(xi.SRC_ALPHA,xi.ONE)):e===THREE.SubtractiveBlending?(xi.enable(xi.BLEND),xi.blendEquation(xi.FUNC_ADD),xi.blendFunc(xi.ZERO,xi.ONE_MINUS_SRC_COLOR)):e===THREE.MultiplyBlending?(xi.enable(xi.BLEND),xi.blendEquation(xi.FUNC_ADD),xi.blendFunc(xi.ZERO,xi.SRC_COLOR)):e===THREE.CustomBlending?xi.enable(xi.BLEND):(xi.enable(xi.BLEND),xi.blendEquationSeparate(xi.FUNC_ADD,xi.FUNC_ADD),xi.blendFuncSeparate(xi.SRC_ALPHA,xi.ONE_MINUS_SRC_ALPHA,xi.ONE,xi.ONE_MINUS_SRC_ALPHA)),$t=e),e===THREE.CustomBlending?(t!==Zt&&(xi.blendEquation(wt(t)),Zt=t),(i!==Jt||n!==ei)&&(xi.blendFunc(wt(i),wt(n)),Jt=i,ei=n)):(Zt=null,Jt=null,ei=null)},this.setTexture=function(e,t){if(e.needsUpdate){e.__webglInit||(e.__webglInit=!0,e.addEventListener("dispose",Ki),e.__webglTexture=xi.createTexture(),Ot.info.memory.textures++),xi.activeTexture(xi.TEXTURE0+t),xi.bindTexture(xi.TEXTURE_2D,e.__webglTexture),xi.pixelStorei(xi.UNPACK_FLIP_Y_WEBGL,e.flipY),xi.pixelStorei(xi.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),xi.pixelStorei(xi.UNPACK_ALIGNMENT,e.unpackAlignment);var i=e.image,n=mt(i.width)&&mt(i.height),r=wt(e.format),o=wt(e.type);gt(xi.TEXTURE_2D,e,n);var a,s=e.mipmaps;if(e instanceof THREE.DataTexture)if(s.length>0&&n){for(var l=0,h=s.length;h>l;l++)a=s[l],xi.texImage2D(xi.TEXTURE_2D,l,r,a.width,a.height,0,r,o,a.data);e.generateMipmaps=!1}else xi.texImage2D(xi.TEXTURE_2D,0,r,i.width,i.height,0,r,o,i.data);else if(e instanceof THREE.CompressedTexture)for(var l=0,h=s.length;h>l;l++)a=s[l],xi.compressedTexImage2D(xi.TEXTURE_2D,l,r,a.width,a.height,0,a.data);else if(s.length>0&&n){for(var l=0,h=s.length;h>l;l++)a=s[l],xi.texImage2D(xi.TEXTURE_2D,l,r,r,o,a);e.generateMipmaps=!1}else xi.texImage2D(xi.TEXTURE_2D,0,r,r,o,e.image);e.generateMipmaps&&n&&xi.generateMipmap(xi.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else xi.activeTexture(xi.TEXTURE0+t),xi.bindTexture(xi.TEXTURE_2D,e.__webglTexture)},this.setRenderTarget=function(e){var t=e instanceof THREE.WebGLRenderTargetCube;if(e&&!e.__webglFramebuffer){void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.addEventListener("dispose",Qi),e.__webglTexture=xi.createTexture(),Ot.info.memory.textures++;var i=mt(e.width)&&mt(e.height),n=wt(e.format),r=wt(e.type);if(t){e.__webglFramebuffer=[],e.__webglRenderbuffer=[],xi.bindTexture(xi.TEXTURE_CUBE_MAP,e.__webglTexture),gt(xi.TEXTURE_CUBE_MAP,e,i);for(var o=0;6>o;o++)e.__webglFramebuffer[o]=xi.createFramebuffer(),e.__webglRenderbuffer[o]=xi.createRenderbuffer(),xi.texImage2D(xi.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,n,e.width,e.height,0,n,r,null),Tt(e.__webglFramebuffer[o],e,xi.TEXTURE_CUBE_MAP_POSITIVE_X+o),xt(e.__webglRenderbuffer[o],e);i&&xi.generateMipmap(xi.TEXTURE_CUBE_MAP)}else e.__webglFramebuffer=xi.createFramebuffer(),e.__webglRenderbuffer=e.shareDepthFrom?e.shareDepthFrom.__webglRenderbuffer:xi.createRenderbuffer(),xi.bindTexture(xi.TEXTURE_2D,e.__webglTexture),gt(xi.TEXTURE_2D,e,i),xi.texImage2D(xi.TEXTURE_2D,0,n,e.width,e.height,0,n,r,null),Tt(e.__webglFramebuffer,e,xi.TEXTURE_2D),e.shareDepthFrom?e.depthBuffer&&!e.stencilBuffer?xi.framebufferRenderbuffer(xi.FRAMEBUFFER,xi.DEPTH_ATTACHMENT,xi.RENDERBUFFER,e.__webglRenderbuffer):e.depthBuffer&&e.stencilBuffer&&xi.framebufferRenderbuffer(xi.FRAMEBUFFER,xi.DEPTH_STENCIL_ATTACHMENT,xi.RENDERBUFFER,e.__webglRenderbuffer):xt(e.__webglRenderbuffer,e),i&&xi.generateMipmap(xi.TEXTURE_2D);t?xi.bindTexture(xi.TEXTURE_CUBE_MAP,null):xi.bindTexture(xi.TEXTURE_2D,null),xi.bindRenderbuffer(xi.RENDERBUFFER,null),xi.bindFramebuffer(xi.FRAMEBUFFER,null)}var a,s,l,h,c;e?(a=t?e.__webglFramebuffer[e.activeCubeFace]:e.__webglFramebuffer,s=e.width,l=e.height,h=0,c=0):(a=null,s=hi,l=ci,h=si,c=li),a!==Wt&&(xi.bindFramebuffer(xi.FRAMEBUFFER,a),xi.viewport(h,c,s,l),Wt=a),ui=s,fi=l},this.shadowMapPlugin=new THREE.ShadowMapPlugin,this.addPrePlugin(this.shadowMapPlugin),this.addPostPlugin(new THREE.SpritePlugin),this.addPostPlugin(new THREE.LensFlarePlugin)},THREE.WebGLRenderTarget=function(e,t,i){this.width=e,this.height=t,i=i||{},this.wrapS=void 0!==i.wrapS?i.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==i.wrapT?i.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==i.magFilter?i.magFilter:THREE.LinearFilter,this.minFilter=void 0!==i.minFilter?i.minFilter:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==i.format?i.format:THREE.RGBAFormat,this.type=void 0!==i.type?i.type:THREE.UnsignedByteType,this.depthBuffer=void 0!==i.depthBuffer?i.depthBuffer:!0,this.stencilBuffer=void 0!==i.stencilBuffer?i.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(){var e=new THREE.WebGLRenderTarget(this.width,this.height);return e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.format=this.format,e.type=this.type,e.depthBuffer=this.depthBuffer,e.stencilBuffer=this.stencilBuffer,e.generateMipmaps=this.generateMipmaps,e.shareDepthFrom=this.shareDepthFrom,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.WebGLRenderTargetCube=function(e,t,i){THREE.WebGLRenderTarget.call(this,e,t,i),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.color=null,this.material=null,this.uvs=[[]],this.z=null},THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.v4=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.color=null,this.material=null,this.uvs=[[]],this.z=null},THREE.RenderableObject=function(){this.object=null,this.z=null},THREE.RenderableParticle=function(){this.object=null,this.x=null,this.y=null,this.z=null,this.rotation=null,this.scale=new THREE.Vector2,this.material=null},THREE.RenderableLine=function(){this.z=null,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null},THREE.GeometryUtils={merge:function(e,t,i){var n,r,o=e.vertices.length,a=e.faceVertexUvs[0].length,s=t instanceof THREE.Mesh?t.geometry:t,l=e.vertices,h=s.vertices,c=e.faces,u=s.faces,f=e.faceVertexUvs[0],p=s.faceVertexUvs[0];void 0===i&&(i=0),t instanceof THREE.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,r=(new THREE.Matrix3).getNormalMatrix(n));for(var d=0,m=h.length;m>d;d++){var g=h[d],v=g.clone();n&&v.applyMatrix4(n),l.push(v)}for(d=0,m=u.length;m>d;d++){var E=u[d],y,T,x,b=E.vertexNormals,_=E.vertexColors;E instanceof THREE.Face3?y=new THREE.Face3(E.a+o,E.b+o,E.c+o):E instanceof THREE.Face4&&(y=new THREE.Face4(E.a+o,E.b+o,E.c+o,E.d+o)),y.normal.copy(E.normal),r&&y.normal.applyMatrix3(r).normalize();for(var w=0,R=b.length;R>w;w++)T=b[w].clone(),r&&T.applyMatrix3(r).normalize(),y.vertexNormals.push(T);y.color.copy(E.color);for(var w=0,R=_.length;R>w;w++)x=_[w],y.vertexColors.push(x.clone());y.materialIndex=E.materialIndex+i,y.centroid.copy(E.centroid),n&&y.centroid.applyMatrix4(n),c.push(y)}for(d=0,m=p.length;m>d;d++){for(var H=p[d],M=[],w=0,R=H.length;R>w;w++)M.push(new THREE.Vector2(H[w].x,H[w].y));f.push(M)}},removeMaterials:function(e,t){for(var i={},n=0,r=t.length;r>n;n++)i[t[n]]=!0;for(var o,a=[],n=0,r=e.faces.length;r>n;n++)o=e.faces[n],o.materialIndex in i||a.push(o);e.faces=a},randomPointInTriangle:function(e,t,i){var n,r,o,a=new THREE.Vector3,s=THREE.GeometryUtils.__v1;return n=THREE.GeometryUtils.random(),r=THREE.GeometryUtils.random(),n+r>1&&(n=1-n,r=1-r),o=1-n-r,a.copy(e),a.multiplyScalar(n),s.copy(t),s.multiplyScalar(r),a.add(s),s.copy(i),s.multiplyScalar(o),a.add(s),a},randomPointInFace:function(e,t,i){var n,r,o,a;if(e instanceof THREE.Face3)return n=t.vertices[e.a],r=t.vertices[e.b],o=t.vertices[e.c],THREE.GeometryUtils.randomPointInTriangle(n,r,o);if(e instanceof THREE.Face4){n=t.vertices[e.a],r=t.vertices[e.b],o=t.vertices[e.c],a=t.vertices[e.d];var s,l;i?e._area1&&e._area2?(s=e._area1,l=e._area2):(s=THREE.GeometryUtils.triangleArea(n,r,a),l=THREE.GeometryUtils.triangleArea(r,o,a),e._area1=s,e._area2=l):(s=THREE.GeometryUtils.triangleArea(n,r,a),l=THREE.GeometryUtils.triangleArea(r,o,a));var h=THREE.GeometryUtils.random()*(s+l);return s>h?THREE.GeometryUtils.randomPointInTriangle(n,r,a):THREE.GeometryUtils.randomPointInTriangle(r,o,a)}},randomPointsInGeometry:function(e,t){function i(e){function t(i,n){if(i>n)return i;var r=i+Math.floor((n-i)/2);return h[r]>e?t(i,r-1):h[r]<e?t(r+1,n):r}var i=t(0,h.length-1);return i}var n,r,o=e.faces,a=e.vertices,s=o.length,l=0,h=[],c,u,f,p;for(r=0;s>r;r++)n=o[r],n instanceof THREE.Face3?(c=a[n.a],u=a[n.b],f=a[n.c],n._area=THREE.GeometryUtils.triangleArea(c,u,f)):n instanceof THREE.Face4&&(c=a[n.a],u=a[n.b],f=a[n.c],p=a[n.d],n._area1=THREE.GeometryUtils.triangleArea(c,u,p),n._area2=THREE.GeometryUtils.triangleArea(u,f,p),n._area=n._area1+n._area2),l+=n._area,h[r]=l;var d,m,g=[],v={};for(r=0;t>r;r++)d=THREE.GeometryUtils.random()*l,m=i(d),g[r]=THREE.GeometryUtils.randomPointInFace(o[m],e,!0),v[m]?v[m]+=1:v[m]=1;return g},triangleArea:function(e,t,i){var n=THREE.GeometryUtils.__v1,r=THREE.GeometryUtils.__v2;return n.subVectors(t,e),r.subVectors(i,e),n.cross(r),.5*n.length()},center:function(e){e.computeBoundingBox();var t=e.boundingBox,i=new THREE.Vector3;return i.addVectors(t.min,t.max),i.multiplyScalar(-.5),e.applyMatrix((new THREE.Matrix4).makeTranslation(i.x,i.y,i.z)),e.computeBoundingBox(),i},normalizeUVs:function(e){for(var t=e.faceVertexUvs[0],i=0,n=t.length;n>i;i++)for(var r=t[i],o=0,a=r.length;a>o;o++)1!==r[o].x&&(r[o].x=r[o].x-Math.floor(r[o].x)),1!==r[o].y&&(r[o].y=r[o].y-Math.floor(r[o].y))},triangulateQuads:function(e){var t,i,n,r,o=[],a=[],s=[];for(t=0,i=e.faceUvs.length;i>t;t++)a[t]=[];for(t=0,i=e.faceVertexUvs.length;i>t;t++)s[t]=[];for(t=0,i=e.faces.length;i>t;t++){var l=e.faces[t];if(l instanceof THREE.Face4){var h=l.a,c=l.b,u=l.c,f=l.d,p=new THREE.Face3,d=new THREE.Face3;for(p.color.copy(l.color),d.color.copy(l.color),p.materialIndex=l.materialIndex,d.materialIndex=l.materialIndex,p.a=h,p.b=c,p.c=f,d.a=c,d.b=u,d.c=f,4===l.vertexColors.length&&(p.vertexColors[0]=l.vertexColors[0].clone(),p.vertexColors[1]=l.vertexColors[1].clone(),p.vertexColors[2]=l.vertexColors[3].clone(),d.vertexColors[0]=l.vertexColors[1].clone(),d.vertexColors[1]=l.vertexColors[2].clone(),d.vertexColors[2]=l.vertexColors[3].clone()),o.push(p,d),n=0,r=e.faceVertexUvs.length;r>n;n++)if(e.faceVertexUvs[n].length){var m=e.faceVertexUvs[n][t],g=m[0],v=m[1],E=m[2],y=m[3],T=[g.clone(),v.clone(),y.clone()],x=[v.clone(),E.clone(),y.clone()];s[n].push(T,x)}for(n=0,r=e.faceUvs.length;r>n;n++)if(e.faceUvs[n].length){var b=e.faceUvs[n][t];a[n].push(b,b)}}else{for(o.push(l),n=0,r=e.faceUvs.length;r>n;n++)a[n].push(e.faceUvs[n][t]);for(n=0,r=e.faceVertexUvs.length;r>n;n++)s[n].push(e.faceVertexUvs[n][t])}}e.faces=o,e.faceUvs=a,e.faceVertexUvs=s,e.computeCentroids(),e.computeFaceNormals(),e.computeVertexNormals(),e.hasTangents&&e.computeTangents()},setMaterialIndex:function(e,t,i,n){for(var r=e.faces,o=i||0,a=n||r.length-1,s=o;a>=s;s++)r[s].materialIndex=t}},THREE.GeometryUtils.random=THREE.Math.random16,THREE.GeometryUtils.__v1=new THREE.Vector3,THREE.GeometryUtils.__v2=new THREE.Vector3,THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(e,t,i,n){var r=new Image,o=new THREE.Texture(r,t),a=new THREE.ImageLoader;return a.addEventListener("load",function(e){o.image=e.content,o.needsUpdate=!0,i&&i(o)}),a.addEventListener("error",function(e){n&&n(e.message)}),a.crossOrigin=this.crossOrigin,a.load(e,r),o.sourceFile=e,o},loadCompressedTexture:function(e,t,i,n){var r=new THREE.CompressedTexture;r.mapping=t;var o=new XMLHttpRequest;return o.onload=function(){var e=o.response,t=THREE.ImageUtils.parseDDS(e,!0);r.format=t.format,r.mipmaps=t.mipmaps,r.image.width=t.width,r.image.height=t.height,r.generateMipmaps=!1,r.needsUpdate=!0,i&&i(r)},o.onerror=n,o.open("GET",e,!0),o.responseType="arraybuffer",o.send(null),r},loadTextureCube:function(e,t,i,n){var r=[];r.loadCount=0;var o=new THREE.Texture;o.image=r,void 0!==t&&(o.mapping=t),o.flipY=!1;for(var a=0,s=e.length;s>a;++a){var l=new Image;r[a]=l,l.onload=function(){r.loadCount+=1,6===r.loadCount&&(o.needsUpdate=!0,i&&i(o))},l.onerror=n,l.crossOrigin=this.crossOrigin,l.src=e[a]}return o},loadCompressedTextureCube:function(e,t,i,n){var r=[];r.loadCount=0;var o=new THREE.CompressedTexture;o.image=r,void 0!==t&&(o.mapping=t),o.flipY=!1,o.generateMipmaps=!1;var a=function(e,t){return function(){var n=e.response,a=THREE.ImageUtils.parseDDS(n,!0);t.format=a.format,t.mipmaps=a.mipmaps,t.width=a.width,t.height=a.height,r.loadCount+=1,6===r.loadCount&&(o.format=a.format,o.needsUpdate=!0,i&&i(o))}};if(e instanceof Array)for(var s=0,l=e.length;l>s;++s){var h={};r[s]=h;var c=new XMLHttpRequest;c.onload=a(c,h),c.onerror=n;var u=e[s];c.open("GET",u,!0),c.responseType="arraybuffer",c.send(null)}else{var u=e,c=new XMLHttpRequest;c.onload=function(){var e=c.response,t=THREE.ImageUtils.parseDDS(e,!0);if(t.isCubemap){for(var n=t.mipmaps.length/t.mipmapCount,a=0;n>a;a++){r[a]={mipmaps:[]};for(var s=0;s<t.mipmapCount;s++)r[a].mipmaps.push(t.mipmaps[a*t.mipmapCount+s]),r[a].format=t.format,r[a].width=t.width,r[a].height=t.height}o.format=t.format,o.needsUpdate=!0,i&&i(o)}},c.onerror=n,c.open("GET",u,!0),c.responseType="arraybuffer",c.send(null)}return o},parseDDS:function(e,t){function i(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function n(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}var r={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},o=542327876,a=1,s=2,l=4,h=8,c=4096,u=131072,f=524288,p=8388608,d=8,m=4194304,g=4096,v=512,E=1024,y=2048,T=4096,x=8192,b=16384,_=32768,w=2097152,R=1,H=2,M=4,S=64,C=512,A=131072,D=i("DXT1"),k=i("DXT3"),P=i("DXT5"),L=31,N=0,z=1,F=2,I=3,O=4,U=7,V=20,B=21,W=27,j=28,G=29,q=30,X=new Int32Array(e,0,L);if(X[N]!==o)return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),r;if(!X[V]&M)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),r;var Y,K=X[B];switch(K){case D:Y=8,r.format=THREE.RGB_S3TC_DXT1_Format;break;case k:Y=16,r.format=THREE.RGBA_S3TC_DXT3_Format;break;case P:Y=16,r.format=THREE.RGBA_S3TC_DXT5_Format;break;default:return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",n(K)),r}r.mipmapCount=1,X[F]&u&&t!==!1&&(r.mipmapCount=Math.max(1,X[U])),r.isCubemap=X[j]&v?!0:!1,r.width=X[O],r.height=X[I];for(var Q=X[z]+4,Z=r.width,J=r.height,et=r.isCubemap?6:1,tt=0;et>tt;tt++){for(var it=0;it<r.mipmapCount;it++){var nt=Math.max(4,Z)/4*Math.max(4,J)/4*Y,rt=new Uint8Array(e,Q,nt),ot={data:rt,width:Z,height:J};r.mipmaps.push(ot),Q+=nt,Z=Math.max(.5*Z,1),J=Math.max(.5*J,1)}Z=r.width,J=r.height}return r},getNormalMap:function(e,t){var i=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},n=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},r=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]};t=1|t;var o=e.width,a=e.height,s=document.createElement("canvas");s.width=o,s.height=a;var l=s.getContext("2d");l.drawImage(e,0,0);for(var h=l.getImageData(0,0,o,a).data,c=l.createImageData(o,a),u=c.data,f=0;o>f;f++)for(var p=0;a>p;p++){var d=0>p-1?0:p-1,m=p+1>a-1?a-1:p+1,g=0>f-1?0:f-1,v=f+1>o-1?o-1:f+1,E=[],y=[0,0,h[4*(p*o+f)]/255*t];E.push([-1,0,h[4*(p*o+g)]/255*t]),E.push([-1,-1,h[4*(d*o+g)]/255*t]),E.push([0,-1,h[4*(d*o+f)]/255*t]),E.push([1,-1,h[4*(d*o+v)]/255*t]),E.push([1,0,h[4*(p*o+v)]/255*t]),E.push([1,1,h[4*(m*o+v)]/255*t]),E.push([0,1,h[4*(m*o+f)]/255*t]),E.push([-1,1,h[4*(m*o+g)]/255*t]);for(var T=[],x=E.length,b=0;x>b;b++){var _=E[b],w=E[(b+1)%x];_=n(_,y),w=n(w,y),T.push(r(i(_,w)))}for(var R=[0,0,0],b=0;b<T.length;b++)R[0]+=T[b][0],R[1]+=T[b][1],R[2]+=T[b][2];R[0]/=T.length,R[1]/=T.length,R[2]/=T.length;var H=4*(p*o+f);u[H]=(R[0]+1)/2*255|0,u[H+1]=(R[1]+1)/2*255|0,u[H+2]=255*R[2]|0,u[H+3]=255}return l.putImageData(c,0,0),s},generateDataTexture:function(e,t,i){for(var n=e*t,r=new Uint8Array(3*n),o=Math.floor(255*i.r),a=Math.floor(255*i.g),s=Math.floor(255*i.b),l=0;n>l;l++)r[3*l]=o,r[3*l+1]=a,r[3*l+2]=s;var h=new THREE.DataTexture(r,e,t,THREE.RGBFormat);return h.needsUpdate=!0,h}},THREE.SceneUtils={createMultiMaterialObject:function(e,t){for(var i=new THREE.Object3D,n=0,r=t.length;r>n;n++)i.add(new THREE.Mesh(e,t[n]));return i},detach:function(e,t,i){e.applyMatrix(t.matrixWorld),t.remove(e),i.add(e)},attach:function(e,t,i){var n=new THREE.Matrix4;n.getInverse(i.matrixWorld),e.applyMatrix(n),t.remove(e),i.add(e)}},THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(e){var t=e.familyName.toLowerCase(),i=this;i.faces[t]=i.faces[t]||{},i.faces[t][e.cssFontWeight]=i.faces[t][e.cssFontWeight]||{},i.faces[t][e.cssFontWeight][e.cssFontStyle]=e;var n=i.faces[t][e.cssFontWeight][e.cssFontStyle]=e;return e},drawText:function(e){var t=[],i=[],n,r,o=this.getFace(),a=this.size/o.resolution,s=0,l=String(e).split(""),h=l.length,c=[];for(n=0;h>n;n++){var u=new THREE.Path,f=this.extractGlyphPoints(l[n],o,a,s,u);s+=f.offset,c.push(f.path)}var p=s/2;return{paths:c,offset:p}},extractGlyphPoints:function(e,t,i,n,r){var o=[],a,s,l,h,c,u,f,p,d,m,g,v,E,y,T,x,b,_,w,R=t.glyphs[e]||t.glyphs["?"];if(R){if(R.o)for(h=R._cachedOutline||(R._cachedOutline=R.o.split(" ")),u=h.length,f=i,p=i,a=0;u>a;)switch(c=h[a++]){case"m":d=h[a++]*f+n,m=h[a++]*p,r.moveTo(d,m);break;case"l":d=h[a++]*f+n,m=h[a++]*p,r.lineTo(d,m);break;case"q":if(g=h[a++]*f+n,v=h[a++]*p,T=h[a++]*f+n,x=h[a++]*p,r.quadraticCurveTo(T,x,g,v),w=o[o.length-1])for(E=w.x,y=w.y,s=1,l=this.divisions;l>=s;s++)var H=s/l,M=THREE.Shape.Utils.b2(H,E,T,g),S=THREE.Shape.Utils.b2(H,y,x,v);break;case"b":if(g=h[a++]*f+n,v=h[a++]*p,T=h[a++]*f+n,x=h[a++]*-p,b=h[a++]*f+n,_=h[a++]*-p,r.bezierCurveTo(g,v,T,x,b,_),w=o[o.length-1])for(E=w.x,y=w.y,s=1,l=this.divisions;l>=s;s++)var H=s/l,M=THREE.Shape.Utils.b3(H,E,T,b,g),S=THREE.Shape.Utils.b3(H,y,x,_,v)}return{offset:R.ha*i,path:r}}}},THREE.FontUtils.generateShapes=function(e,t){t=t||{};var i=void 0!==t.size?t.size:100,n=void 0!==t.curveSegments?t.curveSegments:4,r=void 0!==t.font?t.font:"helvetiker",o=void 0!==t.weight?t.weight:"normal",a=void 0!==t.style?t.style:"normal";THREE.FontUtils.size=i,THREE.FontUtils.divisions=n,THREE.FontUtils.face=r,THREE.FontUtils.weight=o,THREE.FontUtils.style=a;for(var s=THREE.FontUtils.drawText(e),l=s.paths,h=[],c=0,u=l.length;u>c;c++)Array.prototype.push.apply(h,l[c].toShapes());return h},function(e){var t=1e-10,i=function(e,t){var i=e.length;if(3>i)return null;var o=[],a=[],s=[],l,h,c;if(n(e)>0)for(h=0;i>h;h++)a[h]=h;else for(h=0;i>h;h++)a[h]=i-1-h;var u=i,f=2*u;for(h=u-1;u>2;){if(f--<=0)return console.log("Warning, unable to triangulate polygon!"),t?s:o;if(l=h,l>=u&&(l=0),h=l+1,h>=u&&(h=0),c=h+1,c>=u&&(c=0),r(e,l,h,c,u,a)){var p,d,m,g,v;for(p=a[l],d=a[h],m=a[c],o.push([e[p],e[d],e[m]]),s.push([a[l],a[h],a[c]]),g=h,v=h+1;u>v;g++,v++)a[g]=a[v];u--,f=2*u}}return t?s:o},n=function(e){for(var t=e.length,i=0,n=t-1,r=0;t>r;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return.5*i},r=function(e,i,n,r,o,a){var s,l,h,c,u,f,p,d,m;if(l=e[a[i]].x,h=e[a[i]].y,c=e[a[n]].x,u=e[a[n]].y,f=e[a[r]].x,p=e[a[r]].y,t>(c-l)*(p-h)-(u-h)*(f-l))return!1;var g,v,E,y,T,x,b,_,w,R,H,M,S,C,A;for(g=f-c,v=p-u,E=l-f,y=h-p,T=c-l,x=u-h,s=0;o>s;s++)if(s!==i&&s!==n&&s!==r&&(d=e[a[s]].x,m=e[a[s]].y,b=d-l,_=m-h,w=d-c,R=m-u,H=d-f,M=m-p,A=g*R-v*w,S=T*_-x*b,C=E*M-y*H,A>=0&&C>=0&&S>=0))return!1;return!0};return e.Triangulate=i,e.Triangulate.area=n,e}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.Curve=function(){},THREE.Curve.prototype.getPoint=function(e){return console.log("Warning, getPoint() not implemented!"),null},THREE.Curve.prototype.getPointAt=function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},THREE.Curve.prototype.getPoints=function(e){e||(e=5);var t,i=[];for(t=0;e>=t;t++)i.push(this.getPoint(t/e));return i},THREE.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var t,i=[];for(t=0;e>=t;t++)i.push(this.getPointAt(t/e));return i},THREE.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]},THREE.Curve.prototype.getLengths=function(e){if(e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t=[],i,n=this.getPoint(0),r,o=0;for(t.push(0),r=1;e>=r;r++)i=this.getPoint(r/e),o+=i.distanceTo(n),t.push(o),n=i;return this.cacheArcLengths=t,t},THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},THREE.Curve.prototype.getUtoTmapping=function(e,t){var i=this.getLengths(),n=0,r=i.length,o;o=t?t:e*i[r-1];for(var a=0,s=r-1,l;s>=a;)if(n=Math.floor(a+(s-a)/2),l=i[n]-o,0>l)a=n+1;else{if(!(l>0)){s=n;break}s=n-1}if(n=s,i[n]==o){var h=n/(r-1);return h}var c=i[n],u=i[n+1],f=u-c,p=(o-c)/f,h=(n+p)/(r-1);return h},THREE.Curve.prototype.getTangent=function(e){var t=1e-4,i=e-t,n=e+t;0>i&&(i=0),n>1&&(n=1);var r=this.getPoint(i),o=this.getPoint(n),a=o.clone().sub(r);return a.normalize()},THREE.Curve.prototype.getTangentAt=function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},THREE.LineCurve=function(e,t){this.v1=e,this.v2=t},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},THREE.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},THREE.LineCurve.prototype.getTangent=function(e){var t=this.v2.clone().sub(this.v1);return t.normalize()},THREE.QuadraticBezierCurve=function(e,t,i){this.v0=e,this.v1=t,this.v2=i},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.getPoint=function(e){var t,i;return t=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),i=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),new THREE.Vector2(t,i)},THREE.QuadraticBezierCurve.prototype.getTangent=function(e){var t,i;t=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x),i=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y);var n=new THREE.Vector2(t,i);return n.normalize(),n},THREE.CubicBezierCurve=function(e,t,i,n){this.v0=e,this.v1=t,this.v2=i,this.v3=n},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.getPoint=function(e){var t,i;return t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new THREE.Vector2(t,i)},THREE.CubicBezierCurve.prototype.getTangent=function(e){var t,i;t=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var n=new THREE.Vector2(t,i);return n.normalize(),n},THREE.SplineCurve=function(e){this.points=void 0==e?[]:e},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.getPoint=function(e){var t=new THREE.Vector2,i=[],n=this.points,r,o,a;return r=(n.length-1)*e,o=Math.floor(r),a=r-o,i[0]=0==o?o:o-1,i[1]=o,i[2]=o>n.length-2?n.length-1:o+1,i[3]=o>n.length-3?n.length-1:o+2,t.x=THREE.Curve.Utils.interpolate(n[i[0]].x,n[i[1]].x,n[i[2]].x,n[i[3]].x,a),t.y=THREE.Curve.Utils.interpolate(n[i[0]].y,n[i[1]].y,n[i[2]].y,n[i[3]].y,a),t},THREE.EllipseCurve=function(e,t,i,n,r,o,a){this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.getPoint=function(e){var t=this.aEndAngle-this.aStartAngle;this.aClockwise||(e=1-e);var i=this.aStartAngle+e*t,n=this.aX+this.xRadius*Math.cos(i),r=this.aY+this.yRadius*Math.sin(i);return new THREE.Vector2(n,r)},THREE.ArcCurve=function(e,t,i,n,r,o){THREE.EllipseCurve.call(this,e,t,i,i,n,r,o)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.Curve.Utils={tangentQuadraticBezier:function(e,t,i,n){return 2*(1-e)*(i-t)+2*e*(n-i)},tangentCubicBezier:function(e,t,i,n,r){return-3*t*(1-e)*(1-e)+3*i*(1-e)*(1-e)-6*e*i*(1-e)+6*e*n*(1-e)-3*e*e*n+3*e*e*r},tangentSpline:function(e,t,i,n,r){var o=6*e*e-6*e,a=3*e*e-4*e+1,s=-6*e*e+6*e,l=3*e*e-2*e;return o+a+s+l},interpolate:function(e,t,i,n,r){var o=.5*(i-e),a=.5*(n-t),s=r*r,l=r*s;return(2*t-2*i+o+a)*l+(-3*t+3*i-2*o-a)*s+o*r+t}},THREE.Curve.create=function(e,t){return e.prototype=Object.create(THREE.Curve.prototype),e.prototype.getPoint=t,e},THREE.LineCurve3=THREE.Curve.create(function(e,t){this.v1=e,this.v2=t},function(e){var t=new THREE.Vector3;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(e,t,i){this.v0=e,this.v1=t,this.v2=i},function(e){var t,i,n;return t=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),i=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),n=THREE.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z),new THREE.Vector3(t,i,n)}),THREE.CubicBezierCurve3=THREE.Curve.create(function(e,t,i,n){this.v0=e,this.v1=t,this.v2=i,this.v3=n},function(e){var t,i,n;return t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),i=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),n=THREE.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new THREE.Vector3(t,i,n)}),THREE.SplineCurve3=THREE.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t=new THREE.Vector3,i=[],n=this.points,r,o,a;r=(n.length-1)*e,o=Math.floor(r),a=r-o,i[0]=0==o?o:o-1,i[1]=o,i[2]=o>n.length-2?n.length-1:o+1,i[3]=o>n.length-3?n.length-1:o+2;var s=n[i[0]],l=n[i[1]],h=n[i[2]],c=n[i[3]];return t.x=THREE.Curve.Utils.interpolate(s.x,l.x,h.x,c.x,a),t.y=THREE.Curve.Utils.interpolate(s.y,l.y,h.y,c.y,a),t.z=THREE.Curve.Utils.interpolate(s.z,l.z,h.z,c.z,a),t}),THREE.ClosedSplineCurve3=THREE.Curve.create(function(e){this.points=void 0==e?[]:e
},function(e){var t=new THREE.Vector3,i=[],n=this.points,r,o,a;return r=(n.length-0)*e,o=Math.floor(r),a=r-o,o+=o>0?0:(Math.floor(Math.abs(o)/n.length)+1)*n.length,i[0]=(o-1)%n.length,i[1]=o%n.length,i[2]=(o+1)%n.length,i[3]=(o+2)%n.length,t.x=THREE.Curve.Utils.interpolate(n[i[0]].x,n[i[1]].x,n[i[2]].x,n[i[3]].x,a),t.y=THREE.Curve.Utils.interpolate(n[i[0]].y,n[i[1]].y,n[i[2]].y,n[i[3]].y,a),t.z=THREE.Curve.Utils.interpolate(n[i[0]].z,n[i[1]].z,n[i[2]].z,n[i[3]].z,a),t}),THREE.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.add=function(e){this.curves.push(e)},THREE.CurvePath.prototype.checkConnection=function(){},THREE.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new THREE.LineCurve(t,e))},THREE.CurvePath.prototype.getPoint=function(e){for(var t=e*this.getLength(),i=this.getCurveLengths(),n=0,r,o;n<i.length;){if(i[n]>=t){r=i[n]-t,o=this.curves[n];var a=1-r/o.getLength();return o.getPointAt(a);break}n++}return null},THREE.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e=[],t=0,i,n=this.curves.length;for(i=0;n>i;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e},THREE.CurvePath.prototype.getBoundingBox=function(){var e=this.getPoints(),t,i,n,r,o,a;t=i=Number.NEGATIVE_INFINITY,r=o=Number.POSITIVE_INFINITY;var s,l,h,c,u=e[0]instanceof THREE.Vector3;for(c=u?new THREE.Vector3:new THREE.Vector2,l=0,h=e.length;h>l;l++)s=e[l],s.x>t?t=s.x:s.x<r&&(r=s.x),s.y>i?i=s.y:s.y<o&&(o=s.y),u&&(s.z>n?n=s.z:s.z<a&&(a=s.z)),c.add(s);var f={minX:r,minY:o,maxX:t,maxY:i,centroid:c.divideScalar(h)};return u&&(f.maxZ=n,f.minZ=a),f},THREE.CurvePath.prototype.createPointsGeometry=function(e){var t=this.getPoints(e,!0);return this.createGeometry(t)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(e){var t=this.getSpacedPoints(e,!0);return this.createGeometry(t)},THREE.CurvePath.prototype.createGeometry=function(e){for(var t=new THREE.Geometry,i=0;i<e.length;i++)t.vertices.push(new THREE.Vector3(e[i].x,e[i].y,e[i].z||0));return t},THREE.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)},THREE.CurvePath.prototype.getTransformedPoints=function(e,t){var i=this.getPoints(e),n,r;for(t||(t=this.bends),n=0,r=t.length;r>n;n++)i=this.getWrapPoints(i,t[n]);return i},THREE.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var i=this.getSpacedPoints(e),n,r;for(t||(t=this.bends),n=0,r=t.length;r>n;n++)i=this.getWrapPoints(i,t[n]);return i},THREE.CurvePath.prototype.getWrapPoints=function(e,t){var i=this.getBoundingBox(),n,r,o,a,s,l;for(n=0,r=e.length;r>n;n++){o=e[n],a=o.x,s=o.y,l=a/i.maxX,l=t.getUtoTmapping(l,a);var h=t.getPoint(l),c=t.getNormalVector(l).multiplyScalar(s);o.x=h.x+c.x,o.y=h.y+c.y}return e},THREE.Gyroscope=function(){THREE.Object3D.call(this)},THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype),THREE.Gyroscope.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.rotationWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.rotationObject,this.scaleObject),this.matrixWorld.makeFromPositionQuaternionScale(this.translationWorld,this.rotationObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,i=this.children.length;i>t;t++)this.children[t].updateMatrixWorld(e)},THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3,THREE.Gyroscope.prototype.translationObject=new THREE.Vector3,THREE.Gyroscope.prototype.rotationWorld=new THREE.Quaternion,THREE.Gyroscope.prototype.rotationObject=new THREE.Quaternion,THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3,THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3,THREE.Path=function(e){THREE.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},THREE.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;i>t;t++)this.lineTo(e[t].x,e[t].y)},THREE.Path.prototype.moveTo=function(e,t){var i=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:i})},THREE.Path.prototype.lineTo=function(e,t){var i=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,r=n[n.length-2],o=n[n.length-1],a=new THREE.LineCurve(new THREE.Vector2(r,o),new THREE.Vector2(e,t));this.curves.push(a),this.actions.push({action:THREE.PathActions.LINE_TO,args:i})},THREE.Path.prototype.quadraticCurveTo=function(e,t,i,n){var r=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,a=o[o.length-2],s=o[o.length-1],l=new THREE.QuadraticBezierCurve(new THREE.Vector2(a,s),new THREE.Vector2(e,t),new THREE.Vector2(i,n));this.curves.push(l),this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:r})},THREE.Path.prototype.bezierCurveTo=function(e,t,i,n,r,o){var a=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,l=s[s.length-2],h=s[s.length-1],c=new THREE.CubicBezierCurve(new THREE.Vector2(l,h),new THREE.Vector2(e,t),new THREE.Vector2(i,n),new THREE.Vector2(r,o));this.curves.push(c),this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:a})},THREE.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,n=i[i.length-2],r=i[i.length-1],o=[new THREE.Vector2(n,r)];Array.prototype.push.apply(o,e);var a=new THREE.SplineCurve(o);this.curves.push(a),this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:t})},THREE.Path.prototype.arc=function(e,t,i,n,r,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],l=a[a.length-1];this.absarc(e+s,t+l,i,n,r,o)},THREE.Path.prototype.absarc=function(e,t,i,n,r,o){this.absellipse(e,t,i,i,n,r,o)},THREE.Path.prototype.ellipse=function(e,t,i,n,r,o,a){var s=this.actions[this.actions.length-1].args,l=s[s.length-2],h=s[s.length-1];this.absellipse(e+l,t+h,i,n,r,o,a)},THREE.Path.prototype.absellipse=function(e,t,i,n,r,o,a){var s=Array.prototype.slice.call(arguments),l=new THREE.EllipseCurve(e,t,i,n,r,o,a);this.curves.push(l);var h=l.getPoint(a?1:0);s.push(h.x),s.push(h.y),this.actions.push({action:THREE.PathActions.ELLIPSE,args:s})},THREE.Path.prototype.getSpacedPoints=function(e,t){e||(e=40);for(var i=[],n=0;e>n;n++)i.push(this.getPoint(n/e));return i},THREE.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(e,t);e=e||12;var i=[],n,r,o,a,s,l,h,c,u,f,p,d,m,g,v,E,y,T;for(n=0,r=this.actions.length;r>n;n++)switch(o=this.actions[n],a=o.action,s=o.args,a){case THREE.PathActions.MOVE_TO:i.push(new THREE.Vector2(s[0],s[1]));break;case THREE.PathActions.LINE_TO:i.push(new THREE.Vector2(s[0],s[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:for(l=s[2],h=s[3],f=s[0],p=s[1],i.length>0?(g=i[i.length-1],d=g.x,m=g.y):(g=this.actions[n-1].args,d=g[g.length-2],m=g[g.length-1]),v=1;e>=v;v++)E=v/e,y=THREE.Shape.Utils.b2(E,d,f,l),T=THREE.Shape.Utils.b2(E,m,p,h),i.push(new THREE.Vector2(y,T));break;case THREE.PathActions.BEZIER_CURVE_TO:for(l=s[4],h=s[5],f=s[0],p=s[1],c=s[2],u=s[3],i.length>0?(g=i[i.length-1],d=g.x,m=g.y):(g=this.actions[n-1].args,d=g[g.length-2],m=g[g.length-1]),v=1;e>=v;v++)E=v/e,y=THREE.Shape.Utils.b3(E,d,f,c,l),T=THREE.Shape.Utils.b3(E,m,p,u,h),i.push(new THREE.Vector2(y,T));break;case THREE.PathActions.CSPLINE_THRU:g=this.actions[n-1].args;var x=new THREE.Vector2(g[g.length-2],g[g.length-1]),b=[x],_=e*s[0].length;b=b.concat(s[0]);var w=new THREE.SplineCurve(b);for(v=1;_>=v;v++)i.push(w.getPointAt(v/_));break;case THREE.PathActions.ARC:var R=s[0],H=s[1],M=s[2],S=s[3],C=s[4],A=!!s[5],D=C-S,k,P=2*e;for(v=1;P>=v;v++)E=v/P,A||(E=1-E),k=S+E*D,y=R+M*Math.cos(k),T=H+M*Math.sin(k),i.push(new THREE.Vector2(y,T));break;case THREE.PathActions.ELLIPSE:var R=s[0],H=s[1],L=s[2],N=s[3],S=s[4],C=s[5],A=!!s[6],D=C-S,k,P=2*e;for(v=1;P>=v;v++)E=v/P,A||(E=1-E),k=S+E*D,y=R+L*Math.cos(k),T=H+N*Math.sin(k),i.push(new THREE.Vector2(y,T))}var z=i[i.length-1],F=1e-10;return Math.abs(z.x-i[0].x)<F&&Math.abs(z.y-i[0].y)<F&&i.splice(i.length-1,1),t&&i.push(i[0]),i},THREE.Path.prototype.toShapes=function(){var e,t,i,n,r,o=[],a=new THREE.Path;for(e=0,t=this.actions.length;t>e;e++)i=this.actions[e],r=i.args,n=i.action,n==THREE.PathActions.MOVE_TO&&0!=a.actions.length&&(o.push(a),a=new THREE.Path),a[n].apply(a,r);if(0!=a.actions.length&&o.push(a),0==o.length)return[];var s,l,h=[],c=!THREE.Shape.Utils.isClockWise(o[0].getPoints());if(1==o.length)return s=o[0],l=new THREE.Shape,l.actions=s.actions,l.curves=s.curves,h.push(l),h;if(c)for(l=new THREE.Shape,e=0,t=o.length;t>e;e++)s=o[e],THREE.Shape.Utils.isClockWise(s.getPoints())?(l.actions=s.actions,l.curves=s.curves,h.push(l),l=new THREE.Shape):l.holes.push(s);else{for(e=0,t=o.length;t>e;e++)s=o[e],THREE.Shape.Utils.isClockWise(s.getPoints())?(l&&h.push(l),l=new THREE.Shape,l.actions=s.actions,l.curves=s.curves):l.holes.push(s);h.push(l)}return h},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.extrude=function(e){var t=new THREE.ExtrudeGeometry(this,e);return t},THREE.Shape.prototype.makeGeometry=function(e){var t=new THREE.ShapeGeometry(this,e);return t},THREE.Shape.prototype.getPointsHoles=function(e){var t,i=this.holes.length,n=[];for(t=0;i>t;t++)n[t]=this.holes[t].getTransformedPoints(e,this.bends);return n},THREE.Shape.prototype.getSpacedPointsHoles=function(e){var t,i=this.holes.length,n=[];for(t=0;i>t;t++)n[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return n},THREE.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},THREE.Shape.prototype.extractPoints=function(e){return this.useSpacedPoints?this.extractAllSpacedPoints(e):this.extractAllPoints(e)},THREE.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}},THREE.Shape.Utils={removeHoles:function(e,t){var i=e.concat(),n=i.concat(),r,o,a,s,l,h,c,u,f,p,d,m,g,v,E,y,T,x,b,_,w=[];for(f=0;f<t.length;f++){for(d=t[f],Array.prototype.push.apply(n,d),m=Number.POSITIVE_INFINITY,p=0;p<d.length;p++){E=d[p];var R=[];for(v=0;v<i.length;v++)y=i[v],g=E.distanceToSquared(y),R.push(g),m>g&&(m=g,l=p,h=v)}r=h-1>=0?h-1:i.length-1,a=l-1>=0?l-1:d.length-1;var H=[d[l],i[h],i[r]],M=THREE.FontUtils.Triangulate.area(H),S=[d[l],d[a],i[h]],C=THREE.FontUtils.Triangulate.area(S),A=1,D=-1,k=h,P=l;h+=A,l+=D,0>h&&(h+=i.length),h%=i.length,0>l&&(l+=d.length),l%=d.length,r=h-1>=0?h-1:i.length-1,a=l-1>=0?l-1:d.length-1,H=[d[l],i[h],i[r]];var L=THREE.FontUtils.Triangulate.area(H);S=[d[l],d[a],i[h]];var N=THREE.FontUtils.Triangulate.area(S);M+C>L+N&&(h=k,l=P,0>h&&(h+=i.length),h%=i.length,0>l&&(l+=d.length),l%=d.length,r=h-1>=0?h-1:i.length-1,a=l-1>=0?l-1:d.length-1),T=i.slice(0,h),x=i.slice(h),b=d.slice(l),_=d.slice(0,l);var z=[d[l],i[h],i[r]],F=[d[l],d[a],i[h]];w.push(z),w.push(F),i=T.concat(b).concat(_).concat(x)}return{shape:i,isolatedPts:w,allpoints:n}},triangulateShape:function(e,t){var i=THREE.Shape.Utils.removeHoles(e,t),n=i.shape,r=i.allpoints,o=i.isolatedPts,a=THREE.FontUtils.Triangulate(n,!1),s,l,h,c,u,f,p={},d={};for(s=0,l=r.length;l>s;s++)u=r[s].x+":"+r[s].y,void 0!==p[u]&&console.log("Duplicate point",u),p[u]=s;for(s=0,l=a.length;l>s;s++)for(c=a[s],h=0;3>h;h++)u=c[h].x+":"+c[h].y,f=p[u],void 0!==f&&(c[h]=f);for(s=0,l=o.length;l>s;s++)for(c=o[s],h=0;3>h;h++)u=c[h].x+":"+c[h].y,f=p[u],void 0!==f&&(c[h]=f);return a.concat(o)},isClockWise:function(e){return THREE.FontUtils.Triangulate.area(e)<0},b2p0:function(e,t){var i=1-e;return i*i*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,i,n){return this.b2p0(e,t)+this.b2p1(e,i)+this.b2p2(e,n)},b3p0:function(e,t){var i=1-e;return i*i*i*t},b3p1:function(e,t){var i=1-e;return 3*i*i*e*t},b3p2:function(e,t){var i=1-e;return 3*i*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,i,n,r){return this.b3p0(e,t)+this.b3p1(e,i)+this.b3p2(e,n)+this.b3p3(e,r)}},THREE.AnimationHandler=function(){var e=[],t={},i={};i.update=function(t){for(var i=0;i<e.length;i++)e[i].update(t)},i.addToUpdate=function(t){-1===e.indexOf(t)&&e.push(t)},i.removeFromUpdate=function(t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)},i.add=function(e){void 0!==t[e.name]&&console.log("THREE.AnimationHandler.add: Warning! "+e.name+" already exists in library. Overwriting."),t[e.name]=e,r(e)},i.get=function(e){return"string"==typeof e?t[e]?t[e]:(console.log("THREE.AnimationHandler.get: Couldn't find animation "+e),null):void 0},i.parse=function(e){var t=[];if(e instanceof THREE.SkinnedMesh)for(var i=0;i<e.bones.length;i++)t.push(e.bones[i]);else n(e,t);return t};var n=function(e,t){t.push(e);for(var i=0;i<e.children.length;i++)n(e.children[i],t)},r=function(e){if(e.initialized!==!0){for(var t=0;t<e.hierarchy.length;t++){for(var i=0;i<e.hierarchy[t].keys.length;i++)if(e.hierarchy[t].keys[i].time<0&&(e.hierarchy[t].keys[i].time=0),void 0!==e.hierarchy[t].keys[i].rot&&!(e.hierarchy[t].keys[i].rot instanceof THREE.Quaternion)){var n=e.hierarchy[t].keys[i].rot;e.hierarchy[t].keys[i].rot=new THREE.Quaternion(n[0],n[1],n[2],n[3])}if(e.hierarchy[t].keys.length&&void 0!==e.hierarchy[t].keys[0].morphTargets){for(var r={},i=0;i<e.hierarchy[t].keys.length;i++)for(var o=0;o<e.hierarchy[t].keys[i].morphTargets.length;o++){var a=e.hierarchy[t].keys[i].morphTargets[o];r[a]=-1}e.hierarchy[t].usedMorphTargets=r;for(var i=0;i<e.hierarchy[t].keys.length;i++){var s={};for(var a in r){for(var o=0;o<e.hierarchy[t].keys[i].morphTargets.length;o++)if(e.hierarchy[t].keys[i].morphTargets[o]===a){s[a]=e.hierarchy[t].keys[i].morphTargetsInfluences[o];break}o===e.hierarchy[t].keys[i].morphTargets.length&&(s[a]=0)}e.hierarchy[t].keys[i].morphTargetsInfluences=s}}for(var i=1;i<e.hierarchy[t].keys.length;i++)e.hierarchy[t].keys[i].time===e.hierarchy[t].keys[i-1].time&&(e.hierarchy[t].keys.splice(i,1),i--);for(var i=0;i<e.hierarchy[t].keys.length;i++)e.hierarchy[t].keys[i].index=i}var l=parseInt(e.length*e.fps,10);e.JIT={},e.JIT.hierarchy=[];for(var t=0;t<e.hierarchy.length;t++)e.JIT.hierarchy.push(new Array(l));e.initialized=!0}};return i.LINEAR=0,i.CATMULLROM=1,i.CATMULLROM_FORWARD=2,i}(),THREE.Animation=function(e,t,i){this.root=e,this.data=THREE.AnimationHandler.get(t),this.hierarchy=THREE.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.interpolationType=void 0!==i?i:THREE.AnimationHandler.LINEAR,this.points=[],this.target=new THREE.Vector3},THREE.Animation.prototype.play=function(e,t){if(this.isPlaying===!1){this.isPlaying=!0,this.loop=void 0!==e?e:!0,this.currentTime=void 0!==t?t:0;var i,n=this.hierarchy.length,r;for(i=0;n>i;i++){r=this.hierarchy[i],this.interpolationType!==THREE.AnimationHandler.CATMULLROM_FORWARD&&(r.useQuaternion=!0),r.matrixAutoUpdate=!0,void 0===r.animationCache&&(r.animationCache={},r.animationCache.prevKey={pos:0,rot:0,scl:0},r.animationCache.nextKey={pos:0,rot:0,scl:0},r.animationCache.originalMatrix=r instanceof THREE.Bone?r.skinMatrix:r.matrix);var o=r.animationCache.prevKey,a=r.animationCache.nextKey;o.pos=this.data.hierarchy[i].keys[0],o.rot=this.data.hierarchy[i].keys[0],o.scl=this.data.hierarchy[i].keys[0],a.pos=this.getNextKeyWith("pos",i,1),a.rot=this.getNextKeyWith("rot",i,1),a.scl=this.getNextKeyWith("scl",i,1)}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.Animation.prototype.pause=function(){this.isPaused===!0?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.Animation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this)},THREE.Animation.prototype.update=function(e){if(this.isPlaying!==!1){var t=["pos","rot","scl"],i,n,r,o,a,s,l,h,c,u,f=this.data.JIT.hierarchy,p,d,m,g,v;this.currentTime+=e*this.timeScale,d=this.currentTime,p=this.currentTime=this.currentTime%this.data.length,u=parseInt(Math.min(p*this.data.fps,this.data.length*this.data.fps),10);for(var E=0,y=this.hierarchy.length;y>E;E++){h=this.hierarchy[E],c=h.animationCache;for(var T=0;3>T;T++){if(i=t[T],s=c.prevKey[i],l=c.nextKey[i],l.time<=d){if(d>p){if(!this.loop)return void this.stop();for(s=this.data.hierarchy[E].keys[0],l=this.getNextKeyWith(i,E,1);l.time<p;)s=l,l=this.getNextKeyWith(i,E,l.index+1)}else do s=l,l=this.getNextKeyWith(i,E,l.index+1);while(l.time<p);c.prevKey[i]=s,c.nextKey[i]=l}h.matrixAutoUpdate=!0,h.matrixWorldNeedsUpdate=!0,n=(p-s.time)/(l.time-s.time),o=s[i],a=l[i],(0>n||n>1)&&(console.log("THREE.Animation.update: Warning! Scale out of bounds:"+n+" on bone "+E),n=0>n?0:1),"pos"===i?(r=h.position,this.interpolationType===THREE.AnimationHandler.LINEAR?(r.x=o[0]+(a[0]-o[0])*n,r.y=o[1]+(a[1]-o[1])*n,r.z=o[2]+(a[2]-o[2])*n):(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)&&(this.points[0]=this.getPrevKeyWith("pos",E,s.index-1).pos,this.points[1]=o,this.points[2]=a,this.points[3]=this.getNextKeyWith("pos",E,l.index+1).pos,n=.33*n+.33,m=this.interpolateCatmullRom(this.points,n),r.x=m[0],r.y=m[1],r.z=m[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(g=this.interpolateCatmullRom(this.points,1.01*n),this.target.set(g[0],g[1],g[2]),this.target.sub(r),this.target.y=0,this.target.normalize(),v=Math.atan2(this.target.x,this.target.z),h.rotation.set(0,v,0)))):"rot"===i?THREE.Quaternion.slerp(o,a,h.quaternion,n):"scl"===i&&(r=h.scale,r.x=o[0]+(a[0]-o[0])*n,r.y=o[1]+(a[1]-o[1])*n,r.z=o[2]+(a[2]-o[2])*n)}}}},THREE.Animation.prototype.interpolateCatmullRom=function(e,t){var i=[],n=[],r,o,a,s,l,h,c,u,f;return r=(e.length-1)*t,o=Math.floor(r),a=r-o,i[0]=0===o?o:o-1,i[1]=o,i[2]=o>e.length-2?o:o+1,i[3]=o>e.length-3?o:o+2,h=e[i[0]],c=e[i[1]],u=e[i[2]],f=e[i[3]],s=a*a,l=a*s,n[0]=this.interpolate(h[0],c[0],u[0],f[0],a,s,l),n[1]=this.interpolate(h[1],c[1],u[1],f[1],a,s,l),n[2]=this.interpolate(h[2],c[2],u[2],f[2],a,s,l),n},THREE.Animation.prototype.interpolate=function(e,t,i,n,r,o,a){var s=.5*(i-e),l=.5*(n-t);return(2*(t-i)+s+l)*a+(-3*(t-i)-2*s-l)*o+s*r+t},THREE.Animation.prototype.getNextKeyWith=function(e,t,i){var n=this.data.hierarchy[t].keys;for(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?i=i<n.length-1?i:n.length-1:i%=n.length;i<n.length;i++)if(void 0!==n[i][e])return n[i];return this.data.hierarchy[t].keys[0]},THREE.Animation.prototype.getPrevKeyWith=function(e,t,i){var n=this.data.hierarchy[t].keys;for(i=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?i>0?i:0:i>=0?i:i+n.length;i>=0;i--)if(void 0!==n[i][e])return n[i];return this.data.hierarchy[t].keys[n.length-1]},THREE.KeyFrameAnimation=function(e,t,i){this.root=e,this.data=THREE.AnimationHandler.get(t),this.hierarchy=THREE.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0,this.JITCompile=void 0!==i?i:!0;for(var n=0,r=this.hierarchy.length;r>n;n++){var o=this.data.hierarchy[n].keys,a=this.data.hierarchy[n].sids,s=this.hierarchy[n];if(o.length&&a){for(var l=0;l<a.length;l++){var h=a[l],c=this.getNextKeyWith(h,n,0);c&&c.apply(h)}s.matrixAutoUpdate=!1,this.data.hierarchy[n].node.updateMatrix(),s.matrixWorldNeedsUpdate=!0}}},THREE.KeyFrameAnimation.prototype.play=function(e,t){if(!this.isPlaying){this.isPlaying=!0,this.loop=void 0!==e?e:!0,this.currentTime=void 0!==t?t:0,this.startTimeMs=t,this.startTime=1e7,this.endTime=-this.startTime;var i,n=this.hierarchy.length,r,o;for(i=0;n>i;i++){r=this.hierarchy[i],o=this.data.hierarchy[i],r.useQuaternion=!0,void 0===o.animationCache&&(o.animationCache={},o.animationCache.prevKey=null,o.animationCache.nextKey=null,o.animationCache.originalMatrix=r instanceof THREE.Bone?r.skinMatrix:r.matrix);var a=this.data.hierarchy[i].keys;a.length&&(o.animationCache.prevKey=a[0],o.animationCache.nextKey=a[1],this.startTime=Math.min(a[0].time,this.startTime),this.endTime=Math.max(a[a.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.KeyFrameAnimation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.removeFromUpdate(this);for(var e=0;e<this.data.hierarchy.length;e++){var t=this.hierarchy[e],i=this.data.hierarchy[e];if(void 0!==i.animationCache){var n=i.animationCache.originalMatrix;t instanceof THREE.Bone?(n.copy(t.skinMatrix),t.skinMatrix=n):(n.copy(t.matrix),t.matrix=n),delete i.animationCache}}},THREE.KeyFrameAnimation.prototype.update=function(e){if(this.isPlaying){var t,i,n,r,o,a=this.data.JIT.hierarchy,s,l,h;if(this.currentTime+=e*this.timeScale,l=this.currentTime,s=this.currentTime=this.currentTime%this.data.length,s<this.startTimeMs&&(s=this.currentTime=this.startTimeMs+s),o=parseInt(Math.min(s*this.data.fps,this.data.length*this.data.fps),10),h=l>s,h&&!this.loop){for(var c=0,u=this.hierarchy.length;u>c;c++){var f=this.data.hierarchy[c].keys,p=this.data.hierarchy[c].sids,d=f.length-1,m=this.hierarchy[c];if(f.length){for(var g=0;g<p.length;g++){var v=p[g],E=this.getPrevKeyWith(v,c,d);E&&E.apply(v)}this.data.hierarchy[c].node.updateMatrix(),m.matrixWorldNeedsUpdate=!0}}return void this.stop()}if(!(s<this.startTime)){for(var c=0,u=this.hierarchy.length;u>c;c++){n=this.hierarchy[c],r=this.data.hierarchy[c];var f=r.keys,y=r.animationCache;if(this.JITCompile&&void 0!==a[c][o])n instanceof THREE.Bone?(n.skinMatrix=a[c][o],n.matrixWorldNeedsUpdate=!1):(n.matrix=a[c][o],n.matrixWorldNeedsUpdate=!0);else if(f.length){if(this.JITCompile&&y&&(n instanceof THREE.Bone?n.skinMatrix=y.originalMatrix:n.matrix=y.originalMatrix),t=y.prevKey,i=y.nextKey,t&&i){if(i.time<=l){if(h&&this.loop)for(t=f[0],i=f[1];i.time<s;)t=i,i=f[t.index+1];else if(!h)for(var T=f.length-1;i.time<s&&i.index!==T;)t=i,i=f[t.index+1];y.prevKey=t,y.nextKey=i}i.time>=s?t.interpolate(i,s):t.interpolate(i,i.time)}this.data.hierarchy[c].node.updateMatrix(),n.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===a[0][o]){this.hierarchy[0].updateMatrixWorld(!0);for(var c=0;c<this.hierarchy.length;c++)a[c][o]=this.hierarchy[c]instanceof THREE.Bone?this.hierarchy[c].skinMatrix.clone():this.hierarchy[c].matrix.clone()}}}},THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(e,t,i){var n=this.data.hierarchy[t].keys;for(i%=n.length;i<n.length;i++)if(n[i].hasTarget(e))return n[i];return n[0]},THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(e,t,i){var n=this.data.hierarchy[t].keys;for(i=i>=0?i:i+n.length;i>=0;i--)if(n[i].hasTarget(e))return n[i];return n[n.length-1]},THREE.CubeCamera=function(e,t,i){THREE.Object3D.call(this);var n=90,r=1,o=new THREE.PerspectiveCamera(n,r,e,t);o.up.set(0,-1,0),o.lookAt(new THREE.Vector3(1,0,0)),this.add(o);var a=new THREE.PerspectiveCamera(n,r,e,t);a.up.set(0,-1,0),a.lookAt(new THREE.Vector3(-1,0,0)),this.add(a);var s=new THREE.PerspectiveCamera(n,r,e,t);s.up.set(0,0,1),s.lookAt(new THREE.Vector3(0,1,0)),this.add(s);var l=new THREE.PerspectiveCamera(n,r,e,t);l.up.set(0,0,-1),l.lookAt(new THREE.Vector3(0,-1,0)),this.add(l);var h=new THREE.PerspectiveCamera(n,r,e,t);h.up.set(0,-1,0),h.lookAt(new THREE.Vector3(0,0,1)),this.add(h);var c=new THREE.PerspectiveCamera(n,r,e,t);c.up.set(0,-1,0),c.lookAt(new THREE.Vector3(0,0,-1)),this.add(c),this.renderTarget=new THREE.WebGLRenderTargetCube(i,i,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(e,t){var i=this.renderTarget,n=i.generateMipmaps;i.generateMipmaps=!1,i.activeCubeFace=0,e.render(t,o,i),i.activeCubeFace=1,e.render(t,a,i),i.activeCubeFace=2,e.render(t,s,i),i.activeCubeFace=3,e.render(t,l,i),i.activeCubeFace=4,e.render(t,h,i),i.generateMipmaps=n,i.activeCubeFace=5,e.render(t,c,i)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CombinedCamera=function(e,t,i,n,r,o,a){THREE.Camera.call(this),this.fov=i,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2,this.cameraO=new THREE.OrthographicCamera(e/-2,e/2,t/2,t/-2,o,a),this.cameraP=new THREE.PerspectiveCamera(i,e/t,n,r),this.zoom=1,this.toPerspective();var s=e/t},THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype),THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near,this.far=this.cameraP.far,this.cameraP.fov=this.fov/this.zoom,this.cameraP.updateProjectionMatrix(),this.projectionMatrix=this.cameraP.projectionMatrix,this.inPerspectiveMode=!0,this.inOrthographicMode=!1},THREE.CombinedCamera.prototype.toOrthographic=function(){var e=this.fov,t=this.cameraP.aspect,i=this.cameraP.near,n=this.cameraP.far,r=(i+n)/2,o=Math.tan(e/2)*r,a=2*o,s=a*t,l=s/2;o/=this.zoom,l/=this.zoom,this.cameraO.left=-l,this.cameraO.right=l,this.cameraO.top=o,this.cameraO.bottom=-o,this.cameraO.updateProjectionMatrix(),this.near=this.cameraO.near,this.far=this.cameraO.far,this.projectionMatrix=this.cameraO.projectionMatrix,this.inPerspectiveMode=!1,this.inOrthographicMode=!0},THREE.CombinedCamera.prototype.setSize=function(e,t){this.cameraP.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2},THREE.CombinedCamera.prototype.setFov=function(e){this.fov=e,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())},THREE.CombinedCamera.prototype.setLens=function(e,t){void 0===t&&(t=24);var i=2*THREE.Math.radToDeg(Math.atan(t/(2*e)));return this.setFov(i),i},THREE.CombinedCamera.prototype.setZoom=function(e){this.zoom=e,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0,this.rotation.y=Math.PI,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0,this.rotation.y=-Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0,this.rotation.y=Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CircleGeometry=function(e,t,i,n){THREE.Geometry.call(this),e=e||50,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI,t=void 0!==t?Math.max(3,t):8;var r,o=[],a=new THREE.Vector3,s=new THREE.Vector2(.5,.5);for(this.vertices.push(a),o.push(s),r=0;t>=r;r++){var l=new THREE.Vector3,h=i+r/t*n;l.x=e*Math.cos(h),l.y=e*Math.sin(h),this.vertices.push(l),o.push(new THREE.Vector2((l.x/e+1)/2,(l.y/e+1)/2))}var c=new THREE.Vector3(0,0,1);for(r=1;t>=r;r++){var u=r,f=r+1,p=0;this.faces.push(new THREE.Face3(u,f,p,[c,c,c])),this.faceVertexUvs[0].push([o[r],o[r+1],s])}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CubeGeometry=function(e,t,i,n,r,o){function a(e,t,i,n,r,o,a,l){var h,c,u,f=s.widthSegments,p=s.heightSegments,d=r/2,m=o/2,g=s.vertices.length;"x"===e&&"y"===t||"y"===e&&"x"===t?h="z":"x"===e&&"z"===t||"z"===e&&"x"===t?(h="y",p=s.depthSegments):("z"===e&&"y"===t||"y"===e&&"z"===t)&&(h="x",f=s.depthSegments);var v=f+1,E=p+1,y=r/f,T=o/p,x=new THREE.Vector3;for(x[h]=a>0?1:-1,u=0;E>u;u++)for(c=0;v>c;c++){var b=new THREE.Vector3;b[e]=(c*y-d)*i,b[t]=(u*T-m)*n,b[h]=a,s.vertices.push(b)}for(u=0;p>u;u++)for(c=0;f>c;c++){var _=c+v*u,w=c+v*(u+1),R=c+1+v*(u+1),H=c+1+v*u,M=new THREE.Face4(_+g,w+g,R+g,H+g);M.normal.copy(x),M.vertexNormals.push(x.clone(),x.clone(),x.clone(),x.clone()),M.materialIndex=l,s.faces.push(M),s.faceVertexUvs[0].push([new THREE.Vector2(c/f,1-u/p),new THREE.Vector2(c/f,1-(u+1)/p),new THREE.Vector2((c+1)/f,1-(u+1)/p),new THREE.Vector2((c+1)/f,1-u/p)])}}THREE.Geometry.call(this);var s=this;this.width=e,this.height=t,this.depth=i,this.widthSegments=n||1,this.heightSegments=r||1,this.depthSegments=o||1;var l=this.width/2,h=this.height/2,c=this.depth/2;a("z","y",-1,-1,this.depth,this.height,l,0),a("z","y",1,-1,this.depth,this.height,-l,1),a("x","z",1,1,this.width,this.depth,h,2),a("x","z",1,-1,this.width,this.depth,-h,3),a("x","y",1,-1,this.width,this.height,c,4),a("x","y",-1,-1,this.width,this.height,-c,5),this.computeCentroids(),this.mergeVertices()},THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry=function(e,t,i,n,r,o){THREE.Geometry.call(this),this.radiusTop=e=void 0!==e?e:20,this.radiusBottom=t=void 0!==t?t:20,this.height=i=void 0!==i?i:100,this.radiusSegments=n=n||8,this.heightSegments=r=r||1,this.openEnded=o=void 0!==o?o:!1;var a=i/2,s,l,h=[],c=[];for(l=0;r>=l;l++){var u=[],f=[],p=l/r,d=p*(t-e)+e;for(s=0;n>=s;s++){var m=s/n,g=new THREE.Vector3;g.x=d*Math.sin(m*Math.PI*2),g.y=-p*i+a,g.z=d*Math.cos(m*Math.PI*2),this.vertices.push(g),u.push(this.vertices.length-1),f.push(new THREE.Vector2(m,1-p))}h.push(u),c.push(f)}var v=(t-e)/i,E,y;for(s=0;n>s;s++)for(0!==e?(E=this.vertices[h[0][s]].clone(),y=this.vertices[h[0][s+1]].clone()):(E=this.vertices[h[1][s]].clone(),y=this.vertices[h[1][s+1]].clone()),E.setY(Math.sqrt(E.x*E.x+E.z*E.z)*v).normalize(),y.setY(Math.sqrt(y.x*y.x+y.z*y.z)*v).normalize(),l=0;r>l;l++){var T=h[l][s],x=h[l+1][s],b=h[l+1][s+1],_=h[l][s+1],w=E.clone(),R=E.clone(),H=y.clone(),M=y.clone(),S=c[l][s].clone(),C=c[l+1][s].clone(),A=c[l+1][s+1].clone(),D=c[l][s+1].clone();this.faces.push(new THREE.Face4(T,x,b,_,[w,R,H,M])),this.faceVertexUvs[0].push([S,C,A,D])}if(o===!1&&e>0)for(this.vertices.push(new THREE.Vector3(0,a,0)),s=0;n>s;s++){var T=h[0][s],x=h[0][s+1],b=this.vertices.length-1,w=new THREE.Vector3(0,1,0),R=new THREE.Vector3(0,1,0),H=new THREE.Vector3(0,1,0),S=c[0][s].clone(),C=c[0][s+1].clone(),A=new THREE.Vector2(C.u,0);this.faces.push(new THREE.Face3(T,x,b,[w,R,H])),this.faceVertexUvs[0].push([S,C,A])}if(o===!1&&t>0)for(this.vertices.push(new THREE.Vector3(0,-a,0)),s=0;n>s;s++){var T=h[l][s+1],x=h[l][s],b=this.vertices.length-1,w=new THREE.Vector3(0,-1,0),R=new THREE.Vector3(0,-1,0),H=new THREE.Vector3(0,-1,0),S=c[l][s+1].clone(),C=c[l][s].clone(),A=new THREE.Vector2(C.u,1);this.faces.push(new THREE.Face3(T,x,b,[w,R,H])),this.faceVertexUvs[0].push([S,C,A])}this.computeCentroids(),this.computeFaceNormals()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry=function(e,t){return"undefined"==typeof e?void(e=[]):(THREE.Geometry.call(this),e=e instanceof Array?e:[e],this.shapebb=e[e.length-1].getBoundingBox(),this.addShapeList(e,t),this.computeCentroids(),void this.computeFaceNormals())
},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var i=e.length,n=0;i>n;n++){var r=e[n];this.addShape(r,t)}},THREE.ExtrudeGeometry.prototype.addShape=function(e,t){function i(e,t,i){return t||console.log("die"),t.clone().multiplyScalar(i).add(e)}function n(e,t,i){return o(e,t,i)}function r(e,t,i){var n=Math.atan2(t.y-e.y,t.x-e.x),r=Math.atan2(i.y-e.y,i.x-e.x);n>r&&(r+=2*Math.PI);var o=(n+r)/2,a=-Math.cos(o),s=-Math.sin(o),l=new THREE.Vector2(a,s);return l}function o(e,t,i){var n=THREE.ExtrudeGeometry.__v1,o=THREE.ExtrudeGeometry.__v2,a=THREE.ExtrudeGeometry.__v3,s=THREE.ExtrudeGeometry.__v4,l=THREE.ExtrudeGeometry.__v5,h=THREE.ExtrudeGeometry.__v6,c,u,f,p,d,m;return n.set(e.x-t.x,e.y-t.y),o.set(e.x-i.x,e.y-i.y),c=n.normalize(),u=o.normalize(),a.set(-c.y,c.x),s.set(u.y,-u.x),l.copy(e).add(a),h.copy(e).add(s),l.equals(h)?s.clone():(l.copy(t).add(a),h.copy(i).add(s),f=c.dot(s),p=h.sub(l).dot(s),0===f&&(console.log("Either infinite or no solutions!"),console.log(0===p?"Its finite solutions.":"Too bad, no solutions.")),d=p/f,0>d?r(e,t,i):(m=c.multiplyScalar(d).add(l),m.sub(e).clone()))}function a(){if(g){var e=0,t=X*e;for(tt=0;K>tt;tt++)Y=U[tt],c(Y[2]+t,Y[1]+t,Y[0]+t,!0);for(e=E+2*m,t=X*e,tt=0;K>tt;tt++)Y=U[tt],c(Y[0]+t,Y[1]+t,Y[2]+t,!1)}else{for(tt=0;K>tt;tt++)Y=U[tt],c(Y[2],Y[1],Y[0],!0);for(tt=0;K>tt;tt++)Y=U[tt],c(Y[0]+X*E,Y[1]+X*E,Y[2]+X*E,!1)}}function s(){var e=0;for(l(V,e),e+=V.length,D=0,k=I.length;k>D;D++)A=I[D],l(A,e),e+=A.length}function l(e,t){var i,n;for(tt=e.length;--tt>=0;){i=tt,n=tt-1,0>n&&(n=e.length-1);var r=0,o=E+2*m;for(r=0;o>r;r++){var a=X*r,s=X*(r+1),l=t+i+a,h=t+n+a,c=t+n+s,f=t+i+s;u(l,h,c,f,e,r,o,i,n)}}}function h(e,t,i){P.vertices.push(new THREE.Vector3(e,t,i))}function c(i,n,r,o){i+=N,n+=N,r+=N,P.faces.push(new THREE.Face3(i,n,r,null,null,b));var a=o?w.generateBottomUV(P,e,t,i,n,r):w.generateTopUV(P,e,t,i,n,r);P.faceVertexUvs[0].push(a)}function u(i,n,r,o,a,s,l,h,c){i+=N,n+=N,r+=N,o+=N,P.faces.push(new THREE.Face4(i,n,r,o,null,null,_));var u=w.generateSideWallUV(P,e,a,t,i,n,r,o,s,l,h,c);P.faceVertexUvs[0].push(u)}var f=void 0!==t.amount?t.amount:100,p=void 0!==t.bevelThickness?t.bevelThickness:6,d=void 0!==t.bevelSize?t.bevelSize:p-2,m=void 0!==t.bevelSegments?t.bevelSegments:3,g=void 0!==t.bevelEnabled?t.bevelEnabled:!0,v=void 0!==t.curveSegments?t.curveSegments:12,E=void 0!==t.steps?t.steps:1,y=t.extrudePath,T,x=!1,b=t.material,_=t.extrudeMaterial,w=void 0!==t.UVGenerator?t.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,R=this.shapebb,H,M,S,C;y&&(T=y.getSpacedPoints(E),x=!0,g=!1,H=void 0!==t.frames?t.frames:new THREE.TubeGeometry.FrenetFrames(y,E,!1),M=new THREE.Vector3,S=new THREE.Vector3,C=new THREE.Vector3),g||(m=0,p=0,d=0);var A,D,k,P=this,L=[],N=this.vertices.length,z=e.extractPoints(v),F=z.shape,I=z.holes,O=!THREE.Shape.Utils.isClockWise(F);if(O){for(F=F.reverse(),D=0,k=I.length;k>D;D++)A=I[D],THREE.Shape.Utils.isClockWise(A)&&(I[D]=A.reverse());O=!1}var U=THREE.Shape.Utils.triangulateShape(F,I),V=F;for(D=0,k=I.length;k>D;D++)A=I[D],F=F.concat(A);for(var B,W,j,G,q,X=F.length,Y,K=U.length,Q,Z=V.length,J=180/Math.PI,et=[],tt=0,it=V.length,nt=it-1,rt=tt+1;it>tt;tt++,nt++,rt++){nt===it&&(nt=0),rt===it&&(rt=0);var ot=V[tt],at=V[nt],st=V[rt];et[tt]=n(V[tt],V[nt],V[rt])}var lt=[],ht,ct=et.concat();for(D=0,k=I.length;k>D;D++){for(A=I[D],ht=[],tt=0,it=A.length,nt=it-1,rt=tt+1;it>tt;tt++,nt++,rt++)nt===it&&(nt=0),rt===it&&(rt=0),ht[tt]=n(A[tt],A[nt],A[rt]);lt.push(ht),ct=ct.concat(ht)}for(B=0;m>B;B++){for(j=B/m,G=p*(1-j),W=d*Math.sin(j*Math.PI/2),tt=0,it=V.length;it>tt;tt++)q=i(V[tt],et[tt],W),h(q.x,q.y,-G);for(D=0,k=I.length;k>D;D++)for(A=I[D],ht=lt[D],tt=0,it=A.length;it>tt;tt++)q=i(A[tt],ht[tt],W),h(q.x,q.y,-G)}for(W=d,tt=0;X>tt;tt++)q=g?i(F[tt],ct[tt],W):F[tt],x?(S.copy(H.normals[0]).multiplyScalar(q.x),M.copy(H.binormals[0]).multiplyScalar(q.y),C.copy(T[0]).add(S).add(M),h(C.x,C.y,C.z)):h(q.x,q.y,0);var ut;for(ut=1;E>=ut;ut++)for(tt=0;X>tt;tt++)q=g?i(F[tt],ct[tt],W):F[tt],x?(S.copy(H.normals[ut]).multiplyScalar(q.x),M.copy(H.binormals[ut]).multiplyScalar(q.y),C.copy(T[ut]).add(S).add(M),h(C.x,C.y,C.z)):h(q.x,q.y,f/E*ut);for(B=m-1;B>=0;B--){for(j=B/m,G=p*(1-j),W=d*Math.sin(j*Math.PI/2),tt=0,it=V.length;it>tt;tt++)q=i(V[tt],et[tt],W),h(q.x,q.y,f+G);for(D=0,k=I.length;k>D;D++)for(A=I[D],ht=lt[D],tt=0,it=A.length;it>tt;tt++)q=i(A[tt],ht[tt],W),x?h(q.x,q.y+T[E-1].y,T[E-1].x+G):h(q.x,q.y,f+G)}a(),s()},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,i,n,r,o){var a=e.vertices[n].x,s=e.vertices[n].y,l=e.vertices[r].x,h=e.vertices[r].y,c=e.vertices[o].x,u=e.vertices[o].y;return[new THREE.Vector2(a,s),new THREE.Vector2(l,h),new THREE.Vector2(c,u)]},generateBottomUV:function(e,t,i,n,r,o){return this.generateTopUV(e,t,i,n,r,o)},generateSideWallUV:function(e,t,i,n,r,o,a,s,l,h,c,u){var f=e.vertices[r].x,p=e.vertices[r].y,d=e.vertices[r].z,m=e.vertices[o].x,g=e.vertices[o].y,v=e.vertices[o].z,E=e.vertices[a].x,y=e.vertices[a].y,T=e.vertices[a].z,x=e.vertices[s].x,b=e.vertices[s].y,_=e.vertices[s].z;return Math.abs(p-g)<.01?[new THREE.Vector2(f,1-d),new THREE.Vector2(m,1-v),new THREE.Vector2(E,1-T),new THREE.Vector2(x,1-_)]:[new THREE.Vector2(p,1-d),new THREE.Vector2(g,1-v),new THREE.Vector2(y,1-T),new THREE.Vector2(b,1-_)]}},THREE.ExtrudeGeometry.__v1=new THREE.Vector2,THREE.ExtrudeGeometry.__v2=new THREE.Vector2,THREE.ExtrudeGeometry.__v3=new THREE.Vector2,THREE.ExtrudeGeometry.__v4=new THREE.Vector2,THREE.ExtrudeGeometry.__v5=new THREE.Vector2,THREE.ExtrudeGeometry.__v6=new THREE.Vector2,THREE.ShapeGeometry=function(e,t){THREE.Geometry.call(this),e instanceof Array==!1&&(e=[e]),this.shapebb=e[e.length-1].getBoundingBox(),this.addShapeList(e,t),this.computeCentroids(),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.addShapeList=function(e,t){for(var i=0,n=e.length;n>i;i++)this.addShape(e[i],t);return this},THREE.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var i=void 0!==t.curveSegments?t.curveSegments:12,n=t.material,r=void 0===t.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator,o=this.shapebb,a,s,l,h,c=this.vertices.length,u=e.extractPoints(i),f=u.shape,p=u.holes,d=!THREE.Shape.Utils.isClockWise(f);if(d){for(f=f.reverse(),a=0,s=p.length;s>a;a++)l=p[a],THREE.Shape.Utils.isClockWise(l)&&(p[a]=l.reverse());d=!1}var m=THREE.Shape.Utils.triangulateShape(f,p),g=f;for(a=0,s=p.length;s>a;a++)l=p[a],f=f.concat(l);var v,E=f.length,y,T=m.length,x,b=g.length;for(a=0;E>a;a++)v=f[a],this.vertices.push(new THREE.Vector3(v.x,v.y,0));for(a=0;T>a;a++){y=m[a];var _=y[0]+c,w=y[1]+c,R=y[2]+c;this.faces.push(new THREE.Face3(_,w,R,null,null,n)),this.faceVertexUvs[0].push(r.generateBottomUV(this,e,t,_,w,R))}},THREE.LatheGeometry=function(e,t,i,n){THREE.Geometry.call(this),t=t||12,i=i||0,n=n||2*Math.PI;for(var r=1/(e.length-1),o=1/t,a=0,s=t;s>=a;a++)for(var l=i+a*o*n,h=Math.cos(l),c=Math.sin(l),u=0,f=e.length;f>u;u++){var p=e[u],d=new THREE.Vector3;d.x=h*p.x-c*p.y,d.y=c*p.x+h*p.y,d.z=p.z,this.vertices.push(d)}for(var m=e.length,a=0,s=t;s>a;a++)for(var u=0,f=e.length-1;f>u;u++){var g=u+m*a,v=g,E=g+m,h=g+1+m,y=g+1;this.faces.push(new THREE.Face4(v,E,h,y));var T=a*o,x=u*r,b=T+o,_=x+r;this.faceVertexUvs[0].push([new THREE.Vector2(T,x),new THREE.Vector2(b,x),new THREE.Vector2(b,_),new THREE.Vector2(T,_)])}this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry=function(e,t,i,n){THREE.Geometry.call(this),this.width=e,this.height=t,this.widthSegments=i||1,this.heightSegments=n||1;var r,o,a=e/2,s=t/2,l=this.widthSegments,h=this.heightSegments,c=l+1,u=h+1,f=this.width/l,p=this.height/h,d=new THREE.Vector3(0,0,1);for(o=0;u>o;o++)for(r=0;c>r;r++){var m=r*f-a,g=o*p-s;this.vertices.push(new THREE.Vector3(m,-g,0))}for(o=0;h>o;o++)for(r=0;l>r;r++){var v=r+c*o,E=r+c*(o+1),y=r+1+c*(o+1),T=r+1+c*o,x=new THREE.Face4(v,E,y,T);x.normal.copy(d),x.vertexNormals.push(d.clone(),d.clone(),d.clone(),d.clone()),this.faces.push(x),this.faceVertexUvs[0].push([new THREE.Vector2(r/l,1-o/h),new THREE.Vector2(r/l,1-(o+1)/h),new THREE.Vector2((r+1)/l,1-(o+1)/h),new THREE.Vector2((r+1)/l,1-o/h)])}this.computeCentroids()},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry=function(e,t,i,n,r,o){THREE.Geometry.call(this),e=e||0,t=t||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8,n=void 0!==n?Math.max(3,n):8;var a,s,l=[],h=e,c=(t-e)/n;for(a=0;n>=a;a++){for(s=0;i>=s;s++){var u=new THREE.Vector3,f=r+s/i*o;u.x=h*Math.cos(f),u.y=h*Math.sin(f),this.vertices.push(u),l.push(new THREE.Vector2((u.x/h+1)/2,-(u.y/h+1)/2+1))}h+=c}var p=new THREE.Vector3(0,0,1);for(a=0;n>a;a++){var d=a*i;for(s=0;i>=s;s++){var f=s+d,m=f+a,g=f+i+a,v=f+i+1+a;this.faces.push(new THREE.Face3(m,g,v,[p,p,p])),this.faceVertexUvs[0].push([l[m],l[g],l[v]]),m=f+a,g=f+i+1+a,v=f+1+a,this.faces.push(new THREE.Face3(m,g,v,[p,p,p])),this.faceVertexUvs[0].push([l[m],l[g],l[v]])}}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,h)},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry=function(e,t,i,n,r,o,a){THREE.Geometry.call(this),this.radius=e=e||50,this.widthSegments=t=Math.max(3,Math.floor(t)||8),this.heightSegments=i=Math.max(2,Math.floor(i)||6),this.phiStart=n=void 0!==n?n:0,this.phiLength=r=void 0!==r?r:2*Math.PI,this.thetaStart=o=void 0!==o?o:0,this.thetaLength=a=void 0!==a?a:Math.PI;var s,l,h=[],c=[];for(l=0;i>=l;l++){var u=[],f=[];for(s=0;t>=s;s++){var p=s/t,d=l/i,m=new THREE.Vector3;m.x=-e*Math.cos(n+p*r)*Math.sin(o+d*a),m.y=e*Math.cos(o+d*a),m.z=e*Math.sin(n+p*r)*Math.sin(o+d*a),this.vertices.push(m),u.push(this.vertices.length-1),f.push(new THREE.Vector2(p,1-d))}h.push(u),c.push(f)}for(l=0;l<this.heightSegments;l++)for(s=0;s<this.widthSegments;s++){var g=h[l][s+1],v=h[l][s],E=h[l+1][s],y=h[l+1][s+1],T=this.vertices[g].clone().normalize(),x=this.vertices[v].clone().normalize(),b=this.vertices[E].clone().normalize(),_=this.vertices[y].clone().normalize(),w=c[l][s+1].clone(),R=c[l][s].clone(),H=c[l+1][s].clone(),M=c[l+1][s+1].clone();Math.abs(this.vertices[g].y)===this.radius?(this.faces.push(new THREE.Face3(g,E,y,[T,b,_])),this.faceVertexUvs[0].push([w,H,M])):Math.abs(this.vertices[E].y)===this.radius?(this.faces.push(new THREE.Face3(g,v,E,[T,x,b])),this.faceVertexUvs[0].push([w,R,H])):(this.faces.push(new THREE.Face4(g,v,E,y,[T,x,b,_])),this.faceVertexUvs[0].push([w,R,H,M]))}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TextGeometry=function(e,t){t=t||{};var i=THREE.FontUtils.generateShapes(e,t);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,i,t)},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TorusGeometry=function(e,t,i,n,r){THREE.Geometry.call(this);var o=this;this.radius=e||100,this.tube=t||40,this.radialSegments=i||8,this.tubularSegments=n||6,this.arc=r||2*Math.PI;for(var a=new THREE.Vector3,s=[],l=[],h=0;h<=this.radialSegments;h++)for(var c=0;c<=this.tubularSegments;c++){var u=c/this.tubularSegments*this.arc,f=h/this.radialSegments*Math.PI*2;a.x=this.radius*Math.cos(u),a.y=this.radius*Math.sin(u);var p=new THREE.Vector3;p.x=(this.radius+this.tube*Math.cos(f))*Math.cos(u),p.y=(this.radius+this.tube*Math.cos(f))*Math.sin(u),p.z=this.tube*Math.sin(f),this.vertices.push(p),s.push(new THREE.Vector2(c/this.tubularSegments,h/this.radialSegments)),l.push(p.clone().sub(a).normalize())}for(var h=1;h<=this.radialSegments;h++)for(var c=1;c<=this.tubularSegments;c++){var d=(this.tubularSegments+1)*h+c-1,m=(this.tubularSegments+1)*(h-1)+c-1,g=(this.tubularSegments+1)*(h-1)+c,v=(this.tubularSegments+1)*h+c,E=new THREE.Face4(d,m,g,v,[l[d],l[m],l[g],l[v]]);E.normal.add(l[d]),E.normal.add(l[m]),E.normal.add(l[g]),E.normal.add(l[v]),E.normal.normalize(),this.faces.push(E),this.faceVertexUvs[0].push([s[d].clone(),s[m].clone(),s[g].clone(),s[v].clone()])}this.computeCentroids()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry=function(e,t,i,n,r,o,a){function s(e,t,i){return h.vertices.push(new THREE.Vector3(e,t,i))-1}function l(e,t,i,n,r,o){var a=Math.cos(e),s=Math.cos(t),l=Math.sin(e),h=i/n*e,c=Math.cos(h),u=r*(2+c)*.5*a,f=r*(2+c)*l*.5,p=o*r*Math.sin(h)*.5;return new THREE.Vector3(u,f,p)}THREE.Geometry.call(this);var h=this;this.radius=e||100,this.tube=t||40,this.radialSegments=i||64,this.tubularSegments=n||8,this.p=r||2,this.q=o||3,this.heightScale=a||1,this.grid=new Array(this.radialSegments);for(var c=new THREE.Vector3,u=new THREE.Vector3,f=new THREE.Vector3,p=0;p<this.radialSegments;++p){this.grid[p]=new Array(this.tubularSegments);for(var d=0;d<this.tubularSegments;++d){var m=p/this.radialSegments*2*this.p*Math.PI,g=d/this.tubularSegments*2*Math.PI,v=l(m,g,this.q,this.p,this.radius,this.heightScale),E=l(m+.01,g,this.q,this.p,this.radius,this.heightScale),y,T;c.subVectors(E,v),u.addVectors(E,v),f.crossVectors(c,u),u.crossVectors(f,c),f.normalize(),u.normalize(),y=-this.tube*Math.cos(g),T=this.tube*Math.sin(g),v.x+=y*u.x+T*f.x,v.y+=y*u.y+T*f.y,v.z+=y*u.z+T*f.z,this.grid[p][d]=s(v.x,v.y,v.z)}}for(var p=0;p<this.radialSegments;++p)for(var d=0;d<this.tubularSegments;++d){var x=(p+1)%this.radialSegments,b=(d+1)%this.tubularSegments,_=this.grid[p][d],w=this.grid[x][d],R=this.grid[x][b],H=this.grid[p][b],M=new THREE.Vector2(p/this.radialSegments,d/this.tubularSegments),S=new THREE.Vector2((p+1)/this.radialSegments,d/this.tubularSegments),C=new THREE.Vector2((p+1)/this.radialSegments,(d+1)/this.tubularSegments),A=new THREE.Vector2(p/this.radialSegments,(d+1)/this.tubularSegments);this.faces.push(new THREE.Face4(_,w,R,H)),this.faceVertexUvs[0].push([M,S,C,A])}this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry=function(e,t,i,n,r,o){function a(e,t,i){return s.vertices.push(new THREE.Vector3(e,t,i))-1}THREE.Geometry.call(this),this.path=e,this.segments=t||64,this.radius=i||1,this.radiusSegments=n||8,this.closed=r||!1,o&&(this.debug=new THREE.Object3D),this.grid=[];var s=this,l,h,c,u=this.segments+1,f,p,d,m,g,v,E,y,T,x,b,_=new THREE.Vector3,w,R,H,M,S,C,A,D,k,P,L,N,z=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed),F=z.tangents,I=z.normals,O=z.binormals;for(this.tangents=F,this.normals=I,this.binormals=O,w=0;u>w;w++)for(this.grid[w]=[],E=w/(u-1),b=e.getPointAt(E),l=F[w],h=I[w],c=O[w],this.debug&&(this.debug.add(new THREE.ArrowHelper(l,b,i,255)),this.debug.add(new THREE.ArrowHelper(h,b,i,16711680)),this.debug.add(new THREE.ArrowHelper(c,b,i,65280))),R=0;R<this.radiusSegments;R++)y=R/this.radiusSegments*2*Math.PI,T=-this.radius*Math.cos(y),x=this.radius*Math.sin(y),_.copy(b),_.x+=T*h.x+x*c.x,_.y+=T*h.y+x*c.y,_.z+=T*h.z+x*c.z,this.grid[w][R]=a(_.x,_.y,_.z);for(w=0;w<this.segments;w++)for(R=0;R<this.radiusSegments;R++)H=this.closed?(w+1)%this.segments:w+1,M=(R+1)%this.radiusSegments,S=this.grid[w][R],C=this.grid[H][R],A=this.grid[H][M],D=this.grid[w][M],k=new THREE.Vector2(w/this.segments,R/this.radiusSegments),P=new THREE.Vector2((w+1)/this.segments,R/this.radiusSegments),L=new THREE.Vector2((w+1)/this.segments,(R+1)/this.radiusSegments),N=new THREE.Vector2(w/this.segments,(R+1)/this.radiusSegments),this.faces.push(new THREE.Face4(S,C,A,D)),this.faceVertexUvs[0].push([k,P,L,N]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.FrenetFrames=function(e,t,i){function n(e){c[0]=new THREE.Vector3,u[0]=new THREE.Vector3,void 0===e&&(e=new THREE.Vector3(0,0,1)),c[0].crossVectors(e,h[0]).normalize(),u[0].crossVectors(h[0],c[0]).normalize()}function r(){var t=e.getTangentAt(g);c[0]=(new THREE.Vector3).subVectors(t,h[0]).normalize(),u[0]=(new THREE.Vector3).crossVectors(h[0],c[0]),c[0].crossVectors(u[0],h[0]).normalize(),u[0].crossVectors(h[0],c[0]).normalize()}function o(){c[0]=new THREE.Vector3,u[0]=new THREE.Vector3,v=Number.MAX_VALUE,E=Math.abs(h[0].x),y=Math.abs(h[0].y),T=Math.abs(h[0].z),v>=E&&(v=E,s.set(1,0,0)),v>=y&&(v=y,s.set(0,1,0)),v>=T&&s.set(0,0,1),f.crossVectors(h[0],s).normalize(),c[0].crossVectors(h[0],f),u[0].crossVectors(h[0],c[0])}var a=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3,h=[],c=[],u=[],f=new THREE.Vector3,p=new THREE.Matrix4,d=t+1,m,g=1e-4,v,E,y,T,x,b,_;for(this.tangents=h,this.normals=c,this.binormals=u,x=0;d>x;x++)b=x/(d-1),h[x]=e.getTangentAt(b),h[x].normalize();for(o(),x=1;d>x;x++)c[x]=c[x-1].clone(),u[x]=u[x-1].clone(),f.crossVectors(h[x-1],h[x]),f.length()>g&&(f.normalize(),m=Math.acos(h[x-1].dot(h[x])),c[x].applyMatrix4(p.makeRotationAxis(f,m))),u[x].crossVectors(h[x],c[x]);if(i)for(m=Math.acos(c[0].dot(c[d-1])),m/=d-1,h[0].dot(f.crossVectors(c[0],c[d-1]))>0&&(m=-m),x=1;d>x;x++)c[x].applyMatrix4(p.makeRotationAxis(h[x],m*x)),u[x].crossVectors(h[x],c[x])},THREE.PolyhedronGeometry=function(e,t,i,n){function r(e){var t=e.normalize().clone();t.index=c.vertices.push(t)-1;var i=s(e)/2/Math.PI+.5,n=l(e)/Math.PI+.5;return t.uv=new THREE.Vector2(i,1-n),t}function o(e,t,i){var n=new THREE.Face3(e.index,t.index,i.index,[e.clone(),t.clone(),i.clone()]);n.centroid.add(e).add(t).add(i).divideScalar(3),n.normal.copy(n.centroid).normalize(),c.faces.push(n);var r=s(n.centroid);c.faceVertexUvs[0].push([h(e.uv,e,r),h(t.uv,t,r),h(i.uv,i,r)])}function a(e,t){for(var i=Math.pow(2,t),n=Math.pow(4,t),a=r(c.vertices[e.a]),s=r(c.vertices[e.b]),l=r(c.vertices[e.c]),h=[],u=0;i>=u;u++){h[u]=[];for(var f=r(a.clone().lerp(l,u/i)),p=r(s.clone().lerp(l,u/i)),d=i-u,m=0;d>=m;m++)h[u][m]=0==m&&u==i?f:r(f.clone().lerp(p,m/d))}for(var u=0;i>u;u++)for(var m=0;2*(i-u)-1>m;m++){var g=Math.floor(m/2);m%2==0?o(h[u][g+1],h[u+1][g],h[u][g]):o(h[u][g+1],h[u+1][g+1],h[u+1][g])}}function s(e){return Math.atan2(e.z,-e.x)}function l(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}function h(e,t,i){return 0>i&&1===e.x&&(e=new THREE.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new THREE.Vector2(i/2/Math.PI+.5,e.y)),e.clone()}THREE.Geometry.call(this),i=i||1,n=n||0;for(var c=this,u=0,f=e.length;f>u;u++)r(new THREE.Vector3(e[u][0],e[u][1],e[u][2]));for(var p=[],d=this.vertices,m=[],u=0,f=t.length;f>u;u++){var g=d[t[u][0]],v=d[t[u][1]],E=d[t[u][2]];m[u]=new THREE.Face3(g.index,v.index,E.index,[g.clone(),v.clone(),E.clone()])}for(var u=0,f=m.length;f>u;u++)a(m[u],n);for(var u=0,f=this.faceVertexUvs[0].length;f>u;u++){var y=this.faceVertexUvs[0][u],T=y[0].x,x=y[1].x,b=y[2].x,_=Math.max(T,Math.max(x,b)),w=Math.min(T,Math.min(x,b));_>.9&&.1>w&&(.2>T&&(y[0].x+=1),.2>x&&(y[1].x+=1),.2>b&&(y[2].x+=1))}this.mergeVertices();for(var u=0,f=this.vertices.length;f>u;u++)this.vertices[u].multiplyScalar(i);this.computeCentroids(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,i)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.IcosahedronGeometry=function(e,t){this.radius=e,this.detail=t;var i=(1+Math.sqrt(5))/2,n=[[-1,i,0],[1,i,0],[-1,-i,0],[1,-i,0],[0,-1,i],[0,1,i],[0,-1,-i],[0,1,-i],[i,0,-1],[i,0,1],[-i,0,-1],[-i,0,1]],r=[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]];THREE.PolyhedronGeometry.call(this,n,r,e,t)},THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.OctahedronGeometry=function(e,t){var i=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],n=[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]];THREE.PolyhedronGeometry.call(this,i,n,e,t)},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TetrahedronGeometry=function(e,t){var i=[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],n=[[2,1,0],[0,3,2],[1,3,0],[2,3,1]];THREE.PolyhedronGeometry.call(this,i,n,e,t)},THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry=function(e,t,i,n){THREE.Geometry.call(this);var r=this.vertices,o=this.faces,a=this.faceVertexUvs[0];n=void 0===n?!1:n;var s,l,h,c,u,f,p=i+1,d=t+1;for(s=0;i>=s;s++)for(f=s/i,h=0;t>=h;h++)u=h/t,c=e(u,f),r.push(c);var m,g,v,E,y,T,x,b;for(s=0;i>s;s++)for(h=0;t>h;h++)m=s*d+h,g=s*d+h+1,v=(s+1)*d+h,E=(s+1)*d+h+1,y=new THREE.Vector2(h/t,s/i),T=new THREE.Vector2((h+1)/t,s/i),x=new THREE.Vector2(h/t,(s+1)/i),b=new THREE.Vector2((h+1)/t,(s+1)/i),n?(o.push(new THREE.Face3(m,g,v)),o.push(new THREE.Face3(g,E,v)),a.push([y,T,x]),a.push([T,b,x])):(o.push(new THREE.Face4(m,g,E,v)),a.push([y,T,b,x]));this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ConvexGeometry=function(e){function t(t){var n=e[t].clone(),a=n.length();n.x+=a*o(),n.y+=a*o(),n.z+=a*o();for(var l=[],h=0;h<s.length;){var c=s[h];if(i(c,n)){for(var u=0;3>u;u++){for(var f=[c[u],c[(u+1)%3]],p=!0,d=0;d<l.length;d++)if(r(l[d],f)){l[d]=l[l.length-1],l.pop(),p=!1;break}p&&l.push(f)}s[h]=s[s.length-1],s.pop()}else h++}for(var d=0;d<l.length;d++)s.push([l[d][0],l[d][1],t])}function i(t,i){var r=e[t[0]],o=e[t[1]],a=e[t[2]],s=n(r,o,a),l=s.dot(r);return s.dot(i)>=l}function n(e,t,i){var n=new THREE.Vector3,r=new THREE.Vector3;return n.subVectors(i,t),r.subVectors(e,t),n.cross(r),n.normalize(),n}function r(e,t){return e[0]===t[1]&&e[1]===t[0]}function o(){return 2*(Math.random()-.5)*1e-6}function a(e){var t=e.length();return new THREE.Vector2(e.x/t,e.y/t)}THREE.Geometry.call(this);for(var s=[[0,1,2],[0,2,1]],l=3;l<e.length;l++)t(l);for(var h=0,c=new Array(e.length),l=0;l<s.length;l++)for(var u=s[l],f=0;3>f;f++)void 0===c[u[f]]&&(c[u[f]]=h++,this.vertices.push(e[u[f]])),u[f]=c[u[f]];for(var l=0;l<s.length;l++)this.faces.push(new THREE.Face3(s[l][0],s[l][1],s[l][2]));for(var l=0;l<this.faces.length;l++){var u=this.faces[l];this.faceVertexUvs[0].push([a(this.vertices[u.a]),a(this.vertices[u.b]),a(this.vertices[u.c])])}this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ConvexGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.AxisHelper=function(e){e=e||1;var t=new THREE.Geometry;t.vertices.push(new THREE.Vector3,new THREE.Vector3(e,0,0),new THREE.Vector3,new THREE.Vector3(0,e,0),new THREE.Vector3,new THREE.Vector3(0,0,e)),t.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));var i=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,t,i,THREE.LinePieces)},THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype),THREE.ArrowHelper=function(e,t,i,n){THREE.Object3D.call(this),void 0===n&&(n=16776960),void 0===i&&(i=1),this.position=t,this.useQuaternion=!0;var r=new THREE.Geometry;r.vertices.push(new THREE.Vector3(0,0,0)),r.vertices.push(new THREE.Vector3(0,1,0)),this.line=new THREE.Line(r,new THREE.LineBasicMaterial({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line);var o=new THREE.CylinderGeometry(0,.05,.25,5,1);o.applyMatrix((new THREE.Matrix4).makeTranslation(0,.875,0)),this.cone=new THREE.Mesh(o,new THREE.MeshBasicMaterial({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i)},THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.setDirection=function(){var e=new THREE.Vector3,t;return function(i){i.y>.999?this.quaternion.set(0,0,0,1):i.y<-.999?this.quaternion.set(1,0,0,0):(e.set(i.z,0,-i.x).normalize(),t=Math.acos(i.y),this.quaternion.setFromAxisAngle(e,t))}}(),THREE.ArrowHelper.prototype.setLength=function(e){this.scale.set(e,e,e)},THREE.ArrowHelper.prototype.setColor=function(e){this.line.material.color.setHex(e),this.cone.material.color.setHex(e)},THREE.BoxHelper=function(e){e=e||1;var t=new THREE.Geometry,i=[new THREE.Vector3(e,e,e),new THREE.Vector3(-e,e,e),new THREE.Vector3(-e,-e,e),new THREE.Vector3(e,-e,e),new THREE.Vector3(e,e,-e),new THREE.Vector3(-e,e,-e),new THREE.Vector3(-e,-e,-e),new THREE.Vector3(e,-e,-e)];t.vertices.push(i[0],i[1],i[1],i[2],i[2],i[3],i[3],i[0],i[4],i[5],i[5],i[6],i[6],i[7],i[7],i[4],i[0],i[4],i[1],i[5],i[2],i[6],i[3],i[7]),this.vertices=i,THREE.Line.call(this,t,new THREE.LineBasicMaterial,THREE.LinePieces)},THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype),THREE.BoxHelper.prototype.update=function(e){var t=e.geometry;null===t.boundingBox&&t.computeBoundingBox();var i=t.boundingBox.min,n=t.boundingBox.max,r=this.vertices;r[0].set(n.x,n.y,n.z),r[1].set(i.x,n.y,n.z),r[2].set(i.x,i.y,n.z),r[3].set(n.x,i.y,n.z),r[4].set(n.x,n.y,i.z),r[5].set(i.x,n.y,i.z),r[6].set(i.x,i.y,i.z),r[7].set(n.x,i.y,i.z),this.geometry.computeBoundingSphere(),this.geometry.verticesNeedUpdate=!0,this.matrixAutoUpdate=!1,this.matrixWorld=e.matrixWorld},THREE.CameraHelper=function(e){function t(e,t,n){i(e,n),i(t,n)}function i(e,t){n.vertices.push(new THREE.Vector3),n.colors.push(new THREE.Color(t)),void 0===o[e]&&(o[e]=[]),o[e].push(n.vertices.length-1)}THREE.Line.call(this);var n=new THREE.Geometry,r=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),o={},a=16755200,s=16711680,l=43775,h=16777215,c=3355443;t("n1","n2",a),t("n2","n4",a),t("n4","n3",a),t("n3","n1",a),t("f1","f2",a),t("f2","f4",a),t("f4","f3",a),t("f3","f1",a),t("n1","f1",a),t("n2","f2",a),t("n3","f3",a),t("n4","f4",a),t("p","n1",s),t("p","n2",s),t("p","n3",s),t("p","n4",s),t("u1","u2",l),t("u2","u3",l),t("u3","u1",l),t("c","t",h),t("p","c",c),t("cn1","cn2",c),t("cn3","cn4",c),t("cf1","cf2",c),t("cf3","cf4",c),THREE.Line.call(this,n,r,THREE.LinePieces),this.camera=e,this.matrixWorld=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype),THREE.CameraHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Camera,i=new THREE.Projector;return function(){function n(n,o,a,s){e.set(o,a,s),i.unprojectVector(e,t);var l=r.pointMap[n];if(void 0!==l)for(var h=0,c=l.length;c>h;h++)r.geometry.vertices[l[h]].copy(e)}var r=this,o=1,a=1;t.projectionMatrix.copy(this.camera.projectionMatrix),n("c",0,0,-1),n("t",0,0,1),n("n1",-o,-a,-1),n("n2",o,-a,-1),n("n3",-o,a,-1),n("n4",o,a,-1),n("f1",-o,-a,1),n("f2",o,-a,1),n("f3",-o,a,1),n("f4",o,a,1),n("u1",.7*o,1.1*a,-1),n("u2",.7*-o,1.1*a,-1),n("u3",0,2*a,-1),n("cf1",-o,0,1),n("cf2",o,0,1),n("cf3",0,-a,1),n("cf4",0,a,1),n("cn1",-o,0,-1),n("cn2",o,0,-1),n("cn3",0,-a,-1),n("cn4",0,a,-1),this.geometry.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(e,t){THREE.Object3D.call(this),this.matrixAutoUpdate=!1,this.light=e;var i=new THREE.SphereGeometry(t,4,2),n=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere=new THREE.Mesh(i,n),this.lightSphere.matrixWorld=this.light.matrixWorld,this.lightSphere.matrixAutoUpdate=!1,this.add(this.lightSphere),i=new THREE.Geometry,i.vertices.push(this.light.position),i.vertices.push(this.light.target.position),i.computeLineDistances(),n=new THREE.LineDashedMaterial({dashSize:4,gapSize:4,opacity:.75,transparent:!0,fog:!1}),n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(i,n),this.add(this.targetLine)},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.update=function(){this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.computeLineDistances(),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.GridHelper=function(e,t){for(var i=new THREE.Geometry,n=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),r=new THREE.Color(4473924),o=new THREE.Color(8947848),a=-e;e>=a;a+=t){i.vertices.push(new THREE.Vector3(-e,0,a)),i.vertices.push(new THREE.Vector3(e,0,a)),i.vertices.push(new THREE.Vector3(a,0,-e)),i.vertices.push(new THREE.Vector3(a,0,e));var s=0===a?r:o;i.colors.push(s,s,s,s)}THREE.Line.call(this,i,n,THREE.LinePieces)},THREE.GridHelper.prototype=Object.create(THREE.Line.prototype),THREE.HemisphereLightHelper=function(e,t,i,n){THREE.Object3D.call(this),this.light=e;var r=new THREE.SphereGeometry(t,4,2);r.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var o=0,a=8;a>o;o++)r.faces[o].materialIndex=4>o?0:1;var s=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});s.color.copy(e.color).multiplyScalar(e.intensity);var l=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});l.color.copy(e.groundColor).multiplyScalar(e.intensity),this.lightSphere=new THREE.Mesh(r,new THREE.MeshFaceMaterial([s,l])),this.lightSphere.position=e.position,this.lightSphere.lookAt(new THREE.Vector3),this.add(this.lightSphere)},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.update=function(){this.lightSphere.lookAt(new THREE.Vector3),this.lightSphere.material.materials[0].color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere.material.materials[1].color.copy(this.light.groundColor).multiplyScalar(this.light.intensity)},THREE.PointLightHelper=function(e,t){THREE.Object3D.call(this),this.matrixAutoUpdate=!1,this.light=e;var i=new THREE.SphereGeometry(t,4,2),n=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere=new THREE.Mesh(i,n),this.lightSphere.matrixWorld=this.light.matrixWorld,this.lightSphere.matrixAutoUpdate=!1,this.add(this.lightSphere)},THREE.PointLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.PointLightHelper.prototype.update=function(){this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SpotLightHelper=function(e,t){THREE.Object3D.call(this),this.matrixAutoUpdate=!1,this.light=e;var i=new THREE.SphereGeometry(t,4,2),n=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere=new THREE.Mesh(i,n),this.lightSphere.matrixWorld=this.light.matrixWorld,this.lightSphere.matrixAutoUpdate=!1,this.add(this.lightSphere),i=new THREE.CylinderGeometry(1e-4,1,1,8,1,!0),i.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0)),i.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2)),n=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0,opacity:.3,transparent:!0}),n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightCone=new THREE.Mesh(i,n),this.lightCone.position=this.light.position;var r=e.distance?e.distance:1e4,o=r*Math.tan(e.angle);this.lightCone.scale.set(o,o,r),this.lightCone.lookAt(this.light.target.position),this.add(this.lightCone)},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.update=function(){var e=this.light.distance?this.light.distance:1e4,t=e*Math.tan(this.light.angle);this.lightCone.scale.set(t,t,e),this.lightCone.lookAt(this.light.target.position),this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightCone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this),this.render=function(e){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare=function(e,t,i,n,r){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,i,n,r)
},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.add=function(e,t,i,n,r,o){void 0===t&&(t=-1),void 0===i&&(i=0),void 0===o&&(o=1),void 0===r&&(r=new THREE.Color(16777215)),void 0===n&&(n=THREE.NormalBlending),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:e,size:t,distance:i,x:0,y:0,z:0,scale:1,rotation:1,opacity:o,color:r,blending:n})},THREE.LensFlare.prototype.updateLensFlares=function(){var e,t=this.lensFlares.length,i,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(e=0;t>e;e++)i=this.lensFlares[e],i.x=this.positionScreen.x+n*i.distance,i.y=this.positionScreen.y+r*i.distance,i.wantedRotation=i.x*Math.PI*.25,i.rotation+=.25*(i.wantedRotation-i.rotation)},THREE.MorphBlendMesh=function(e,t){THREE.Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n="__default",r=0,o=i-1,a=i/1;this.createAnimation(n,r,o,a),this.setAnimationWeight(n,1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.createAnimation=function(e,t,i,n){var r={startFrame:t,endFrame:i,length:i-t+1,fps:n,duration:(i-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=r,this.animationsList.push(r)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t=/([a-z]+)(\d+)/,i,n={},r=this.geometry,o=0,a=r.morphTargets.length;a>o;o++){var s=r.morphTargets[o],l=s.name.match(t);if(l&&l.length>1){var h=l[1],c=l[2];n[h]||(n[h]={start:1/0,end:-1/0});var u=n[h];o<u.start&&(u.start=o),o>u.end&&(u.end=o),i||(i=h)}}for(var h in n){var u=n[h];this.createAnimation(h,u.start,u.end,e)}this.firstAnimation=i},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var i=this.animationsMap[e];i&&(i.fps=t,i.duration=(i.end-i.start)/i.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var i=this.animationsMap[e];i&&(i.duration=t,i.fps=(i.end-i.start)/i.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var i=this.animationsMap[e];i&&(i.weight=t)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var i=this.animationsMap[e];i&&(i.time=t)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0,i=this.animationsMap[e];return i&&(t=i.time),t},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1,i=this.animationsMap[e];return i&&(t=i.duration),t},THREE.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("animation["+e+"] undefined")},THREE.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},THREE.MorphBlendMesh.prototype.update=function(e){for(var t=0,i=this.animationsList.length;i>t;t++){var n=this.animationsList[t];if(n.active){var r=n.duration/n.length;n.time+=n.direction*e,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var o=n.startFrame+THREE.Math.clamp(Math.floor(n.time/r),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o);var s=n.time%r/r;n.directionBackwards&&(s=1-s),this.morphTargetInfluences[n.currentFrame]=s*a,this.morphTargetInfluences[n.lastFrame]=(1-s)*a}}},THREE.LensFlarePlugin=function(){function e(e,i){var n=t.createProgram(),r=t.createShader(t.FRAGMENT_SHADER),o=t.createShader(t.VERTEX_SHADER),a="precision "+i+" float;\n";return t.shaderSource(r,a+e.fragmentShader),t.shaderSource(o,a+e.vertexShader),t.compileShader(r),t.compileShader(o),t.attachShader(n,r),t.attachShader(n,o),t.linkProgram(n),n}var t,i,n,r={};this.init=function(o){t=o.context,i=o,n=o.getPrecision(),r.vertices=new Float32Array(16),r.faces=new Uint16Array(6);var a=0;r.vertices[a++]=-1,r.vertices[a++]=-1,r.vertices[a++]=0,r.vertices[a++]=0,r.vertices[a++]=1,r.vertices[a++]=-1,r.vertices[a++]=1,r.vertices[a++]=0,r.vertices[a++]=1,r.vertices[a++]=1,r.vertices[a++]=1,r.vertices[a++]=1,r.vertices[a++]=-1,r.vertices[a++]=1,r.vertices[a++]=0,r.vertices[a++]=1,a=0,r.faces[a++]=0,r.faces[a++]=1,r.faces[a++]=2,r.faces[a++]=0,r.faces[a++]=2,r.faces[a++]=3,r.vertexBuffer=t.createBuffer(),r.elementBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,r.vertices,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.elementBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,r.faces,t.STATIC_DRAW),r.tempTexture=t.createTexture(),r.occlusionTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,r.tempTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGB,16,16,0,t.RGB,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.bindTexture(t.TEXTURE_2D,r.occlusionTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,16,16,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<=0?(r.hasVertexTexture=!1,r.program=e(THREE.ShaderFlares.lensFlare,n)):(r.hasVertexTexture=!0,r.program=e(THREE.ShaderFlares.lensFlareVertexTexture,n)),r.attributes={},r.uniforms={},r.attributes.vertex=t.getAttribLocation(r.program,"position"),r.attributes.uv=t.getAttribLocation(r.program,"uv"),r.uniforms.renderType=t.getUniformLocation(r.program,"renderType"),r.uniforms.map=t.getUniformLocation(r.program,"map"),r.uniforms.occlusionMap=t.getUniformLocation(r.program,"occlusionMap"),r.uniforms.opacity=t.getUniformLocation(r.program,"opacity"),r.uniforms.color=t.getUniformLocation(r.program,"color"),r.uniforms.scale=t.getUniformLocation(r.program,"scale"),r.uniforms.rotation=t.getUniformLocation(r.program,"rotation"),r.uniforms.screenPosition=t.getUniformLocation(r.program,"screenPosition")},this.render=function(e,n,o,a){var s=e.__webglFlares,l=s.length;if(l){var h=new THREE.Vector3,c=a/o,u=.5*o,f=.5*a,p=16/a,d=new THREE.Vector2(p*c,p),m=new THREE.Vector3(1,1,0),g=new THREE.Vector2(1,1),v=r.uniforms,E=r.attributes;t.useProgram(r.program),t.enableVertexAttribArray(r.attributes.vertex),t.enableVertexAttribArray(r.attributes.uv),t.uniform1i(v.occlusionMap,0),t.uniform1i(v.map,1),t.bindBuffer(t.ARRAY_BUFFER,r.vertexBuffer),t.vertexAttribPointer(E.vertex,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(E.uv,2,t.FLOAT,!1,16,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.elementBuffer),t.disable(t.CULL_FACE),t.depthMask(!1);var y,T,x,b,_;for(y=0;l>y;y++)if(p=16/a,d.set(p*c,p),b=s[y],h.set(b.matrixWorld.elements[12],b.matrixWorld.elements[13],b.matrixWorld.elements[14]),h.applyMatrix4(n.matrixWorldInverse),h.applyProjection(n.projectionMatrix),m.copy(h),g.x=m.x*u+u,g.y=m.y*f+f,r.hasVertexTexture||g.x>0&&g.x<o&&g.y>0&&g.y<a)for(t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,r.tempTexture),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGB,g.x-8,g.y-8,16,16,0),t.uniform1i(v.renderType,0),t.uniform2f(v.scale,d.x,d.y),t.uniform3f(v.screenPosition,m.x,m.y,m.z),t.disable(t.BLEND),t.enable(t.DEPTH_TEST),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r.occlusionTexture),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,g.x-8,g.y-8,16,16,0),t.uniform1i(v.renderType,1),t.disable(t.DEPTH_TEST),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,r.tempTexture),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),b.positionScreen.copy(m),b.customUpdateCallback?b.customUpdateCallback(b):b.updateLensFlares(),t.uniform1i(v.renderType,2),t.enable(t.BLEND),T=0,x=b.lensFlares.length;x>T;T++)_=b.lensFlares[T],_.opacity>.001&&_.scale>.001&&(m.x=_.x,m.y=_.y,m.z=_.z,p=_.size*_.scale/a,d.x=p*c,d.y=p,t.uniform3f(v.screenPosition,m.x,m.y,m.z),t.uniform2f(v.scale,d.x,d.y),t.uniform1f(v.rotation,_.rotation),t.uniform1f(v.opacity,_.opacity),t.uniform3f(v.color,_.color.r,_.color.g,_.color.b),i.setBlending(_.blending,_.blendEquation,_.blendSrc,_.blendDst),i.setTexture(_.texture,1),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0));t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.depthMask(!0)}}},THREE.ShadowMapPlugin=function(){function e(e,t){var i=new THREE.DirectionalLight;i.isVirtual=!0,i.onlyShadow=!0,i.castShadow=!0,i.shadowCameraNear=e.shadowCameraNear,i.shadowCameraFar=e.shadowCameraFar,i.shadowCameraLeft=e.shadowCameraLeft,i.shadowCameraRight=e.shadowCameraRight,i.shadowCameraBottom=e.shadowCameraBottom,i.shadowCameraTop=e.shadowCameraTop,i.shadowCameraVisible=e.shadowCameraVisible,i.shadowDarkness=e.shadowDarkness,i.shadowBias=e.shadowCascadeBias[t],i.shadowMapWidth=e.shadowCascadeWidth[t],i.shadowMapHeight=e.shadowCascadeHeight[t],i.pointsWorld=[],i.pointsFrustum=[];for(var n=i.pointsWorld,r=i.pointsFrustum,o=0;8>o;o++)n[o]=new THREE.Vector3,r[o]=new THREE.Vector3;var a=e.shadowCascadeNearZ[t],s=e.shadowCascadeFarZ[t];return r[0].set(-1,-1,a),r[1].set(1,-1,a),r[2].set(-1,1,a),r[3].set(1,1,a),r[4].set(-1,-1,s),r[5].set(1,-1,s),r[6].set(-1,1,s),r[7].set(1,1,s),i}function t(e,t){var i=e.shadowCascadeArray[t];i.position.copy(e.position),i.target.position.copy(e.target.position),i.lookAt(i.target),i.shadowCameraVisible=e.shadowCameraVisible,i.shadowDarkness=e.shadowDarkness,i.shadowBias=e.shadowCascadeBias[t];var n=e.shadowCascadeNearZ[t],r=e.shadowCascadeFarZ[t],o=i.pointsFrustum;o[0].z=n,o[1].z=n,o[2].z=n,o[3].z=n,o[4].z=r,o[5].z=r,o[6].z=r,o[7].z=r}function i(e,t){var i=t.shadowCamera,n=t.pointsFrustum,r=t.pointsWorld;f.set(1/0,1/0,1/0),p.set(-1/0,-1/0,-1/0);for(var o=0;8>o;o++){var a=r[o];a.copy(n[o]),THREE.ShadowMapPlugin.__projector.unprojectVector(a,e),a.applyMatrix4(i.matrixWorldInverse),a.x<f.x&&(f.x=a.x),a.x>p.x&&(p.x=a.x),a.y<f.y&&(f.y=a.y),a.y>p.y&&(p.y=a.y),a.z<f.z&&(f.z=a.z),a.z>p.z&&(p.z=a.z)}i.left=f.x,i.right=p.x,i.top=p.y,i.bottom=f.y,i.updateProjectionMatrix()}function n(e){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[0]:e.material}var r,o,a,s,l,h,c=new THREE.Frustum,u=new THREE.Matrix4,f=new THREE.Vector3,p=new THREE.Vector3,d=new THREE.Vector3;this.init=function(e){r=e.context,o=e;var t=THREE.ShaderLib.depthRGBA,i=THREE.UniformsUtils.clone(t.uniforms);a=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i}),s=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i,morphTargets:!0}),l=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i,skinning:!0}),h=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:i,morphTargets:!0,skinning:!0}),a._shadowPass=!0,s._shadowPass=!0,l._shadowPass=!0,h._shadowPass=!0},this.render=function(e,t){o.shadowMapEnabled&&o.shadowMapAutoUpdate&&this.update(e,t)},this.update=function(f,p){var m,g,v,E,y,T,x,b,_,w,R,H,M,S,C,A=[],D=0,k=null;for(r.clearColor(1,1,1,1),r.disable(r.BLEND),r.enable(r.CULL_FACE),r.frontFace(r.CCW),r.cullFace(o.shadowMapCullFace===THREE.CullFaceFront?r.FRONT:r.BACK),o.setDepthTest(!0),m=0,g=f.__lights.length;g>m;m++)if(S=f.__lights[m],S.castShadow)if(S instanceof THREE.DirectionalLight&&S.shadowCascade)for(y=0;y<S.shadowCascadeCount;y++){var P;if(S.shadowCascadeArray[y])P=S.shadowCascadeArray[y];else{P=e(S,y),P.originalCamera=p;var L=new THREE.Gyroscope;L.position=S.shadowCascadeOffset,L.add(P),L.add(P.target),p.add(L),S.shadowCascadeArray[y]=P,console.log("Created virtualLight",P)}t(S,y),A[D]=P,D++}else A[D]=S,D++;for(m=0,g=A.length;g>m;m++){if(S=A[m],!S.shadowMap){var N=THREE.LinearFilter;o.shadowMapType===THREE.PCFSoftShadowMap&&(N=THREE.NearestFilter);var z={minFilter:N,magFilter:N,format:THREE.RGBAFormat};S.shadowMap=new THREE.WebGLRenderTarget(S.shadowMapWidth,S.shadowMapHeight,z),S.shadowMapSize=new THREE.Vector2(S.shadowMapWidth,S.shadowMapHeight),S.shadowMatrix=new THREE.Matrix4}if(!S.shadowCamera){if(S instanceof THREE.SpotLight)S.shadowCamera=new THREE.PerspectiveCamera(S.shadowCameraFov,S.shadowMapWidth/S.shadowMapHeight,S.shadowCameraNear,S.shadowCameraFar);else{if(!(S instanceof THREE.DirectionalLight)){console.error("Unsupported light type for shadow");continue}S.shadowCamera=new THREE.OrthographicCamera(S.shadowCameraLeft,S.shadowCameraRight,S.shadowCameraTop,S.shadowCameraBottom,S.shadowCameraNear,S.shadowCameraFar)}f.add(S.shadowCamera),f.autoUpdate===!0&&f.updateMatrixWorld()}for(S.shadowCameraVisible&&!S.cameraHelper&&(S.cameraHelper=new THREE.CameraHelper(S.shadowCamera),S.shadowCamera.add(S.cameraHelper)),S.isVirtual&&P.originalCamera==p&&i(p,S),T=S.shadowMap,x=S.shadowMatrix,b=S.shadowCamera,b.position.getPositionFromMatrix(S.matrixWorld),d.getPositionFromMatrix(S.target.matrixWorld),b.lookAt(d),b.updateMatrixWorld(),b.matrixWorldInverse.getInverse(b.matrixWorld),S.cameraHelper&&(S.cameraHelper.visible=S.shadowCameraVisible),S.shadowCameraVisible&&S.cameraHelper.update(),x.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),x.multiply(b.projectionMatrix),x.multiply(b.matrixWorldInverse),u.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),c.setFromMatrix(u),o.setRenderTarget(T),o.clear(),C=f.__webglObjects,v=0,E=C.length;E>v;v++)H=C[v],M=H.object,H.render=!1,M.visible&&M.castShadow&&((M instanceof THREE.Mesh||M instanceof THREE.ParticleSystem)&&M.frustumCulled&&!c.intersectsObject(M)||(M._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,M.matrixWorld),H.render=!0));var F,I,O;for(v=0,E=C.length;E>v;v++)H=C[v],H.render&&(M=H.object,w=H.buffer,F=n(M),I=M.geometry.morphTargets.length>0&&F.morphTargets,O=M instanceof THREE.SkinnedMesh&&F.skinning,R=M.customDepthMaterial?M.customDepthMaterial:O?I?h:l:I?s:a,w instanceof THREE.BufferGeometry?o.renderBufferDirect(b,f.__lights,k,R,w,M):o.renderBuffer(b,f.__lights,k,R,w,M));for(C=f.__webglObjectsImmediate,v=0,E=C.length;E>v;v++)H=C[v],M=H.object,M.visible&&M.castShadow&&(M._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,M.matrixWorld),o.renderImmediateObject(b,f.__lights,k,a,M))}var U=o.getClearColor(),V=o.getClearAlpha();r.clearColor(U.r,U.g,U.b,V),r.enable(r.BLEND),o.shadowMapCullFace===THREE.CullFaceFront&&r.cullFace(r.BACK)}},THREE.ShadowMapPlugin.__projector=new THREE.Projector,THREE.SpritePlugin=function(){function e(e,t){var n=i.createProgram(),r=i.createShader(i.FRAGMENT_SHADER),o=i.createShader(i.VERTEX_SHADER),a="precision "+t+" float;\n";return i.shaderSource(r,a+e.fragmentShader),i.shaderSource(o,a+e.vertexShader),i.compileShader(r),i.compileShader(o),i.attachShader(n,r),i.attachShader(n,o),i.linkProgram(n),n}function t(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id}var i,n,r,o={};this.init=function(t){i=t.context,n=t,r=t.getPrecision(),o.vertices=new Float32Array(16),o.faces=new Uint16Array(6);var a=0;o.vertices[a++]=-1,o.vertices[a++]=-1,o.vertices[a++]=0,o.vertices[a++]=0,o.vertices[a++]=1,o.vertices[a++]=-1,o.vertices[a++]=1,o.vertices[a++]=0,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=1,o.vertices[a++]=-1,o.vertices[a++]=1,o.vertices[a++]=0,o.vertices[a++]=1,a=0,o.faces[a++]=0,o.faces[a++]=1,o.faces[a++]=2,o.faces[a++]=0,o.faces[a++]=2,o.faces[a++]=3,o.vertexBuffer=i.createBuffer(),o.elementBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,o.vertexBuffer),i.bufferData(i.ARRAY_BUFFER,o.vertices,i.STATIC_DRAW),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,o.elementBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,o.faces,i.STATIC_DRAW),o.program=e(THREE.ShaderSprite.sprite,r),o.attributes={},o.uniforms={},o.attributes.position=i.getAttribLocation(o.program,"position"),o.attributes.uv=i.getAttribLocation(o.program,"uv"),o.uniforms.uvOffset=i.getUniformLocation(o.program,"uvOffset"),o.uniforms.uvScale=i.getUniformLocation(o.program,"uvScale"),o.uniforms.rotation=i.getUniformLocation(o.program,"rotation"),o.uniforms.scale=i.getUniformLocation(o.program,"scale"),o.uniforms.alignment=i.getUniformLocation(o.program,"alignment"),o.uniforms.color=i.getUniformLocation(o.program,"color"),o.uniforms.map=i.getUniformLocation(o.program,"map"),o.uniforms.opacity=i.getUniformLocation(o.program,"opacity"),o.uniforms.useScreenCoordinates=i.getUniformLocation(o.program,"useScreenCoordinates"),o.uniforms.sizeAttenuation=i.getUniformLocation(o.program,"sizeAttenuation"),o.uniforms.screenPosition=i.getUniformLocation(o.program,"screenPosition"),o.uniforms.modelViewMatrix=i.getUniformLocation(o.program,"modelViewMatrix"),o.uniforms.projectionMatrix=i.getUniformLocation(o.program,"projectionMatrix"),o.uniforms.fogType=i.getUniformLocation(o.program,"fogType"),o.uniforms.fogDensity=i.getUniformLocation(o.program,"fogDensity"),o.uniforms.fogNear=i.getUniformLocation(o.program,"fogNear"),o.uniforms.fogFar=i.getUniformLocation(o.program,"fogFar"),o.uniforms.fogColor=i.getUniformLocation(o.program,"fogColor"),o.uniforms.alphaTest=i.getUniformLocation(o.program,"alphaTest")},this.render=function(e,r,a,s){var l=e.__webglSprites,h=l.length;if(h){var c=o.attributes,u=o.uniforms,f=s/a,p=.5*a,d=.5*s;i.useProgram(o.program),i.enableVertexAttribArray(c.position),i.enableVertexAttribArray(c.uv),i.disable(i.CULL_FACE),i.enable(i.BLEND),i.bindBuffer(i.ARRAY_BUFFER,o.vertexBuffer),i.vertexAttribPointer(c.position,2,i.FLOAT,!1,16,0),i.vertexAttribPointer(c.uv,2,i.FLOAT,!1,16,8),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,o.elementBuffer),i.uniformMatrix4fv(u.projectionMatrix,!1,r.projectionMatrix.elements),i.activeTexture(i.TEXTURE0),i.uniform1i(u.map,0);var m=0,g=0,v=e.fog;v?(i.uniform3f(u.fogColor,v.color.r,v.color.g,v.color.b),v instanceof THREE.Fog?(i.uniform1f(u.fogNear,v.near),i.uniform1f(u.fogFar,v.far),i.uniform1i(u.fogType,1),m=1,g=1):v instanceof THREE.FogExp2&&(i.uniform1f(u.fogDensity,v.density),i.uniform1i(u.fogType,2),m=2,g=2)):(i.uniform1i(u.fogType,0),m=0,g=0);var E,y,T,x,b,_,w=[];for(E=0;h>E;E++)y=l[E],T=y.material,y.visible&&0!==T.opacity&&(T.useScreenCoordinates?y.z=-y.position.z:(y._modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,y.matrixWorld),y.z=-y._modelViewMatrix.elements[14]));for(l.sort(t),E=0;h>E;E++)y=l[E],T=y.material,y.visible&&0!==T.opacity&&T.map&&T.map.image&&T.map.image.width&&(i.uniform1f(u.alphaTest,T.alphaTest),T.useScreenCoordinates===!0?(i.uniform1i(u.useScreenCoordinates,1),i.uniform3f(u.screenPosition,(y.position.x*n.devicePixelRatio-p)/p,(d-y.position.y*n.devicePixelRatio)/d,Math.max(0,Math.min(1,y.position.z))),w[0]=n.devicePixelRatio,w[1]=n.devicePixelRatio):(i.uniform1i(u.useScreenCoordinates,0),i.uniform1i(u.sizeAttenuation,T.sizeAttenuation?1:0),i.uniformMatrix4fv(u.modelViewMatrix,!1,y._modelViewMatrix.elements),w[0]=1,w[1]=1),_=e.fog&&T.fog?g:0,m!==_&&(i.uniform1i(u.fogType,_),m=_),b=1/(T.scaleByViewport?s:1),w[0]*=b*f*y.scale.x,w[1]*=b*y.scale.y,i.uniform2f(u.uvScale,T.uvScale.x,T.uvScale.y),i.uniform2f(u.uvOffset,T.uvOffset.x,T.uvOffset.y),i.uniform2f(u.alignment,T.alignment.x,T.alignment.y),i.uniform1f(u.opacity,T.opacity),i.uniform3f(u.color,T.color.r,T.color.g,T.color.b),i.uniform1f(u.rotation,y.rotation),i.uniform2fv(u.scale,w),n.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst),n.setDepthTest(T.depthTest),n.setDepthWrite(T.depthWrite),n.setTexture(T.map,0),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0));i.enable(i.CULL_FACE)}}},THREE.DepthPassPlugin=function(){function e(e){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[0]:e.material}this.enabled=!1,this.renderTarget=null;var t,i,n,r,o,a,s=new THREE.Frustum,l=new THREE.Matrix4;this.init=function(e){t=e.context,i=e;var s=THREE.ShaderLib.depthRGBA,l=THREE.UniformsUtils.clone(s.uniforms);n=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l}),r=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,morphTargets:!0}),o=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,skinning:!0}),a=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:l,morphTargets:!0,skinning:!0}),n._shadowPass=!0,r._shadowPass=!0,o._shadowPass=!0,a._shadowPass=!0},this.render=function(e,t){this.enabled&&this.update(e,t)},this.update=function(h,c){var u,f,p,d,m,g,v,E,y,T,x,b,_=null;for(t.clearColor(1,1,1,1),t.disable(t.BLEND),i.setDepthTest(!0),h.autoUpdate===!0&&h.updateMatrixWorld(),c.matrixWorldInverse.getInverse(c.matrixWorld),l.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),s.setFromMatrix(l),i.setRenderTarget(this.renderTarget),i.clear(),b=h.__webglObjects,p=0,d=b.length;d>p;p++)y=b[p],T=y.object,y.render=!1,T.visible&&((T instanceof THREE.Mesh||T instanceof THREE.ParticleSystem)&&T.frustumCulled&&!s.intersectsObject(T)||(T._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,T.matrixWorld),y.render=!0));var w,R,H;for(p=0,d=b.length;d>p;p++)if(y=b[p],y.render){if(T=y.object,v=y.buffer,T instanceof THREE.ParticleSystem&&!T.customDepthMaterial)continue;w=e(T),w&&i.setMaterialFaces(T.material),R=T.geometry.morphTargets.length>0&&w.morphTargets,H=T instanceof THREE.SkinnedMesh&&w.skinning,E=T.customDepthMaterial?T.customDepthMaterial:H?R?a:o:R?r:n,v instanceof THREE.BufferGeometry?i.renderBufferDirect(c,h.__lights,_,E,v,T):i.renderBuffer(c,h.__lights,_,E,v,T)}for(b=h.__webglObjectsImmediate,p=0,d=b.length;d>p;p++)y=b[p],T=y.object,T.visible&&(T._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,T.matrixWorld),i.renderImmediateObject(c,h.__lights,_,n,T));var M=i.getClearColor(),S=i.getClearAlpha();t.clearColor(M.r,M.g,M.b,S),t.enable(t.BLEND)}},THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +","texture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +","texture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +","texture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +","texture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +","texture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +","texture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +","texture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +","texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility = (       visibility.r / 9.0 ) *","( 1.0 - visibility.g / 9.0 ) *","(       visibility.b / 9.0 ) *","( 1.0 - visibility.a / 9.0 );","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},lensFlare:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +","texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +","texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +","texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}},THREE.ShaderSprite={sprite:{vertexShader:["uniform int useScreenCoordinates;","uniform int sizeAttenuation;","uniform vec3 screenPosition;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 alignment;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position + alignment;","vec2 rotatedPosition;","rotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;","rotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;","vec4 finalPosition;","if( useScreenCoordinates != 0 ) {","finalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );","} else {","finalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );","}","gl_Position = finalPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")}},THREE.TrackballControls=function(e,t){function i(e){u.enabled!==!1&&(window.removeEventListener("keydown",i),m=d,d===f.NONE&&(e.keyCode!==u.keys[f.ROTATE]||u.noRotate?e.keyCode!==u.keys[f.ZOOM]||u.noZoom?e.keyCode!==u.keys[f.PAN]||u.noPan||(d=f.PAN):d=f.ZOOM:d=f.ROTATE))}function n(e){u.enabled!==!1&&(d=m,window.addEventListener("keydown",i,!1))}function r(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),d===f.NONE&&(d=e.button),d!==f.ROTATE||u.noRotate?d!==f.ZOOM||u.noZoom?d!==f.PAN||u.noPan||(_=w=u.getMouseOnScreen(e.clientX,e.clientY)):y=T=u.getMouseOnScreen(e.clientX,e.clientY):v=E=u.getMouseProjectionOnBall(e.clientX,e.clientY),document.addEventListener("mousemove",o,!1),document.addEventListener("mouseup",a,!1))}function o(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),d!==f.ROTATE||u.noRotate?d!==f.ZOOM||u.noZoom?d!==f.PAN||u.noPan||(w=u.getMouseOnScreen(e.clientX,e.clientY)):T=u.getMouseOnScreen(e.clientX,e.clientY):E=u.getMouseProjectionOnBall(e.clientX,e.clientY))}function a(e){u.enabled!==!1&&(e.preventDefault(),e.stopPropagation(),d=f.NONE,document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a))}function s(e){if(u.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=0;e.wheelDelta?t=e.wheelDelta/40:e.detail&&(t=-e.detail/3),y.y+=.01*t}}function l(e){if(u.enabled!==!1)switch(e.touches.length){case 1:d=f.TOUCH_ROTATE,v=E=u.getMouseProjectionOnBall(e.touches[0].pageX,e.touches[0].pageY);break;case 2:d=f.TOUCH_ZOOM;var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY;b=x=Math.sqrt(t*t+i*i);break;case 3:d=f.TOUCH_PAN,_=w=u.getMouseOnScreen(e.touches[0].pageX,e.touches[0].pageY);break;default:d=f.NONE}}function h(e){if(u.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:E=u.getMouseProjectionOnBall(e.touches[0].pageX,e.touches[0].pageY);break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY;b=Math.sqrt(t*t+i*i);break;case 3:w=u.getMouseOnScreen(e.touches[0].pageX,e.touches[0].pageY);break;default:d=f.NONE}}function c(e){if(u.enabled!==!1){switch(e.touches.length){case 1:v=E=u.getMouseProjectionOnBall(e.touches[0].pageX,e.touches[0].pageY);break;case 2:x=b=0;break;case 3:_=w=u.getMouseOnScreen(e.touches[0].pageX,e.touches[0].pageY)}d=f.NONE}}var u=this,f={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={width:0,height:0,offsetLeft:0,offsetTop:0},this.radius=(this.screen.width+this.screen.height)/4,this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var p=new THREE.Vector3,d=f.NONE,m=f.NONE,g=new THREE.Vector3,v=new THREE.Vector3,E=new THREE.Vector3,y=new THREE.Vector2,T=new THREE.Vector2,x=0,b=0,_=new THREE.Vector2,w=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var R={type:"change"};this.handleResize=function(){this.screen.width=window.innerWidth,this.screen.height=window.innerHeight,this.screen.offsetLeft=0,this.screen.offsetTop=0,this.radius=(this.screen.width+this.screen.height)/4},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)},this.getMouseOnScreen=function(e,t){return new THREE.Vector2((e-u.screen.offsetLeft)/u.radius*.5,(t-u.screen.offsetTop)/u.radius*.5)},this.getMouseProjectionOnBall=function(e,t){var i=new THREE.Vector3((e-.5*u.screen.width-u.screen.offsetLeft)/u.radius,(.5*u.screen.height+u.screen.offsetTop-t)/u.radius,0),n=i.length();n>1?i.normalize():i.z=Math.sqrt(1-n*n),g.copy(u.object.position).sub(u.target);var r=u.object.up.clone().setLength(i.y);return r.add(u.object.up.clone().cross(g).setLength(i.x)),r.add(g.setLength(i.z)),r},this.rotateCamera=function(){var e=Math.acos(v.dot(E)/v.length()/E.length());if(e){var t=(new THREE.Vector3).crossVectors(v,E).normalize(),i=new THREE.Quaternion;e*=u.rotateSpeed,i.setFromAxisAngle(t,-e),g.applyQuaternion(i),u.object.up.applyQuaternion(i),E.applyQuaternion(i),u.staticMoving?v.copy(E):(i.setFromAxisAngle(t,e*(u.dynamicDampingFactor-1)),v.applyQuaternion(i))}},this.zoomCamera=function(){if(d===f.TOUCH_ZOOM){var e=x/b;x=b,g.multiplyScalar(e)}else{var e=1+(T.y-y.y)*u.zoomSpeed;1!==e&&e>0&&(g.multiplyScalar(e),u.staticMoving?y.copy(T):y.y+=(T.y-y.y)*this.dynamicDampingFactor)}},this.panCamera=function(){var e=w.clone().sub(_);if(e.lengthSq()){e.multiplyScalar(g.length()*u.panSpeed);var t=g.clone().cross(u.object.up).setLength(e.x);t.add(u.object.up.clone().setLength(e.y)),u.object.position.add(t),u.target.add(t),u.staticMoving?_=w:_.add(e.subVectors(w,_).multiplyScalar(u.dynamicDampingFactor))
}},this.checkDistances=function(){u.noZoom&&u.noPan||(u.object.position.lengthSq()>u.maxDistance*u.maxDistance&&u.object.position.setLength(u.maxDistance),g.lengthSq()<u.minDistance*u.minDistance&&u.object.position.addVectors(u.target,g.setLength(u.minDistance)))},this.update=function(){g.subVectors(u.object.position,u.target),u.noRotate||u.rotateCamera(),u.noZoom||u.zoomCamera(),u.noPan||u.panCamera(),u.object.position.addVectors(u.target,g),u.checkDistances(),u.object.lookAt(u.target),p.distanceToSquared(u.object.position)>0&&(u.dispatchEvent(R),p.copy(u.object.position))},this.reset=function(){d=f.NONE,m=f.NONE,u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.up.copy(u.up0),g.subVectors(u.object.position,u.target),u.object.lookAt(u.target),u.dispatchEvent(R),p.copy(u.object.position)},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",r,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",l,!1),this.domElement.addEventListener("touchend",c,!1),this.domElement.addEventListener("touchmove",h,!1),window.addEventListener("keydown",i,!1),window.addEventListener("keyup",n,!1),this.handleResize()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.ColorConverter={setHSV:function(e,t,i,n){return e.setHSL(t,i*n/((t=(2-i)*n)<1?t:2-t),.5*t)},getHSV:function(e){var t=e.getHSL();return t.s*=t.l<.5?t.l:1-t.l,{h:t.h,s:2*t.s/(t.l+t.s),v:t.l+t.s}},setCMYK:function(e,t,i,n,r){var o=(1-t)*(1-r),a=(1-i)*(1-r),s=(1-n)*(1-r);return e.setRGB(o,a,s)},getCMYK:function(e){var t=e.r,i=e.g,n=e.b,r=1-Math.max(t,i,n),o=(1-t-r)/(1-r),a=(1-i-r)/(1-r),s=(1-n-r)/(1-r);return{c:o,m:a,y:s,k:r}}},THREE.SVGRenderer=function(){function e(e){S.setRGB(0,0,0),C.setRGB(0,0,0),A.setRGB(0,0,0);for(var t=0,i=e.length;i>t;t++){var n=e[t],r=n.color;n instanceof THREE.AmbientLight?(S.r+=r.r,S.g+=r.g,S.b+=r.b):n instanceof THREE.DirectionalLight?(C.r+=r.r,C.g+=r.g,C.b+=r.b):n instanceof THREE.PointLight&&(A.r+=r.r,A.g+=r.g,A.b+=r.b)}}function t(e,t,i,n){for(var r=0,o=e.length;o>r;r++){var a=e[r],s=a.color;if(a instanceof THREE.DirectionalLight){var l=k.getPositionFromMatrix(a.matrixWorld).normalize(),h=i.dot(l);if(0>=h)continue;h*=a.intensity,n.r+=s.r*h,n.g+=s.g*h,n.b+=s.b*h}else if(a instanceof THREE.PointLight){var l=k.getPositionFromMatrix(a.matrixWorld),h=i.dot(k.subVectors(l,t).normalize());if(0>=h)continue;if(h*=0==a.distance?1:1-Math.min(t.distanceTo(l)/a.distance,1),0==h)continue;h*=a.intensity,n.r+=s.r*h,n.g+=s.g*h,n.b+=s.b*h}}}function i(e,t,i){}function n(e,t,i,n){z=a(O++),z.setAttribute("x1",e.positionScreen.x),z.setAttribute("y1",e.positionScreen.y),z.setAttribute("x2",t.positionScreen.x),z.setAttribute("y2",t.positionScreen.y),n instanceof THREE.LineBasicMaterial&&(z.setAttribute("style","fill: none; stroke: "+n.color.getStyle()+"; stroke-width: "+n.linewidth+"; stroke-opacity: "+n.opacity+"; stroke-linecap: "+n.linecap+"; stroke-linejoin: "+n.linejoin),m.appendChild(z))}function r(e,i,n,r,o){if(c.info.render.vertices+=3,c.info.render.faces++,z=s(F++),z.setAttribute("d","M "+e.positionScreen.x+" "+e.positionScreen.y+" L "+i.positionScreen.x+" "+i.positionScreen.y+" L "+n.positionScreen.x+","+n.positionScreen.y+"z"),o instanceof THREE.MeshBasicMaterial)H.copy(o.color),o.vertexColors===THREE.FaceColors&&H.multiply(r.color);else if(o instanceof THREE.MeshLambertMaterial||o instanceof THREE.MeshPhongMaterial)M.copy(o.color),o.vertexColors===THREE.FaceColors&&M.multiply(r.color),H.copy(S),t(p,r.centroidModel,r.normalModel,H),H.multiply(M).add(o.emissive);else if(o instanceof THREE.MeshDepthMaterial)D=1-o.__2near/(o.__farPlusNear-r.z*o.__farMinusNear),H.setRGB(D,D,D);else if(o instanceof THREE.MeshNormalMaterial){var a=r.normalModelView;H.setRGB(a.x,a.y,a.z).multiplyScalar(.5).addScalar(.5)}o.wireframe?z.setAttribute("style","fill: none; stroke: "+H.getStyle()+"; stroke-width: "+o.wireframeLinewidth+"; stroke-opacity: "+o.opacity+"; stroke-linecap: "+o.wireframeLinecap+"; stroke-linejoin: "+o.wireframeLinejoin):z.setAttribute("style","fill: "+H.getStyle()+"; fill-opacity: "+o.opacity),m.appendChild(z)}function o(e,i,n,r,o,a){if(c.info.render.vertices+=4,c.info.render.faces++,z=s(F++),z.setAttribute("d","M "+e.positionScreen.x+" "+e.positionScreen.y+" L "+i.positionScreen.x+" "+i.positionScreen.y+" L "+n.positionScreen.x+","+n.positionScreen.y+" L "+r.positionScreen.x+","+r.positionScreen.y+"z"),a instanceof THREE.MeshBasicMaterial)H.copy(a.color),a.vertexColors===THREE.FaceColors&&H.multiply(o.color);else if(a instanceof THREE.MeshLambertMaterial||a instanceof THREE.MeshPhongMaterial)M.copy(a.color),a.vertexColors===THREE.FaceColors&&M.multiply(o.color),H.copy(S),t(p,o.centroidModel,o.normalModel,H),H.multiply(M).add(a.emissive);else if(a instanceof THREE.MeshDepthMaterial)D=1-a.__2near/(a.__farPlusNear-o.z*a.__farMinusNear),H.setRGB(D,D,D);else if(a instanceof THREE.MeshNormalMaterial){var l=o.normalModelView;H.setRGB(l.x,l.y,l.z).multiplyScalar(.5).addScalar(.5)}a.wireframe?z.setAttribute("style","fill: none; stroke: "+H.getStyle()+"; stroke-width: "+a.wireframeLinewidth+"; stroke-opacity: "+a.opacity+"; stroke-linecap: "+a.wireframeLinecap+"; stroke-linejoin: "+a.wireframeLinejoin):z.setAttribute("style","fill: "+H.getStyle()+"; fill-opacity: "+a.opacity),m.appendChild(z)}function a(e){return null==N[e]?(N[e]=document.createElementNS("http://www.w3.org/2000/svg","line"),0==U&&N[e].setAttribute("shape-rendering","crispEdges"),N[e]):N[e]}function s(e){return null==P[e]?(P[e]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==U&&P[e].setAttribute("shape-rendering","crispEdges"),P[e]):P[e]}function l(e){return null==L[e]?(L[e]=document.createElementNS("http://www.w3.org/2000/svg","circle"),0==U&&L[e].setAttribute("shape-rendering","crispEdges"),L[e]):L[e]}function h(e){for(;e.length<6;)e="0"+e;return e}console.log("THREE.SVGRenderer",THREE.REVISION);var c=this,u,f,p,d=new THREE.Projector,m=document.createElementNS("http://www.w3.org/2000/svg","svg"),g,v,E,y,T,x,b,_,w=new THREE.Box2,R=new THREE.Box2,H=new THREE.Color,M=new THREE.Color,S=new THREE.Color,C=new THREE.Color,A=new THREE.Color,D,k=new THREE.Vector3,P=[],L=[],N=[],z,F,I,O,U=1;this.domElement=m,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.setQuality=function(e){switch(e){case"high":U=1;break;case"low":U=0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setClearColor=function(e,t){},this.setSize=function(e,t){g=e,v=t,E=g/2,y=v/2,m.setAttribute("viewBox",-E+" "+-y+" "+g+" "+v),m.setAttribute("width",g),m.setAttribute("height",v),w.min.set(-E,-y),w.max.set(E,y)},this.clear=function(){for(F=0,I=0,O=0;m.childNodes.length>0;)m.removeChild(m.childNodes[0])},this.render=function(t,a){if(a instanceof THREE.Camera==!1)return void console.error("THREE.SVGRenderer.render: camera is not an instance of THREE.Camera.");this.autoClear===!0&&this.clear(),c.info.render.vertices=0,c.info.render.faces=0,u=d.projectScene(t,a,this.sortObjects,this.sortElements),f=u.elements,p=u.lights,e(p);for(var s=0,l=f.length;l>s;s++){var h=f[s],m=h.material;if(void 0!==m&&m.visible!==!1)if(R.makeEmpty(),h instanceof THREE.RenderableParticle)T=h,T.x*=E,T.y*=-y,i(T,h,m);else if(h instanceof THREE.RenderableLine)T=h.v1,x=h.v2,T.positionScreen.x*=E,T.positionScreen.y*=-y,x.positionScreen.x*=E,x.positionScreen.y*=-y,R.setFromPoints([T.positionScreen,x.positionScreen]),w.isIntersectionBox(R)===!0&&n(T,x,h,m);else if(h instanceof THREE.RenderableFace3){if(T=h.v1,x=h.v2,b=h.v3,T.positionScreen.z<-1||T.positionScreen.z>1)continue;if(x.positionScreen.z<-1||x.positionScreen.z>1)continue;if(b.positionScreen.z<-1||b.positionScreen.z>1)continue;T.positionScreen.x*=E,T.positionScreen.y*=-y,x.positionScreen.x*=E,x.positionScreen.y*=-y,b.positionScreen.x*=E,b.positionScreen.y*=-y,R.setFromPoints([T.positionScreen,x.positionScreen,b.positionScreen]),w.isIntersectionBox(R)===!0&&r(T,x,b,h,m)}else if(h instanceof THREE.RenderableFace4){if(T=h.v1,x=h.v2,b=h.v3,_=h.v4,T.positionScreen.z<-1||T.positionScreen.z>1)continue;if(x.positionScreen.z<-1||x.positionScreen.z>1)continue;if(b.positionScreen.z<-1||b.positionScreen.z>1)continue;if(_.positionScreen.z<-1||_.positionScreen.z>1)continue;T.positionScreen.x*=E,T.positionScreen.y*=-y,x.positionScreen.x*=E,x.positionScreen.y*=-y,b.positionScreen.x*=E,b.positionScreen.y*=-y,_.positionScreen.x*=E,_.positionScreen.y*=-y,R.setFromPoints([T.positionScreen,x.positionScreen,b.positionScreen,_.positionScreen]),w.isIntersectionBox(R)===!0&&o(T,x,b,_,h,m)}}}};